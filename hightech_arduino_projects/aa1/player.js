/* VimeoPlayer - v2.74.2 - 2018-06-14 - https://player.vimeo.com/NOTICE.txt */
var VimeoPlayer=function(){"use strict";var s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var M=t(function(e){var t,n,i;i=function(){var t,n,i,r,o,a,e=Object.prototype.toString,s="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),t=function(e,t,n,i){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:!1!==i})}}catch(e){t=function(e,t,n){return e[t]=n,e}}function l(e,t){i.add(e,t),n||(n=s(i.drain))}function u(e){var t,n=typeof e;return null==e||"object"!=n&&"function"!=n||(t=e.then),"function"==typeof t&&t}function c(){for(var e=0;e<this.chain.length;e++)d(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function d(e,t,n){var i,r;try{!1===t?n.reject(e.msg):(i=!0===t?e.msg:t.call(void 0,e.msg))===n.promise?n.reject(TypeError("Promise-chain cycle")):(r=u(i))?r.call(i,n.resolve,n.reject):n.resolve(i)}catch(e){n.reject(e)}}function f(e){var t=this;t.triggered||(t.triggered=!0,t.def&&(t=t.def),t.msg=e,t.state=2,0<t.chain.length&&l(c,t))}function h(e,n,i,r){for(var t=0;t<n.length;t++)!function(t){e.resolve(n[t]).then(function(e){i(t,e)},r)}(t)}function v(e){this.def=e,this.triggered=!1}function p(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var i=new function(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}(this);this.then=function(e,t){var n={success:"function"!=typeof e||e,failure:"function"==typeof t&&t};return n.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");n.resolve=e,n.reject=t}),i.chain.push(n),0!==i.state&&l(c,i),n.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,function(e){(function e(n){var i,r=this;if(!r.triggered){r.triggered=!0,r.def&&(r=r.def);try{(i=u(n))?l(function(){var t=new v(r);try{i.call(n,function(){e.apply(t,arguments)},function(){f.apply(t,arguments)})}catch(e){f.call(t,e)}}):(r.msg=n,r.state=1,0<r.chain.length&&l(c,r))}catch(e){f.call(new v(r),e)}}}).call(i,e)},function(e){f.call(i,e)})}catch(e){f.call(i,e)}}i={add:function(e,t){a=new function(e,t){this.fn=e,this.self=t,this.next=void 0}(e,t),o?o.next=a:r=a,o=a,a=void 0},drain:function(){var e=r;for(r=o=n=void 0;e;)e.fn.call(e.self),e=e.next}};var m=t({},"constructor",p,!1);return t(p.prototype=m,"__NPO__",0,!1),t(p,"resolve",function(n){return n&&"object"==typeof n&&1===n.__NPO__?n:new this(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");e(n)})}),t(p,"reject",function(n){return new this(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");t(n)})}),t(p,"all",function(t){var a=this;return"[object Array]"!=e.call(t)?a.reject(TypeError("Not an array")):0===t.length?a.resolve([]):new a(function(n,e){if("function"!=typeof n||"function"!=typeof e)throw TypeError("Not a function");var i=t.length,r=Array(i),o=0;h(a,t,function(e,t){r[e]=t,++o===i&&n(r)},e)})}),t(p,"race",function(t){var i=this;return"[object Array]"!=e.call(t)?i.reject(TypeError("Not an array")):new i(function(n,e){if("function"!=typeof n||"function"!=typeof e)throw TypeError("Not a function");h(i,t,function(e,t){n(t)},e)})}),p},(n=s)[t="Promise"]=n[t]||i(),e.exports&&(e.exports=n[t])});Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}}});var n=navigator.userAgent.toLowerCase();function i(e){e=e.toLowerCase();var t=new RegExp(e).test(n);return"safari"===e?t&&new RegExp("version").test(n):t}function r(e){var t=document.createElement("div"),n=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ");for(var r in i){var o=i[r];if(void 0!==t.style[o])return o}return e}var o=!!i("android")&&(parseFloat(n.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),a=window.devicePixelRatio||1,l=!(!i("windows phone")&&!i("iemobile"))&&(parseFloat(n.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),u=!!i("msie")&&parseFloat(n.replace(/^.*msie (\d+).*$/,"$1")),c=!!i("trident")&&parseFloat(n.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,d=!!(i("ipad;")||i("iphone;")||i("ipod touch;"))&&parseFloat(n.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2"));function f(){if(!i("safari"))return[];var e=n.split(" ").find(function(e){return/version\//.test(e)});return e?e.replace("version/","").split(".").map(function(e){return parseInt(e,10)}):[]}var h=i("safari")&&i("apple")&&!i("chrome")&&!i("android")&&11==f()[0],Te={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:o,hasAutoplayPolicy:o||d||h||66<=function(){if(!i("chrome"))return[];var e=n.split(" ").find(function(e){return d?/CriOS\//.test(e):/chrome\//.test(e)});return e?e.replace("chrome/","").split(".").map(function(e){return parseInt(e,10)}):[]}()[0],iOS:d,mobileAndroid:o&&i("mobile"),browser:{bb10:i("bb10"),chrome:i("chrome"),firefox:i("firefox"),ie:u||c,edge:i("edge"),opera:i("opera"),safari:i("safari")&&i("apple")&&!i("chrome")&&!i("android")},devicePixelRatio:a,flash:function(){var e=navigator,t=!1,n=[0,0,0],i=null,r="Shockwave Flash",o="application/x-shockwave-flash";if(void 0!==e.plugins&&"object"==typeof e.plugins[r])!(i=e.plugins[r].description)||void 0!==e.mimeTypes&&e.mimeTypes[o]&&!e.mimeTypes[o].enabledPlugin||(t=!0,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),n[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),n[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),n[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(void 0!==window.ActiveXObject)try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a&&(i=a.GetVariable("$version"))&&(t=!0,i=i.split(" ")[1].split(","),n=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)])}catch(e){}return{installed:t,version:n.join("."),major:n[0],minor:n[1],revision:n[2]}}(),iPhone:i("iphone;")||i("ipod touch;")||i("ipod;"),iPad:i("ipad;"),iPadNonRetina:i("ipad;")&&a<2,mac:i("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||i("windows phone")||1<window.navigator.maxTouchPoints||window.navigator.msMaxTouchPoints||!1,transformProperty:r("transform"),transitionProperty:r("transition"),windowsPhone:l},v=/mac os x 10_13/.test(n),p=Te.iOS&&/os 11/.test(n),m=Te.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,g=Te.iPad&&(1024===window.screen.availHeight&&1366===window.screen.availWidth||1112===window.screen.availHeight&&834===window.screen.availWidth);Te.hevc=!!(h&&v||h&&p)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"'),Te.hdr=h&&p&&(m||g),Te.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&48<=screen.colorDepth&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),Te.spatialPlayback=!(Te.iOS||Te.iPad||Te.browser.ie)&&(!i("safari")||11<f()[0]||11==f()[0]&&(1<f()[2]||0<f()[1])),Te.stereoscopic=Te.spatialPlayback&&Te.mobileAndroid;var y=Array.isArray,_="object"==typeof s&&s&&s.Object===Object&&s,b="object"==typeof self&&self&&self.Object===Object&&self,w=_||b||Function("return this")(),k=w.Symbol,S=Object.prototype,E=S.hasOwnProperty,T=S.toString,x=k?k.toStringTag:void 0;var A=function(e){var t=E.call(e,x),n=e[x];try{e[x]=void 0}catch(e){}var i=T.call(e);return t?e[x]=n:delete e[x],i},L=Object.prototype.toString;var P=function(e){return L.call(e)},C="[object Null]",O="[object Undefined]",R=k?k.toStringTag:void 0;var I=function(e){return null==e?void 0===e?O:C:R&&R in Object(e)?A(e):P(e)};var D=function(e){return null!=e&&"object"==typeof e},F="[object Symbol]";var B=function(e){return"symbol"==typeof e||D(e)&&I(e)==F},q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,N=/^\w*$/;var j=function(e,t){if(y(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!B(e))||N.test(e)||!q.test(e)||null!=t&&e in Object(t)};var U=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},V="[object AsyncFunction]",H="[object Function]",W="[object GeneratorFunction]",z="[object Proxy]";var G,K=function(e){if(!U(e))return!1;var t=I(e);return t==H||t==W||t==V||t==z},Y=w["__core-js_shared__"],X=(G=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"";var $=function(e){return!!X&&X in e},Q=Function.prototype.toString;var J=function(e){if(null!=e){try{return Q.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Z=/^\[object .+?Constructor\]$/,ee=Function.prototype,te=Object.prototype,ne=ee.toString,ie=te.hasOwnProperty,re=RegExp("^"+ne.call(ie).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var oe=function(e){return!(!U(e)||$(e))&&(K(e)?re:Z).test(J(e))};var ae=function(e,t){return null==e?void 0:e[t]};var se=function(e,t){var n=ae(e,t);return oe(n)?n:void 0},le=se(Object,"create");var ue=function(){this.__data__=le?le(null):{},this.size=0};var ce=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},de="__lodash_hash_undefined__",fe=Object.prototype.hasOwnProperty;var he=function(e){var t=this.__data__;if(le){var n=t[e];return n===de?void 0:n}return fe.call(t,e)?t[e]:void 0},ve=Object.prototype.hasOwnProperty;var pe=function(e){var t=this.__data__;return le?void 0!==t[e]:ve.call(t,e)},me="__lodash_hash_undefined__";var ge=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=le&&void 0===t?me:t,this};function ye(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}ye.prototype.clear=ue,ye.prototype.delete=ce,ye.prototype.get=he,ye.prototype.has=pe,ye.prototype.set=ge;var _e=ye;var be=function(){this.__data__=[],this.size=0};var we=function(e,t){return e===t||e!=e&&t!=t};var ke=function(e,t){for(var n=e.length;n--;)if(we(e[n][0],t))return n;return-1},Se=Array.prototype.splice;var Ee=function(e){var t=this.__data__,n=ke(t,e);return!(n<0||(n==t.length-1?t.pop():Se.call(t,n,1),--this.size,0))};var xe=function(e){var t=this.__data__,n=ke(t,e);return n<0?void 0:t[n][1]};var Ae=function(e){return-1<ke(this.__data__,e)};var Le=function(e,t){var n=this.__data__,i=ke(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};function Pe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Pe.prototype.clear=be,Pe.prototype.delete=Ee,Pe.prototype.get=xe,Pe.prototype.has=Ae,Pe.prototype.set=Le;var Ce=Pe,Oe=se(w,"Map");var Re=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Me=function(e,t){var n=e.__data__;return Re(t)?n["string"==typeof t?"string":"hash"]:n.map};var Ie=function(e){var t=Me(this,e).delete(e);return this.size-=t?1:0,t};var De=function(e){return Me(this,e).get(e)};var Fe=function(e){return Me(this,e).has(e)};var Be=function(e,t){var n=Me(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};function qe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}qe.prototype.clear=function(){this.size=0,this.__data__={hash:new _e,map:new(Oe||Ce),string:new _e}},qe.prototype.delete=Ie,qe.prototype.get=De,qe.prototype.has=Fe,qe.prototype.set=Be;var Ne=qe,je="Expected a function";function Ue(r,o){if("function"!=typeof r||null!=o&&"function"!=typeof o)throw new TypeError(je);var a=function(){var e=arguments,t=o?o.apply(this,e):e[0],n=a.cache;if(n.has(t))return n.get(t);var i=r.apply(this,e);return a.cache=n.set(t,i)||n,i};return a.cache=new(Ue.Cache||Ne),a}Ue.Cache=Ne;var Ve=Ue,He=500;var We=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ze=/\\(\\)?/g,Ge=function(e){var t=Ve(e,function(e){return n.size===He&&n.clear(),e}),n=t.cache;return t}(function(e){var r=[];return 46===e.charCodeAt(0)&&r.push(""),e.replace(We,function(e,t,n,i){r.push(n?i.replace(ze,"$1"):t||e)}),r});var Ke=function(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r},Ye=1/0,Xe=k?k.prototype:void 0,$e=Xe?Xe.toString:void 0;var Qe=function e(t){if("string"==typeof t)return t;if(y(t))return Ke(t,e)+"";if(B(t))return $e?$e.call(t):"";var n=t+"";return"0"==n&&1/t==-Ye?"-0":n};var Je=function(e){return null==e?"":Qe(e)};var Ze=function(e,t){return y(e)?e:j(e,t)?[e]:Ge(Je(e))},et=1/0;var tt=function(e){if("string"==typeof e||B(e))return e;var t=e+"";return"0"==t&&1/e==-et?"-0":t};var nt=function(e,t){for(var n=0,i=(t=Ze(t,e)).length;null!=e&&n<i;)e=e[tt(t[n++])];return n&&n==i?e:void 0};var it=function(e,t,n){var i=null==e?void 0:nt(e,t);return void 0===i?n:i},rt="object"==typeof global&&global&&global.Object===Object&&global,ot="object"==typeof self&&self&&self.Object===Object&&self,at=(rt||ot||Function("return this")()).Symbol,st=Object.prototype,lt=st.hasOwnProperty,ut=st.toString,ct=at?at.toStringTag:void 0;var dt=Object.prototype.toString;var ft="[object Null]",ht="[object Undefined]",vt=at?at.toStringTag:void 0;function pt(e){return null==e?void 0===e?ht:ft:vt&&vt in Object(e)?function(e){var t=lt.call(e,ct),n=e[ct];try{e[ct]=void 0}catch(e){}var i=ut.call(e);return t?e[ct]=n:delete e[ct],i}(e):(t=e,dt.call(t));var t}var mt,gt,yt=(mt=Object.getPrototypeOf,gt=Object,function(e){return mt(gt(e))});var _t,bt="[object Object]",wt=Function.prototype,kt=Object.prototype,St=wt.toString,Et=kt.hasOwnProperty,Tt=St.call(Object);_t="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")();var xt,At,Lt=("function"==typeof(At=_t.Symbol)?At.observable?xt=At.observable:(xt=At("observable"),At.observable=xt):xt="@@observable",xt),Pt={INIT:"@@redux/INIT"};function Ct(e,t,n){var i;if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(Ct)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var r=e,o=t,a=[],s=a,l=!1;function u(){s===a&&(s=a.slice())}function c(){return o}function d(t){if("function"!=typeof t)throw new Error("Expected listener to be a function.");var n=!0;return u(),s.push(t),function(){if(n){n=!1,u();var e=s.indexOf(t);s.splice(e,1)}}}function f(e){if(!function(e){if(null==(t=e)||"object"!=typeof t||pt(e)!=bt)return!1;var t,n=yt(e);if(null===n)return!0;var i=Et.call(n,"constructor")&&n.constructor;return"function"==typeof i&&i instanceof i&&St.call(i)==Tt}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,o=r(o,e)}finally{l=!1}for(var t=a=s,n=0;n<t.length;n++){(0,t[n])()}return e}return f({type:Pt.INIT}),(i={dispatch:f,subscribe:d,getState:c,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");r=e,f({type:Pt.INIT})}})[Lt]=function(){var e,n=d;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function t(){e.next&&e.next(c())}return t(),{unsubscribe:n(t)}}})[Lt]=function(){return this},e},i}function Ot(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var Rt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};var Mt=window.Array.from,It=[1];"function"==typeof Mt&&Mt(It)===It&&(Mt=!1);var Dt,Ft,Bt,qt,Nt,jt,Ut=Mt||function(e){return[].slice.call(e,0)},Vt={object:!0,symbol:!0},Ht=Object.keys,Wt=function(){try{return!0}catch(e){return!1}}()?Object.keys:function(e){return Ht(null==e?e:Object(e))},zt=Math.max,Gt="function"==typeof(Ft=Object.assign)&&(Ft(Dt={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),Dt.foo+Dt.bar+Dt.trzy==="razdwatrzy")?Object.assign:function(t,n){var i,e,r,o=zt(arguments.length,2);for(t=Object(function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e}(t)),r=function(e){try{t[e]=n[e]}catch(e){i||(i=e)}},e=1;e<o;++e)n=arguments[e],Wt(n).forEach(r);if(void 0!==i)throw i;return t},Kt=Array.prototype.forEach,Yt=Object.create,Xt=function(e){var t=Yt(null);return Kt.call(arguments,function(e){null!=e&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t},$t=function(e){return"function"==typeof e},Qt="razdwatrzy",Jt=String.prototype.indexOf,Zt="function"==typeof Qt.contains&&!0===Qt.contains("dwa")&&!1===Qt.contains("foo")?String.prototype.contains:function(e){return-1<Jt.call(this,e,arguments[1])},en=t(function(e){(e.exports=function(e,t){var n,i,r,o,a;return arguments.length<2||"string"!=typeof e?(o=t,t=e,e=null):o=arguments[2],null==e?(n=r=!0,i=!1):(n=Zt.call(e,"c"),i=Zt.call(e,"e"),r=Zt.call(e,"w")),a={value:t,configurable:n,enumerable:i,writable:r},o?Gt(Xt(o),a):a}).gs=function(e,t,n){var i,r,o,a;return"string"!=typeof e?(o=n,n=t,t=e,e=null):o=arguments[3],null==t?t=void 0:$t(t)?null==n?n=void 0:$t(n)||(o=n,n=void 0):(o=t,t=n=void 0),null==e?(i=!0,r=!1):(i=Zt.call(e,"c"),r=Zt.call(e,"e")),a={get:t,set:n,configurable:i,enumerable:r},o?Gt(Xt(o),a):a}}),tn=function(e){if(!(t=e)||!("symbol"==typeof t||t.constructor&&"Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag]))throw new TypeError(e+" is not a symbol");var t;return e},nn=Object.create,rn=Object.defineProperties,on=Object.defineProperty,an=Object.prototype,sn=nn(null);if("function"==typeof Symbol){Bt=Symbol;try{String(Bt()),jt=!0}catch(e){}}var ln,un=(ln=nn(null),function(e){for(var t,n,i=0;ln[e+(i||"")];)++i;return ln[e+=i||""]=!0,on(an,t="@@"+e,en.gs(null,function(e){n||(n=!0,on(this,t,en(e)),n=!1)})),t});Nt=function(e){if(this instanceof Nt)throw new TypeError("TypeError: Symbol is not a constructor");return qt(e)};var cn=qt=function e(t){var n;if(this instanceof e)throw new TypeError("TypeError: Symbol is not a constructor");return jt?Bt(t):(n=nn(Nt.prototype),t=void 0===t?"":String(t),rn(n,{__description__:en("",t),__name__:en("",un(t))}))};rn(qt,{for:en(function(e){return sn[e]?sn[e]:sn[e]=qt(String(e))}),keyFor:en(function(e){var t;for(t in tn(e),sn)if(sn[t]===e)return t}),hasInstance:en("",Bt&&Bt.hasInstance||qt("hasInstance")),isConcatSpreadable:en("",Bt&&Bt.isConcatSpreadable||qt("isConcatSpreadable")),iterator:en("",Bt&&Bt.iterator||qt("iterator")),match:en("",Bt&&Bt.match||qt("match")),replace:en("",Bt&&Bt.replace||qt("replace")),search:en("",Bt&&Bt.search||qt("search")),species:en("",Bt&&Bt.species||qt("species")),split:en("",Bt&&Bt.split||qt("split")),toPrimitive:en("",Bt&&Bt.toPrimitive||qt("toPrimitive")),toStringTag:en("",Bt&&Bt.toStringTag||qt("toStringTag")),unscopables:en("",Bt&&Bt.unscopables||qt("unscopables"))}),rn(Nt.prototype,{constructor:en(qt),toString:en("",function(){return this.__name__})}),rn(qt.prototype,{toString:en(function(){return"Symbol ("+tn(this).__description__+")"}),valueOf:en(function(){return tn(this)})}),on(qt.prototype,qt.toPrimitive,en("",function(){var e=tn(this);return"symbol"==typeof e?e:e.toString()})),on(qt.prototype,qt.toStringTag,en("c","Symbol")),on(Nt.prototype,qt.toStringTag,en("c",qt.prototype[qt.toStringTag])),on(Nt.prototype,qt.toPrimitive,en("c",qt.prototype[qt.toPrimitive]));var dn="function"==typeof Symbol&&Vt[typeof Symbol.iterator]&&Vt[typeof Symbol.toPrimitive]&&Vt[typeof Symbol.toStringTag]?Symbol:cn,fn=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=t.repeat=function(e,t){return new Array(t+1).join(e)},i=t.pad=function(e,t){return n("0",t-e.toString().length)+e};t.formatTime=function(e){return i(e.getHours(),2)+":"+i(e.getMinutes(),2)+":"+i(e.getSeconds(),2)+"."+i(e.getMilliseconds(),3)},t.timer="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date});e(fn);fn.repeat,fn.pad,fn.formatTime,fn.timer;var hn=t(function(e,t){var n;n=function(v){var e,t,n=[];function i(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function p(e,t,n){p.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function m(e,t){m.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function g(e,t){g.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function y(e,t,n){y.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function _(e,t,n){var i=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,i),e}function b(e){var t=typeof e;return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":void 0!==e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function w(i,r,o,a,e,t,s){var l=(e=e||[]).slice(0);if(void 0!==t){if(a){if("function"==typeof a&&a(l,t))return;if("object"==typeof a){if(a.prefilter&&a.prefilter(l,t))return;if(a.normalize){var n=a.normalize(l,t,i,r);n&&(i=n[0],r=n[1])}}}l.push(t)}"regexp"===b(i)&&"regexp"===b(r)&&(i=i.toString(),r=r.toString());var u=typeof i,c=typeof r;if("undefined"===u)"undefined"!==c&&o(new m(l,r));else if("undefined"===c)o(new g(l,i));else if(b(i)!==b(r))o(new p(l,i,r));else if("[object Date]"===Object.prototype.toString.call(i)&&"[object Date]"===Object.prototype.toString.call(r)&&i-r!=0)o(new p(l,i,r));else if("object"===u&&null!==i&&null!==r){if((s=s||[]).indexOf(i)<0){if(s.push(i),Array.isArray(i)){var d;i.length;for(d=0;d<i.length;d++)d>=r.length?o(new y(l,d,new g(v,i[d]))):w(i[d],r[d],o,a,l,d,s);for(;d<r.length;)o(new y(l,d,new m(v,r[d++])))}else{var f=Object.keys(i),h=Object.keys(r);f.forEach(function(e,t){var n=h.indexOf(e);0<=n?(w(i[e],r[e],o,a,l,e,s),h=_(h,n)):w(i[e],v,o,a,l,e,s)}),h.forEach(function(e){w(v,r[e],o,a,l,e,s)})}s.length=s.length-1}}else i!==r&&("number"===u&&isNaN(i)&&isNaN(r)||o(new p(l,i,r)))}function o(e,t,n,i){return i=i||[],w(e,t,function(e){e&&i.push(e)},n),i.length?i:v}function a(e,t,n){if(e&&t&&n&&n.kind){for(var i=e,r=-1,o=n.path?n.path.length-1:0;++r<o;)void 0===i[n.path[r]]&&(i[n.path[r]]="number"==typeof n.path[r]?[]:{}),i=i[n.path[r]];switch(n.kind){case"A":!function e(t,n,i){if(i.path&&i.path.length){var r,o=t[n],a=i.path.length-1;for(r=0;r<a;r++)o=o[i.path[r]];switch(i.kind){case"A":e(o[i.path[r]],i.index,i.item);break;case"D":delete o[i.path[r]];break;case"E":case"N":o[i.path[r]]=i.rhs}}else switch(i.kind){case"A":e(t[n],i.index,i.item);break;case"D":t=_(t,n);break;case"E":case"N":t[n]=i.rhs}return t}(n.path?i[n.path[r]]:i,n.index,n.item);break;case"D":delete i[n.path[r]];break;case"E":case"N":i[n.path[r]]=n.rhs}}}return e="object"==typeof s&&s?s:"undefined"!=typeof window?window:{},(t=e.DeepDiff)&&n.push(function(){void 0!==t&&e.DeepDiff===o&&(e.DeepDiff=t,t=v)}),i(p,r),i(m,r),i(g,r),i(y,r),Object.defineProperties(o,{diff:{value:o,enumerable:!0},observableDiff:{value:w,enumerable:!0},applyDiff:{value:function(t,n,i){t&&n&&w(t,n,function(e){i&&!i(t,n,e)||a(t,n,e)})},enumerable:!0},applyChange:{value:a,enumerable:!0},revertChange:{value:function(e,t,n){if(e&&t&&n&&n.kind){var i,r,o=e;for(r=n.path.length-1,i=0;i<r;i++)void 0===o[n.path[i]]&&(o[n.path[i]]={}),o=o[n.path[i]];switch(n.kind){case"A":!function e(t,n,i){if(i.path&&i.path.length){var r,o=t[n],a=i.path.length-1;for(r=0;r<a;r++)o=o[i.path[r]];switch(i.kind){case"A":e(o[i.path[r]],i.index,i.item);break;case"D":case"E":o[i.path[r]]=i.lhs;break;case"N":delete o[i.path[r]]}}else switch(i.kind){case"A":e(t[n],i.index,i.item);break;case"D":case"E":t[n]=i.lhs;break;case"N":t=_(t,n)}return t}(o[n.path[i]],n.index,n.item);break;case"D":case"E":o[n.path[i]]=n.lhs;break;case"N":delete o[n.path[i]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==t},enumerable:!0},noConflict:{value:function(){return n&&(n.forEach(function(e){e()}),n=null),o},enumerable:!0}}),o},e.exports=n()}),vn=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n){var i=(0,o.default)(e,t);try{n?r.groupCollapsed("diff"):r.group("diff")}catch(e){r.log("diff")}i?i.forEach(function(e){var t,n=e.kind,i=function(e){var t=e.kind,n=e.path,i=e.lhs,r=e.rhs,o=e.index,a=e.item;switch(t){case"E":return[n.join("."),i,"→",r];case"N":return[n.join("."),r];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+o+"]",a];default:return[]}}(e);r.log.apply(r,["%c "+a[n].text,(t=n,"color: "+a[t].color+"; font-weight: bold")].concat(function(e){{if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Ut(e)}}(i)))}):r.log("—— no diff ——");try{r.groupEnd()}catch(e){r.log("—— diff end —— ")}};var n,o=(n=hn)&&n.__esModule?n:{default:n};var a={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}};e.exports=t.default});e(vn);var pn=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof dn&&"symbol"==typeof dn.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof dn&&e.constructor===dn&&e!==dn.prototype?"symbol":typeof e};t.printBuffer=function(b,w){var k=w.logger,S=w.actionTransformer,e=w.titleFormatter,E=void 0===e?(t=w,r=t.timestamp,o=t.duration,function(e,t,n){var i=["action"];return i.push("%c"+String(e.type)),r&&i.push("%c@ "+t),o&&i.push("%c(in "+n.toFixed(2)+" ms)"),i.join(" ")}):e,T=w.collapsed,x=w.colors,A=w.level,L=w.diff,P=void 0===w.titleFormatter;var t,r,o;b.forEach(function(e,t){var n=e.started,i=e.startedTime,r=e.action,o=e.prevState,a=e.error,s=e.took,l=e.nextState,u=b[t+1];u&&(l=u.prevState,s=u.started-n);var c=S(r),d="function"==typeof T?T(function(){return l},r,e):T,f=(0,fn.formatTime)(i),h=x.title?"color: "+x.title(c)+";":"",v=["color: gray; font-weight: lighter;"];v.push(h),w.timestamp&&v.push("color: gray; font-weight: lighter;"),w.duration&&v.push("color: gray; font-weight: lighter;");var p=E(c,f,s);try{d?x.title&&P?k.groupCollapsed.apply(k,["%c "+p].concat(v)):k.groupCollapsed(p):x.title&&P?k.group.apply(k,["%c "+p].concat(v)):k.group(p)}catch(e){k.log(p)}var m=O(A,c,[o],"prevState"),g=O(A,c,[c],"action"),y=O(A,c,[a,o],"error"),_=O(A,c,[l],"nextState");m&&(x.prevState?k[m]("%c prev state","color: "+x.prevState(o)+"; font-weight: bold",o):k[m]("prev state",o)),g&&(x.action?k[g]("%c action    ","color: "+x.action(c)+"; font-weight: bold",c):k[g]("action    ",c)),a&&y&&(x.error?k[y]("%c error     ","color: "+x.error(a,o)+"; font-weight: bold;",a):k[y]("error     ",a)),_&&(x.nextState?k[_]("%c next state","color: "+x.nextState(l)+"; font-weight: bold",l):k[_]("next state",l)),L&&(0,C.default)(o,l,k,d);try{k.groupEnd()}catch(e){k.log("—— log end ——")}})};var n,C=(n=vn)&&n.__esModule?n:{default:n};function O(e,t,n,i){switch(void 0===e?"undefined":r(e)){case"object":return"function"==typeof e[i]?e[i].apply(e,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Ut(e)}(n)):e[i];case"function":return e(t);default:return e}}});e(pn);pn.printBuffer;var mn=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},e.exports=t.default});e(mn);var gn=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.createLogger=t.defaults=void 0;var n,h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i=(n=mn)&&n.__esModule?n:{default:n};function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=h({},i.default,e),t=a.logger,s=a.stateTransformer,l=a.errorTransformer,u=a.predicate,c=a.logErrors,d=a.diffPredicate;if(void 0===t)return function(){return function(t){return function(e){return t(e)}}};if(e.getState&&e.dispatch)return function(){return function(t){return function(e){return t(e)}}};var f=[];return function(e){var o=e.getState;return function(r){return function(e){if("function"==typeof u&&!u(o,e))return r(e);var t={};f.push(t),t.started=fn.timer.now(),t.startedTime=new Date,t.prevState=s(o()),t.action=e;var n=void 0;if(c)try{n=r(e)}catch(e){t.error=l(e)}else n=r(e);t.took=fn.timer.now()-t.started,t.nextState=s(o());var i=a.diff&&"function"==typeof d?d(o,e):a.diff;if((0,pn.printBuffer)(f,h({},a,{diff:i})),f.length=0,t.error)throw t.error;return n}}}}var o=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;if("function"==typeof t||"function"==typeof n)return r()({dispatch:t,getState:n})};t.defaults=i.default,t.createLogger=r,t.logger=o,t.default=o});e(gn);var yn;gn.logger,gn.createLogger,gn.defaults;function _n(l){var u={};return(l=l||{}).on=function(e,t){for(var n=0,i=(e=[].concat(e)).length;n<i;n++){var r=e[n];if(!r)throw new Error("Tried to listen for an undefined event.");u[r]||(u[r]=[]),u[r].push(t)}return l},l.once=function(e,t){function n(){t.apply(l.off(e,n),arguments)}return n.handler=t,l.on(e,n)},l.off=function(e,t){for(var n=0,i=(e=[].concat(e)).length;n<i;n++){var r=e[n];if(!r)throw new Error("Tried to remove an undefined event.");if(r in u){var o=u[r].indexOf(t);if(-1===o){for(var a=0,s=u[r].length;a<s;a++)if(u[r][a].handler===t){o=n;break}if(-1===o)return l}u[r].splice(o,1)}}return l},l.fire=function(e){if(!e)throw new Error("Tried to fire an undefined event.");if(e in u)for(var t=u[e].slice(0),n=0,i=t.length;n<i;n++)t[n].apply(l,t.slice.call(arguments,1));return l},l}if(window.HTMLMediaElement){var bn=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=bn.apply(this,arguments);return e&&e.catch(function(){}),e}}if((function(){for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var n=e[t];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(e){return setTimeout(e,0)},window.cancelAnimationFrame=clearTimeout)}(),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),"undefined"!=typeof DOMTokenList)&&!((yn=document.createElement("div")).classList.toggle("test-class",!1),!yn.classList.contains("test-class"))){var wn=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){!0!==t?!1!==t?wn.call(this,e):this.remove(e):this.add(e)}}"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return r;r++}return-1}});var kn=function(t){return function(e){return null==t?void 0:t[e]}},Sn=kn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),En=/&(?:amp|lt|gt|quot|#39);/g,Tn=RegExp(En.source);var xn=function(e){return(e=Je(e))&&Tn.test(e)?e.replace(En,Sn):e};function An(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length&&t[0]instanceof An){var i=t[0];return this.red=i.red,this.green=i.green,this.blue=i.blue,this.alpha=i.alpha,this.hue=i.hue,this.saturation=i.saturation,this.lightness=i.lightness,this}if(1===t.length){if("string"==typeof t[0]&&0<=t[0].indexOf("rgb"))return this.rgba=function(e){var t=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([\d.]+))?\)/.exec(e);if(!t)throw new Error("Invalid rgb value");return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(t[5])||1}}(t[0]),this;if("string"!=typeof(r=(r=""+t[0]).replace("#",""))||3!==r.length&&6!==r.length||isNaN(parseInt(r,16)))throw new Error("Invalid hex value");return this.hex=t[0],this}var r;if(3===t.length||4===t.length){for(var o=0;o<3;o++)if(isNaN(parseInt(t[o],10))||parseInt(t[o],10)<0||255<parseInt(t[o],10))throw new Error("Invalid rgb value");if(t[3]&&parseFloat(t[3])<0||1<parseFloat(t[3]))throw new Error("Invalid alpha value");return this.rgba={red:t[0],green:t[1],blue:t[2],alpha:parseFloat(t[3])||1},this}throw new Error("Invalid color")}An.prototype={get complement(){var e=this.clone();return e.rgb={red:255-this.red,green:255-this.green,blue:255-this.blue},e},get hex(){return An.rgbToHex(this.red,this.green,this.blue)},set hex(e){return this.rgba=An.hexToRgb(e),this},get hsl(){return"hsl("+this.hue+","+this.saturation+"%,"+Math.round(this.lightness)+"%)"},set hsl(e){this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness;var t=An.hslToRgb(e.hue,e.saturation,e.lightness);return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this},get luminance(){function e(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*e(this.red/255)+.7152*e(this.green/255)+.0722*e(this.blue/255)},get rgb(){return"rgb("+this.red+","+this.green+","+this.blue+")"},set rgb(e){return this.rgba=e,this},get rgba(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},set rgba(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha||1;var t=An.rgbToHsl(e.red,e.green,e.blue);return this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this},get yiq(){return(299*this.red+587*this.green+114*this.blue)/1e3},clone:function(){return new An(this)},lighten:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness+e},t&&n)for(var i=n.contrast(this).ratio;i<t&&(this.lighten(5),i=n.contrast(this).ratio,!(100<=this.lightness)););return this},darken:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness-e},t&&n)for(var i=n.contrast(this).ratio;i<t&&(this.darken(5),i=n.contrast(this).ratio,!(this.lightness<=0)););return this},overlayOn:function(e){if(1<=this.alpha)return this;var t=this.clone();return t.rgba={red:t.red*this.alpha+e.red*e.alpha*(1-this.alpha),green:t.green*this.alpha+e.green*e.alpha*(1-this.alpha),blue:t.blue*this.alpha+e.blue*e.alpha*(1-this.alpha),alpha:t.alpha+e.alpha*(1-this.alpha)},t},contrast:function(e){var t=this.alpha;if(1<=t){e.alpha<1&&(e=e.overlayOn(this));var n=this.luminance+.05,i=e.luminance+.05,r=n/i;return n<i&&(r=1/r),{ratio:r=Math.round(10*r)/10,error:0,min:r,max:r}}var o=this.overlayOn(An.white).contrast(e).ratio,a=this.overlayOn(An.black).contrast(e).ratio,s=Math.max(o,a),l={red:Math.min(Math.max(0,(e.red-this.red*t)/(1-t)),255),green:Math.min(Math.max(0,(e.green-this.green*t)/(1-t)),255),blue:Math.min(Math.max(0,(e.blue-this.blue*t)/(1-t)),255)},u=this.clone();u.rgb=l;var c=this.overlayOn(u).contrast(e).ratio;return{ratio:Math.round((c+s)/2*10)/10,error:Math.round((s-c)/2*10)/10,min:c,max:s,closest:u,farthest:a===s?An.white:An.black}},wcagAACompliant:function(e){return 4.5<=this.contrast(e).ratio},wcagAAACompliant:function(e){return 7<=this.contrast(e).ratio},yiqContrastColor:function(){return 120<=this.yiq?new An(0,0,0):new An(255,255,255)}},An.hexToRgb=function(e){var t;return 3===(e=String(e)).length||4===e.length?(t=/^#?([A-Fa-f0-9])([A-Fa-f0-9])([A-Fa-f0-9])$/i.exec(e))&&(t[1]+=t[1],t[2]+=t[2],t[3]+=t[3]):t=/^#?([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})$/i.exec(e),t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null},An.rgbToHex=function(e,t,n){return"#"+((1<<24)+(Math.round(e)<<16)+(Math.round(t)<<8)+Math.round(n)).toString(16).slice(1)},An.rgbToHsl=function(e,t,n){e/=255,t/=255,n/=255;var i,r=Math.max(e,t,n),o=Math.min(e,t,n),a=(r+o)/2,s=a;if(r===o)return{hue:0,saturation:0,lightness:100*s};var l=r-o;return i=.5<s?l/(2-r-o):l/(r+o),r===e?a=(t-n)/l+(t<n?6:0):r===t?a=(n-e)/l+2:r===n&&(a=(e-t)/l+4),a/=6,{hue:Math.round(360*a),saturation:Math.round(100*i),lightness:Math.round(100*s)}},An.hslToRgb=function(e,t,n){function i(e,t,n){return n<0&&(n+=1),1<n&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+6*(2/3-n)*(t-e):e}if(e/=360,n/=100,0===(t/=100))return{red:Math.floor(255*n),green:Math.floor(255*n),blue:Math.floor(255*n)};var r=n<.5?n*(1+t):n+t-t*n,o=2*n-r;return{red:Math.floor(255*i(o,r,e+1/3)),green:Math.floor(255*i(o,r,e)),blue:Math.floor(255*i(o,r,e-1/3))}},An.hslToHex=function(e,t,n){var i=An.hslToRgb(e,t,n);return An.rgbToHex(i.red,i.green,i.blue)},An.white=new An("fff"),An.black=new An("000");var Ln="[object String]";var Pn=function(e){return"string"==typeof e||!y(e)&&D(e)&&I(e)==Ln};function Cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var On=function(e){for(var t=this,n=arguments.length,i=Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return function i(r){return r.length>=e.length?e.apply(t,r):function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i([].concat(r,t))}}(i)}(function(t,n){return Object.keys(t).every(function(e){return t[e]===n[e]})}),Rn=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return{get:function(e){return e?t.find(On(e)):t},insert:function(e){return(t=t.concat(e)).slice(-1).pop()},getOrInsert:function(e){return this.get(e)||this.insert(e)},remove:function(e){return t.splice(t.findIndex(On(e)),1).pop()}}};function Mn(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:document.styleSheets[0];try{n.insertRule?n.insertRule(e+"{"+t+"}",(n.cssRules||n.rules).length):n.addRule(e,t)}catch(e){}}function In(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document.activeElement,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;try{e.blur()}catch(e){t&&t(e)}}function Dn(e){var t=e.getBoundingClientRect();return document.msFullscreenElement&&window.parent!==window&&e.offsetWidth<e.clientWidth&&(t={bottom:100*t.bottom,left:100*t.left,top:100*t.top,right:100*t.right,width:100*t.width,height:100*t.height}),t}function Fn(e){try{return new URL(e).origin}catch(e){}var t=document.createElement("a");return t.href=e,t.origin?t.origin:t.protocol.replace(":","")+"://"+t.host}function Bn(e){var t=e.width,n=e.height,i=e.elementWidth,r=e.elementHeight,o=e.threshold,a=void 0===o?10:o,s=1,l=t/n,u=i-r*l,c=r-i/l;if(0<u&&u<a||0<c&&c<a){var d=i/(i-u),f=r/(r-c);s=Math.max(d,f)}return{extraWidth:u,extraHeight:c,scaleFactor:s}}function qn(e,t,n){return n<e?n:e<t?t:e}function Nn(e,t,n){var i=n.width,r=n.height,o=n.scrollbars,a=void 0===o?"yes":o,s=n.resizable,l=void 0===s?"yes":s,u=n.toolbar,c=void 0===u?"no":u,d=(window.screenY||window.screenTop||0)+window.outerHeight/2-r/2,f=(window.screenX||window.screenLeft||0)+window.outerWidth/2-i/2;window.chrome&&-1!==window.navigator.userAgent.toLowerCase().indexOf("mac os x")&&(r+=27),window.safari&&(r+=47);var h="scrollbars="+a+",resizable="+l+",toolbar="+c;return window.open(e,t,"width="+i+",height="+r+",left="+f+",top="+d+","+h)}function jn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.method,r=void 0===n?"GET":n,i=t.withCredentials,o=void 0===i||i,a=t.allowErrorStatuses,s=void 0!==a&&a,l=t.jwt,u=void 0!==l&&l;return new M(function(t,n){var i=new XMLHttpRequest;i.open(r,e,!0),o&&(i.withCredentials=!0),u&&i.setRequestHeader("Authorization","jwt "+u),i.onload=function(){if(400<=i.status&&!s){var e={403:"Forbidden",404:"Not Found",500:"Internal Server Error"};return e[i.status]?void n(new Error(e[i.status])):void n(new Error("Request returned non-200 status code: "+i.status))}t(i.responseText)},i.onerror=function(){return n(new Error("The request failed."))},i.send()})}function Un(e){for(var t,n,i=(e||document).querySelectorAll("[tabindex]"),r=[],o=0,a=0,s=i.length;a<s;a++)t=i[a],n=window.getComputedStyle(t,""),0<t.tabIndex&&"none"!==n.display&&0<n.opacity&&"hidden"!==n.visibility&&(r[o++]=t);var l=r.shift();l&&(l.focus(),l.blur())}function Vn(e,t){if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t||3);return Math.round(e*n)/n}function Hn(e,t){return-1!==Ut(t).indexOf(e)}function Wn(e){return e?Ut(e.parentNode.children).indexOf(e):-1}var zn=Cn(Wn,function(e,t){for(;e&&e.parentElement&&!Hn(e,t);)e=e.parentElement;return Hn(e,t)?e:null});var Gn=function(e){return e+"px"};var Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yn=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Xn=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),$n=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Qn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Jn=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function Zn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!e||"null"===e||0===t.length)return{track:null};var n=e.split("."),i=Jn(n,2),r=i[0],o=i[1],a=r.split(/[-_]/),s=Jn(a,1)[0],l=r!==s,u=t.filter(function(e){return l&&e.language===r||e.language===s}).sort(function(e,t){var n=2*(e.language===s&&e.kind===o)+2*(e.language===r)+1*(e.kind===o);return 2*(t.language===s&&t.kind===o)+2*(t.language===r)+1*(t.kind===o)-n});return 0<u.length?{track:u[0],exactMatch:u[0].language===r&&u[0].kind===o}:{track:null}}var ei={badPlayback:"bad-playback",bufferStarted:"buffer-started",bufferEnded:"buffer-ended",spatialUnsupported:"spatial-unsupported",spatialFailure:"spatial-failure"},ti=1e4,ni=5,ii={PRIVACY_PUBLIC:"anybody",PRIVACY_NOBODY:"nobody",PRIVACY_FOLLOW:"contacts",PRIVACY_PASSWORD:"password",PRIVACY_USER:"users",PRIVACY_PURGATORY:"purgatory",PRIVACY_HIDE_FROM_VIMEO:"disable",PRIVACY_PAYTOVIEW:"ptv",PRIVACY_PAYTOVIEWEXTRA:"ptv_extra",PRIVACY_UNLISTED:"unlisted"},ri={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},oi={seek:"control-seek",changeVolume:"control-change-volume",hideOverlay:"control-hide-overlay",showOverlay:"control-show-overlay",openPopup:"control-open-popup",reset:"control-reset",changeLoop:"control-change-loop",changeQuality:"control-change-quality",openVimeo:"control-open-vimeo",changeColor:"control-change-color",disableVolume:"control-disable-volume",enableVolume:"control-enable-volume",disableCaptions:"control-disable-captions",enableCaptions:"control-enable-captions",forceFullscreen:"control-force-fullscreen",turnCaptionsOn:"control-turn-captions-on",turnCaptionsOff:"control-turn-captions-off",toggleNativeControls:"control-toggle-native-controls",showOutro:"control-show-outro",hideOutro:"control-hide-outro",setEffect:"control-set-effect",activatePictureInPicture:"control-activate-picture-in-picture",deactivatePictureInPicture:"control-deactivate-picture-in-picture",attachSpatialPlaybackEvents:"control-attach-spatial-playback-events",toggleSpatialPlayback:"control-toggle-spatial-playback",revealSpatialControls:"control-reveal-spatial-controls",setTime:"control-set-time",addCard:"control-add-card",removeCard:"control-remove-card",changePlaybackRate:"control-change-playback-rate"},ai={like:{will:"willLikeVideo",did:"didLikeVideo"},unlike:{will:"willUnlikeVideo",did:"didUnlikeVideo"},addToWatchLater:{will:"willAddToWatchLater",did:"didAddToWatchLater"},removeFromWatchLater:{will:"willRemoveFromWatchLater",did:"didRemoveFromWatchLater"},purchase:{will:"willOpenVodPurchaseForm",did:"didOpenVodPurchaseForm"},shareOverlay:{will:"willOpenShareOverlay",did:"didOpenShareOverlay"},loginForm:{will:"willOpenLoginForm",did:"didOpenLoginForm"},collectionsOverlay:{will:"willOpenCollectionsOverlay",did:"didOpenCollectionsOverlay"},showOutro:{will:"willShowOutro",did:"didShowOutro"},playLog:{will:"willSendPlayLog",did:"didSendPlayLog"}},si={apiError:"events-api-error",error:"events-error",hevcRestrictedStreams:"hevc-restricted-streams",playInitiated:"events-play-initiated",paused:"events-paused",played:"events-played",loadProgress:"events-load-progress",playProgress:"events-play-progress",seeked:"events-seeked",ended:"events-ended",bufferStarted:"events-buffer-started",bufferEnded:"events-buffer-ended",volumeChanged:"events-volume-changed",qualityChanged:"events-quality-changed",targetTimeReached:"events-target-time-reached",cueChanged:"events-cue-changed",streamChanged:"events-stream-changed",ranIntoBuffer:"events-ran-into-buffer",playbackResumed:"events-playback-resumed",adaptiveBandwidth:"events-adaptive-bandwidth",streamTargetChange:"events-stream-target-change",forcedQuality:"events-forced-quality",cuepoint:"events-cuepoint",firstTimeUpdate:"events-first-time-update",droppedFrames:"events-dropped-frames",segmentDownloaded:"events-segment-downloaded",playbackRateChanged:"events-playback-rate-changed",videoDurationMismatch:"events-video-duration-mismatch",fullscreenButtonPressed:"events-fullscreen-button-pressed",pauseButtonPressed:"events-pause-button-pressed",playButtonPressed:"events-play-button-pressed",prefsButtonPressed:"events-prefs-button-pressed",ccButtonPressed:"events-cc-button-pressed",scrubbingStarted:"events-scrubbing-started",scrubbingEnded:"events-scrubbing-ended",volumeScrubbingStarted:"events-volume-scrubbing-started",volumeScrubbingEnded:"events-volume-scrubbing-ended",controlBarVisibilityChanged:"events-control-bar-visibility-changed",sidedockVisibilityChanged:"events-sidedock-visibility-changed",menuVisibilityChanged:"events-menu-visibility-changed",captionsChanged:"events-captions-changed",cuePointAdded:"events-cue-point-added",cuePointRemoved:"events-cue-point-removed",spatialMotionStart:"events-spatial-motion-start",spatialMotionEnd:"events-spatial-motion-end",stereoscopicButtonPressed:"events-stereoscopic-button-pressed",controlbarBufferStarted:"events-controlbar-buffer-started",controlbarBufferEnded:"events-controlbar-buffer-ended",menuPanelOpened:"events-menu-panel-opened",menuPanelClosed:"events-menu-panel-closed",menuCentered:"events-menu-centered",badgePressed:"events-badge-pressed",willEnterFullscreen:"events-will-enter-fullscreen",didEnterFullscreen:"events-did-enter-fullscreen",willExitFullscreen:"events-will-exit-fullscreen",didExitFullscreen:"events-did-exit-fullscreen",likeButtonPressed:"events-like-button-pressed",watchLaterButtonPressed:"events-watch-later-button-pressed",shareButtonPressed:"events-share-button-pressed",embedButtonPressed:"events-embed-button-pressed",vodButtonPressed:"events-vod-button-pressed",collectionsButtonPressed:"events-collections-button-pressed",followButtonPressed:"events-follow-button-pressed",overlayOpened:"events-overlay-opened",overlayClosed:"events-overlay-closed",overlayCleared:"events-overlay-cleared",overlayCloseButtonPressed:"events-overlay-close-button-pressed",facebookButtonPressed:"events-facebook-button-pressed",twitterButtonPressed:"events-twitter-button-pressed",tumblrButtonPressed:"events-tumblr-button-pressed",emailButtonPressed:"events-email-button-pressed",embedCodeCopied:"events-embed-code-copied",popupOpened:"events-popup-opened",effectButtonPressed:"events-effect-button-pressed",debugButtonPressed:"events-debug-button-pressed",emailCaptureSubmitted:"events-email-capture-submitted",popupClosed:"events-popup-closed",shareViewShown:"events-share-view-shown",embedViewShown:"events-embed-view-shown",shareViewEnd:"events-share-view-end",embedViewEnd:"events-embed-view-end",mousedOut:"events-moused-out",mousedOver:"events-moused-over",mouseTimeout:"events-mouse-timeout",liked:"events-liked",unliked:"events-unliked",addedToWatchLater:"events-added-to-watch-later",removedFromWatchLater:"events-removed-from-watch-later",userLogIn:"events-user-log-in",userLoggedIn:"events-user-logged-in",userLoggedOut:"events-user-logged-out",loginFailure:"events-login-failure",colorChanged:"events-color-changed",configChanged:"events-config-changed",passwordUnlocked:"events-password-unlocked",privateUnlocked:"events-private-unlocked",enteredTinyMode:"events-entered-tiny-mode",enteredMiniMode:"events-entered-mini-mode",enteredNormalMode:"events-entered-normal-mode",signatureExpired:"events-signature-expired",requestConfigReloaded:"events-request-config-reloaded",embedSettingChanged:"events-embed-setting-changed",outroDisplayed:"events-outro-displayed",outroHidden:"events-outro-hidden",outroVideoPressed:"events-outro-video-pressed",becameActive:"events-became-active",becameInactive:"events-became-inactive",tipped:"events-tipped",emailCaptureSuccess:"events-email-capture-success",loadVideo:"events-load-video",cameraUpdate:"events-camera-update",outroLinkPressed:"events-outro-link-pressed",errorLinkPressed:"events-error-link-pressed",followed:"events-followed",unfollowed:"events-unfollowed",outroImagePressed:"events-outro-image-pressed",outroCtaPressed:"events-outro-cta-pressed",hudDisplayed:"events-hud-displayed",hudHidden:"events-hud-hidden",cardDisplayed:"events-card-displayed",cardPressed:"events-card-pressed",spaceChanged:"events-space-changed",emailCaptureEnd:"events-email-capture-end",titleModuleReady:"events-title-module-ready",sidedockModuleReady:"events-sidedock-module-ready",controlBarModuleReady:"events-control-bar-module-ready",videoModuleReady:"events-video-module-ready",overlayModuleReady:"events-overlay-module-ready",notificationModuleReady:"events-notification-module-ready",statsModuleReady:"events-stats-module-ready",apiModuleReady:"events-api-module-ready",ready:"events-ready",telecineReady:"events-telecine-ready",notificationHidden:"events-notification-hidden",alertVisibilityChanged:"events-alert-visibility-changed",airPlayAvailable:"events-air-play-available",airPlayNotAvailable:"events-air-play-not-available",airPlayActivated:"events-air-play-activated",airPlayDeactivated:"events-air-play-deactivated",airPlayButtonPressed:"events-air-play-button-pressed",pictureInPictureAvailable:"events-picture-in-picture-available",pictureInPictureNotAvailable:"events-picture-in-picture-not-available",pictureInPictureActivated:"events-picture-in-picture-activated",pictureInPictureDeactivated:"events-picture-in-picture-deactivated",liveEventPending:"events-live-event-pending",liveEventActive:"events-live-event-active",liveEventStarted:"events-live-event-started",liveEventEnded:"events-live-event-ended",liveArchiveStarted:"events-live-archive-started",liveArchiveDone:"events-live-archive-done",liveArchiveError:"events-live-archive-error",liveRepresentationsAvailable:"events-live-representations-available",liveStreamOnline:"events-live-stream-online",liveStreamOffline:"events-live-stream-offline"},li="done",ui={pending:"pending",active:"active",started:"started",ended:"ended"},ci={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","video/vnd.mpeg.dash.mpd":"live","application/x-mpegURL":"hlslive"},di={likes:"likes",watchLater:"watchlater",following:"following"},fi={low:.5,high:2},hi={HTMLScanner:"html",MediaSourceScanner:"html",LiveScanner:"html",SWFScanner:"flash"},vi={main:1,privateLocked:2,privateUnlocked:3,privatePassword:4,error:7,contentRating:9};var pi={isObject:function(e){return"object"==typeof e&&null!==e},isError:function(e){switch({}.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}},mi={collectWindowErrors:!0,debug:!1},gi="undefined"!=typeof window?window:void 0!==s?s:"undefined"!=typeof self?self:{},yi=[].slice,_i="?",bi=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function wi(){return"undefined"==typeof document||void 0===document.location?"":document.location.href}mi.report=function(){var u,t,r=[],o=null,a=null,c=null;function d(e,t){var n=null;if(!t||mi.collectWindowErrors){for(var i in r)if(r.hasOwnProperty(i))try{r[i].apply(null,[e].concat(yi.call(arguments,2)))}catch(e){n=e}if(n)throw n}}function n(e,t,n,i,r){if(c)mi.computeStackTrace.augmentStackTraceWithInitialElement(c,t,n,e),f();else if(r&&pi.isError(r))d(mi.computeStackTrace(r),!0);else{var o,a={url:t,line:n,column:i},s=void 0,l=e;if("[object String]"==={}.toString.call(e))(o=e.match(bi))&&(s=o[1],l=o[2]);a.func=_i,d({name:s,message:l,url:wi(),stack:[a]},!0)}return!!u&&u.apply(this,arguments)}function f(){var e=c,t=o;d.apply(a=c=o=null,[e,!1].concat(t))}function e(e,t){var n=yi.call(arguments,1);if(c){if(a===e)return;f()}var i=mi.computeStackTrace(e);if(c=i,a=e,o=n,setTimeout(function(){a===e&&f()},i.incomplete?2e3:0),!1!==t)throw e}return e.subscribe=function(e){t||(u=gi.onerror,gi.onerror=n,t=!0),r.push(e)},e.unsubscribe=function(e){for(var t=r.length-1;0<=t;--t)r[t]===e&&r.splice(t,1)},e.uninstall=function(){t&&(gi.onerror=u,t=!1,u=void 0),r=[]},e}(),mi.computeStackTrace=function(){function i(e){if(void 0!==e.stack&&e.stack){for(var t,n,i,r=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,a=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,s=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,l=/\((\S*)(?::(\d+))(?::(\d+))\)/,u=e.stack.split("\n"),c=[],d=(/^(.*) is undefined$/.exec(e.message),0),f=u.length;d<f;++d){if(n=r.exec(u[d])){var h=n[2]&&0===n[2].indexOf("native");n[2]&&0===n[2].indexOf("eval")&&(t=l.exec(n[2]))&&(n[2]=t[1],n[3]=t[2],n[4]=t[3]),i={url:h?null:n[2],func:n[1]||_i,args:h?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=a.exec(u[d]))i={url:n[2],func:n[1]||_i,args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=o.exec(u[d])))continue;n[3]&&-1<n[3].indexOf(" > eval")&&(t=s.exec(n[3]))?(n[3]=t[1],n[4]=t[2],n[5]=null):0!==d||n[5]||void 0===e.columnNumber||(c[0].column=e.columnNumber+1),i={url:n[3],func:n[1]||_i,args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}!i.func&&i.line&&(i.func=_i),c.push(i)}return c.length?{name:e.name,message:e.message,url:wi(),stack:c}:null}}function c(e,t,n,i){var r={url:t,line:n};if(r.url&&r.line){if(e.incomplete=!1,r.func||(r.func=_i),0<e.stack.length&&e.stack[0].url===r.url){if(e.stack[0].line===r.line)return!1;if(!e.stack[0].line&&e.stack[0].func===r.func)return e.stack[0].line=r.line,!1}return e.stack.unshift(r),e.partial=!0}return e.incomplete=!0,!1}function d(e,t){for(var n,i,r=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,o=[],a={},s=!1,l=d.caller;l&&!s;l=l.caller)if(l!==f&&l!==mi.report){if(i={url:null,func:_i,line:null,column:null},l.name?i.func=l.name:(n=r.exec(l.toString()))&&(i.func=n[1]),void 0===i.func)try{i.func=n.input.substring(0,n.input.indexOf("{"))}catch(e){}a[""+l]?s=!0:a[""+l]=!0,o.push(i)}t&&o.splice(0,t);var u={name:e.name,message:e.message,url:wi(),stack:o};return c(u,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),u}function f(e,t){var n=null;t=null==t?0:+t;try{if(n=i(e))return n}catch(e){}try{if(n=d(e,t+1))return n}catch(e){}return{name:e.name,message:e.message,url:wi()}}return f.augmentStackTraceWithInitialElement=c,f.computeStackTraceFromStackProp=i,f}();var ki=mi,Si=t(function(e,t){function s(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function r(i,r){var o=[],a=[];return null==r&&(r=function(e,t){return o[0]===t?"[Circular ~]":"[Circular ~."+a.slice(0,s(o,t)).join(".")+"]"}),function(e,t){if(0<o.length){var n=s(o,this);~n?o.splice(n+1):o.push(this),~n?a.splice(n,1/0,e):a.push(e),~s(o,t)&&(t=r.call(this,e,t))}else o.push(t);return null==i?t:i.call(this,e,t)}}(e.exports=function(e,t,n,i){return JSON.stringify(e,r(t,i),n)}).getSerialize=r});Si.getSerialize;function Ei(e){this.name="RavenConfigError",this.message=e}var Ti=(Ei.prototype=new Error).constructor=Ei,xi=function(e,t,n){var i=e[t],r=e;if(t in e){var o="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),t=""+e.join(" ");n&&n(t,{level:o,logger:"console",extra:{arguments:e}}),i&&Function.prototype.apply.call(i,r,e)}}},Ai=pi.isError,Li=pi.isObject,Pi=xi,Ci="source protocol user pass host port path".split(" "),Oi=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/;function Ri(){return+new Date}var Mi="undefined"!=typeof window?window:void 0!==s?s:"undefined"!=typeof self?self:{},Ii=Mi.document,Di=Mi.navigator;function Fi(){for(var e in this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!qi(Ii),this._hasNavigator=!qi(Di),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],crossOrigin:"anonymous",collectWindowErrors:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,sampleRate:1},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=Mi.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=Ri(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=Mi.location,this._lastHref=this._location&&this._location.href,this._resetBackoff(),this._originalConsole)this._originalConsoleMethods[e]=this._originalConsole[e]}Fi.prototype={VERSION:"3.14.2",debug:!1,TraceKit:ki,config:function(e,t){var n=this;if(n._globalServer)return this._logDebug("error","Error: Raven has already been configured"),n;if(!e)return n;var i=n._globalOptions;t&&Vi(t,function(e,t){"tags"===e||"extra"===e||"user"===e?n._globalContext[e]=t:i[e]=t}),n.setDSN(e),i.ignoreErrors.push(/^Script error\.?$/),i.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),i.ignoreErrors=Gi(i.ignoreErrors),i.ignoreUrls=!!i.ignoreUrls.length&&Gi(i.ignoreUrls),i.whitelistUrls=!!i.whitelistUrls.length&&Gi(i.whitelistUrls),i.includePaths=Gi(i.includePaths),i.maxBreadcrumbs=Math.max(0,Math.min(i.maxBreadcrumbs||100,100));var r={xhr:!0,console:!0,dom:!0,location:!0},o=i.autoBreadcrumbs;return"[object Object]"==={}.toString.call(o)?o=Hi(r,o):!1!==o&&(o=r),i.autoBreadcrumbs=o,ki.collectWindowErrors=!!i.collectWindowErrors,n},install:function(){var e=this;return e.isSetup()&&!e._isRavenInstalled&&(ki.report.subscribe(function(){e._handleOnErrorStackInfo.apply(e,arguments)}),e._instrumentTryCatch(),e._globalOptions.autoBreadcrumbs&&e._instrumentBreadcrumbs(),e._drainPlugins(),e._isRavenInstalled=!0),Error.stackTraceLimit=e._globalOptions.stackTraceLimit,this},setDSN:function(e){var t=this,n=t._parseDSN(e),i=n.path.lastIndexOf("/"),r=n.path.substr(1,i);t._dsn=e,t._globalKey=n.user,t._globalSecret=n.pass&&n.pass.substr(1),t._globalProject=n.path.substr(i+1),t._globalServer=t._getGlobalServer(n),t._globalEndpoint=t._globalServer+"/"+r+"api/"+t._globalProject+"/store/",this._resetBackoff()},context:function(e,t,n){return Ni(e)&&(n=t||[],t=e,e=void 0),this.wrap(e,t).apply(this,n)},wrap:function(i,r,o){var a=this;if(qi(r)&&!Ni(i))return i;if(Ni(i)&&(r=i,i=void 0),!Ni(r))return r;try{if(r.__raven__)return r;if(r.__raven_wrapper__)return r.__raven_wrapper__}catch(e){return r}function e(){var e=[],t=arguments.length,n=!i||i&&!1!==i.deep;for(o&&Ni(o)&&o.apply(this,arguments);t--;)e[t]=n?a.wrap(i,arguments[t]):arguments[t];try{return r.apply(this,e)}catch(e){throw a._ignoreNextOnError(),a.captureException(e,i),e}}for(var t in r)zi(r,t)&&(e[t]=r[t]);return e.prototype=r.prototype,(r.__raven_wrapper__=e).__raven__=!0,e.__inner__=r,e},uninstall:function(){return ki.report.uninstall(),this._restoreBuiltIns(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},captureException:function(t,e){if(!Ai(t))return this.captureMessage(t,Hi({trimHeadFrames:1,stacktrace:!0},e));this._lastCapturedException=t;try{var n=ki.computeStackTrace(t);this._handleStackInfo(n,e)}catch(e){if(t!==e)throw e}return this},captureMessage:function(e,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)){var n=Hi({message:e+""},t=t||{});if(this._globalOptions.stacktrace||t&&t.stacktrace){var i;try{throw new Error(e)}catch(e){i=e}i.name=null,t=Hi({fingerprint:e,trimHeadFrames:(t.trimHeadFrames||0)+1},t);var r=ki.computeStackTrace(i),o=this._prepareFrames(r,t);n.stacktrace={frames:o.reverse()}}return this._send(n),this}},captureBreadcrumb:function(e){var t=Hi({timestamp:Ri()/1e3},e);if(Ni(this._globalOptions.breadcrumbCallback)){var n=this._globalOptions.breadcrumbCallback(t);if(Li(n)&&!Ui(n))t=n;else if(!1===n)return this}return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(e){var t=[].slice.call(arguments,1);return this._plugins.push([e,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(e){return this._globalContext.user=e,this},setExtraContext:function(e){return this._mergeContext("extra",e),this},setTagsContext:function(e){return this._mergeContext("tags",e),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(Si(this._globalContext))},setEnvironment:function(e){return this._globalOptions.environment=e,this},setRelease:function(e){return this._globalOptions.release=e,this},setDataCallback:function(t){var n=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=Ni(t)?function(e){return t(e,n)}:t,this},setBreadcrumbCallback:function(t){var n=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=Ni(t)?function(e){return t(e,n)}:t,this},setShouldSendCallback:function(t){var n=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=Ni(t)?function(e){return t(e,n)}:t,this},setTransport:function(e){return this._globalOptions.transport=e,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var e=Mi.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(Ii){var t=(e=e||{}).eventId||this.lastEventId();if(!t)throw new Ti("Missing eventId");var n=e.dsn||this._dsn;if(!n)throw new Ti("Missing DSN");var i=encodeURIComponent,r="";r+="?eventId="+i(t),r+="&dsn="+i(n);var o=e.user||this._globalContext.user;o&&(o.name&&(r+="&name="+i(o.name)),o.email&&(r+="&email="+i(o.email)));var a=this._getGlobalServer(this._parseDSN(n)),s=Ii.createElement("script");s.async=!0,s.src=a+"/api/embed/error-page/"+r,(Ii.head||Ii.body).appendChild(s)}},_ignoreNextOnError:function(){var e=this;this._ignoreOnError+=1,setTimeout(function(){e._ignoreOnError-=1})},_triggerEvent:function(e,t){var n,i;if(this._hasDocument){for(i in t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),Ii.createEvent?(n=Ii.createEvent("HTMLEvents")).initEvent(e,!0,!0):(n=Ii.createEventObject()).eventType=e,t)zi(t,i)&&(n[i]=t[i]);if(Ii.createEvent)Ii.dispatchEvent(n);else try{Ii.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(e){}}},_breadcrumbEventHandler:function(n){var i=this;return function(e){if(i._keypressTimeout=null,i._lastCapturedEvent!==e){var t;i._lastCapturedEvent=e;try{t=$i(e.target)}catch(e){t="<unknown>"}i.captureBreadcrumb({category:"ui."+n,message:t})}}},_keypressEventHandler:function(){var r=this;return function(e){var t;try{t=e.target}catch(e){return}var n=t&&t.tagName;if(n&&("INPUT"===n||"TEXTAREA"===n||t.isContentEditable)){var i=r._keypressTimeout;i||r._breadcrumbEventHandler("input")(e),clearTimeout(i),r._keypressTimeout=setTimeout(function(){r._keypressTimeout=null},1e3)}}},_captureUrlChange:function(e,t){var n=Yi(this._location.href),i=Yi(t),r=Yi(e);this._lastHref=t,n.protocol===i.protocol&&n.host===i.host&&(t=i.relative),n.protocol===r.protocol&&n.host===r.host&&(e=r.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},_instrumentTryCatch:function(){var u=this,t=u._wrappedBuiltIns;function e(o){return function(e,t){for(var n=new Array(arguments.length),i=0;i<n.length;++i)n[i]=arguments[i];var r=n[0];return Ni(r)&&(n[0]=u.wrap(r)),o.apply?o.apply(this,n):o(n[0],n[1])}}var c=this._globalOptions.autoBreadcrumbs;function n(l){var e=Mi[l]&&Mi[l].prototype;e&&e.hasOwnProperty&&e.hasOwnProperty("addEventListener")&&(er(e,"addEventListener",function(s){return function(e,t,n,i){try{t&&t.handleEvent&&(t.handleEvent=u.wrap(t.handleEvent))}catch(e){}var r,o,a;return c&&c.dom&&("EventTarget"===l||"Node"===l)&&(o=u._breadcrumbEventHandler("click"),a=u._keypressEventHandler(),r=function(e){if(e){var t;try{t=e.type}catch(e){return}return"click"===t?o(e):"keypress"===t?a(e):void 0}}),s.call(this,e,u.wrap(t,void 0,r),n,i)}},t),er(e,"removeEventListener",function(r){return function(e,t,n,i){try{t=t&&(t.__raven_wrapper__?t.__raven_wrapper__:t)}catch(e){}return r.call(this,e,t,n,i)}},t))}er(Mi,"setTimeout",e,t),er(Mi,"setInterval",e,t),Mi.requestAnimationFrame&&er(Mi,"requestAnimationFrame",function(t){return function(e){return t(u.wrap(e))}},t);for(var i=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],r=0;r<i.length;r++)n(i[r])},_instrumentBreadcrumbs:function(){var u=this,e=this._globalOptions.autoBreadcrumbs,t=u._wrappedBuiltIns;if(e.xhr&&"XMLHttpRequest"in Mi){var n=XMLHttpRequest.prototype;er(n,"open",function(n){return function(e,t){return ji(t)&&-1===t.indexOf(u._globalKey)&&(this.__raven_xhr={method:e,url:t,status_code:null}),n.apply(this,arguments)}},t),er(n,"send",function(s){return function(e){var t=this;function n(){if(t.__raven_xhr&&(1===t.readyState||4===t.readyState)){try{t.__raven_xhr.status_code=t.status}catch(e){}u.captureBreadcrumb({type:"http",category:"xhr",data:t.__raven_xhr})}}for(var i,r,o=["onload","onerror","onprogress"],a=0;a<o.length;a++)(i=o[a])in(r=t)&&Ni(r[i])&&er(r,i,function(e){return u.wrap(e)});return"onreadystatechange"in t&&Ni(t.onreadystatechange)?er(t,"onreadystatechange",function(e){return u.wrap(e,void 0,n)}):t.onreadystatechange=n,s.apply(this,arguments)}},t)}e.xhr&&"fetch"in Mi&&er(Mi,"fetch",function(l){return function(e,t){for(var n=new Array(arguments.length),i=0;i<n.length;++i)n[i]=arguments[i];var r,o=n[0],a="GET";"string"==typeof o?r=o:(r=o.url,o.method&&(a=o.method)),n[1]&&n[1].method&&(a=n[1].method);var s={method:a,url:r,status_code:null};return u.captureBreadcrumb({type:"http",category:"fetch",data:s}),l.apply(this,n).then(function(e){return s.status_code=e.status,e})}},t),e.dom&&this._hasDocument&&(Ii.addEventListener?(Ii.addEventListener("click",u._breadcrumbEventHandler("click"),!1),Ii.addEventListener("keypress",u._keypressEventHandler(),!1)):(Ii.attachEvent("onclick",u._breadcrumbEventHandler("click")),Ii.attachEvent("onkeypress",u._keypressEventHandler())));var i=Mi.chrome,r=!(i&&i.app&&i.app.runtime)&&Mi.history&&history.pushState;if(e.location&&r){var o=Mi.onpopstate;Mi.onpopstate=function(){var e=u._location.href;if(u._captureUrlChange(u._lastHref,e),o)return o.apply(this,arguments)},er(history,"pushState",function(t){return function(){var e=2<arguments.length?arguments[2]:void 0;return e&&u._captureUrlChange(u._lastHref,e+""),t.apply(this,arguments)}},t)}if(e.console&&"console"in Mi&&console.log){var a=function(e,t){u.captureBreadcrumb({message:e,level:t.level,category:"console"})};Vi(["debug","info","warn","error","log"],function(e,t){Pi(console,t,a)})}},_restoreBuiltIns:function(){for(var e;this._wrappedBuiltIns.length;){var t=(e=this._wrappedBuiltIns.shift())[0],n=e[1],i=e[2];t[n]=i}},_drainPlugins:function(){var r=this;Vi(this._plugins,function(e,t){var n=t[0],i=t[1];n.apply(r,[r].concat(i))})},_parseDSN:function(t){var e=Oi.exec(t),n={},i=7;try{for(;i--;)n[Ci[i]]=e[i]||""}catch(e){throw new Ti("Invalid DSN: "+t)}if(n.pass&&!this._globalOptions.allowSecretKey)throw new Ti("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},_getGlobalServer:function(e){var t="//"+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(e,t){var n=this._prepareFrames(e,t);this._triggerEvent("handle",{stackInfo:e,options:t}),this._processException(e.name,e.message,e.url,e.lineno,n,t)},_prepareFrames:function(e,t){var i=this,r=[];if(e.stack&&e.stack.length&&(Vi(e.stack,function(e,t){var n=i._normalizeFrame(t);n&&r.push(n)}),t&&t.trimHeadFrames))for(var n=0;n<t.trimHeadFrames&&n<r.length;n++)r[n].in_app=!1;return r=r.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(e){if(e.url){var t={filename:e.url,lineno:e.line,colno:e.column,function:e.func||"?"};return t.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(t.filename)||/(Raven|TraceKit)\./.test(t.function)||/raven\.(min\.)?js$/.test(t.filename)),t}},_processException:function(e,t,n,i,r,o){var a;if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t))&&(t+="",r&&r.length?(n=r[0].filename||n,r.reverse(),a={frames:r}):n&&(a={frames:[{filename:n,lineno:i,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(n))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(n)))){var s=Hi({exception:{values:[{type:e,value:t,stacktrace:a}]},culprit:n},o);this._send(s)}},_trimPacket:function(e){var t=this._globalOptions.maxMessageLength;if(e.message&&(e.message=Wi(e.message,t)),e.exception){var n=e.exception.values[0];n.value=Wi(n.value,t)}var i=e.request;return i&&(i.url&&(i.url=Wi(i.url,this._globalOptions.maxUrlLength)),i.Referer&&(i.Referer=Wi(i.Referer,this._globalOptions.maxUrlLength))),e.breadcrumbs&&e.breadcrumbs.values&&this._trimBreadcrumbs(e.breadcrumbs),e},_trimBreadcrumbs:function(e){for(var t,n,i,r=["to","from","url"],o=0;o<e.values.length;++o)if((n=e.values[o]).hasOwnProperty("data")&&Li(n.data)){i=n.data;for(var a=0;a<r.length;++a)t=r[a],i.hasOwnProperty(t)&&(i[t]=Wi(i[t],this._globalOptions.maxUrlLength))}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var e={};return this._hasNavigator&&Di.userAgent&&(e.headers={"User-Agent":navigator.userAgent}),this._hasDocument&&(Ii.location&&Ii.location.href&&(e.url=Ii.location.href),Ii.referrer&&(e.headers||(e.headers={}),e.headers.Referer=Ii.referrer)),e}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&Ri()-this._backoffStart<this._backoffDuration},_isRepeatData:function(e){var t,n,i=this._lastData;return!(!i||e.message!==i.message||e.culprit!==i.culprit)&&(e.stacktrace||i.stacktrace?Zi(e.stacktrace,i.stacktrace):!e.exception&&!i.exception||(t=e.exception,n=i.exception,!Ji(t,n)&&(t=t.values[0],n=n.values[0],t.type===n.type&&t.value===n.value&&Zi(t.stacktrace,n.stacktrace))))},_setBackoffState:function(e){if(!this._shouldBackoff()){var t=e.status;if(400===t||401===t||429===t){var n;try{n=e.getResponseHeader("Retry-After"),n=1e3*parseInt(n,10)}catch(e){}this._backoffDuration=n||(2*this._backoffDuration||1e3),this._backoffStart=Ri()}}},_send:function(e){var t=this._globalOptions,n={project:this._globalProject,logger:t.logger,platform:"javascript"},i=this._getHttpData();i&&(n.request=i),e.trimHeadFrames&&delete e.trimHeadFrames,(e=Hi(n,e)).tags=Hi(Hi({},this._globalContext.tags),e.tags),e.extra=Hi(Hi({},this._globalContext.extra),e.extra),e.extra["session:duration"]=Ri()-this._startTime,this._breadcrumbs&&0<this._breadcrumbs.length&&(e.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),Ui(e.tags)&&delete e.tags,this._globalContext.user&&(e.user=this._globalContext.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),Ni(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!Ui(e)&&(Ni(t.shouldSendCallback)&&!t.shouldSendCallback(e)||(this._shouldBackoff()?this._logDebug("warn","Raven dropped error due to backoff: ",e):"number"==typeof t.sampleRate?Math.random()<t.sampleRate&&this._sendProcessedPayload(e):this._sendProcessedPayload(e)))},_getUuid:function(){return Xi()},_sendProcessedPayload:function(t,n){var i=this,e=this._globalOptions;if(this.isSetup())if(this._lastEventId=t.event_id||(t.event_id=this._getUuid()),t=this._trimPacket(t),this._globalOptions.allowDuplicates||!this._isRepeatData(t)){this._lastData=t,this._logDebug("debug","Raven about to send:",t);var r={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(r.sentry_secret=this._globalSecret);var o=t.exception&&t.exception.values[0];this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:t.message,event_id:t.event_id,level:t.level||"error"});var a=this._globalEndpoint;(e.transport||this._makeRequest).call(this,{url:a,auth:r,data:t,options:e,onSuccess:function(){i._resetBackoff(),i._triggerEvent("success",{data:t,src:a}),n&&n()},onError:function(e){i._logDebug("error","Raven transport failed to send: ",e),e.request&&i._setBackoffState(e.request),i._triggerEvent("failure",{data:t,src:a}),e=e||new Error("Raven send failed (no additional details provided)"),n&&n(e)}})}else this._logDebug("warn","Raven dropped repeat event: ",t)},_makeRequest:function(t){var n=new XMLHttpRequest;if("withCredentials"in n||"undefined"!=typeof XDomainRequest){var e=t.url;"withCredentials"in n?n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status)t.onSuccess&&t.onSuccess();else if(t.onError){var e=new Error("Sentry error code: "+n.status);e.request=n,t.onError(e)}}:(n=new XDomainRequest,e=e.replace(/^https?:/,""),t.onSuccess&&(n.onload=t.onSuccess),t.onError&&(n.onerror=function(){var e=new Error("Sentry error code: XDomainRequest");e.request=n,t.onError(e)})),n.open("POST",e+"?"+Ki(t.auth)),n.send(Si(t.data))}},_logDebug:function(e){this._originalConsoleMethods[e]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[e],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(e,t){qi(t)?delete this._globalContext[e]:this._globalContext[e]=Hi(this._globalContext[e]||{},t)}};var Bi=Object.prototype;function qi(e){return void 0===e}function Ni(e){return"function"==typeof e}function ji(e){return"[object String]"===Bi.toString.call(e)}function Ui(e){for(var t in e)return!1;return!0}function Vi(e,t){var n,i;if(qi(e.length))for(n in e)zi(e,n)&&t.call(null,n,e[n]);else if(i=e.length)for(n=0;n<i;n++)t.call(null,n,e[n])}function Hi(n,e){return e&&Vi(e,function(e,t){n[e]=t}),n}function Wi(e,t){return!t||e.length<=t?e:e.substr(0,t)+"…"}function zi(e,t){return Bi.hasOwnProperty.call(e,t)}function Gi(e){for(var t,n=[],i=0,r=e.length;i<r;i++)ji(t=e[i])?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return new RegExp(n.join("|"),"i")}function Ki(e){var n=[];return Vi(e,function(e,t){n.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}),n.join("&")}function Yi(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",i=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+n+i}}function Xi(){var e=Mi.crypto||Mi.msCrypto;if(!qi(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(t[0])+n(t[1])+n(t[2])+n(t[3])+n(t[4])+n(t[5])+n(t[6])+n(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function $i(e){for(var t,n=[],i=0,r=0,o=" > ".length;e&&i++<5&&!("html"===(t=Qi(e))||1<i&&80<=r+n.length*o+t.length);)n.push(t),r+=t.length,e=e.parentNode;return n.reverse().join(" > ")}function Qi(e){var t,n,i,r,o,a=[];if(!e||!e.tagName)return"";if(a.push(e.tagName.toLowerCase()),e.id&&a.push("#"+e.id),(t=e.className)&&ji(t))for(n=t.split(/\s+/),o=0;o<n.length;o++)a.push("."+n[o]);var s=["type","name","title","alt"];for(o=0;o<s.length;o++)i=s[o],(r=e.getAttribute(i))&&a.push("["+i+'="'+r+'"]');return a.join("")}function Ji(e,t){return!!(!!e^!!t)}function Zi(e,t){if(Ji(e,t))return!1;var n,i,r=e.frames,o=t.frames;if(r.length!==o.length)return!1;for(var a=0;a<r.length;a++)if(n=r[a],i=o[a],n.filename!==i.filename||n.lineno!==i.lineno||n.colno!==i.colno||n.function!==i.function)return!1;return!0}function er(e,t,n,i){var r=e[t];e[t]=n(r),i&&i.push([e,t,r])}"undefined"!=typeof __false__&&__false__&&(Fi.utils={isUndefined:qi,isFunction:Ni,isString:ji,isObject:Li,isEmptyObject:Ui,isError:Ai,each:Vi,objectMerge:Hi,truncate:Wi,hasKey:zi,joinRegExp:Gi,urlencode:Ki,uuid4:Xi,htmlTreeAsString:$i,htmlElementAsString:Qi,parseUrl:Yi,fill:er}),Fi.prototype.setUser=Fi.prototype.setUserContext,Fi.prototype.setReleaseContext=Fi.prototype.setRelease;var tr=Fi,nr="undefined"!=typeof window?window:void 0!==s?s:"undefined"!=typeof self?self:{},ir=nr.Raven,rr=new tr;rr.noConflict=function(){return nr.Raven=ir,rr},rr.afterLoad();var or=rr;function ar(e){Te.iOS&&"onpagehide"in window?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)}var sr={setUp:function(t){if(t.request.sentry)try{var e="dev"===t.request.build.js?"dev":"production",n={session:t.request.session,locale:t.request.lang,git_commit:t.request.build.player,debug_intent:t.request.sentry.debug_intent?1:0};if(t.request.ab_tests){var i=t.request.ab_tests;Object.keys(i).forEach(function(e){var t=i[e].data;Object.keys(t).forEach(function(e){n[e]=t[e]})})}or.config(t.request.sentry.url,{logger:"player-raven",release:t.request.build.js,environment:e,tags:n,autoBreadcrumbs:{console:!1},includePaths:[/https?:\/\/.*vimeo\.com/],ignoreErrors:["Permission denied to access property 'toString'",'Permission denied to access property "toString"',"The play() request was interrupted by a call to pause().","Permission denied to access property 'href'",'Permission denied to access property "href"',"docs-homescreen-gb-container","Failed to load image.",'Объект не поддерживает свойство или метод "endsWith"',"play() can only be initiated by a user gesture.","Forbidden","Not Found"],shouldSendCallback:function(e){return!(!t.request||!t.request.sentry.enabled&&!(t.request.sentry.debug_enabled&&e.extra&&e.extra.debugLink))}}).install(),window.addEventListener("unhandledrejection",function(e){e.preventDefault(),e.reason&&or.captureException(e.reason)}),t.request.sentry.debug_intent&&ar(function(){or.captureMessage("Session debug",{level:"info"})})}catch(e){}},captureException:function(e,t){return or.captureException(e,t),or.lastEventId()},captureMessage:function(e,t){return or.captureMessage(e,t),or.lastEventId()},captureBreadcrumb:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"player",i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"info";or.captureBreadcrumb({message:e,data:t,category:n,level:i})}};function lr(o){var t=document.referrer||o.config.request.referrer;try{t=decodeURIComponent(t)}catch(e){t=xn(t)}var n,l="_ASYNC_",i={ready:!0,error:!0},r=_n(),a=!(!window.postMessage||!window.parent.postMessage),s=!(8<=Te.browser.ie&&Te.browser.ie<10),u=null,c=o.config.embed.api,e=!1,d=!1,f=null,h=!1,v=null,p=["play","pause","ended","timeupdate","progress","seeked","error","texttrackchange","cuechange","volumechange","loaded","emailcapture","cuepoint","motionstart","motionend","liveeventstarted","liveeventended","livestreamonline","livestreamoffline","playbackratechange","bufferstart","bufferend","controlbarvisibilitychanged"],m=p.filter(function(e){return"emailcapture"!==e}),g={onFinish:"ended",onLoading:"progress",onLoad:"ready",onProgress:"timeupdate",onPlay:"play",onPause:"pause",onSeek:"seeked"},y={playProgress:"timeupdate",loadProgress:"progress",finish:"ended",seek:"seeked"};function _(e,t,n){this.message=e,this.name=t,this.source=n}_.prototype=new Error;var b={_fireEvent:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.events.fire.apply(null,t)},_setEmbedEditor:function(e){o.config.embed.editor=!!e},_setEmbedSetting:function(e,t){o.config.embed.on_site&&(t="object"===(void 0===t?"undefined":Kn(t))?t:Number(t),"badge"===e&&(t?t=n:n=o.config.embed.settings.badge),o.config.embed.settings[e]=t,o.events.fire(si.embedSettingChanged,e,t),o.events.fire(oi.reset),o.events.fire(si.configChanged,!1,o.config))},_showOverlay:function(e,t){o.events.fire(oi.showOverlay,e,t)},_toggleDebugHud:function(){o.events.fire(si.debugButtonPressed)},_fieldOfView:{get:function(){var e=o.telecine.getEffectByName("ThreeSixtyEffect");if(o.telecine&&!e)throw new _("Field of view is not available in the current player.","UnsupportedError","getFieldOfView");return e.fieldOfView},set:function(e){var t=o.telecine.getEffectByName("ThreeSixtyEffect");if(o.telecine&&!t)throw new _("Field of view is not available in the current player.","UnsupportedError","setFieldOfView");o.telecine.getEffectByName("ThreeSixtyEffect").fieldOfView=e}},_coordinates:{get:function(){var e=o.telecine.getEffectByName("ThreeSixtyEffect");if(o.telecine&&!e)throw new _("Coordinates are not available in the current player.","UnsupportedError","getCoordinates");return e.currentCoordinates},set:function(e){var t=o.telecine.getEffectByName("ThreeSixtyEffect");if(o.telecine&&!t)throw new _("Coordinates are not available in the current player.","UnsupportedError","setCoordinates");try{o.telecine.getEffectByName("ThreeSixtyEffect").currentCoordinates=e}catch(e){throw new _(e.message,"RangeError","setCoordinates")}}},addEventListener:function(e,t){if(e in g&&(e=g[e]),e in y&&(e=y[e]),p.indexOf(e)<0)throw new _("“"+e+"” is not a valid event. Valid events are: "+m.join(", ")+".","TypeError","addEventListener");t?r.on(e,t):i[e]=!0,("loaded"===e&&o.config.view===vi.main||o.config.view===vi.privateUnlocked)&&k()},removeEventListener:function(e,t){t?r.off(e,t):i[e]=!1},play:function(){w("play"),o.events.fire(si.playButtonPressed)},pause:function(){w("pause"),o.events.fire(si.pauseButtonPressed)},loadVideo:function(e){var t=function(n){if(!n)return{};if(Number.isInteger(parseInt(n,10)))return{id:parseInt(n,10),params:{}};if("string"==typeof n)return 0!==n.indexOf("https://")?{}:{url:n,params:{}};var t=["portrait","title","byline","color","autoplay","loop","video_version"],e=Object.keys(n).filter(function(e){return-1!==t.indexOf(e)}).reduce(function(e,t){return e[t]=n[t],e},{});return"url"in n?0!==n.url.indexOf("https://")?{}:{url:n.url,params:e}:"id"in n&&Number.isInteger(parseInt(n.id,10))?{id:parseInt(n.id,10),params:e}:{}}(e),n=t.id,i=t.url,r=t.params;if(!n&&!i)throw new _("The video id must be an integer.","TypeError","loadVideo");if(i&&i.match(null===new RegExp("^https?://"+o.config.player_url+"/video/([0-9]+)/config")))throw new _("The config url must be a valid Vimeo url.","TypeError","loadVideo");return o.loadVideo(i||n,r).then(function(){return 2<c&&E({method:"loadVideo",value:e}),e}).catch(function(){try{w("loadVideo")}catch(e){if(e instanceof _)return void T(e);T(new _("An error occurred loading the video.","Error","loadVideo"))}throw new _("An error occurred loading the video.","Error","loadVideo")}),l},unload:function(){o.config.view!==vi.main&&o.config.view!==vi.privateUnlocked||o.events.fire(oi.reset)},enableTextTrack:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=("text_tracks"in o.config.request?o.config.request.text_tracks:[]).map(function(e){return e.language=e.lang,e});if(!n.some(function(e){return e.language.toLowerCase()===t.toLowerCase()}))throw new _("There are no tracks for “"+t.toUpperCase()+"”.","InvalidTrackLanguageError","enableTextTrack");var i=Zn(e?t+"."+e:t,n).track;if(!i||e&&i.kind!==e)throw new _("There are no "+e+" tracks for “"+t.toUpperCase()+"”.","InvalidTrackError","enableTextTrack");return o.events.fire(oi.turnCaptionsOn,i.id,!0),2<c&&o.events.once(si.captionsChanged,function(e,t){E({method:"enableTextTrack",value:{label:e.label,language:e.language,kind:e.kind}})}),l},disableTextTrack:function(){o.events.fire(oi.turnCaptionsOff)},ping:function(){return o.config.video.id},addCuePoint:function(e,t){if(o.telecine&&"moogaloop"===o.telecine.currentScanner)throw new _("Cue points are not supported in the current player.","UnsupportedError","addCuePoint");if(e=parseFloat(e),isNaN(e)||e<0||e>o.config.video.duration)throw new _("Cue point time must be positive number less than the duration of the video ("+Vn(o.config.video.duration)+").","RangeError","addCuePoint");try{var n=o.telecine.addCuePoint(e,t);return setTimeout(function(){o.events.fire(si.cuePointAdded,n)},0),n.id}catch(e){if("CuePointsNotSupported"===e.name)throw new _("Cue points are not supported in the current player.","UnsupportedError","addCuePoint");throw new _("Unable to add cue point","InvalidCuePoint","addCuePoint")}},removeCuePoint:function(t){if(o.telecine&&"moogaloop"===o.telecine.currentScanner)throw new _("Cue points are not supported in the current player.","UnsupportedError","removeCuePoint");var e=o.telecine.cuePoints.filter(function(e){return e.id===t})[0];if(!e)throw new _("Cue point “"+t+"” was not found.","InvalidCuePoint","removeCuePoint");o.telecine.removeCuePoint(e),setTimeout(function(){o.events.fire(si.cuePointRemoved,e)},0)},_addCard:function(e){o.events.fire(oi.addCard,e)},_removeCard:function(e){o.events.fire(oi.removeCard,e)},autopause:{get:function(){if(o.telecine&&"moogaloop"===o.telecine.currentScanner)throw new _("Autopause is not supported in the current player.","UnsupportedError","getAutopause");return!!o.config.embed.autopause},set:function(e){if(o.telecine&&"moogaloop"===o.telecine.currentScanner)throw new _("Autopause is not supported in the current player.","UnsupportedError","setAutopause");o.config.embed.autopause=!!e}},color:{get:function(){return o.config.embed.color.replace("#","")},set:function(e){if("moogaloop"!==o.telecine.currentScanner){if(o.config.embed.settings.color&&!o.config.embed.on_site)throw new _("The creator of the video has chosen to always use "+new An(o.config.embed.color).hex+".","EmbedSettingsError","setColor");try{var t=new An(e);o.events.fire(oi.changeColor,t.hex)}catch(e){throw new _("The color should be 3- or 6-digit hex value.","TypeError","setColor")}var n=new An(23,35,34,.75);if(n.contrast(t).ratio<3){var i=t.clone().lighten(5,3,n);throw new _(t.hex+" does not meet minimum contrast ratio. We recommend using brighter colors. (You could try "+i.hex+" instead.) See WCAG 2.0 guidelines: http://www.w3.org/TR/WCAG/#visual-audio-contrast","ContrastError","setColor")}}else o.events.fire(oi.changeColor,e)}},cuePoints:{get:function(){if(o.telecine&&"moogaloop"===o.telecine.currentScanner)throw new _("Cue points are not supported in the current player.","UnsupportedError","getCuePoints");return o.telecine.cuePoints.map(function(e){return{time:e.time,data:e.data,id:e.id}})}},currentTime:{get:function(){return o.telecine&&.1<o.telecine.currentTime?Vn(o.telecine.currentTime):0},set:function(e){if(e=parseFloat(e),isNaN(e)||e<0||e>o.config.video.duration)throw new _("Seconds must be a positive number less than the duration of the video ("+Vn(o.config.video.duration)+").","RangeError","setCurrentTime");return o.events.fire(oi.seek,null,e),o.events.fire(si.mousedOver),2<c&&o.events.once(si.seeked,function(e,t,n){E({method:"setCurrentTime",value:e})}),l}},duration:{get:function(){return Vn(o.config.video.duration)}},ended:{get:function(){return!!o.telecine.ended}},loop:{get:function(){return!!o.config.embed.loop},set:function(e){o.events.fire(oi.changeLoop,e)}},paused:{get:function(){return!(o.telecine&&"paused"in o.telecine)||!!o.telecine.paused}},playbackRate:{get:function(){return o.telecine?o.telecine.playbackRate:1},set:function(e){if(!o.config.embed.settings.speed)throw new _("Setting the playback rate is not enabled for this video.","Error","setPlaybackRate");if(isNaN(e)||e<fi.low||e>fi.high)throw new _("Playback rate should be a number between "+fi.low+" and "+fi.high+".","RangeError","setPlaybackRate");o.events.fire(oi.changePlaybackRate,e)}},textTracks:{get:function(){return(o.telecine?o.telecine.video.textTracks:[]).map(function(e){return{label:e.label,language:e.language,kind:e.kind,mode:e===v?"showing":"disabled"}})}},videoEmbedCode:{get:function(){return o.config.video.embed_code}},videoHeight:{get:function(){return o.telecine.videoHeight||o.config.video.height}},videoId:{get:function(){return o.config.video.id}},videoTitle:{get:function(){return o.config.video.title}},videoWidth:{get:function(){return o.telecine.videoWidth||o.config.video.width}},videoUrl:{get:function(){if(!o.config.video.url)throw new _("The URL is not available because of the video’s privacy settings.","PrivacyError","getVideoUrl");return o.config.video.url}},volume:{get:function(){var e=Vn(o.config.request.cookie.volume);return 1===c?Math.round(100*e):e},set:function(e){if(e=parseFloat(e),1===c&&(e/=100),isNaN(e)||e<0||1<e)throw new _("Volume should be a number between 0 and 1.","RangeError","setVolume");u=e;o.events.fire(oi.changeVolume,e,!0)}},_like:{get:function(){return!!o.config.user.liked},set:function(e){if(o.config.embed.on_site){if(o.config.user.liked===e)return;o.events.fire(si.likeButtonPressed,e)}}},_watchLater:{get:function(){return!!o.config.user.watch_later},set:function(e){if(o.config.embed.on_site){if(o.config.user.watch_later===e)return;o.events.fire(si.watchLaterButtonPressed,e)}}},_setOutro:function(e,t){o.config.embed.outro!==e?(o.events.fire(oi.hideOutro),setTimeout(function(){o.config.embed.outro=e,o.events.fire(oi.showOutro,e,t)},400)):o.events.fire(oi.showOutro,e,t)},_hideOutro:function(){o.events.fire(oi.hideOutro)},_setEmailCapture:function(e){if(e){if(o.config.embed.email=o.config.embed.email||{},o.config.embed.email.position=e.position.toLowerCase(),"after"===e.position.toLowerCase())return o.config.embed.outro="email",void o.events.fire(oi.showOutro,"email",{version:2,data:e});o.config.embed.email.timecode=e.timecode,e.nohide=!0,e.noblur=!0,b._showOverlay("email-capture",e)}else b._unsetEmailCapture()},_unsetEmailCapture:function(){o.config.embed.outro&&(o.events.fire(oi.hideOutro),delete o.config.embed.outro),o.config.embed.email&&(o.events.fire(oi.hideOverlay,{unmakeModal:!0}),delete o.config.embed.email)}};function w(e){switch(o.config.view){case vi.privateLocked:throw new _("The video is private.","PrivacyError",e);case vi.privatePassword:throw new _("The video is password-protected. The viewer must enter the password first.","PasswordError",e);case vi.error:throw new _(o.config.message,"NotFoundError",e)}}function k(){h||(E({event:"loaded",data:{id:o.config.video.id}}),h=!0)}function S(e){if(e.source===window.parent){var t=function(t){if(!t||""===t)return{};if("object"===(void 0===t?"undefined":Kn(t)))return t;try{return c=2,JSON.parse(t)}catch(e){var r={};return t.split("&").forEach(function(e){try{var t=e.split("="),n=decodeURIComponent(t[0]),i=decodeURIComponent(t[1]);if("id"===n)return;"params"===n&&(n="value"),i=i.split(",")[0],r[n]=i}catch(e){}}),c=1,r}}(e.data),n=t.method,i=t.value;if(void 0!==n)try{var r=function(e){if(!e||"_"===e.substr(0,1))return null;switch(1===c&&(e=e.replace("api_","")),e){case"changeColor":return b.color.set;case"paused":return b.paused.get;case"seekTo":return b.currentTime.set}if("function"==typeof b[e])return b[e];var t=e.substr(0,3),n=e.substr(3,1).toLowerCase()+e.substr(4);return b[n]&&b[n][t]?b[n][t]:null}(n);if(!r)throw new _("“"+n+"” is not a valid method. Valid methods are: "+function(){var e=[];for(var t in b)if(b.hasOwnProperty(t)&&0!==t.indexOf("_")){if("function"==typeof b[t]){e.push(t);continue}"function"==typeof b[t].get&&e.push("get"+t.charAt(0).toUpperCase()+t.slice(1)),"function"==typeof b[t].set&&e.push("set"+t.charAt(0).toUpperCase()+t.slice(1))}return e.sort()}().join(", ")+".","TypeError",n);sr.captureBreadcrumb("API message received",t,"api");var o=[i];r===b.addCuePoint&&"object"===(void 0===i?"undefined":Kn(i))?o=[i.time,i.data]:r===b.enableTextTrack&&"object"===(void 0===i?"undefined":Kn(i))&&(o=[i.language,i.kind]);var a=r.apply(e,o),s=0!==n.indexOf("get")&&"paused"!==n;if(a===l||s&&c<3)return;E({method:n,value:void 0!==a&&""!==a?a:i})}catch(e){T(e)}}}function E(e){if((!e.event||(r.fire(e.event,e.data),i[e.event]))&&a){o.config.embed&&o.config.embed.player_id&&(e.player_id=o.config.embed.player_id);try{1===c?e=function(e){var t=e.event;if(1===c)for(var n in g)if(g[n]===e.event){t=n;break}switch(t){case"onSeek":case"onProgress":delete e.data.percent,delete e.data.duration;break;case"onLoading":delete e.data.seconds,delete e.data.duration}var i="method="+encodeURIComponent(t||e.method);i+="&params=";var r=[];if(void 0!==e.value)r.push(encodeURIComponent(e.value));else if("object"===Kn(e.data))for(var o in e.data)r.push(encodeURIComponent(e.data[o]));else void 0!==e.data&&r.push(encodeURIComponent(e.data));return e.player_id&&r.push(e.player_id),i+=r.join(",")}(e):2===c&&(e=function(e){if(e.event){for(var t in y)if(y[t]===e.event){e.event=t;break}"cuechange"===e.event&&(e.data.text=e.data.cues[0].text,e.data.html=e.data.cues[0].html,delete e.data.cues)}return JSON.stringify(e)}(e)),"object"!==(void 0===e?"undefined":Kn(e))||"ready"!==e.event&&s||(e=JSON.stringify(e))}catch(e){}if(window.parent!=window)try{window.parent.postMessage(e,t&&"null"!==t?t:"*")}catch(e){}}}function T(e){var t={event:"error",data:{message:"An error occurred.",name:"Error",method:e.source}};e instanceof _&&(t={event:"error",data:{message:e.message,name:e.name,method:e.source}}),E(t)}function x(){if(e&&f){try{switch(f){case"not-supported":throw new _("This video is not supported in this browser.","NotSupportedError");case"no-files":throw new _("There was an error loading the files for this video.","FileError");default:throw new _("An error occurred during playback.","PlaybackError")}}catch(e){T(e)}f=null}}return o.events.on(si.played,function(e){d||(d=!0,E({event:"play",data:{seconds:Vn(e),percent:Vn(e/o.config.video.duration),duration:Vn(o.config.video.duration)}}))}),o.events.on(si.paused,function(e){d=!1,E({event:"pause",data:{seconds:Vn(e),percent:Vn(e/o.config.video.duration),duration:Vn(o.config.video.duration)}})}),o.events.on(si.ended,function(){d=!1,E({event:"ended",data:{seconds:Vn(o.config.video.duration),percent:1,duration:Vn(o.config.video.duration)}})}),o.events.on(si.playProgress,function(e,t,n){E({event:"timeupdate",data:{seconds:Vn(e),percent:Vn(n),duration:Vn(t)}})}),o.events.on(si.bufferStarted,function(){E({event:"bufferstart",data:{}})}),o.events.on(si.bufferEnded,function(){E({event:"bufferend",data:{}})}),o.events.on(si.loadProgress,function(e,t,n){var i={event:"progress",data:{percent:Vn(n),duration:Vn(t),seconds:Vn(e)}};c<3&&(i.data.bytesLoaded=-1,i.data.bytesTotal=-1),E(i)}),o.events.on(si.seeked,function(e,t,n){E({event:"seeked",data:{seconds:Vn(e),percent:Vn(n),duration:Vn(t)}})}),o.events.on(si.volumeChanged,function(e){E({event:"volumechange",data:{volume:Vn(e)}})}),o.events.on(si.playbackRateChanged,function(e){E({event:"playbackratechange",data:{playbackRate:e}})}),o.events.on(si.error,function(e){f=e,x()}),o.events.on(si.apiError,function(e){T(new _(e.message,e.name,e.method))}),o.events.on(si.cueChanged,function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=e||{},i=n.language,r=void 0===i?null:i,o=n.label,a=void 0===o?null:o,s=n.kind;E({event:"cuechange",data:{label:a,language:r,kind:void 0===s?null:s,cues:t}})}),o.events.on(si.captionsChanged,function(e){var t=(v=e)||{},n=t.language,i=void 0===n?null:n,r=t.label,o=void 0===r?null:r,a=t.kind;E({event:"texttrackchange",data:{label:o,language:i,kind:void 0===a?null:a}})}),o.doNotTrackEnabled||o.events.on(si.emailCaptureSuccess,function(){E({event:"emailcapture"})}),o.events.on(si.cuepoint,function(e){E({event:"cuepoint",data:{time:e.time,data:e.data,id:e.id}})}),o.events.on(si.spatialMotionStart,function(){E({event:"motionstart",data:{}})}),o.events.on(si.spatialMotionEnd,function(){E({event:"motionend",data:{}})}),o.events.on(si.spaceChanged,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i.spacechange=!0,E({event:"spacechange",data:e})}),o.events.on(si.liveEventStarted,function(){E({event:"liveeventstarted",data:{}})}),o.events.on(si.liveEventEnded,function(){E({event:"liveeventended",data:{}})}),o.events.on(si.liveStreamOnline,function(){E({event:"livestreamonline",data:{}})}),o.events.on(si.liveStreamOffline,function(){E({event:"livestreamoffline",data:{}})}),o.events.on(si.controlBarVisibilityChanged,function(e){E({event:"controlbarvisibilitychanged",data:{visible:e}})}),o.events.on(oi.reset,function(){f=null,h=!1}),o.events.on(si.configChanged,function(e){u&&setTimeout(function(){o.events.fire(oi.changeVolume,u,!0)},0),e&&k()}),o.events.fire(si.apiModuleReady),o.events.once(si.ready,function(){e=!0,"embed"in o.config&&o.config.embed.on_site||(window.addEventListener?window.addEventListener("message",S,!1):window.attachEvent("onmessage",S)),E({event:"ready"}),x()}),b}var ur=/^(%20|\s)*(javascript|data)/im,cr=/[^\x20-\x7E]/gim,dr=/^([^:]+):/gm,fr=[".","/"];function hr(e){var t=e.match(dr);return t&&t[0]}function vr(e){var t,n=e.replace(cr,"");if(t=n,-1<fr.indexOf(t[0]))return n;var i=hr(n);return i&&ur.test(i)?"":n}function pr(e){return e?decodeURI(encodeURI((t=vr(e),n=hr(t=t.trim()),t&&!n&&(t="http://"+t),t))):null;var t,n}function mr(e){if("object"!==(void 0===e?"undefined":Kn(e)))return"";var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}var gr=6e4;function yr(e){var l=e.events,v=null,p=null,t=null,u=null,m=null;function n(){return p&&p-gr<=(new Date).getTime()}function g(e){var t=(new Date).getTime()+1e3*e;return m=setTimeout(function(){"onLine"in navigator&&!navigator.onLine||(u=r().catch(function(e){return sr.captureException(e)}))},1e3*e-gr-5e3),t}function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};clearTimeout(m);var n=v;if(isNaN(e)&&"string"!=typeof e)return p=g((v=e).request.expires),M.resolve({old:n,loaded:v});(new Date).getTime();var i,r=v&&v.video&&v.video.id,o=v&&v.request&&v.request.session,a=v&&v.request&&v.request.referrer,s=v&&v.embed&&v.embed.player_id,l=v&&v.embed&&v.embed.on_site,u=v&&v.embed&&v.embed.context,c=e;if(!isNaN(e)){var d=v&&v.player_url?"https://"+v.player_url:"",f="string"!=typeof(i=window.location.search)?{}:i.replace("?","").split("&").reduce(function(e,t){if(0<t.length){var n=t.split("="),i=Jn(n,2),r=i[0],o=i[1];e[r]=decodeURIComponent(o)}return e},{}),h=mr(Object.assign(f,t));c=d+"/video/"+e+"/config"+(0<h.length?"?":"")+h}return a&&(c+=(-1===c.indexOf("?")?"?":"&")+"referrer="+encodeURIComponent(a)),jn(c,{allowErrorStatuses:!0}).then(function(e){(v=JSON.parse(e)).view!==vi.error&&(p=g(v.request.expires),o&&v.video.id===r&&(v.request.session=o),a&&(v.request.referrer=a),s&&(v.embed.player_id=s),l&&(v.embed.on_site=1,v.embed.context=u));(new Date).getTime();return{old:n,loaded:v}})}function r(){clearTimeout(m);(new Date).getTime();var t=v&&v.request.referrer,n=v.video.live_event?v.request.files.dash.streams:null,e=v.request,i=e.signature,r=e.session,o=e.timestamp,a=e.expires,s="https://"+v.player_url+"/video/"+v.video.id+"/config/request?session="+r+"&signature="+i+"&time="+o+"&expires="+a;return t&&(s+=(-1===s.indexOf("?")?"?":"&")+"referrer="+encodeURIComponent(t)),jn(s).then(function(e){v.request=JSON.parse(e),t&&(v.request.referrer=t),n&&(v.request.files.dash.streams=n),p=g(v.request.expires);(new Date).getTime();return u=null,l.fire(si.requestConfigReloaded),v.request})}return window.addEventListener("online",function(){n()&&(u=r().catch(function(e){return sr.captureException(e)}))}),l.on(si.error,function(e){"media-url-expired"===e&&(u=r().catch(function(e){return sr.captureException(e)}))}),{get isExpired(){return n()},load:function(e,t){return i(e,t)},reload:function(){return v&&v.video.id?i(v.video.id):M.reject(new Error("No config loaded."))},toJSON:function(){return v},get config(){return v},set config(e){v=e},verify:function(){return n()?(u||(u=r()),u):M.resolve(v.request)},get _video(){return t},set _video(e){t=e}}}var _r=function(){return w.Date.now()},br=NaN,wr=/^\s+|\s+$/g,kr=/^[-+]0x[0-9a-f]+$/i,Sr=/^0b[01]+$/i,Er=/^0o[0-7]+$/i,Tr=parseInt;var xr=function(e){if("number"==typeof e)return e;if(B(e))return br;if(U(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=U(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(wr,"");var n=Sr.test(e);return n||Er.test(e)?Tr(e.slice(2),n?2:8):kr.test(e)?br:+e},Ar="Expected a function",Lr=Math.max,Pr=Math.min;var Cr=function(i,r,e){var o,a,s,l,u,c,d=0,f=!1,h=!1,t=!0;if("function"!=typeof i)throw new TypeError(Ar);function v(e){var t=o,n=a;return o=a=void 0,d=e,l=i.apply(n,t)}function p(e){var t=e-c;return void 0===c||r<=t||t<0||h&&s<=e-d}function m(){var e,t,n=_r();if(p(n))return g(n);u=setTimeout(m,(t=r-((e=n)-c),h?Pr(t,s-(e-d)):t))}function g(e){return u=void 0,t&&o?v(e):(o=a=void 0,l)}function n(){var e,t=_r(),n=p(t);if(o=arguments,a=this,c=t,n){if(void 0===u)return d=e=c,u=setTimeout(m,r),f?v(e):l;if(h)return u=setTimeout(m,r),v(c)}return void 0===u&&(u=setTimeout(m,r)),l}return r=xr(r)||0,U(e)&&(f=!!e.leading,s=(h="maxWait"in e)?Lr(xr(e.maxWait)||0,r):s,t="trailing"in e?!!e.trailing:t),n.cancel=function(){void 0!==u&&clearTimeout(u),o=c=a=u=void(d=0)},n.flush=function(){return void 0===u?l:g(_r())},n},Or="PREVIEW_SET_SIZE",Rr=function(e,t){return{type:Or,payload:{width:e,height:t}}},Mr=Object.prototype;var Ir=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Mr)};var Dr=function(t,n){return function(e){return t(n(e))}}(Object.keys,Object),Fr=Object.prototype.hasOwnProperty;var Br=function(e){if(!Ir(e))return Dr(e);var t=[];for(var n in Object(e))Fr.call(e,n)&&"constructor"!=n&&t.push(n);return t},qr=se(w,"DataView"),Nr=se(w,"Promise"),jr=se(w,"Set"),Ur=se(w,"WeakMap"),Vr="[object Map]",Hr="[object Promise]",Wr="[object Set]",zr="[object WeakMap]",Gr="[object DataView]",Kr=J(qr),Yr=J(Oe),Xr=J(Nr),$r=J(jr),Qr=J(Ur),Jr=I;(qr&&Jr(new qr(new ArrayBuffer(1)))!=Gr||Oe&&Jr(new Oe)!=Vr||Nr&&Jr(Nr.resolve())!=Hr||jr&&Jr(new jr)!=Wr||Ur&&Jr(new Ur)!=zr)&&(Jr=function(e){var t=I(e),n="[object Object]"==t?e.constructor:void 0,i=n?J(n):"";if(i)switch(i){case Kr:return Gr;case Yr:return Vr;case Xr:return Hr;case $r:return Wr;case Qr:return zr}return t});var Zr=Jr,eo="[object Arguments]";var to=function(e){return D(e)&&I(e)==eo},no=Object.prototype,io=no.hasOwnProperty,ro=no.propertyIsEnumerable,oo=to(function(){return arguments}())?to:function(e){return D(e)&&io.call(e,"callee")&&!ro.call(e,"callee")},ao=9007199254740991;var so=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=ao};var lo=function(e){return null!=e&&so(e.length)&&!K(e)};var uo=function(){return!1},co=t(function(e,t){var n=t&&!t.nodeType&&t,i=n&&e&&!e.nodeType&&e,r=i&&i.exports===n?w.Buffer:void 0,o=(r?r.isBuffer:void 0)||uo;e.exports=o}),fo={};fo["[object Float32Array]"]=fo["[object Float64Array]"]=fo["[object Int8Array]"]=fo["[object Int16Array]"]=fo["[object Int32Array]"]=fo["[object Uint8Array]"]=fo["[object Uint8ClampedArray]"]=fo["[object Uint16Array]"]=fo["[object Uint32Array]"]=!0,fo["[object Arguments]"]=fo["[object Array]"]=fo["[object ArrayBuffer]"]=fo["[object Boolean]"]=fo["[object DataView]"]=fo["[object Date]"]=fo["[object Error]"]=fo["[object Function]"]=fo["[object Map]"]=fo["[object Number]"]=fo["[object Object]"]=fo["[object RegExp]"]=fo["[object Set]"]=fo["[object String]"]=fo["[object WeakMap]"]=!1;var ho=function(e){return D(e)&&so(e.length)&&!!fo[I(e)]};var vo=function(t){return function(e){return t(e)}},po=t(function(e,t){var n=t&&!t.nodeType&&t,i=n&&e&&!e.nodeType&&e,r=i&&i.exports===n&&_.process,o=function(){try{return r&&r.binding&&r.binding("util")}catch(e){}}();e.exports=o}),mo=po&&po.isTypedArray,go=mo?vo(mo):ho,yo="[object Map]",_o="[object Set]",bo=Object.prototype.hasOwnProperty;var wo=function(e){if(null==e)return!0;if(lo(e)&&(y(e)||"string"==typeof e||"function"==typeof e.splice||co(e)||go(e)||oo(e)))return!e.length;var t=Zr(e);if(t==yo||t==_o)return!e.size;if(Ir(e))return!Br(e).length;for(var n in e)if(bo.call(e,n))return!1;return!0};function ko(e,t){var n=e,i=t;return n%320!=0&&(n=100*Math.ceil(e/100),i=Math.round(n/e*t)),{width:n,height:i}}function So(e){var t=e.width,n=e.height,i=e.baseUrl,r=e.webpSupport,o=void 0!==r&&r,a=e.crop,s=void 0!==a&&a,l=i+(o?".webp":".jpg"),u={},c=parseInt(t,10),d=parseInt(n,10);return 0!==c&&(s?u.w=c:u.mw=c),0!==d&&(s?u.h=d:u.mh=d),1<Te.devicePixelRatio&&(u.q=70),wo(u)||(l+="?"+mr(u)),l}function Eo(i){return new M(function(e,t){var n=new Image;n.src=i,n.onload=function(){return e(n)},n.onerror=function(){return t(new Error("Failed to load image."))}})}function To(r,o,a){var e=null;function s(){return a.getAttribute("data-thumb")}function l(){return ko(o.get("ui.player.innerWidth")*Te.devicePixelRatio,o.get("ui.player.innerHeight")*Te.devicePixelRatio)}function n(){if(!r.config.video.thumbs.base)return M.resolve();var e=l(),t=e.width,n=So({width:t,height:e.height,baseUrl:r.config.video.thumbs.base,webpSupport:r.config.request.flags.webp});a.setAttribute("data-thumb",n),a.setAttribute("data-thumb-width",t);var i=Eo(n).then(function(e){return o.dispatch(Rr(e.width,e.height)),r.config.embed.autoplay||(a.style.backgroundImage="url("+s()+")"),e}).catch(function(e){sr.captureException(e,{extra:{thumbnailUrl:n}})});return M.race([i,new M(function(e){return setTimeout(e,2e3)})])}return e=n(),r.events.on(si.didEnterFullscreen,function(){a.classList.contains("vp-preview-invisible")&&"beginning"!==r.config.embed.outro||(e=n())}),o.watch("ui.player.innerWidth",Cr(function(){e=e.then(function(){return e=l().width,t=a.getAttribute("data-thumb-width"),e<=parseInt(t,10)||0===e?M.resolve():n();var e,t}).catch(function(e){})},250)),o.watch("ui.preview.scaleFactor",function(e){1<e?a.classList.add("vp-preview-cover"):a.classList.remove("vp-preview-cover")}),{show:function(){a.style.backgroundImage="url("+s()+")",a.classList.remove("vp-preview-invisible")},hide:function(){a.classList.add("vp-preview-invisible")},resetThumbnail:function(){a.setAttribute("data-thumb",""),a.setAttribute("data-thumb-width",""),a.style.backgroundImage=""},getThumbnail:s,loadThumbnail:n,thumbnailPromise:e}}function xo(e){return!0===e||!1===e?Number(e):"null"===e?null:e}function Ao(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document.cookie;try{if(e&&""!==e)return e.split(";").reduce(function(e,t){return 0===(t=t.trim()).indexOf(n+"=")?decodeURIComponent(t.substr(n.length+1)):e},null)}catch(e){}return null}var Lo=["quality","volume","captions"],Po=null;function Co(o){var a,e=0!==o.config.request.urls.proxy.indexOf(window.location.origin),n=0;function i(e,t){if(Po){var n={method:"set",key:"sync_"+e,val:t,session:o.config.request.session};return r=n,Po.then(function(e){var t=Fn(o.config.request.urls.proxy);return e.contentWindow.postMessage(r,t),e}).catch(function(e){sr.captureException(e,{extra:{proxyUrl:o.config.request.urls.proxy}})}),i=n,void(o.config.embed.on_site&&window.postMessage(i,window.location.origin))}var i,r;try{window.localStorage.setItem("sync_"+e,JSON.stringify(t))}catch(e){}}function r(e,t){0<=Lo.indexOf(e)&&(o.config.request.cookie[e]=t);var n=[];0<=Lo.indexOf(e)&&null!==t&&n.push(e+"="+t);var i=s(Lo);for(var r in i)r in i&&null!==i[r]&&r!==e&&n.push(r+"="+i[r]);!function(e,t,n){var i=new Date;i.setFullYear(i.getFullYear()+1),i=i.toGMTString();var r=e+"="+(t=xo(t))+";";r+="expires="+i+";",r+="path=/;",r+="domain="+n+";";try{document.cookie=r}catch(e){return}}("player",'"'+n.join("&")+'"',o.config.request.cookie_domain)}function s(e){var t=null;try{t=Ao("player")}catch(e){}if(!t)return null;t=t.substring(1,t.length-1);var i={};t.split("&").forEach(function(e){e=e.split("="),i[e[0]]=xo(decodeURIComponent(e[1]||""))});var n=[].concat(e),r=n.reduce(function(e,t){if(t in i){var n=parseFloat(i[t]);return e[t]=isNaN(n)||"quality"===t?i[t]:n,e}return e[t]=null,e},{});return 1===n.length?r[e]:r}function l(e,t){i(e,t=xo(t)),r(e,t)}function u(e,t){switch(e){case"sync_quality":o.events.fire(oi.changeQuality,t,!0);break;case"sync_volume":o.events.fire(oi.changeVolume,t,!0);break;case"sync_captions":if(null===t){o.events.fire(oi.turnCaptionsOff,!0);break}o.events.fire(oi.turnCaptionsOn,t,!0);break;case"sync_login":!function(e){if(4<n)return;n++,e&&!o.config.user.logged_in?o.events.fire(si.userLogIn):!e&&o.config.user.logged_in&&o.events.fire(si.userLoggedOut)}(t);break;case"sync_active":null!==t&&t!==o.config.request.session&&o.config.embed.autopause&&o.events.fire(si.becameInactive)}}return o.events.on(si.qualityChanged,function(e,t){t||l("quality",e)}),o.events.on(si.volumeChanged,function(e,t){o.config.request.cookie.volume=xo(e),t||l("volume",e)}),o.events.on(si.captionsChanged,function(e,t){if(e){var n=e.language+"."+e.kind;return o.config.request.cookie.captions=xo(n),void(t||l("captions",n))}o.config.request.cookie.captions=null,t||l("captions",null)}),o.events.on(si.playButtonPressed,function(){o.config.embed.settings.background||(l("active",o.config.request.session),o.events.fire(si.becameActive))}),o.events.on([si.pauseButtonPressed,si.ended],function(){s("active")===o.config.request.session&&l("active",null)}),o.events.on(si.userLoggedIn,function(){l("login",!0)}),e&&!Po&&(a=o.config.request.urls.proxy,Po=new M(function(n,t){document.createElement("a").href=o.config.request.urls.proxy;var i=document.createElement("iframe");i.src=a,i.setAttribute("title","Vimeo LocalStorage Proxy"),i.setAttribute("aria-hidden","true"),i.setAttribute("hidden",""),i.onload=function(e){var t=Fn(o.config.request.urls.proxy);i.contentWindow.postMessage({method:"ping"},t)},i.onerror=function(e){t(e)};var r=setTimeout(function(){t()},1e4);window.addEventListener("message",function e(t){0!==a.indexOf(t.origin)||"ready"!==t.data&&"ping"!==t.data||(window.removeEventListener("message",e,!1),clearTimeout(r),n(i))},!1),document.body.appendChild(i)})),e?window.addEventListener("message",function(e){var t=Fn(o.config.request.urls.proxy);e.origin===t&&"object"===Kn(e.data)&&"key"in e.data&&"newValue"in e.data?u(e.data.key,e.data.newValue):e.origin===window.location.origin&&e.data.session!==o.config.request.session&&u(e.data.key,e.data.val)},!1):window.addEventListener("storage",function(t){if(0===t.key.indexOf("sync_")&&t.oldValue!==t.newValue&&window.localStorage.getItem(t.key)===t.newValue)try{u(t.key,JSON.parse(t.newValue))}catch(e){sr.captureException(e,{extra:{key:t.key,oldValue:t.oldValue,newValue:t.newValue}})}},!1),{reset:function(){l("login",!!o.config.user.logged_in)}}}var Oo,Ro,Mo,Io=window.WeakMap||(Oo=Object.defineProperty,Ro=Date.now()%1e9,(Mo=function(){this.name="__st"+(1e9*Math.random()>>>0)+Ro+++"__"}).prototype.set=function(e,t){if("object"!==(void 0===e?"undefined":Kn(e))&&"function"!=typeof e)throw new TypeError("Invalid value used as weak map key");var n=e[this.name];return n&&n[0]===e?n[1]=t:Oo(e,this.name,{value:[e,t],writable:!0}),this},Mo.prototype.get=function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},Mo.prototype.delete=function(e){var t=e[this.name];return!(!t||t[0]!==e||(t[0]=t[1]=void 0,0))},Mo.prototype.has=function(e){var t=e[this.name];return!!t&&t[0]===e},Mo),Do="function"==typeof dn&&"symbol"==typeof dn.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof dn&&e.constructor===dn&&e!==dn.prototype?"symbol":typeof e},Fo=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Bo=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),qo=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},No=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},jo=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Uo=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Vo=function e(t,n,i,r){var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,i,r)}else if("value"in o&&o.writable)o.value=i;else{var s=o.set;void 0!==s&&s.call(r,i)}return i},Ho=function(e,t){if(Array.isArray(e))return e;if(dn.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[dn.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Wo=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Ut(e)},TelecineError=function TelecineError(e,t){Fo(this,TelecineError),this.name=e,this.message=t,Object.freeze(this)},zo=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,n),this._telecine=e,this._element=e._element,this._options=t}return Bo(n,null,[{key:"displayName",get:function(){return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}]),Bo(n,[{key:"activate",value:function(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")}},{key:"deactivate",value:function(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")}}]),n}();Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}}});var Go=navigator.userAgent.toLowerCase();function Ko(e){e=e.toLowerCase();var t=new RegExp(e).test(Go);return"safari"===e?t&&new RegExp("version").test(Go):t}function Yo(e){var t=document.createElement("div"),n=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ");for(var r in i){var o=i[r];if(void 0!==t.style[o])return o}return e}var Xo=!!Ko("android")&&(parseFloat(Go.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),$o=window.devicePixelRatio||1,Qo=!(!Ko("windows phone")&&!Ko("iemobile"))&&(parseFloat(Go.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),Jo=!!Ko("msie")&&parseFloat(Go.replace(/^.*msie (\d+).*$/,"$1")),Zo=!!Ko("trident")&&parseFloat(Go.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,ea=!!(Ko("ipad;")||Ko("iphone;")||Ko("ipod touch;"))&&parseFloat(Go.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2"));function ta(){if(!Ko("safari"))return[];var e=Go.split(" ").find(function(e){return/version\//.test(e)});return e?e.replace("version/","").split(".").map(function(e){return parseInt(e,10)}):[]}var na=Ko("safari")&&Ko("apple")&&!Ko("chrome")&&!Ko("android")&&11==ta()[0],ia={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:Xo,hasAutoplayPolicy:Xo||ea||na||66<=function(){if(!Ko("chrome"))return[];var e=Go.split(" ").find(function(e){return ea?/CriOS\//.test(e):/chrome\//.test(e)});return e?e.replace("chrome/","").split(".").map(function(e){return parseInt(e,10)}):[]}()[0],iOS:ea,mobileAndroid:Xo&&Ko("mobile"),browser:{bb10:Ko("bb10"),chrome:Ko("chrome"),firefox:Ko("firefox"),ie:Jo||Zo,edge:Ko("edge"),opera:Ko("opera"),safari:Ko("safari")&&Ko("apple")&&!Ko("chrome")&&!Ko("android")},devicePixelRatio:$o,flash:function(){var e=navigator,t=!1,n=[0,0,0],i=null,r="Shockwave Flash",o="application/x-shockwave-flash";if(void 0!==e.plugins&&"object"==typeof e.plugins[r])!(i=e.plugins[r].description)||void 0!==e.mimeTypes&&e.mimeTypes[o]&&!e.mimeTypes[o].enabledPlugin||(t=!0,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),n[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),n[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),n[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(void 0!==window.ActiveXObject)try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a&&(i=a.GetVariable("$version"))&&(t=!0,i=i.split(" ")[1].split(","),n=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)])}catch(e){}return{installed:t,version:n.join("."),major:n[0],minor:n[1],revision:n[2]}}(),iPhone:Ko("iphone;")||Ko("ipod touch;")||Ko("ipod;"),iPad:Ko("ipad;"),iPadNonRetina:Ko("ipad;")&&$o<2,mac:Ko("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Ko("windows phone")||1<window.navigator.maxTouchPoints||window.navigator.msMaxTouchPoints||!1,transformProperty:Yo("transform"),transitionProperty:Yo("transition"),windowsPhone:Qo},ra=/mac os x 10_13/.test(Go),oa=ia.iOS&&/os 11/.test(Go),aa=ia.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,sa=ia.iPad&&(1024===window.screen.availHeight&&1366===window.screen.availWidth||1112===window.screen.availHeight&&834===window.screen.availWidth);function la(l){var u={};return(l=l||{}).on=function(e,t){for(var n=0,i=(e=[].concat(e)).length;n<i;n++){var r=e[n];if(!r)throw new Error("Tried to listen for an undefined event.");u[r]||(u[r]=[]),u[r].push(t)}return l},l.once=function(e,t){function n(){t.apply(l.off(e,n),arguments)}return n.handler=t,l.on(e,n)},l.off=function(e,t){for(var n=0,i=(e=[].concat(e)).length;n<i;n++){var r=e[n];if(!r)throw new Error("Tried to remove an undefined event.");if(r in u){var o=u[r].indexOf(t);if(-1===o){for(var a=0,s=u[r].length;a<s;a++)if(u[r][a].handler===t){o=n;break}if(-1===o)return l}u[r].splice(o,1)}}return l},l.fire=function(e){if(!e)throw new Error("Tried to fire an undefined event.");if(e in u)for(var t=u[e].slice(0),n=0,i=t.length;n<i;n++)t[n].apply(l,t.slice.call(arguments,1));return l},l}function ua(t,n,i){var r=void 0;try{document.removeChild({})}catch(e){r=Object.create(Object.getPrototypeOf(e),{name:{value:n,configurable:!0,writable:!0},code:{value:t,configurable:!0,writable:!0},message:{value:i,configurable:!0,writable:!0},toString:{value:function(){return n+": DOM Exception "+t},configurable:!0,writable:!0}})}return Object.freeze(r)}ia.hevc=!!(na&&ra||na&&oa)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"'),ia.hdr=na&&oa&&(aa||sa),ia.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&48<=screen.colorDepth&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),ia.spatialPlayback=!(ia.iOS||ia.iPad||ia.browser.ie)&&(!Ko("safari")||11<ta()[0]||11==ta()[0]&&(1<ta()[2]||0<ta()[1])),ia.stereoscopic=ia.spatialPlayback&&ia.mobileAndroid;var ca,da=/Firefox/.test(navigator.userAgent),fa=/i(Phone|Pad|Pod touch);/.test(navigator.userAgent),ha=/Android/.test(navigator.userAgent),va={firefox:da,iOS:fa,android:ha,androidMobile:ha&&/mobile/.test(navigator.userAgent.toLowerCase()),chrome:!!(ca=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./))&&{major:ca[1],minor:ca[2]}};var pa=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t].id===""+e)return this[t];return null};function ma(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return e.item=function(e){return this[e]},e.getTrackById=pa,e}function ga(e,t){var n=e,i=Array.isArray(n),r=0;for(n=i?n:n[dn.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=Ho(o,2),s=a[0],l=a[1];if(s<=t&&t<=l)return[s,l]}return[]}function ya(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^(16*Math.random()>>e)/4).toString(16)})}function _a(e){return function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i}(e).buffer}function ba(e){if("function"==typeof M){var t=M.resolve();t.then.bind(t)(e)}else ba(e)}function wa(e,t,n,i){var r=0,o=0,a=e,s=t,l=n/i;return l<=a/s?r=(l*(o=s)).toFixed(2):o=((r=a)/l).toFixed(2),{width:r,height:o,left:Math.max((a-r)/2,0),top:Math.max((s-o)/2,0)}}function ka(e){var t=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/.exec(e),n=0;if(void 0!==t[8]&&(n+=t[8]),void 0!==t[7]&&(n+=60*t[7]),void 0!==t[6]&&(n+=3600*t[6]),void 0!==t[5]&&(n+=86400*t[5]),void 0!==t[4]&&(n+=604800*t[4]),void 0!==t[3]&&(n+=2628e3*t[3]),void 0!==t[2]&&(n+=3154e4*t[2]),0!==n)return n}function Sa(e){return void 0!==document.webkitFullscreenElement?!!document.webkitFullscreenElement:e.webkitDisplayingFullscreen}function Ea(r){var o=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return new M(function(t,n){var i=new XMLHttpRequest;i.open("GET",r,!0),i.onload=function(){if(200!==i.status&&n("Failed to load JSON url: "+r+" "+i.status),o){var e=void 0;try{e=JSON.parse(i.response)}catch(e){n("Failed to parse JSON url: "+e+" "+r+" "+i.response)}t(e)}else t(i)},i.onerror=function(){n("Failed to load JSON url: "+r)},i.send()})}var Ta=function(e,t){if(!e||void 0===e[t])throw ua(1,"INDEX_SIZE_ERR");return e[t]};function xa(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return Object.freeze(qo({get length(){return r.length},start:function(e){return Ta(r,e)},end:function(e){return Ta(o,e)}},dn.iterator,function(){return e=r,t=o,i=0,qo(n={},dn.iterator,function(){return this}),qo(n,"next",function(){return i<e.length?{done:!1,value:t?[e[i],t[i++]]:e[i++]}:{done:!0}}),n;var e,t,n,i}))}xa.from=function(e){if(!(e instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");for(var t=[],n=[],i=0,r=e.length;i<r;i++)t.push(e.start(i)),n.push(e.end(i));return xa(t,n)};var Aa,La,Pa={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},Ca={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},Oa={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},Ra={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_FAILURE:"drmfailure",EME_UNSUPPORTED:"emeunsupported",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",STREAM_CHANGE:"streamchange",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",PRESENTATION_MODE_CHANGE:"presentationmodechange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",AV_DURATION_MISMATCH:"avdurationmismatch"},Ma={EVENT_PENDING:"liveeventpending",EVENT_ACTIVE:"liveeventactive",EVENT_STARTING:"liveeventstarting",EVENT_STARTED:"liveeventstarted",EVENT_ENDED:"liveeventended",ARCHIVE_STARTED:"livearchivestarted",ARCHIVE_DONE:"livearchivedone",ARCHIVE_ERROR:"livearchiveerror",STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",REPRESENTATIONS_AVAILABLE:"liverepresentationsavailable"},Ia={CAMERA_UPDATE:"cameraupdate",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported"},Da={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},Fa=Object.assign({},Pa,Ca,Oa,Ra,Ia,Ma,Da),Ba=function(){function i(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,i),this._element=e,this._options=n,this._telecineVideo=null,this._currentFile=null,this._externalDisplays=[],la(this),this.on("play",function(){return t._initMediaSession()})}return Bo(i,null,[{key:"displayName",get:function(){return"Scanner"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[]}},{key:"supportsSettingVolume",get:function(){return!0}},{key:"supportsTextTracks",get:function(){return!1}},{key:"supportsPlaybackRate",get:function(){return!1}}]),Bo(i,[{key:"deactivate",value:function(){this._telecineVideo&&(this._telecineVideo.off("filesrcupdate"),this._telecineVideo.off("texttracksrcupdate"))}},{key:"reactivate",value:function(){}},{key:"play",value:function(){return M.reject(new TelecineError("NotImplemented","The scanner must implement the play method."))}},{key:"pause",value:function(){throw new TelecineError("NotImplemented","The scanner must implement the pause method.")}},{key:"addTextTrack",value:function(e){return this}},{key:"removeTextTrack",value:function(e){return this}},{key:"getCuesForTrack",value:function(e){return[]}},{key:"getActiveCuesForTrack",value:function(e){return[]}},{key:"setModeForTrack",value:function(e,t){return this}},{key:"setSrcForTrack",value:function(e,t){return this}},{key:"addCuePoint",value:function(e){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this scanner.")}},{key:"removeCuePoint",value:function(e){return!1}},{key:"removeAllCuePoints",value:function(){return!1}},{key:"showExternalDisplayPicker",value:function(t){if(!this._externalDisplays.length)throw new TelecineError("ExternalDisplayUnvailable","No external displays are available.");if(t){var e=this._externalDisplays.filter(function(e){return e.constructor.displayName.replace("ExternalDisplay","")===t})[0];if(!e)throw new TelecineError("InvalidExternalDisplay","The specified external display is not available.");e.showPicker()}else this._externalDisplays[0].showPicker()}},{key:"initDrm",value:function(){return!1}},{key:"_pickFile",value:function(){return this._files.length<1?null:this._files.slice(0).sort(function(e,t){return e.priority-t.priority})[0]}},{key:"_updateCurrentFile",value:function(){var e=this._pickFile();e?this.currentFile=e:this.fire(Ra.SCANNER_ERROR,{reason:"all files failed"})}},{key:"_switchToNextFile",value:function(){var e=this._files.indexOf(this._currentFile);this._files.splice(e,1),this._updateCurrentFile()}},{key:"_initMediaSession",value:function(){var e=this;if("mediaSession"in navigator){var t={title:this._telecineVideo.title,artist:this._telecineVideo.subtitle,artwork:[]};this._telecineVideo.metadata.thumbnail&&t.artwork.push({src:this._telecineVideo.metadata.thumbnail}),navigator.mediaSession.metadata=new MediaMetadata(t),"function"==typeof navigator.mediaSession.setActionHandler&&(navigator.mediaSession.setActionHandler("play",function(){e.play(),e.fire(Da.MEDIASESSION_PLAY)}),navigator.mediaSession.setActionHandler("pause",function(){e.pause(),e.fire(Da.MEDIASESSION_PAUSE)}),navigator.mediaSession.setActionHandler("seekforward",function(){e.currentTime=Math.min(e.duration,e.currentTime+10),e.fire(Da.MEDIASESSION_SEEK_FORWARD)}),navigator.mediaSession.setActionHandler("seekbackward",function(){e.currentTime=Math.max(0,e.currentTime-10),e.fire(Da.MEDIASESSION_SEEK_BACKWARD)}))}}},{key:"buffered",get:function(){return xa()}},{key:"cuePoints",get:function(){return[]}},{key:"currentFile",get:function(){return this._currentFile},set:function(e){this._currentFile=e,this.fire(Ra.CURRENT_FILE_CHANGE,e)}},{key:"currentTime",get:function(){return 0},set:function(e){}},{key:"duration",get:function(){return NaN}},{key:"ended",get:function(){return!1}},{key:"externalDisplayAvailable",get:function(){return this._externalDisplays.some(function(e){return e.available})}},{key:"externalDisplayActive",get:function(){return this._externalDisplays.some(function(e){return e.active})}},{key:"loop",get:function(){return!1},set:function(e){}},{key:"isLowerProfileAvailable",get:function(){return null}},{key:"muted",get:function(){return!1},set:function(e){}},{key:"playsinline",get:function(){return!1},set:function(e){}},{key:"paused",get:function(){return!0}},{key:"defaultPlaybackRate",get:function(){return 1},set:function(e){}},{key:"playbackRate",get:function(){return 1},set:function(e){}},{key:"preload",get:function(){return"none"},set:function(e){}},{key:"presentationMode",get:function(){return"inline"},set:function(e){if(-1===this.supportedPresentationModes.indexOf(e))throw new TelecineError("InvalidPresentationMode","The “"+e+"” presentation mode is not supported.")}},{key:"supportedPresentationModes",get:function(){return["inline"]}},{key:"video",get:function(){return this._telecineVideo},set:function(i){var r=this;if(this.reactivate(),this._telecineVideo!==i){if(this._telecineVideo&&(this._telecineVideo.off("filesrcupdate"),this._telecineVideo.off("texttracksrcupdate")),this.removeAllCuePoints(),this._telecineVideo=i,this._files=i.files.filter(function(e){return-1!==r.constructor.supportedVideoTypes.indexOf(e.mime)}),this._telecineVideo.on("filesrcupdate",function(e){e===r._currentFile&&r._updateCurrentFile()}),this._telecineVideo.on("texttracksrcupdate",function(e){r.video.currentScanner&&r.video.currentScanner.setSrcForTrack(e,e.src)}),this._options.externalDisplays&&this._options.externalDisplays.length){this._externalDisplays=[];var e=this.constructor.supportedExternalDisplays;Array.isArray(e)||(e=[]);var t=e.map(function(e){return e.displayName});this._options.externalDisplays.filter(function(e){return e.supported&&-1!==t.indexOf(e.displayName)}).forEach(function(e){var t=new e(i),n=e.displayName.replace("ExternalDisplay","");t.on(Pa.LOADED_METADATA,function(e){return r.fire(Pa.LOADED_METADATA,e)}),t.on("available",function(){return r.fire(Ca.AVAILABLE,{type:n})}),t.on("unavailable",function(){return r.fire(Ca.UNAVAILABLE,{type:n})}),t.on("activated",function(){"function"==typeof r.onexternaldisplayactivated&&r.onexternaldisplayactivated(t),r.fire(Ca.ACTIVATED,{type:n})}),t.on("deactivated",function(){"function"==typeof r.onexternaldisplaydeactivated&&r.onexternaldisplaydeactivated(t),r.fire(Ca.DEACTIVATED,{type:n})}),r._externalDisplays.push(t)})}this._updateCurrentFile()}}},{key:"videoWidth",get:function(){return 0}},{key:"videoHeight",get:function(){return 0}},{key:"volume",get:function(){return 1},set:function(e){}}]),i}(),qa=new Io,Na=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,r);var n=parseFloat(e);if(isNaN(n))throw new TypeError("Time must be a number.");if(n<0)throw new TypeError("Time must be a positive number.");this.time=e,this.data=t,this.id=ya();try{var i="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new i(e,e+.25,JSON.stringify(t)),this.vttCue.id=this.id}catch(e){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this browser.")}qa.set(this.vttCue,this),Object.freeze(this)}return Bo(r,null,[{key:"fromVTTCue",value:function(e){if(qa.has(e))return qa.get(e);var t={};try{t=JSON.parse(e.text)}catch(e){}return new r(e.startTime,t)}}]),r}(),ja=function(){function n(e){var t=this;Fo(this,n),this._interval=null,this._rates=[],this._averageRate=0,this._lastChecked=null,this._lastLoaded=0,this._scanner=e,this._scanner.on("loadstart",function(){return t.startInterval()}),this._scanner.on("progress",function(){return t.startInterval()}),this._scanner.on("ended",function(){return t.stopInterval()})}return Bo(n,[{key:"startInterval",value:function(){var e=this;this._interval||(this._interval=window.setInterval(function(){return e.updateDownloadRate()},1e3))}},{key:"stopInterval",value:function(){window.clearInterval(this._interval)}},{key:"updateDownloadRate",value:function(){var e=void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now(),t=0,n=this._scanner.buffered,i=Array.isArray(n),r=0;for(n=i?n:n[dn.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=Ho(o,2),s=a[0];t+=a[1]-s}if(!this._lastChecked)return this._lastChecked=e,void(this._lastLoaded=t);if(this._lastLoaded!==t){var l=Math.max(t-this._lastLoaded,0);this._rates.push(l),this._rates=this._rates.slice(-15),this._averageRate=this._rates.reduce(function(e,t){return e+t})/this._rates.length,this._lastChecked=e,this._lastLoaded=t,Math.round(t)>=Math.round(this._scanner.duration)&&this.stopInterval()}}},{key:"averageDownloadRate",get:function(){return this._averageRate}}]),n}(),Ua=function(){function t(e){Fo(this,t),this._available=!1,this._active=!1,this._video=e,la(this)}return Bo(t,null,[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}]),Bo(t,[{key:"showPicker",value:function(){}},{key:"getFile",value:function(){var e=this.constructor.displayName.replace("ExternalDisplay","");if(this._video.externalDisplayFiles[e])return this._video.externalDisplayFiles[e];var n=this.constructor.supportedVideoTypes,t=this._video.files.filter(function(e){return-1!==n.indexOf(e.mime)}).sort(function(e,t){return e.mime===t.mime?e.priority-t.priority:n.indexOf(e.mime)-n.indexOf(t.mime)});if(!t.length)throw new Error("No files available for "+this.constructor.displayName+" external display.");return t[0]}},{key:"active",get:function(){return this._active}},{key:"available",get:function(){return this._available}},{key:"element",get:function(){return document.createElement("div")}}]),t}(),AirPlayExternalDisplay=function(e){function AirPlayExternalDisplay(e){Fo(this,AirPlayExternalDisplay);var t=Uo(this,(AirPlayExternalDisplay.__proto__||Object.getPrototypeOf(AirPlayExternalDisplay)).call(this,e));return t._videoElement=document.createElement("video"),t._videoElement.setAttribute("data-airplay",""),t._videoElement.setAttribute("x-webkit-airplay","allow"),t.addVideoEventListeners(),t}return jo(AirPlayExternalDisplay,Ua),Bo(AirPlayExternalDisplay,null,[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}]),Bo(AirPlayExternalDisplay,[{key:"addVideoEventListeners",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._videoElement;e.addEventListener(Pa.LOADED_METADATA,function(e){t.fire(Pa.LOADED_METADATA,e)}),e.addEventListener("webkitplaybacktargetavailabilitychanged",function(e){switch(e.availability){case"available":t._available||(t._available=!0,t.fire(Oa.AIRPLAY_AVAILABLE));break;case"not-available":t._available&&(t._available=!1,t.fire(Oa.AIRPLAY_UNAVAILABLE))}}),e.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",function(e){if(e.target.webkitCurrentPlaybackTargetIsWireless)return t._active=!0,void t.fire(Oa.AIRPLAY_ACTIVATED);t._active=!1,t.fire(Oa.AIRPLAY_DEACTIVATED)})}},{key:"showPicker",value:function(){var e=this;this._videoElement.webkitShowPlaybackTargetPicker(),this.loadMetadata().then(function(){return e._videoElement.webkitShowPlaybackTargetPicker()}).catch(function(){})}},{key:"loadMetadata",value:function(){var n=this;return 1<=this._videoElement.readyState?M.resolve():new M(function(e,t){n._videoElement.addEventListener(Pa.LOADED_METADATA,function(){e()}),n._videoElement.src=n.getFile().src})}},{key:"element",get:function(){return this._videoElement},set:function(e){if(!(e instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");e!==this._videoElement&&(this.addVideoEventListeners(e),this._videoElement=e,this._videoElement.setAttribute("x-webkit-airplay","allow"))}}]),AirPlayExternalDisplay}(),Va=document.createElement("video"),Ha={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},Wa={disabled:"DISABLED"in(Aa="undefined"==typeof TextTrack?{}:TextTrack)?Aa.DISABLED:"disabled",hidden:"HIDDEN"in Aa?Aa.HIDDEN:"hidden",showing:"SHOWING"in Aa?Aa.SHOWING:"showing"},za="track"in(La=document.createElement("track"))&&"oncuechange"in La.track,Ga=new Io,Ka=0,Ya=function(e){function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,s);var n=Uo(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,t)),i=e.querySelector("video");return i||((i=document.createElement("video")).preload="none",n._element.appendChild(i)),n._video=i,t.htmlScanner&&t.htmlScanner.controls&&(n._video.controls=!0),n._boundHandleVideoEvent=n.handleVideoEvent.bind(n),n.addVideoEventListeners(),n._downloadRate=new ja(n),n._bufferTimer=null,n._readyState=Ka,n._paused=!0,n._preload="none",n._externalDisplayActivated=!1,n._inFullscreen=!1,n}return jo(s,Ba),Bo(s,null,[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supported",get:function(){return 0<s.supportedVideoTypes.length}},{key:"supportedVideoTypes",get:function(){var e=[];if("function"!=typeof Va.canPlayType)return e;for(var t in Ha){var n=Ha[t];ia.android&&"application/vnd.apple.mpegurl"===t||(ia.android&&!ia.mobileAndroid&&"video/mp4"===t&&ia.android instanceof String?3<parseInt(ia.android.split(".")[0],10)&&e.push(t):Va.canPlayType(n).replace(/^no$/,"")&&e.push(t))}return e}},{key:"supportedExternalDisplays",get:function(){return[AirPlayExternalDisplay]}},{key:"supportsSettingVolume",get:function(){if(ia.android)return!1;var e=Va.volume;return Va.volume=.5*e,Va.volume!==e}},{key:"supportsTextTracks",get:function(){return void 0!==Va.textTracks&&Va.textTracks instanceof TextTrackList}},{key:"supportsPlaybackRate",get:function(){if(ia.android&&va.chrome&&va.chrome.major<52)return!1;var e=Va.playbackRate;Va.playbackRate=.5*e;var t=e!==Va.playbackRate;return Va.playbackRate=e,t}}]),Bo(s,[{key:"deactivate",value:function(){No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"deactivate",this).call(this),this.removeVideoEventListeners(),this.removeSnapshot(),this._video.style.display="none",window.clearTimeout(this._bufferTimer)}},{key:"reactivate",value:function(){No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"reactivate",this).call(this),this.addVideoEventListeners(),this._video.style.display=""}},{key:"addVideoEventListeners",value:function(){var n=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._video;Object.keys(Pa).forEach(function(e){var t=Pa[e];i.addEventListener(t,n._boundHandleVideoEvent)})}},{key:"removeVideoEventListeners",value:function(){var n=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._video;Object.keys(Pa).forEach(function(e){var t=Pa[e];i.removeEventListener(t,n._boundHandleVideoEvent)})}},{key:"play",value:function(){var n=this;this._video.preload="",this._paused=!1;var e=this._video.play();return void 0!==e?e=e.catch(function(e){n.fire(Pa.ERROR,new TelecineError(e.name,e.message))}):new M(function(e,t){n._video.addEventListener("playing",e)})}},{key:"pause",value:function(){this._paused=!0,this._video.pause()}},{key:"addTextTrack",value:function(i){var t=this,r=document.createElement("track");r.id="telecine-track-"+i.id,r.src=i.src,r.kind=i.kind,r.srclang=i.language,r.label=i.label,r.addEventListener("cuechange",function(){return i.dispatchEvent("cuechange")}),this._video.addEventListener("timeupdate",function(){Sa(t._video)&&(i.mode=r.track.mode)});var n=function(){var e=va.iOS&&Sa(t._video);!i._modeHasBeenSet||e?i.mode=r.track.mode:r.track.mode=Wa[i.mode]},o=[];if(r.addEventListener("load",n),["loadeddata","seeking"].forEach(function(e){t._video.addEventListener(e,n),o.push([e,n])}),i._modeHasBeenSet&&(r.track.mode=Wa[i.mode]),!za){var a=[],e=function(){var e=r.track;if(e&&"disabled"!==Wa[e.mode]){if(a.length!==e.activeCues.length)return i.dispatchEvent("cuechange"),void(a=Ut(e.activeCues));for(var t=0,n=e.activeCues.length;t<n;t++)if(e.activeCues[t].startTime!==a[t].startTime)return i.dispatchEvent("cuechange"),void(a=Ut(e.activeCues))}};this._video.addEventListener("timeupdate",e),o.push(["timeupdate",e])}return ba(function(){return t._video.appendChild(r)}),Ga.set(i,o),No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"addTextTrack",this).call(this,i)}},{key:"removeTextTrack",value:function(e){var r=this,t=this._video.querySelector("#telecine-track-"+e.id);t&&this._video.removeChild(t);var n=Ga.get(e);return Array.isArray(n)&&n.forEach(function(e){var t=Ho(e,2),n=t[0],i=t[1];r._video.removeEventListener(n,i)}),No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"removeTextTrack",this).call(this,e)}},{key:"getCuesForTrack",value:function(e){var t=this.getTrackById("telecine-track-"+e.id);return t?Ut(t.cues):No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"getCuesForTrack",this).call(this,e)}},{key:"getActiveCuesForTrack",value:function(e){var t=this.getTrackById("telecine-track-"+e.id);return t?Ut(t.activeCues):No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"getActiveCuesForTrack",this).call(this,e)}},{key:"setModeForTrack",value:function(e,t){var n=this.getTrackById("telecine-track-"+e.id);return n&&n.mode!==Wa[t]&&(n.mode=Wa[t],za||"disabled"===t||e.dispatchEvent("cuechange")),No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"setModeForTrack",this).call(this,e,t)}},{key:"setSrcForTrack",value:function(e,t){var n=this._video.querySelector("#telecine-track-"+e.id);return n&&null===n.track.cues&&(n.src=t),No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"setSrcForTrack",this).call(this,e,t)}},{key:"addCuePoint",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(this._cuePointTrack||(this._cuePointTrack=this._video.addTextTrack("metadata"),this._cuePointTrack.mode="hidden",this._cuePointTrack.addEventListener("cuechange",function(e){[].concat(Wo(e.target.activeCues)).forEach(function(e){t.fire(Ra.CUE_POINT,Na.fromVTTCue(e))})})),e=parseFloat(e),isNaN(e))throw new TypeError("Time must be a number.");if(e<0||e>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");var i=new Na(e,n);return this._cuePointTrack.addCue(i.vttCue),i}},{key:"removeCuePoint",value:function(e){if(!e)throw new TelecineError("InvalidCuePoint","The specified cue point is not valid.");return this._cuePointTrack.removeCue(e.vttCue),!0}},{key:"removeAllCuePoints",value:function(){var t=this;return this._cuePointTrack&&this._cuePointTrack.length&&[].concat(Wo(this._cuePointTrack.cues)).forEach(function(e){t._cuePointTrack.removeCue(e)}),!0}},{key:"oncanplay",value:function(){return!1}},{key:"oncanplaythrough",value:function(){return!1}},{key:"onerror",value:function(){if(!this._video.error)return!1;switch(this._video.error.code){case this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this.fire(Pa.ERROR,new TelecineError("MediaSrcNotSupportedError","The media was not suitable.")),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_DECODE:return this.fire(Pa.ERROR,new TelecineError("MediaDecodeError","The media could not be decoded.")),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_NETWORK:return this.fire(Pa.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")),!1;case this._video.error.MEDIA_ERR_ABORTED:return this.fire(Pa.ERROR,new TelecineError("MediaAbortedError","The user agent aborted the fetching of the media.")),!1;default:return this.fire(Pa.ERROR,new TelecineError("MediaUnknownError","An unknown error occurred.")),!1}}},{key:"onloadedmetadata",value:function(){this.readyState=1}},{key:"onloadeddata",value:function(){this.readyState=2}},{key:"onsuspend",value:function(){this.updateReadyState()}},{key:"onplay",value:function(){if(this._ignorePlayEvent)return this._ignorePlayEvent=!1;("picture-in-picture"===this.presentationMode||"fullscreen"===this.presentationMode||this._inFullscreen)&&(this._paused=!1)}},{key:"onpause",value:function(){if(window.clearTimeout(this._bufferTimer),this._ignorePauseEvent)return this._ignorePauseEvent=!1;("picture-in-picture"===this.presentationMode||"fullscreen"===this.presentationMode||this._inFullscreen)&&(this._paused=!0)}},{key:"onended",value:function(){if(this._paused=!0,this._video.paused||this._video.pause(),this.currentTime<this._video.duration)return!1}},{key:"onprogress",value:function(){this.updateReadyState()}},{key:"ontimeupdate",value:function(){var e=this,t=ga(this.buffered,this.currentTime),n=1e3*(Ho(t,2)[1]-this.currentTime);if(!va.firefox&&(n<.25&&this.currentTime+n<this.duration&&(this.readyState=2),window.clearTimeout(this._bufferTimer),!this.paused)){var i=0,r=this.buffered,o=Array.isArray(r),a=0;for(r=o?r:r[dn.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var l=Ho(s,2),u=l[0];i+=l[1]-u}i>=this.duration||(this._bufferTimer=window.setTimeout(function(){e._video.paused||2<e.readyState&&(e.readyState=2)},1500))}}},{key:"onwaiting",value:function(){return va.firefox&&(this.readyState=2),!1}},{key:"onemptied",value:function(){this._readyState=Ka}},{key:"onseeked",value:function(){this.readyState<2&&(this.readyState=2),this.updateReadyState()}},{key:"onwebkitbeginfullscreen",value:function(){this._inFullscreen=!0}},{key:"onwebkitendfullscreen",value:function(){this._inFullscreen=!1,this._video.paused&&(this._paused=!0)}},{key:"onwebkitpresentationmodechanged",value:function(){switch(this._video.webkitPresentationMode){case"picture-in-picture":this._video.controls=!0;break;case"inline":this._options.htmlScanner&&this._options.htmlScanner.controls||(this._video.controls=!1)}this.fire(Ra.PRESENTATION_MODE_CHANGE,this._video.webkitPresentationMode)}},{key:"shouldHandleVideoEvent",value:function(e){return!0}},{key:"handleVideoEvent",value:function(e){e.target===this._video&&!1!==this.shouldHandleVideoEvent(e)&&("function"==typeof this["on"+e.type]&&!1===this["on"+e.type](e)||this.fire(e.type))}},{key:"swapVideo",value:function(e,t){var n=e.paused;this.removeVideoEventListeners(e),e.parentElement.replaceChild(t,e),e.pause(),t.currentTime=e.currentTime,n||t.play(),this.addVideoEventListeners(t),this._video=t}},{key:"onexternaldisplayactivated",value:function(e){this._externalDisplayActivated||(this._video!==e.element&&(this._originalVideo=this._video,this.swapVideo(this._video,e.element)),this._externalDisplayActivated=!0)}},{key:"onexternaldisplaydeactivated",value:function(e){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(e.element,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)}},{key:"setVideoSrc",value:function(e){this._video.src=e}},{key:"canSeekTo",value:function(e){var t=this.duration;if(t&&t<e&&(e=t),0<this._video.seekable.length)for(var n=0,i=this._video.seekable.length;n<i;n++)if(this._video.seekable.start(n)<=e&&this._video.seekable.end(n)>=e)return!0;return!1}},{key:"seekToTime",value:function(i){var r=this;return this.canSeekTo(i)?(ga(this.buffered,i).length||(this.readyState=1),this._video.currentTime=i,M.resolve(this._video.currentTime)):new M(function(e,t){var n=function n(){r.canSeekTo(i)&&(Object.keys(Pa).forEach(function(e){var t=Pa[e];r._video.removeEventListener(t,n)}),ga(r.buffered,i).length||(r.readyState=1),r._video.currentTime=i,e(r._video.currentTime))};Object.keys(Pa).forEach(function(e){var t=Pa[e];r._video.addEventListener(t,n)})})}},{key:"takeSnapshot",value:function(){var e=this._element.querySelector("[telecine-snapshot]");e||((e=document.createElement("canvas")).setAttribute("telecine-snapshot",""),this._element.appendChild(e)),e.setAttribute("width",this._element.clientWidth+"px"),e.setAttribute("height",this._element.clientHeight+"px"),e.style.display="";var t=wa(this._video.clientWidth,this._video.clientHeight,this._video.videoWidth,this._video.videoHeight),n=t.width,i=t.height,r=t.left,o=t.top;e.style.cssText="position:absolute;width:"+n+"px;height:"+i+"px;left:"+r+"px;top:"+o+"px";var a=e.getContext("2d");0<e.width&&0<e.height&&a.drawImage(this._video,0,0,e.width,e.height)}},{key:"removeSnapshot",value:function(){var e=this._element.querySelector("[telecine-snapshot]");e&&(e.style.display="none")}},{key:"getTrackById",value:function(e){if("function"==typeof this._video.textTracks.getTrackById)return this._video.textTracks.getTrackById(e);var t=document.getElementById(e);return t?t.track:null}},{key:"updateReadyState",value:function(){if(this.buffered.length){var e=(this.duration-this.buffered.end(this.buffered.length-1))/this._downloadRate.averageDownloadRate,t=this.duration-this.currentTime;if(isFinite(e)){var n=ga(this.buffered,this.currentTime),i=Ho(n,2)[1]-this.currentTime;e<t?this.readyState=4:4===this.readyState&&t<e?this.readyState=3:2<i&&(e<=t/2||10<i)&&(this.readyState=3)}}}},{key:"initDrm",value:function(){var e=this._telecineVideo.drmHandler;e&&e.init(this)}},{key:"buffered",get:function(){return xa.from(this._video.buffered)}},{key:"cuePoints",get:function(){return this._cuePointTrack?[].concat(Wo(this._cuePointTrack.cues)).map(function(e){return Na.fromVTTCue(e)}):No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"cuePoints",this)}},{key:"currentFile",get:function(){return No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"currentFile",this)},set:function(e){var t=this,n=!this._video.paused,i=this.currentTime,r=!this._currentFile||e.video.id!==this._currentFile.video.id;if(r||this.takeSnapshot(),this._ignorePlayEvent=!1,this._ignorePauseEvent=!1,this._currentFile=e,r&&(this._video.preload=this._preload),this.constructor===s&&this._video.readyState>Ka&&(this._video.currentTime=0),(va.iOS||ia.android)&&this._currentFile.video.title){var o=this._currentFile.video.title;this._currentFile.video.subtitle&&(o=o+" "+this._currentFile.video.subtitle),this._video.setAttribute("title",o)}else this._video.removeAttribute("title");this._readyState=Ka,this.setVideoSrc(this._currentFile.src,r),this.fire(Ra.CURRENT_FILE_CHANGE,e),this.constructor!==s||r?n&&this.play():(this.seekToTime(i).then(function(e){return n&&t.play(),e}).catch(function(){}),this.once("canplay",function(){return t.removeSnapshot()}),this.once("playing",function(){return t.removeSnapshot()}))}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this.seekToTime(e)}},{key:"duration",get:function(){return this._video.duration}},{key:"ended",get:function(){return this._video.ended}},{key:"loop",get:function(){return this._video.loop},set:function(e){this._video.loop=e}},{key:"muted",get:function(){return this._video.muted},set:function(e){this._video.muted=e}},{key:"playsinline",get:function(){return this._video.playsinline},set:function(e){(this._video.playsinline=e)?this._video.setAttribute("playsinline",""):this._video.removeAttribute("playsinline")}},{key:"paused",get:function(){return this._paused}},{key:"defaultPlaybackRate",get:function(){return this._video.defaultPlaybackRate},set:function(e){this._video.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._video.playbackRate},set:function(e){this._video.playbackRate=e}},{key:"preload",get:function(){return this._preload},set:function(e){this._video.preload=e,this._preload=e}},{key:"presentationMode",get:function(){return this._video.webkitPresentationMode?this._video.webkitPresentationMode:No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"presentationMode",this)},set:function(e){Vo(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"presentationMode",e,this),"function"==typeof this._video.webkitSetPresentationMode&&this._video.webkitSetPresentationMode(e)}},{key:"supportedPresentationModes",get:function(){var e=No(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"supportedPresentationModes",this);return"function"==typeof this._video.webkitSupportsPresentationMode&&this._video.webkitSupportsPresentationMode("picture-in-picture")&&e.push("picture-in-picture"),e}},{key:"video",get:function(){return this._telecineVideo},set:function(e){var t=this;Vo(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"video",e,this),va.iOS&&this._externalDisplays.forEach(function(e){"AirPlay"===e.constructor.displayName&&(e.element=t._video)}),this.initDrm()}},{key:"videoWidth",get:function(){return this._video.videoWidth}},{key:"videoHeight",get:function(){return this._video.videoHeight}},{key:"volume",get:function(){return this._video.volume},set:function(e){this._video.volume=e}},{key:"readyState",get:function(){return this._readyState},set:function(e){if(this._readyState!==e&&!(1===this._video.readyState&&1<e)){var t=this._readyState;this._readyState=e,3<=t&&e<=2&&(this.fire(Pa.WAITING),this._video.paused||(this._ignorePauseEvent=!0,this._video.pause())),t<=2&&3===e&&(this.fire(Pa.CAN_PLAY),!1===this._paused&&this.play()),4===e&&(t<=2&&(this.fire(Pa.CAN_PLAY),!1===this._paused&&this._video.paused&&(this._ignorePlayEvent=!0,this.play())),this.fire(Pa.CAN_PLAY_THROUGH))}}}]),s}();function Xa(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(0===e.length)return 0;for(var n=0,i=0,r=0;r<e.length;r++){var o=t[r]||1;i+=o,n+=e[r]*o}return n/i}function $a(e){e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}function Qa(l){var u={};return(l=l||{}).on=function(e,t){for(var n=0,i=(e=[].concat(e)).length;n<i;n++){var r=e[n];if(!r)throw new Error("Tried to listen for an undefined event.");u[r]||(u[r]=[]),u[r].push(t)}return l},l.once=function(e,t){function n(){t.apply(l.off(e,n),arguments)}return n.handler=t,l.on(e,n)},l.off=function(e,t){for(var n=0,i=(e=[].concat(e)).length;n<i;n++){var r=e[n];if(!r)throw new Error("Tried to remove an undefined event.");if(r in u){var o=u[r].indexOf(t);if(-1===o){for(var a=0,s=u[r].length;a<s;a++)if(u[r][a].handler===t){o=n;break}if(-1===o)return l}u[r].splice(o,1)}}return l},l.fire=function(e){if(!e)throw new Error("Tried to fire an undefined event.");if(e in u)for(var t=u[e].slice(0),n=0,i=t.length;n<i;n++)t[n].apply(l,t.slice.call(arguments,1));return l},l}var Ja="function"==typeof dn&&"symbol"==typeof dn.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof dn&&e.constructor===dn&&e!==dn.prototype?"symbol":typeof e},Za=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},es=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),ts=function(e,t){if(Array.isArray(e))return e;if(dn.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[dn.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},ns=[],is=[],rs=[],os=[],as=function(){function m(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.retryCount,n=void 0===t?3:t,i=e.parallel,r=void 0===i?1:i,o=e.includeWithSpeeds,a=void 0===o||o;Za(this,m),this._queue=[],this._activeXhrRequests=new Set,this._retries=new Io,this._retryCount=n,this._running=!1,this._processingQueue=!1,this._parallel=r,this._includeWithSpeeds=a,this._transmuxer=null,this._initialize()}return es(m,null,[{key:"getPercentileSpeed",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.8;return function(e,t){if(e.sort(),0===e.length)return 0;if(t<=0)return e[0];if(1<=t)return e[e.length-1];var n=e.length*t,i=Math.floor(n),r=i+1,o=n%1;return r>=e.length?e[i]:e[i]*(1-o)+e[r]*o}(ns.slice(-e),t)}},{key:"getAverageSpeed",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return Xa(ns.slice(-e),t)}},{key:"getMedianSpeed",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5;return $a(ns.slice(-e))}},{key:"getResponseSpeeds",value:function(){return ns}},{key:"getProgressSpeeds",value:function(){return os}},{key:"getAverageBitrate",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1/0,t=m.getTime()-e,n=[],i=[],r=os.length-1;0<=r;r--){var o=os[r];if(o.startTime<t)break;n.push(o.bitrate)}for(var a=0;n.length>a;a++)i.push(n.length-a);return Xa(n,i)}},{key:"getFailedSegments",value:function(){return is}},{key:"getSuccessfulSegments",value:function(){return rs}},{key:"getTime",value:function(){return"undefined"!=typeof performance?performance.now():(new Date).getTime()}},{key:"calculateExponentialBackoff",value:function(e){return 500*Math.pow(2,e)+Math.round(1e3*Math.random())}}]),es(m,[{key:"add",value:function(e,t,n){return this._addSegmentToQueue(e,t,n),this._running&&!this._processingQueue&&this._processQueue(),this}},{key:"start",value:function(){return this._running||(this._running=!0,this._processQueue()),this}},{key:"stop",value:function(){return this._running=!1,this}},{key:"abort",value:function(){var i=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._queue.filter(function(e){return!t||t===e[0].stream}).forEach(function(e){var t=i._getSegmentInfoFromData(e),n=ts(t,4)[3];i.fire("downloadabort",n)}),this._queue=this._queue.filter(function(e){return t&&t!==e[0].stream}),this._activeXhrRequests.forEach(function(e){t&&t!==e.stream||e.abort()})}},{key:"_insertAtPosition",value:function(e,t){for(var n=0;n<this._queue.length;n++){if(this._queue[n][0].priority>e.priority)break}this._queue.splice(n,0,[e,t])}},{key:"_initializeMux",value:function(){return new M(function(e,t){window.muxjs?e():document.getElementById("muxjs").onload=function(){e()}})}},{key:"_initialize",value:function(){var e=this;this._pendingFetchMap=new Io,Qa(this),window.addEventListener("online",function(){e.start()}),window.addEventListener("offline",function(){e.stop(),e.abort()})}},{key:"_addSegmentToQueue",value:function(e,t,n){e.hasOwnProperty("priority")?this._insertAtPosition(e,t):this._queue[n?"unshift":"push"]([e,t])}},{key:"_processQueue",value:function(){if(this._running){this._processingQueue=!0;for(var e=this._parallel-this._activeXhrRequests.size,t=0;t<e;t++)this._fetchOne()}}},{key:"_retry",value:function(e,t,n){var i=this,r=t[0],o=t[1];if(this._retries.get(r)||this._retries.set(r,0),this._retries.set(r,this._retries.get(r)+1),this._retries.get(r)>this._retryCount)this._handleDownloadError(n,e.status,e.data.url,e.data.duration);else{var a=m.calculateExponentialBackoff(this._retries.get(r));setTimeout(function(){i.add(r,o,!0)},a)}}},{key:"_handleXHRResponse",value:function(e,t,n,i){var r,o=this;if(500<=e.status&&e.status<600)this._retry(e,t,n);else if(400<=e.status&&e.status<500)this._handleDownloadError(n,e.status,e.data.url,e.data.duration);else if(this.fire("downloadend",n,{headers:(r=e.getAllResponseHeaders(),r?r.split("\n").reduce(function(e,t){var n=t.indexOf(":"),i=t.substring(0,n),r=t.substring(n+1);return void 0!==i&&void 0!==r&&(e[i.trim().toLowerCase()]=r.trim()),e},{}):{})}),rs.push({url:e.data.url,status:e.status,duration:e.data.duration}),e.data.url&&e.data.url.match(".ts$")){var a=new Uint8Array(e.response);this._transmuxer?this._feedMuxer.bind(this)(e,a,i):this._initializeMux().then(function(){o._transmuxer=new window.muxjs.Transmuxer({}),o._feedMuxer.bind(o)(e,a,i)})}else i.call(this,new Uint8Array(e.response))}},{key:"_feedMuxer",value:function(t,e,n){var i=this;this._transmuxer.on("data",function(e){n.call(i,new Uint8Array(t.data.isInitSegmentRequest?e.initSegment:e.data.buffer))}),this._transmuxer.push(e),this._transmuxer.flush()}},{key:"_handleDownloadError",value:function(e,t,n,i){is.push({url:n,status:t,duration:i}),this.fire("downloaderror",e,t)}},{key:"_getSegmentInfoFromData",value:function(e){var t=e[1],n=e[0],i=n;return n.id&&(i=n.id),[n.url,n.byteRange,n.isInitSegmentRequest,i,t]}},{key:"_continueProcessingQueue",value:function(){0!==this._activeXhrRequests.size||0!==this._queue.length?this._activeXhrRequests.size<this._parallel&&this._processQueue():this._processingQueue=!1}},{key:"_fetchOne",value:function(){var o=this;if(0!==this._queue.length){var a=null,s=this._queue.shift(),e=this._getSegmentInfoFromData(s),t=ts(e,5),n=t[0],i=t[1],r=t[2],l=t[3],u=t[4],c=s[0].includeWithBandwidthChecks,d=m.getTime(),f=new XMLHttpRequest;f.stream=s[0].stream,f.data={},f.data.url=n,f.data.isInitSegmentRequest=r;var h=0,v=m.getTime(),p=0;f.addEventListener("progress",function(e){if(e.lengthComputable){var t=8*(e.loaded-h),n=m.getTime(),i=n-v,r={startTime:v,length:i,bitrate:t/(i/1e3),index:p};0<p&&(100<=os.length&&os.shift(),os.push(r)),v=n,h=e.loaded,p+=1,o._pendingFetchMap.set(f,{bytesTotal:e.total,bytesLoaded:e.loaded,percent:e.loaded/e.total,identifier:l}),o.fire("progress",l)}}),f.open("GET",n,!0),f.responseType="arraybuffer",i&&f.setRequestHeader("Range","bytes="+i),f.onload=function(e){var t=Date.now()-a;f.data.duration=t,o._activeXhrRequests.delete(f),o._pendingFetchMap.delete(f);var n=(m.getTime()-d)/1e3,i=e.target.response.byteLength;if(40960<i){var r=8*i/n;100<ns.length&&ns.shift(),o._includeWithSpeeds&&c&&ns.push(r)}o._handleXHRResponse(f,s,l,u),o._continueProcessingQueue()},f.onerror=function(){var e=Date.now()-a;f.data.duration=e,o._activeXhrRequests.delete(f),o._pendingFetchMap.delete(f),o._retry(f,s,l),o._continueProcessingQueue()},f.onabort=function(){var e=Date.now()-a;f.data.duration=e,is.push({url:n,status:"abort",duration:e}),o._pendingFetchMap.delete(f),o._activeXhrRequests.delete(f),o.fire("downloadabort",l),0===o._activeXhrRequests.size&&0===o._queue.length&&(o._processingQueue=!1),o._continueProcessingQueue()},this.fire("downloadstart",l),this._activeXhrRequests.add(f),a=Date.now(),f.data.requestSendTime=a,f.send()}else this._processingQueue=!1}},{key:"parallel",get:function(){return this._parallel},set:function(e){this._parallel=e}},{key:"pendingFetches",get:function(){var n=this,i=[];return this._activeXhrRequests.forEach(function(e){if(n._pendingFetchMap.get(e)){var t=n._pendingFetchMap.get(e);t.elapsedTime=Date.now()-e.data.requestSendTime,i.push(t)}}),i}}]),m}(),ss=function(){function t(e){Za(this,t),Qa(this),this._sorcerer=e,this._sourceBuffer=null,this._activeStreamIndex=null,this._needsStreamSwitch=!1,this._needInitSegment=!0,this._lastAppended=null,this._toRemove=[],this._streams=[],this._quotaExceeded=!1,this._quotaExceededTimer=null,this._appendingFinalSegment=!1,this._finalSegmentTime=void 0,this._addingInitSegment=!1,this._isFirstSegment=!0,this._bufferState={},this._sorcerer.on("durationset",this._onDurationSet.bind(this))}return es(t,[{key:"addStream",value:function(e){var t=this;e.on("segmentadd",function(){return t._process()});var n=this._streams.push(e)-1;e.index=n,null===this._activeStreamIndex&&(this._setActiveIndex(n),this._needsStreamSwitch=!0)}},{key:"streamIndexAtTime",value:function(e){return this._bufferState[void 0]?{stream:this.activeStreamIndex}:this._bufferState[Math.floor(e/6)]}},{key:"switchTo",value:function(e){var t=this,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=e;"object"===(void 0===e?"undefined":Ja(e))&&(i=e.index);var r=this._activeStreamIndex!==i,o=r;if(!r&&this._needsStreamSwitch&&(r=!0),r){this._needsStreamSwitch=!1;var a=this._activeStreamIndex,s=this._streams[a];s&&o&&n&&s.abort(),this._switchToIndex=i,this._setActiveIndex(i)}return this._process(),new M(function(e){r?t._resolveSwitchComplete=function(){t._switchToIndex===i&&(t._resolveSwitchComplete=null,e(),t.fire("streamchange",i))}:e()})}},{key:"isTimeInBuffer",value:function(e){for(var t=0;t<this.sourceBuffer.buffered.length;t++){var n=this.sourceBuffer.buffered.start(t),i=this.sourceBuffer.buffered.end(t);if(n<=e&&e<=i)return!0}return!1}},{key:"hasAppendedFinalSegment",value:function(){return void 0!==this._finalSegmentTime&&this.isTimeInBuffer(this._finalSegmentTime)}},{key:"clear",value:function(){this._streams.forEach(function(e){e.clear()})}},{key:"remove",value:function(n){var i=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._sorcerer._mediaSource.duration;return new M(function(e,t){i._toRemove.push([n,r,e]),i._process()})}},{key:"_onDurationSet",value:function(){var e=this._sorcerer._mediaSource.duration,t=Math.floor(e/6);t+=1<6%e?1:0;for(var n=0;n<t;n++)this._bufferState[n]={stream:null,segment:n,type:"video"}}},{key:"_attachEvents",value:function(){var e=this;this.bound={handleUpdateEnd:this._handleUpdateEnd.bind(this)},this._sourceBuffer.addEventListener("updateend",this.bound.handleUpdateEnd),this._sorcerer.on("endofstream",function(){e._handleUpdateEnd()}),this._sorcerer.on("ended",this.bound.handleEnded)}},{key:"_handleUpdateEnd",value:function(e){this._appendingFinalSegment&&(this._finalSegmentTime=this._sourceBuffer.buffered.end(this._sourceBuffer.buffered.length-1),this._sorcerer._fireStreamHasEnded(),this._appendingFinalSegment=!1),this._lastAppended&&(this.fire("appendbufferend",this._lastAppended),this._lastAppended=null,this._resolveSwitchComplete&&this._resolveSwitchComplete()),this._process()}},{key:"_removeEventListeners",value:function(){this.bound&&(this._sourceBuffer&&this._sourceBuffer.removeEventListener("updateend",this.bound.handleUpdateEnd),this._sorcerer.off("endofstream",this.bound.handleUpdateEnd),this._sorcerer.off("ended",this.bound.handleEnded))}},{key:"_setActiveIndex",value:function(e){this._needInitSegment=!0,this._activeStreamIndex=e,this._sorcerer._frameDropper.streamIndex=e}},{key:"_process",value:function(){var t=this,n=this._streams[this._activeStreamIndex];if(this._sourceBuffer){if(n&&"closed"!==this._sorcerer._mediaSource.readyState){var i=this._sourceBuffer;if(!i.updating)if(this._toRemove.length){var e=this._toRemove.shift(),r=ts(e,3),o=r[0],a=r[1],s=r[2],l=this;i.addEventListener("updateend",function e(t){i.removeEventListener("updateend",e),s(),clearTimeout(l._quotaExceededTimer),l._quotaExceededTimer=setTimeout(function(){l._quotaExceeded=!1,l._process()},5e3)});var u=o;i.remove(u,a)}else if(!this._quotaExceeded&&!this._addingInitSegment){if(this._needInitSegment)return this._addingInitSegment=!0,n.getInitSegment().then(function(e){return t._lastAppended=null,i.appendBuffer(e),t._addingInitSegment=!1,e}).catch(function(e){t._addingInitSegment=!1}),void(this._needInitSegment=!1);var c=n.getNextSegment();if(null!==c){var d=n.getIdForSegment(c);n.isFinal(c)&&(this._appendingFinalSegment=!0),this._lastAppended=d,this.fire("appendbufferstart",d);try{i.appendBuffer(c),this._bufferState[d.segment]=d,this._isFirstSegment&&(this._isFirstSegment=!1,this.fire("initialbufferstart"))}catch(e){if("QuotaExceededError"===e.name){this._quotaExceeded=!0;if(6<this._sorcerer._video.currentTime){var f=this._sorcerer._video.currentTime-6;this._sorcerer.removeBuffer(0,f)}n._readyToAppend.unshift(c)}}}}}}else this.on("sourcebufferattach",this._process)}},{key:"streams",get:function(){return this._streams}},{key:"activeStreamIndex",get:function(){return this._activeStreamIndex}},{key:"sourceBuffer",get:function(){return this._sourceBuffer},set:function(e){this._sourceBuffer=e,this._attachEvents(),this.fire("sourcebufferattach")}}]),t}(),ls=function(){function h(n){var i=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new as;Za(this,h),Qa(this),this._readyToAppend=[],this._initSegment=null,this._index=NaN,this._codec=e,this._fetcher=t,this._fetcher.start(),this._bufferData=new Io,this._segmentToId={},this._getInitSegmentPromise=new M(function(t,e){h.isValidSegmentUrl(n)?i._fetcher.add({url:n.url||n,byteRange:n.byteRange,id:null,stream:i,isInitSegmentRequest:!0},function(e){i._initSegment=e,t(e)}):(i._initSegment=n,t(n))})}return es(h,null,[{key:"isValidSegmentUrl",value:function(e){return"string"==typeof e||"string"==typeof e.url&&"string"==typeof e.byteRange}}]),es(h,[{key:"getIdForSegment",value:function(e){return h.isValidSegmentUrl(e)?this._segmentToId[e]:this._bufferData.get(e).id}},{key:"isFinal",value:function(e){return this._bufferData.get(e).final}},{key:"addSegment",value:function(n){var i=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=e.identifier,r=void 0===t?null:t,o=e.isFinalSegment,a=void 0!==o&&o,s=e.loadOnly,l=void 0!==s&&s,u=e.priority,c=void 0===u?0:u,d=e.includeWithBandwidthChecks,f=void 0===d||d;return new M(function(t,e){if(h.isValidSegmentUrl(n))return i._segmentToId[n]=r||n,i.fire("queued",i.getIdForSegment(n)),void i._fetcher.add({url:n.url||n,byteRange:n.byteRange,id:i.getIdForSegment(n),stream:i,includeWithBandwidthChecks:f,isInitSegmentRequest:!1,priority:c},function(e){i._bufferData.set(e,{id:r||n,final:a}),i._readyToAppend.push(e),i.fire("bufferqueueadd",i.getIdForSegment(n)),l||i.fire("segmentadd"),t()});i._bufferData.set(n,{id:r,final:a}),i._readyToAppend.push(n),i.fire("bufferqueueadd",r),t()})}},{key:"clear",value:function(){this._readyToAppend=[]}},{key:"abort",value:function(){var e=this;this._getInitSegmentPromise.then(function(){e._fetcher.abort(e)}).catch(function(e){})}},{key:"getNextSegment",value:function(){return 0===this._readyToAppend.length?null:this._readyToAppend.shift()}},{key:"getInitSegment",value:function(){return this._getInitSegmentPromise}},{key:"codec",get:function(){return this._codec},set:function(e){this._codec=e}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"pendingFetches",get:function(){return this._fetcher.pendingFetches}}]),h}(),us=function(){function t(e){Za(this,t),this._video=e,this._running=!1,this._droppedFramesTimeout=null,this._droppedFrameData={},this._decodedFrameData={},this._droppedFrames=0,this._decodedFrames=0,this._streamIndex="default",this.bound={startCheckingDroppedFrames:this._startCheckingDroppedFrames.bind(this),stopCheckingDroppedFrames:this._stopCheckingDroppedFrames.bind(this)}}return es(t,[{key:"start",value:function(){return this._startCheckingDroppedFrames(),this}},{key:"stop",value:function(){return this._stopCheckingDroppedFrames(),this}},{key:"destroy",value:function(){this._stopCheckingDroppedFrames(),this._removeEvents()}},{key:"getDroppedFrameRate",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"average",i=this._droppedFrameData[t];if(!i)return 0;if(i.length<e)return 0;var r=i.slice(-e);return"median"===n?$a(r):Xa(r)}},{key:"getDroppedFrameTotal",value:function(){return{dropped:this._getTotalDroppedFrames(),total:this._getTotalFrames()}}},{key:"_attachEvents",value:function(){this._video.addEventListener("playing",this.bound.startCheckingDroppedFrames),this._video.addEventListener("pause",this.bound.stopCheckingDroppedFrames),this._video.addEventListener("ended",this.bound.stopCheckingDroppedFrames)}},{key:"_removeEvents",value:function(){this._video.removeEventListener("playing",this.bound.startCheckingDroppedFrames),this._video.removeEventListener("pause",this.bound.stopCheckingDroppedFrames),this._video.removeEventListener("ended",this.bound.stopCheckingDroppedFrames)}},{key:"_startCheckingDroppedFrames",value:function(){this._running=!0,this._checkDroppedFrames()}},{key:"_stopCheckingDroppedFrames",value:function(){this._running=!1}},{key:"_checkDroppedFrames",value:function(){var e=this;if(this._running&&null!==this._streamIndex){clearTimeout(this._droppedFramesTimeout);var t=this._getTotalDroppedFrames(),n=t-this._droppedFrames;this._droppedFrames=t;var i=this._getTotalDecodedFrames(),r=i-this._decodedFrames;this._decodedFrames=i,this._droppedFrameData[this._streamIndex]||(this._droppedFrameData[this._streamIndex]=[]),this._decodedFrameData[this._streamIndex]||(this._decodedFrameData[this._streamIndex]=[]),100<this._droppedFrameData[this._streamIndex].length&&this._droppedFrameData[this._streamIndex].shift(),100<this._decodedFrameData[this._streamIndex].length&&this._decodedFrameData[this._streamIndex].shift(),this._droppedFrameData[this._streamIndex].push(n),this._decodedFrameData[this._streamIndex].push(r),this._droppedFramesTimeout=setTimeout(function(){e._checkDroppedFrames()},1e3)}}},{key:"_getTotalDroppedFrames",value:function(){return"function"==typeof this._video.getVideoPlaybackQuality?this._video.getVideoPlaybackQuality().droppedVideoFrames:this._video.webkitDroppedFrameCount||0}},{key:"_getTotalFrames",value:function(){return"function"==typeof this._video.getVideoPlaybackQuality?this._video.getVideoPlaybackQuality().totalVideoFrames:this._video.webkitDecodedFrameCount||0}},{key:"_getTotalDecodedFrames",value:function(){if("function"==typeof this._video.getVideoPlaybackQuality){var e=this._video.getVideoPlaybackQuality();return e.totalVideoFrames-e.droppedVideoFrames-e.corruptedVideoFrames}return this._video.webkitDecodedFrameCount||0}},{key:"streamIndex",get:function(){return this._streamIndex},set:function(e){this._streamIndex=e}}]),t}(),cs=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Za(this,n),this._video=e,this._options=t,Qa(this),this._options.duration&&(this._options.duration=Math.ceil(100*this._options.duration)/100),this._bufferCount=0,this._frameDropper=new us(e),this._mediaSource=new MediaSource,this._fetcher=new as({parallel:1}),this._video.src=URL.createObjectURL(this._mediaSource),this._buffersForCodec={},this._readyPromiseResolve=null,this._attachEvents()}return es(n,[{key:"switchTo",value:function(e){return 1===this._bufferCount&&this.video.switchTo(e)}},{key:"getCurrentSpeed",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=void 0===t?"average":t,i=e.howMany,r=void 0===i?10:i,o=e.weights,a=void 0===o?[]:o,s=e.percentile,l=void 0===s?null:s;return"average"===n?as.getAverageSpeed(r,a):"median"===n?as.getMedianSpeed(r):as.getPercentileSpeed(r,l)}},{key:"getAverageDownloadBitrate",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;return as.getAverageBitrate(e)}},{key:"getResponseSpeeds",value:function(){return as.getResponseSpeeds()}},{key:"getFailedSegments",value:function(){return as.getFailedSegments()}},{key:"getSuccessfulSegments",value:function(){return as.getSuccessfulSegments()}},{key:"getDroppedFrameRate",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.activeStreamIndex,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"average";return this._frameDropper.getDroppedFrameRate(e,t,n)}},{key:"getDroppedFrameTotal",value:function(){return this._frameDropper.getDroppedFrameTotal()}},{key:"clear",value:function(){for(var e in this._buffersForCodec)this._buffersForCodec[e].clear()}},{key:"streamIndexAtTime",value:function(e,t){return this._buffersForCodec[t].streamIndexAtTime(e)?this._buffersForCodec[t].streamIndexAtTime(e).stream:null}},{key:"removeBuffer",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._video.duration;if(t<e)return M.resolve();var n=[];for(var i in this._buffersForCodec)n.push(this._buffersForCodec[i].remove(e,t));return M.all(n)}},{key:"addStream",value:function(e,t){var n=this,i=this._getCodecType(e);if(!this._buffersForCodec[i]){this._bufferCount+=1;var r=new ss(this,i);this._buffersForCodec[i]=r,this.readyPromise.then(function(){var t=void 0;try{t=n._mediaSource.addSourceBuffer(e)}catch(e){if(22!==e.code)return void n.fire("srcnotsupported",e);t=n._buffersForCodec[i]}n._options.duration&&(t.appendWindowEnd=n._options.duration),r.sourceBuffer=t}).catch(function(e){}),["appendbufferstart","appendbufferend","streamchange","initialbufferstart"].forEach(function(t){r.on(t,function(e){n.fire(t,e)})})}var o=new ls(t,e,this._fetcher);return["queued","bufferqueueadd"].forEach(function(t){o.on(t,function(e){n.fire(t,e)})}),this._buffersForCodec[i].addStream(o),o}},{key:"destroy",value:function(){this.clear(),this._removeEventListeners(),this._frameDropper.destroy(),this._fetcher.abort(),this._video.src&&URL.revokeObjectURL(this._video.src)}},{key:"_attachEvents",value:function(){var r=this;this.bound={handleSourceOpen:this._handleSourceOpen.bind(this)},this.readyPromise=new M(function(e,t){r._readyPromiseResolve=e,r._mediaSource.addEventListener("sourceopen",r.bound.handleSourceOpen)}),["downloadstart","downloadend","downloadabort","downloaderror","progress"].forEach(function(i){r._fetcher.on(i,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];r.fire.apply(r,[i].concat(t))})})}},{key:"_sourceBuffersAreUpdating",value:function(){for(var e=0;e<this._mediaSource.sourceBuffers.length;e++)if(this._mediaSource.sourceBuffers[e].updating)return!0;return!1}},{key:"_fireStreamHasEnded",value:function(){for(var e in this._buffersForCodec){if(!this._buffersForCodec[e].hasAppendedFinalSegment())return}"open"===this._mediaSource.readyState&&(this._sourceBuffersAreUpdating()||(this._mediaSource.endOfStream(),this.fire("endofstream")))}},{key:"_handleSourceOpen",value:function(){this._options.duration&&(this._mediaSource.duration=this._options.duration,this.fire("durationset")),this._readyPromiseResolve(),this._mediaSource.removeEventListener("sourceopen",this.bound.handleSourceOpen)}},{key:"_removeEventListeners",value:function(){for(var e in this._buffersForCodec)this._buffersForCodec[e]._removeEventListeners()}},{key:"_getCodecType",value:function(e){return 0===e.indexOf("audio")?"audio":"video"}},{key:"mediaSource",get:function(){return this._mediaSource}},{key:"pendingFetches",get:function(){return this._fetcher.pendingFetches}},{key:"streams",get:function(){return 1===this._bufferCount&&this.video.streams}},{key:"activeStreamIndex",get:function(){return 1===this._bufferCount&&this.video.activeStreamIndex}},{key:"video",get:function(){return!!this._buffersForCodec.video&&this._buffersForCodec.video}},{key:"audio",get:function(){return!!this._buffersForCodec.audio&&this._buffersForCodec.audio}}]),n}(),ds=function(){function t(e){Fo(this,t),this.scanner=e}return Bo(t,null,[{key:"displayName",get:function(){return"Brain"}}]),Bo(t,[{key:"shouldPowerUp",value:function(e,t){return!1}},{key:"shouldPowerDown",value:function(e,t){return!1}},{key:"canPowerUp",value:function(e,t){return 1!==e.length&&t<e.length-1}},{key:"canPowerDown",value:function(e,t){return 1!==e.length&&0<t}},{key:"filterStreams",value:function(e){return e}}]),t}(),fs=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,i);var n=Uo(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return n._options=t,n.blacklisted=[],n.whitelisted=[],n.MAX_LOADABLE_SEGMENTS_AUTO=3,n.MAX_LOADABLE_SEGMENTS_LOCKED=15,n.BANDWIDTH_THRESHOLD=.85,n.SEGMENT_DURATION=6,n}return jo(i,ds),Bo(i,null,[{key:"displayName",get:function(){return"Skyfire"}}]),Bo(i,[{key:"shouldPowerUp",value:function(e,t,n){n&&this._options.startingBandwidthThreshold&&(this.BANDWIDTH_THRESHOLD=this._options.startingBandwidthThreshold);var i=e.indexOf(t);if(-1===i&&(i=0),!this.canPowerUp(e,i))return!1;var r=this.getCurrentSpeed();if(!r)return!1;var o=this._getStreamFromSpeed(r,this.BANDWIDTH_THRESHOLD,e);return o!==i&&o}},{key:"shouldPowerDown",value:function(e,t){var n=e.indexOf(t);if(-1===n)return e.length-1;if(!this.canPowerDown(e,n))return!1;var i=this.getCurrentSpeed();if(!i)return!1;if(this.hasTooManyDroppedFrames(n,t,this._options.droppedFrameSwitchPercent))return n-1;var r=this._getStreamFromSpeed(i,.9,e);return r!==n&&r}},{key:"hasTooManyDroppedFrames",value:function(e,t,n){return n<=this.scanner.sorcerer.getDroppedFrameRate(10,e,"median")/t.framerate*100&&(this.blacklist(e),!0)}},{key:"isTimeInBuffer",value:function(e){var t=this.scanner._video;return this._timesAreInRange(e,e,t.buffered)}},{key:"getCurrentSpeed",value:function(){if(this._options.tests&&this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group)return this.scanner.downloadSpeed;return this.scanner.sorcerer.getCurrentSpeed({type:"average",howMany:3,weights:[1,2,5]})}},{key:"getDistanceFromBuffer",value:function(e){for(var t=e,n=this.scanner._video,i=0;i<n.buffered.length;i++)if(n.buffered.start(i)<=e&&n.buffered.end(i)>=e){t=n.buffered.end(i);break}return t-e}},{key:"getTimeEstimateToLoad",value:function(e,t){if(null===t)return 3;var n=t.segments[e],i=n.end-n.start,r=this.getCurrentSpeed();return 1.3*(i*(t.bitrate+t.audioBitrate)/r)}},{key:"canPlayFromTimeInStream",value:function(e,t){if(!this.isTimeInBuffer(e))return!1;if(!t)return!1;var n=this.getSegmentsToLoad(!1,"video",t);if(0===n.length)return!0;var i=this.getDistanceFromBuffer(e);return this.getTimeEstimateToLoad(n[0],t)<i}},{key:"getSegmentsToLoad",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"video",n=arguments[2],i=this.scanner._video,r=this.scanner.currentTime,o=[],a=r+this._getSecondsToLoadAhead(r,i.duration,n),s=this.scanner.sorcerer[t].activeStreamIndex,l=this.scanner._streams[t][s],u=this.scanner.sorcerer[t].sourceBuffer,c=null;u&&(c=u.buffered);for(var d=0;d<l.segments.length;d++){var f=l.segments[d];if(!(f.end<r||f.start>a)){var h=r>=f.start&&r<f.end,v=this._isSegmentInBuffer(f,c);!e&&v||e&&v&&h||(h?o.push(d):a>=f.start&&o.push(d))}}return o}},{key:"blacklist",value:function(e){this.blacklisted[e]=1}},{key:"lock",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.whitelisted=e}},{key:"filterStreams",value:function(e){for(var t=this.scanner._video.clientWidth,n=this.scanner._video.clientHeight,i=[],r=void 0,o=!1,a=0;a<e.length;a++)if(r&&r[0]===e[a].width&&r[1]===e[a].height)i.push(e[a]);else{if(o)break;if(!(this.blacklisted[a]&&-1===this.whitelisted.indexOf(a)||this.whitelisted.length&&-1===this.whitelisted.indexOf(a)))if(this.whitelisted.length)i.push(e[a]);else{var s=this._getScaleFromDimensions(t,n,e[a].width,e[a].height);(n<1e3/(window.devicePixelRatio||1)?1.75:1)<=s&&(o=!0),i.push(e[a]),r=[e[a].width,e[a].height]}}return i}},{key:"_getStreamFromSpeed",value:function(e,t,n){for(var i=0,r=i;r<n.length;r++)e*t>n[r].bitrate+n[r].audioBitrate&&(i=r);return i}},{key:"_getVisibleDimensions",value:function(e,t,n,i){var r=n/i,o=e-t*r,a=t-e/r,s=e-o,l=t-a;return 0<o&&(l=t),0<a&&(s=e),[s,l]}},{key:"_getScaleFromDimensions",value:function(e,t,n,i){var r=this._getVisibleDimensions(e,t,n,i),o=n*i;this.scanner.video&&this.scanner.video.metadata.percentShown&&(o*=this.scanner.video.metadata.percentShown);var a=window.devicePixelRatio||1;return o/(r[0]*r[1]*a*a)}},{key:"_getSecondsToLoadAhead",value:function(e,t,n){var i=n&&12e3<n.bitrate;return 1===this.whitelisted.length?i?30:this.MAX_LOADABLE_SEGMENTS_LOCKED*this.SEGMENT_DURATION:this.MAX_LOADABLE_SEGMENTS_AUTO*this.SEGMENT_DURATION}},{key:"_round",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3;if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"_timesAreInRange",value:function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!n)return!1;t=Math.min(t,this.scanner._video.duration);for(var r=0;r<n.length;r++){var o=this._round(n.start(r))-i,a=this._round(n.end(r))+i;if(o<=e&&t<=a)return!0}return!1}},{key:"_hasSeparateStreams",value:function(){return 0<this.scanner._streams.video.length&&0<this.scanner._streams.audio.length}},{key:"_isSegmentInBuffer",value:function(e,t){var n=1;return this._hasSeparateStreams()&&(n=.05),this._timesAreInRange(e.start,e.end,t,n)}}]),i}(),hs=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,i);var n=Uo(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return n._options=t,n.MAX_LOADABLE_SEGMENTS_AUTO=10,n.inVirginState=!0,n.targetStreamChanged=!1,n._initializeEvents(),n}return jo(i,fs),Bo(i,null,[{key:"displayName",get:function(){return"BBA"}}]),Bo(i,[{key:"_initializeEvents",value:function(){var e=this;this.scanner.on(Ra.STREAM_TARGET_CHANGE,function(){e.targetStreamChanged=!0})}},{key:"getSegmentsToLoad",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"video",n=arguments[2];return e&&this.targetStreamChanged?this.targetStreamChanged=!1:e=!1,No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"getSegmentsToLoad",this).call(this,e,t,n)}},{key:"shouldPowerUp",value:function(e,t,n){var i=e.indexOf(t);if(-1===i&&(i=0),!this.canPowerUp(e,i))return!1;var r=this.scanner.sorcerer.video._sourceBuffer?this.scanner.sorcerer.video._sourceBuffer.buffered:null,o=this._getStreamFromBuffer(r,e,i);return!(o<=i)&&o}},{key:"shouldPowerDown",value:function(e,t){var n=e.indexOf(t);if(-1===n)return e.length-1;if(!this.canPowerDown(e,n))return!1;if(!this.getCurrentSpeed())return!1;if(this.hasTooManyDroppedFrames(n,t,this._options.droppedFrameSwitchPercent))return n-1;var i=this.scanner.sorcerer.video._sourceBuffer?this.scanner.sorcerer.video._sourceBuffer.buffered:null,r=this._getStreamFromBuffer(i,e,n);return!(n<=r)&&r}},{key:"_getStreamFromBuffer",value:function(e,t,n){var i=this,r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],o=6*this.SEGMENT_DURATION,a=this.getDistanceFromBuffer(this.scanner.currentTime);if(this.scanner.sorcerer.video.streams[n].pendingFetches.forEach(function(e){a+=e.percent*i.SEGMENT_DURATION}),!r&&this._isVirginBuffer(e,t)||!e){var s=this.getCurrentSpeed();return this._getStreamFromSpeed(s,.85,t)}if(a<=3*this.SEGMENT_DURATION)return this.scanner.fire("bufferoccupancy",0),0;var l=Math.min(1,(a-3*this.SEGMENT_DURATION)/o);if(a===this.scanner._video.duration-this.scanner._video.currentTime&&(l=1),this.scanner.fire(Ra.BUFFER_OCCUPANCY,Math.round(100*l)/100),1===l)return t.length-1;for(var u=[],c=1;c<t.length;c++)u.push(t[c].bitrate);var d=l*u.slice(-1)[0],f=[];u.forEach(function(e){f.push(Math.abs(d-e))});var h=f.indexOf(Math.min.apply(Math,f))+1,v=Math.max(0,n-1);return d>u[v-1]&&d<=u[v]||d>=u[v]&&d<u[v+1]?n:h}},{key:"_isVirginBuffer",value:function(e,t){return!(!this.inVirginState||this._getStreamFromSpeed(this.getCurrentSpeed(),.85,t)===this._getStreamFromBuffer(e,t,this.scanner.sorcerer.video.activeStreamIndex,!0))||(this.inVirginState&&(this.inVirginState=!1),!1)}}]),i}(),vs="video",ps="audio",ms=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,i);var n=Uo(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n.reset(),n.manifestLoadDurations=[],t.mediaSourceScanner&&(n._maxPreloadStreamIndex=t.mediaSourceScanner.maxPreloadStreamIndex,n._shouldUseBBA=t.mediaSourceScanner.shouldUseBBA),n}return jo(i,Ya),Bo(i,null,[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&"undefined"!=typeof Set}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json"]}}]),Bo(i,[{key:"deactivate",value:function(){No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"deactivate",this).call(this),this.sorcerer&&this.sorcerer.destroy(),this.reset()}},{key:"reset",value:function(){this._waitingOnSet=new Set,this._streamsForSegment={};var e=this._options.mediaSourceScanner||{};e.tests=this._options.tests,this._shouldUseBBA?this._brain=new hs(this,e):this._brain=new fs(this,e),this._ready=!1,this._startedPlaying=!1,this._manifest=null,this._streams={},this._streams[ps]=[],this._streams[vs]=[],this._audioStreams=[],this._onReady=null,this._baseUrl=null,this._lastTargetStreamId=null,this._timeToSeekTo=null,this._resolveSeek=null,this._resolveStartPreload=null,this._reloadingExistingVideo=!1,this._lastStreamIndex=null,this._checkSwitchUp=!1,this._clearBufferAtTime=!1,this._preloadStream=null,this._removeBufferPromise=null,this._ranIntoBuffer=!1,this._restrictedStreamIndexes=[],this._switching={},this._fireEndedTimeout=null,this._firedFakeEndedEvent=!1,this._lastDownloadBitrate=0}},{key:"preloadStream",value:function(){var h=this;return this._preloadStream||(this._preloadStream=new M(function(o,e){var a=1;h._streams.audio.length&&(a=2);var u=0,c=!1,d=h.sorcerer.video.activeStreamIndex;h._restrictedStreamIndexes.length&&(d=h._restrictedStreamIndexes[0]);var f=0,s=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];for(var t in e&&(d=h.sorcerer.video.activeStreamIndex),h._streams)if(0!==h._streams[t].length){var n=h._brain.getSegmentsToLoad(!1,t,h._getCurrentStream());0<n.length&&(f=n[0]);var i=d;t===ps&&(i=h._getAudioIndexFromVideo(d));var r=h._getSegmentUrl(i,f,t),o=h._isFinalSegment(i,f),a=h.sorcerer[t].streams[i],s={stream:i,segment:f,type:t},l=r;if(h._useRangeRequests())l={url:l,byteRange:h._getRangeForSegment(i,f,t)};"audio"!==t||i!==c?("audio"===t&&!1===c&&(c=i),a.addSegment(l,{identifier:s,isFinalSegment:o,loadOnly:!0,priority:0})):(u+=1,h._handleAppendBufferEnd(s))}};h.sorcerer.on("bufferqueueadd",function e(t){if(!((u+=1)<a)&&t.segment===f){if(0===h._restrictedStreamIndexes.length){var n=h._getStreamIndexToLoad(!0);if(!1!==n&&n>t.stream)return h.sorcerer.video.switchTo(n,!1),h._streams.audio.length&&h.sorcerer.audio.switchTo(h._getAudioIndexFromVideo(n),!1),void s(!(u=0))}var i=h._getCurrentStream(d).segments[0].end,r=h._getDuration(!0);h.currentTime>=r&&(h.currentTime=r),h.currentTime>i&&(h.sorcerer.clear(),h._waitingOnSet=new Set),h.sorcerer.video.switchTo(d,!1),h._streams.audio.length&&h.sorcerer.audio.switchTo(h._getAudioIndexFromVideo(d),!1),h.sorcerer.off("bufferqueueadd",e),h._ready=!0,o()}}),s()})),this._preloadStream}},{key:"loadManifest",value:function(o){var a=this;return new M(function(e,n){var i=null,r=new XMLHttpRequest;r.open("GET",o,!0),r.timeout=1e4,r.onload=function(){var t=Date.now()-i;if(400<=r.status)return a.manifestLoadDurations.push({url:o,status:r.status,duration:t}),a.reset(),410===r.status?void a.fire(Ra.MEDIA_URL_EXPIRED):void n("JSON manifest failed to load.");"responseURL"in r&&r.responseURL!==o&&r.responseURL.indexOf("live-archive")&&(a._baseUrl=r.responseURL.split("/").slice(0,-2).join("/"));try{e(JSON.parse(r.response)),a.manifestLoadDurations.push({url:o,status:r.status,duration:t}),a.fire(Ra.MANIFEST_LOADED)}catch(e){a.manifestLoadDurations.push({url:o,status:r.status,duration:t}),n()}},r.onerror=function(){var e=Date.now()-i;a.manifestLoadDurations.push({url:o,status:r.status,duration:e}),a.reset(),n("JSON manifest failed to load.")},r.ontimeout=function(){var e=Date.now()-i;a.manifestLoadDurations.push({url:o,status:r.status,duration:e}),a.reset(),a.fire(Ra.MANIFEST_TIMEOUT),n("JSON manifest "+o+" timed out in "+e+"ms.")},i=Date.now(),r.send()})}},{key:"setVideoSrc",value:function(t,e){var n=this;if((!(2<arguments.length&&void 0!==arguments[2])||arguments[2])&&!e&&this._onReady){if(("metadata"===this._preload||"none"===this._preload&&!this._paused)&&!this._ready)return void this._onReady.then(function(){var e=n._paused;n.setVideoSrc(t,e,!1)});if("auto"===this._preload)return void this._onReady.then(function(){n.setVideoSrc(t,!1,!1)})}if(e){this.reset();try{this._video.currentTime=0}catch(e){}}e||!this._paused||this.sorcerer||(e=!0);var i="_initializeManifest";e&&(this._video.preload="",i="_initialize");var r=t.split("/");r.pop();var o=r.join("/")+"/";this._reloadingExistingVideo=!e,this._onReady=this._startPreload(t,this._preload).then(this.loadManifest.bind(this)).then(function(e){return"string"==typeof n._baseUrl&&-1!==n._baseUrl.indexOf("live-archive")||(n._baseUrl=o),e}).then(this[i].bind(this)),e&&"auto"===this._preload&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this),!1)),this._onReady=this._addCatchToPromise(this._onReady)}},{key:"getBitrateAtTime",value:function(e,t){if(!this.sorcerer)return 0;var n=this.sorcerer.streamIndexAtTime(e,t);return this._streams[t][n]?this._streams[t][n].bitrate:0}},{key:"updateReadyState",value:function(){}},{key:"lockStreamIndexes",value:function(){var t=this,e=this._restrictedStreamIndexes.map(function(e){return t._streams[vs].indexOf(t._streams[vs][e])});if(this._video.paused||(this._ignorePauseEvent=!0,this._video.pause()),this._switching[vs]=!1,this._brain.lock(e),this._startedPlaying||"auto"===this._preload){var n=Math.max(this.currentTime-7,0),i=Math.min(this.currentTime+7,this._video.duration);this.sorcerer.removeBuffer(n,i).then(function(){!t._startedPlaying&&"auto"===t._preload||t.ended?t._loadSegments():(t.seekToTime(t.currentTime),!t._paused&&t._video.paused&&(t._ignorePlayEvent=!0,t.play()))})}}},{key:"seekToTime",value:function(e){var t=this;if(e===this.currentTime)return M.resolve();this._shouldUseBBA&&(this._brain.inVirginState=!0),clearTimeout(this._fireEndedTimeout),this._firedFakeEndedEvent=!1;var n=null===this._timeToSeekTo;if(n||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,this._ready)for(var i in this._streams)if(0<this._streams[i].length){var r=this.sorcerer[i].activeStreamIndex;this.sorcerer[i].streams[r].abort()}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),M.all([this._onReady,this._removeBufferPromise]).then(function(){t._loadSegments()}),this._paused&&0===e&&this.fire(Pa.SEEKING),this.readyState=1,n||this.play(),this._onReady.then(function(){return t._seekInProgressPromise}).catch(function(e){})}},{key:"takeSnapshot",value:function(){}},{key:"initDrm",value:function(){}},{key:"onstalled",value:function(){return!1}},{key:"onseeked",value:function(e){this._startedPlaying&&(this._loadSegments(),No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"onseeked",this).call(this,e))}},{key:"onended",value:function(e){return clearTimeout(this._fireEndedTimeout),!this._firedFakeEndedEvent&&(No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"onended",this).call(this,e),!0)}},{key:"onseeking",value:function(e){var t=this;this._startedPlaying&&(clearTimeout(this._seekTimeout),this._seekTimeout=setTimeout(function(){t._loadSegments()},100))}},{key:"onloadeddata",value:function(){var e=this;ba(function(){e.readyState=4})}},{key:"ontimeupdate",value:function(e){var t=this;if(!this.sorcerer)return!1;if(clearTimeout(this._fireEndedTimeout),0===this.currentTime)return this._startedPlaying;if(this._timeToSeekTo)return!1;if(this._clearBufferAtTime&&this.currentTime>=this._clearBufferAtTime){this.sorcerer.removeBuffer(0,this._clearBufferAtTime-2),this._clearBufferAtTime=!1}this._loadSegments();var n=this.sorcerer.getDroppedFrameTotal();this.fire(Ra.DROPPED_FRAMES,n);var i=this.sorcerer.getResponseSpeeds(),r=this._streams[vs][this.sorcerer.video.activeStreamIndex],o=this._options.tests&&this._options.tests.download_bitrate;if((!o||!o.group)&&r){var a={speed:this._brain.getCurrentSpeed(),bitrate:r.bitrate,speeds:i};this.fire(Ra.BANDWIDTH,a)}var s=this._video.buffered.length;if(!s)return!0;var l=this._video.buffered.end(s-1);if(!this._firedFakeEndedEvent&&this.currentTime+.5>this._video.duration){this._fireEndedTimeout=setTimeout(function(){t.onended(),t._firedFakeEndedEvent=!0,t.fire(Pa.ENDED,{simulated:!0})},500)}if(Math.ceil(l)===Math.ceil(this._video.duration))return!0;return Math.abs(this.currentTime-l)<.2?(this._ranIntoBuffer||(this.fire(Ra.STREAM_BUFFER_START,{hasLowerStreamIndex:0<this.sorcerer[vs].activeStreamIndex}),this._ranIntoBuffer=!0,this.readyState=2),!1):void 0}},{key:"onprogress",value:function(){this._brain.canPlayFromTimeInStream(this.currentTime,this._getCurrentStream())&&(this.readyState<3&&(this.readyState=4),this._ranIntoBuffer&&(this.fire(Ra.STREAM_BUFFER_END),this._ranIntoBuffer=!1))}},{key:"onplay",value:function(){return"picture-in-picture"===this.presentationMode&&(this._paused=!1,!0)}},{key:"onpause",value:function(){return"picture-in-picture"===this.presentationMode&&(this._paused=!0)}},{key:"onwaiting",value:function(e){return!1}},{key:"onerror",value:function(){return!!this._video.error&&(this._video.error.code===this._video.error.MEDIA_ERR_DECODE?(this.fire(Ra.SCANNER_ERROR,{reason:"encountered media decode error"}),!1):No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"onerror",this).call(this))}},{key:"pause",value:function(){var e=this;ba(function(){e.fire(Pa.PAUSE)}),No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;return this._firedFakeEndedEvent&&(this.currentTime=0),ba(function(){e.fire(Pa.PLAY)}),this._paused=!1,this._resolveStartPreload&&this._resolveStartPreload(),this._reloadingExistingVideo||this._ready||"auto"===this._preload||(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),this._startedPlaying?this._onReady.then(function(){return M.resolve(e._seekInProgressPromise)}).then(function(){return e._paused?null:No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"play",e).call(e)}):No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"play",this).call(this).then(function(){e._startedPlaying=!0})}},{key:"_getAudioIndexFromVideo",value:function(e){return 0!==this._streams.audio.length&&(1<this._streams.audio.length&&1e6<this._streams.video[e].bitrate?1:0)}},{key:"_addCallbackToPromise",value:function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=e.then(t);return n&&(i=this._addCatchToPromise(i)),i}},{key:"_addCatchToPromise",value:function(e){var t=this;return e.catch(function(e){return t.fire(Ra.FILE_ERROR,{reason:e}),new M(function(e,t){})})}},{key:"_handleBufferForSeek",value:function(){if(this._ready){12e3<this._streams[vs][this.sorcerer.video.activeStreamIndex].bitrate/1e3&&(this._removeBufferPromise=this.sorcerer.removeBuffer())}}},{key:"_startPreload",value:function(n,i){var r=this;return new M(function(e,t){"none"!==i||r._reloadingExistingVideo&&!r._paused?e(n):r._resolveStartPreload=function(){e(n),r._resolveStartPreload=null}})}},{key:"_getSeekReadyPromiseForTime",value:function(){var n=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._timeToSeekTo;return new M(function(e,t){n._startedPlaying&&0===i||n._brain.canPlayFromTimeInStream(i,n._getCurrentStream())?e(i):(n._handleBufferForSeek(),n._resolveSeek=e)}).then(function(e){n._timeToSeekTo=null,n._seekInProgressPromise=null,n.readyState=4;var t=new M(function(t,e){n._lastSeekReject=e;n._video.addEventListener("seeked",function e(){t(n._video.currentTime),n._video.removeEventListener("seeked",e)})});return n._video.currentTime=e,t})}},{key:"_handlePreloadChanged",value:function(e,t){"auto"!==e&&"auto"===t&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),e!==t&&"none"!==t&&this._resolveStartPreload&&this._resolveStartPreload()}},{key:"_avDurationDifference",value:function(e){var t=e.audio.reduce(function(e,t){return e+t.duration},0),n=e.video.reduce(function(e,t){return e+t.duration},0),i=t/e.audio.length,r=n/e.video.length;return i+4<r?r-i:0}},{key:"_initializeManifest",value:function(a){var s=this;return new M(function(e,t){if(s._manifest=a,s._streams[vs]=s._sortStreams(a.video),a.audio){var n=s._avDurationDifference(a);if(0<n)return s.fire(Ra.AV_DURATION_MISMATCH,n),s.fire(Ra.SCANNER_ERROR,{reason:"Encountered A/V duration mismatch"}),void t();s._streams[ps]=s._sortStreams(a.audio)}for(var i=0;i<s._streams[vs].length;i++){var r=0;if(a.audio){var o=s._streams[ps][s._getAudioIndexFromVideo(i)];o&&(r=o.bitrate)}s._streams[vs][i].audioBitrate=r}s._initDrm(s._streams[vs],s._streams[ps]),e()})}},{key:"_setUpSorcerer",value:function(e,t){this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new cs(e,t),this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments()}},{key:"_getDuration",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=e?1/0:0;for(var n in this._streams)this._streams[n].length&&(t=Math[e?"min":"max"](t,this._streams[n][0].duration));return t}},{key:"_initialize",value:function(a){var s=this;return new M(function(o,e){s._initializeManifest(a).then(function(){var e=s._brain.filterStreams(s._streams[vs]).length-1,t=s._streams[vs][0];(s._restrictedStreamIndexes.length&&(t=s._streams[vs][s._restrictedStreamIndexes[0]]),void 0!==s._maxPreloadStreamIndex)&&(e<=s._streams[vs].indexOf(a.video[s._maxPreloadStreamIndex])&&(t=s._streams[vs][e]));s._setUpSorcerer(s._video,{duration:s._getDuration()}),s.sorcerer.on("srcnotsupported",function(){s.fire(Ra.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})});var n=s._streams[vs].indexOf(t),i=function(i){s._streams[i].forEach(function(e,t){var n=s._getSegmentUrl(t,"init",i);s._useRangeRequests()&&s._streams[i][t].init_segment_range&&(n={url:n,byteRange:s._getRangeForSegment(t,"init",i)});s.sorcerer.addStream(e.mime_type+'; codecs="'+s._streams[i][t].codecs+'"',n)})};for(var r in s._streams)i(r);s.sorcerer.video.switchTo(n),s.sorcerer.on("queued",s._handleQueued.bind(s)),s.sorcerer.on("downloadabort",s._handleAborted.bind(s)),s.sorcerer.on("appendbufferend",s._handleAppendBufferEnd.bind(s)),s.sorcerer.on("downloadend",s._handleDownloadEnd.bind(s)),s.sorcerer.on("downloaderror",s._handleDownloadError.bind(s)),s.sorcerer.on("progress",s._handleProgress.bind(s)),s.sorcerer.video.on("streamchange",s._handleStreamChange.bind(s)),s.sorcerer.mediaSource.addEventListener("sourceended",function(){s.fire(Pa.PROGRESS)}),o()})})}},{key:"_sortStreams",value:function(e){var t=e.slice(0);return t.sort(function(e,t){var n=e.width*e.height*e.bitrate,i=t.width*t.height*t.bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:n-i}),t}},{key:"_useRangeRequests",value:function(){return!!this._manifest.video[0].segments[0].range}},{key:"_getRangeForSegment",value:function(e,t,n){return"init"===t?this._streams[n][e].init_segment_range:this._streams[n][e].segments[t].range}},{key:"_getSegmentPriority",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vs;return"init"===t?0:this._streams[n][e].segments[t].start}},{key:"_getSegmentUrl",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vs;if("init"===t&&!this._streams[n][e].init_segment_range&&-1===this._streams[n][e].init_segment.indexOf("."))return _a(this._streams[n][e].init_segment);var i=this._baseUrl,r=this._manifest.base_url&&-1!==this._manifest.base_url.indexOf("//");return r&&(i=this._manifest.base_url),this._manifest.base_url&&!r&&(i+=this._manifest.base_url),this._streams[n][e].base_url&&(i+=this._streams[n][e].base_url),this._useRangeRequests()?i:"init"===t?i+=this._streams[n][e].init_segment:(this._streams[n][e].segments[t].url&&(i+=this._streams[n][e].segments[t].url),i)}},{key:"_key",value:function(e,t,n){return e+":"+t+":"+n}},{key:"_isFinalSegment",value:function(e,t){return t===this._streams[vs][e].segments.length-1}},{key:"_getCurrentlyLoadingStreamsForSegment",value:function(e,t){var n=[],i=this._streamsForSegment[e];if(!i)return n;for(var r=0;r<i.length;r++)this._waitingOnSet.has(this._key(i[r],e,t))&&n.push(i[r]);return n}},{key:"_getCurrentStream",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:vs;return void 0!==this.sorcerer&&(e=this.sorcerer[t].activeStreamIndex),this._streams[t][e]}},{key:"_getStreamIndexToLoad",value:function(e){var t=this._streams[vs];if(0===(t=this._brain.filterStreams(t)).length)return!1;if(this._switching[vs])return!1;var n=t[t.length-1];if(n.id!==this._lastTargetStreamId){this._lastTargetStreamId=n.id;var i={index:this._streams[vs].indexOf(n),streams:this._streams[vs]};this.fire(Ra.STREAM_TARGET_CHANGE,i)}var r=this._getCurrentStream(),o=this._brain.shouldPowerUp(t,r,e);return!1===o&&(o=this._brain.shouldPowerDown(t,r)),!1===o?o:this._streams[vs].indexOf(t[o])}},{key:"_loadSegmentsForType",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:vs,n=this._getStreamIndexToLoad();t===ps&&(!1===n&&(n=this.sorcerer[vs].activeStreamIndex),n=this._getAudioIndexFromVideo(n),this.sorcerer[ps].activeStreamIndex===n&&(n=!1));var i=!1;!1!==n&&(i=n>this.sorcerer[t].activeStreamIndex,this._switching[t]=!0,this.sorcerer[t].switchTo(n).then(function(){e._switching[t]=!1}));for(var r=this._brain.getSegmentsToLoad(i,t,this._getCurrentStream()),o=this.sorcerer[t].activeStreamIndex,a=0;a<r.length;a++){var s=this._getSegmentUrl(o,r[a],t),l=this._getCurrentlyLoadingStreamsForSegment(r[a],t);if(!(1<l.length)&&!(1===l.length&&o<=l[0])){var u=this._isFinalSegment(o,r[a],t),c={stream:o,segment:r[a],type:t},d=this.sorcerer[t].streams[o],f=s;if(this._useRangeRequests())f={url:f,byteRange:this._getRangeForSegment(o,r[a],t)};var h=this._getSegmentPriority(o,r[a],t),v=t===vs;d.addSegment(f,{identifier:c,isFinalSegment:u,priority:h,includeWithBandwidthChecks:v})}}}},{key:"_loadSegments",value:function(){var t=this;return this._onReady.then(function(){for(var e in t._streams)0<t._streams[e].length&&t._loadSegmentsForType(e)})}},{key:"_handleQueued",value:function(e){this._waitingOnSet.add(this._key(e.stream,e.segment,e.type)),this._streamsForSegment[e.segment]||(this._streamsForSegment[e.segment]=[]),-1===this._streamsForSegment[e.segment].indexOf(e.stream)&&this._streamsForSegment[e.segment].push(e.stream)}},{key:"_clearWaitingOn",value:function(t){var n=this;this._streamsForSegment[t.segment].forEach(function(e){n._waitingOnSet.delete(n._key(e,t.segment,t.type))})}},{key:"_handleAborted",value:function(e){this._streamsForSegment[e.segment]&&this._clearWaitingOn(e)}},{key:"_handleAppendBufferEnd",value:function(e){this._checkSwitchUp&&e.stream===this._lastStreamIndex&&(this._checkSwitchUp=!1,this._clearBufferAtTime=this._streams[vs][e.stream].segments[e.segment].start),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e),null!==this._timeToSeekTo&&this._resolveSeek&&this._brain.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream())&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null)}},{key:"_handleDownloadEnd",value:function(e,t){this.fire(Ra.DOWNLOAD_END,{identifier:e,data:t})}},{key:"_handleDownloadError",value:function(e,t){this._clearWaitingOn(e);var n=Ra.DOWNLOAD_ERROR;410===t&&(n=Ra.MEDIA_URL_EXPIRED),this.fire(n,{identifier:e,status:t})}},{key:"_handleProgress",value:function(){if(this._options.tests&&this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group){var e=this._streams[vs][this.sorcerer.video.activeStreamIndex],t=this.sorcerer.getAverageDownloadBitrate(this._options.tests.download_bitrate.data.duration);if(this._lastDownloadBitrate!==t&&0!==t){var n={speed:this._lastDownloadBitrate=t,bitrate:e.bitrate};this.fire(Ra.BANDWIDTH,n)}}}},{key:"_handleStreamChange",value:function(e){e>this._lastStreamIndex&&0<this.currentTime&&(this._checkSwitchUp=!0),this._lastStreamIndex=e;var t={index:this._manifest.video.indexOf(this._streams[vs][e]),streams:this._manifest.video};this.fire(Ra.STREAM_CHANGE,t)}},{key:"_initDrm",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(this._telecineVideo.drmHandler){var n={audio:t.map(function(e){return e.mime_type+';codecs="'+e.codecs+'"'}),video:e.map(function(e){return e.mime_type+';codecs="'+e.codecs+'"'})};this._telecineVideo.drmHandler.init(this,n)}}},{key:"preload",get:function(){return this._preload},set:function(e){this._handlePreloadChanged(this._preload,e),this._preload=e}},{key:"videoWidth",get:function(){var e=this._getCurrentStream();return e?e.width:this._video.videoWidth}},{key:"videoHeight",get:function(){var e=this._getCurrentStream();return e?e.height:this._video.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this._restrictedStreamIndexes.join(",")!==t.join(",")&&(this._restrictedStreamIndexes=t,this._onReady.then(function(){return e.lockStreamIndexes()}))}},{key:"currentTime",get:function(){return this._firedFakeEndedEvent?this._video.duration:null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime},set:function(e){(this._startedPlaying||0!==e)&&this.seekToTime(e)}},{key:"downloadSpeed",get:function(){return this._lastDownloadBitrate}},{key:"isLowerProfileAvailable",get:function(){return this.sorcerer?0<this.sorcerer[vs].activeStreamIndex:null}}]),i}(),gs=function(e){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,r);var n=Uo(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t)),i=document.createElement("canvas");return n._backingCanvas=i.getContext("2d"),n._resizeHandler=function(){return n.onresize()},n}return jo(r,zo),Bo(r,null,[{key:"displayName",get:function(){return"AsciiEffect"}},{key:"supported",get:function(){return!/iphone|ipod/i.test(navigator.userAgent)}},{key:"supportedScanners",get:function(){return[Ya,ms]}}]),Bo(r,[{key:"activate",value:function(){window.addEventListener("resize",this._resizeHandler,!1),this._telecine.paused?this._renderFrame():this._startRendering()}},{key:"deactivate",value:function(){this._stopRendering(),window.removeEventListener("resize",this._resizeHandler,!1),this._element.removeChild(this._output)}},{key:"onplay",value:function(){this._startRendering()}},{key:"onpause",value:function(){this._stopRendering()}},{key:"onended",value:function(){this._stopRendering()}},{key:"onseeked",value:function(){this._renderFrame()}},{key:"onresize",value:function(){var e=this._telecine._currentScanner._video,t=this._getRenderProperties(e.clientWidth,e.clientHeight,this._telecine.videoWidth,this._telecine.videoHeight);this._adjustRenderSize(this._output,t),this._telecine.paused&&this._renderFrame()}},{key:"_getRenderProperties",value:function(e,t,n,i){var r=wa(e,t,n,i),o=Math.max(Math.min(Math.floor(r.height/10),60),10);this._options.color&&(o=Math.floor(o/2));var a=document.createElement("pre");a.style.cssText="position:absolute;left:-9001px;top:0;font-size:10px;margin:0;padding:0;line-height:1",a.innerHTML="X",this._element.appendChild(a);var s=t/o/a.clientHeight*10+"px";a.style.fontSize=s;for(var l=a.clientHeight,u=Math.ceil(r.height/l),c=r.height-u*l,d=parseFloat((c/u+l)/l),f=a.clientWidth,h=Math.ceil(r.width/f),v=[],p=0;p<h;p++)v.push("X");a.innerHTML=v.join("");var m=(r.width-a.clientWidth)/h+"px";return this._element.removeChild(a),{fontSize:s,lineHeight:d,letterSpacing:m,horizontalResolution:h,verticalResolution:u,top:r.top}}},{key:"_createOutputElement",value:function(e){var t=document.createElement("pre");return t.style.cssText="position:absolute;left:0;top:0;margin:0;padding:0;background:#000;width:100%;height:100%;text-align:center",t.style.color=this._options.color?"#fff":"#0f0",this._adjustRenderSize(t,e),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),t}},{key:"_adjustRenderSize",value:function(e,t){var n=t.fontSize,i=t.lineHeight,r=t.letterSpacing,o=t.horizontalResolution,a=t.verticalResolution,s=t.top;this._backingCanvas.width=o,this._backingCanvas.height=a,this._renderWidth=o,this._renderHeight=a,e.style.fontSize=n,e.style.lineHeight=i,e.style.letterSpacing=r,e.style.paddingTop=s+"px"}},{key:"_getFrame",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._backingCanvas.drawImage(e,0,0,this._renderWidth,this._renderHeight);var n=null;try{n=this._backingCanvas.getImageData(0,0,this._renderWidth,this._renderHeight).data}catch(e){this._stopRendering()}for(var i=[],r=0;r<this._renderHeight;r++){for(var o=0;o<this._renderWidth;o++){var a=4*(r*this._renderWidth+o),s=n[a],l=n[a+1],u=n[a+2],c=3*s+4*l+u>>>3;if(t){var d=" CGO08@"[Math.floor(c/256*7)];if(" "===d||250<=s&&250<=l&&250<=u){i.push(d);continue}i.push('<span style="color:rgb('+s+","+l+","+u+')">'+d+"</span>")}else{var f="  .,:;iltfLG@"[Math.floor(c/256*13)];i.push(f)}}i.push("\n")}return i.join("")}},{key:"_requestRenderAnimationFrame",value:function(){var e=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame),this._content&&(this._animationFrame=window.requestAnimationFrame(function(){e._output.innerHTML=e._content,e._content=null}))}},{key:"_renderFrame",value:function(){if(!this._output){var e=this._telecine._currentScanner._video,t=this._getRenderProperties(e.clientWidth,e.clientHeight,this._telecine.videoWidth,this._telecine.videoHeight);this._output=this._createOutputElement(t),this._element.appendChild(this._output)}this._content=this._getFrame(this._telecine._currentScanner._video,this._options.color),this._requestRenderAnimationFrame()}},{key:"_startRendering",value:function(){var e=this;this._interval&&window.clearInterval(this._interval);var t=Math.min(Math.max(this._options.fps,15),30);this._interval=window.setInterval(function(){e._renderFrame()},1/t)}},{key:"_stopRendering",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=null)}}]),r}(),ys=["width","height","bandwidth","duration","timescale","presentationTimeOffset"],_s=function(){function i(e,t){Fo(this,i);var n=new DOMParser;this.manifest=n.parseFromString(e,"application/xml"),this.url=t,this.mpd=this.manifest.getElementsByTagName("MPD")[0]}return Bo(i,[{key:"_attrsToObj",value:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n].nodeName,r=e[n].nodeValue;-1!==ys.indexOf(i)&&(r=parseInt(r,10)),t[i]=r}return t}},{key:"_getAttribute",value:function(e,t){var n=e.attributes.getNamedItem(t);return n?n.nodeValue:null}},{key:"_constructAdaptationSets",value:function(i){for(var r=this,o=[],e=function(e){var t=r._attrsToObj(i[e].attributes),n=i[e].getElementsByTagName("Representation");t.representations=r._constructRepresentations(n),t.frameRate&&t.representations.forEach(function(e){e.framerate=parseInt(t.frameRate,10)}),1===t.representations.length&&(t.width&&(t.representations[0].width=t.width),t.height&&(t.representations[0].height=t.height)),o.push(t)},t=0;t<i.length;t++)e(t);return o}},{key:"_constructRepresentations",value:function(e){for(var t=[],n=0;n<e.length;n++){var i=this._attrsToObj(e[n].attributes),r=e[n].getElementsByTagName("SegmentList")[0];i.segmentList=this._constructSegmentList(r),t.push(i)}return t}},{key:"_constructSegmentList",value:function(e){var t=e.getElementsByTagName("Initialization")[0],n=e.getElementsByTagName("SegmentURL"),i=this._attrsToObj(e.attributes);i.startNumber=parseInt(i.startNumber,10),i.initSegment=this.baseURL+this._getAttribute(t,"sourceURL"),i.segments=[];for(var r=0;r<n.length;r++){var o=this._getAttribute(n[r],"media"),a=o.match(/cn(\d*)/);if(null===a)throw new Error("Error parsing segment index from segment URL");i.segments.push({index:parseInt(a[1],10),url:this.baseURL+o})}return i}},{key:"profiles",get:function(){return this._getAttribute(this.mpd,"profiles")}},{key:"type",get:function(){return this._getAttribute(this.mpd,"type")}},{key:"minimumUpdatePeriod",get:function(){return ka(this._getAttribute(this.mpd,"minimumUpdatePeriod"))}},{key:"publishTime",get:function(){return this._getAttribute(this.mpd,"publishTime")}},{key:"availabilityStartTime",get:function(){return this._getAttribute(this.mpd,"availabilityStartTime")}},{key:"timeShiftBufferDepth",get:function(){return ka(this._getAttribute(this.mpd,"timeShiftBufferDepth"))}},{key:"suggestedPresentationDelay",get:function(){return ka(this._getAttribute(this.mpd,"suggestedPresentationDelay"))}},{key:"minBufferTime",get:function(){return ka(this._getAttribute(this.mpd,"minBufferTime"))}},{key:"baseURL",get:function(){return this.url.substr(0,this.url.lastIndexOf("/")+1)}},{key:"periods",get:function(){for(var e=[],t=this.mpd.getElementsByTagName("Period"),n=0;n<t.length;n++){var i=this._attrsToObj(t[n].attributes),r=t[n].getElementsByTagName("AdaptationSet");i.adaptationSets=this._constructAdaptationSets(r),e.push(i)}return e}},{key:"audioAdaptationSet",get:function(){return this.periods[0].adaptationSets.find(function(e){return 0===e.mimeType.search(/audio/)})}},{key:"videoAdaptationSet",get:function(){return this.periods[0].adaptationSets.find(function(e){return 0===e.mimeType.search(/video/)})}},{key:"representations",get:function(){return this.periods[0].adaptationSets[0].representations}},{key:"audioRepresentations",get:function(){return this.audioAdaptationSet?this.audioAdaptationSet.representations:null}},{key:"videoRepresentations",get:function(){return this.videoAdaptationSet.representations}}]),i}(),bs=["width","height","bandwidth","duration","timescale","presentationTimeOffset"],ws=function(){function r(e,t,n){var i=this;Fo(this,r),window.m3u8Parser?this._initialize(e,t,n):document.getElementById("m3u8-parser").onload=function(){i._initialize(e,t,n)}}return Bo(r,[{key:"_initialize",value:function(e,t,n){var i=this,r=new window.m3u8Parser.Parser;r.push(e),r.end(),this.manifest=r.manifest,this.url=t,this.playlists=[];for(var o=this.playlistsLoaded=0;o<this.manifest.playlists.length;o++){var a=this.baseURL+this.manifest.playlists[o].uri;this._requestText(a,this.manifest.playlists[o]).then(function(e){i._manifestUrl=e.responseURL,(r=new window.m3u8Parser.Parser).push(e.response),r.end();var t=e.playlist;t.manifest=r.manifest,t.baseUrl=i.baseURL,i.playlists.push(t),i.playlistsLoaded+=1,i.playlistsLoaded===i.manifest.playlists.length&&n()}).catch()}}},{key:"_attrsToObj",value:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n].nodeName,r=e[n].nodeValue;-1!==bs.indexOf(i)&&(r=parseInt(r,10)),t[i]=r}return t}},{key:"_getAttribute",value:function(e,t){var n=e.attributes.getNamedItem(t);return n?n.nodeValue:null}},{key:"_constructAdaptationSets",value:function(i){for(var r=this,o=[],e=function(e){var t=i.playlists[e],n=t;t.representations=r._constructRepresentations(n),t.frameRate&&t.representations.forEach(function(e){e.framerate=parseInt(t.frameRate,10)}),1===t.representations.length&&(t.width&&(t.representations[0].width=t.width),t.height&&(t.representations[0].height=t.height)),o.push(t)},t=0;t<i.playlists.length;t++)e(t);return o}},{key:"_constructRepresentations",value:function(e){for(var t=[],n=0;n<e.length;n++){var i=this._attrsToObj(e[n].attributes),r=e[n].getElementsByTagName("SegmentList")[0];i.segmentList=this._constructSegmentList(r),t.push(i)}return t}},{key:"_constructSegmentList",value:function(e){var t=e.getElementsByTagName("Initialization")[0],n=e.getElementsByTagName("SegmentURL"),i=this._attrsToObj(e.attributes);i.startNumber=parseInt(i.startNumber,10),i.initSegment=this.baseURL+this._getAttribute(t,"sourceURL"),i.segments=[];for(var r=0;r<n.length;r++){var o=this._getAttribute(n[r],"media"),a=o.match(/cn(\d*)/);if(null===a)throw new Error("Error parsing segment index from segment URL");i.segments.push({index:parseInt(a[1],10),url:this.baseURL+o})}return i}},{key:"_requestText",value:function(i,r){return new M(function(e,t){var n=new XMLHttpRequest;n.open("GET",i,!0),n.onload=function(){200!==n.status&&t("Failed to load url: "+i+" "+n.status),n.playlist=r,e(n)},n.onerror=function(){t("Failed to load url: "+i)},n.send()})}},{key:"profiles",get:function(){return this._getAttribute(this.manifest,"profiles")}},{key:"type",get:function(){return"dynamic"}},{key:"minimumUpdatePeriod",get:function(){return ka("PT3.0S")}},{key:"baseURL",get:function(){return this.url.substr(0,this.url.lastIndexOf("/")+1)}},{key:"periods",get:function(){var e=[],t={id:"0",start:"PT0.0S"};return t.adaptationSets=this._constructAdaptationSets(this.manifest),e.push(t),e}},{key:"audioAdaptationSet",get:function(){return this.periods[0].adaptationSets.find(function(e){return 0===e.mimeType.search(/audio/)})}},{key:"videoAdaptationSet",get:function(){return this.playlists}},{key:"representations",get:function(){return this.periods[0].adaptationSets[0].representations}},{key:"audioRepresentations",get:function(){return null}},{key:"videoRepresentations",get:function(){for(var e=[],t=0;t<this.playlists.length;t++){for(var n=this.playlists[t],i=0;i<n.manifest.segments.length;i++){var r=n.manifest.segments[i],o=r.uri.substring(0,r.uri.length-3);r.index=o.substring(o.lastIndexOf("_")+1,o.length)}var a={baseUrl:n.baseUrl,bandwidth:n.attributes.BANDWIDTH,codecs:n.attributes.CODECS,framerate:30,height:n.attributes.RESOLUTION.height,id:n.uri,sar:"1:1",segmentList:n.manifest.segments,width:n.attributes.RESOLUTION.width};e.push(a)}return e}}]),r}(),ks=[1,2,5],Ss=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,i);var n=Uo(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n.BANDWIDTH_THRESHOLD=.8,n.consecutiveStreamIndex={},n}return jo(i,fs),Bo(i,null,[{key:"displayName",get:function(){return"Live"}}]),Bo(i,[{key:"optimalStreamIndex",value:function(e,t){if(1===e.length)return e[0].index;e=this.filterStreams(e);var n=0;n=this._options.tests&&this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group?this.scanner.sorcerer.getAverageDownloadBitrate(this._options.tests.download_bitrate.data.duration):this.scanner.sorcerer.getCurrentSpeed({type:"average",howMany:5,weights:ks});for(var i=t,r=0;r<e.length;r++)n*this.BANDWIDTH_THRESHOLD>e[r].bandwidth&&(i=e[r].index);this._clearConsecutiveStreamIndexes(i),this.consecutiveStreamIndex[i]++;var o=1.5*this.scanner.segmentLength;return this.scanner.duration-this.scanner.currentTime<o?0:2<this.consecutiveStreamIndex[i]&&i!==t?i:t}},{key:"_clearConsecutiveStreamIndexes",value:function(e){for(var t in this.consecutiveStreamIndex[e]||(this.consecutiveStreamIndex[e]=0),this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(t)&&parseInt(t,10)!==e&&(this.consecutiveStreamIndex[t]=0)}}]),i}(),Es="video",Ts="audio",xs="video/vnd.mpeg.dash.mpd",As="application/x-mpegURL",Ls=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,i);var n=Uo(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n._manifestUrl=null,n._apiManifestUrl=null,n._hasPlayed=!1,n._manifestRequested=!1,n._liveHls=n._options.tests.live_hls&&n._options.tests.live_hls.group,n.STREAM_SWITCH_CHECK_INTERVAL=2e3,n._livePoller=t.livePoller,n._setUpLivePoller(),n.reset(),window.addEventListener("online",function(){n._pauseReset(),n.play()}),n}return jo(i,Ya),Bo(i,null,[{key:"displayName",get:function(){return"LiveScanner"}},{key:"supportedVideoTypes",get:function(){return va.iOS?[As]:[xs,As]}},{key:"supportsPlaybackRate",get:function(){return!1}}]),Bo(i,[{key:"deactivate",value:function(){No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"deactivate",this).call(this),this.reset()}},{key:"reset",value:function(){this._manifestTimeout&&clearTimeout(this._manifestTimeout),this._sorcerer&&this._sorcerer.destroy(),this._sorcerer=null,this._hasAudioRepresentation=!1,this._streams={},this._streams[Es]=[],this._streams[Ts]=[],this._lastStreamIndex=0,this._manifest=null,this._manifestTimeout=null,this._lastSegmentAppended={audio:-1,video:-1},this._noSegmentsLoadedCount={audio:0,video:0},this._seenBufferLength=!1,this._hasLoadedManifest=!1,this._isOnline=!1,this._hasEnded=!1,this._hlsAvailabilityCheckTimeout=null,this._bufferedIndex=0,this._streamChanging=!1,this._timeSinceLastStreamSwitchCheck=0,this._forcePlayOnManifestLoad=!1,this._abr=new Ss(this,this._options),this._restrictedStreamIndexes=[],this._lastDownloadBitrate=0,this._manifestRequested=!1}},{key:"_pauseReset",value:function(){this._manifestTimeout&&clearTimeout(this._manifestTimeout),this._manifestTimeout=null,isNaN(this.duration)||(this.currentTime=this.duration)}},{key:"_setUpLivePoller",value:function(){var t=this;this._livePoller.on("liveeventended",function(e){t._hasEnded=!0,t._sorcerer.destroy(),t.deactivate()})}},{key:"_refreshLiveApiPlaylistUrl",value:function(){var o=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return new M(function(n,i){var r=o._livePoller.liveEvent.playlistRefreshUrl;Ea(r,!0).then(function(e){if("url"in e){var t=e.url;o._loadManifestFromExplcitRedirect(t,a).then(n).catch(i)}else i("Error parsing 'url' key from player live API refresh endpoint: "+r+" "+e)}).catch(i)})}},{key:"_loadManifestFromExplcitRedirect",value:function(e){var i=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return new M(function(t,n){i._apiManifestUrl=e,i._isPlaybackHLS()?Ea(i._apiManifestUrl).then(function(e){i._manifestUrl=e.responseURL,i._loadManifest(i._manifestUrl,r).then(t).catch(n)}).catch(n):Ea(i._apiManifestUrl,!0).then(function(e){"url"in e?(i._manifestUrl=e.url,i._loadManifest(i._manifestUrl,r).then(t).catch(n)):n("Error parsing 'url' key from Live API manifest endpoint: "+i._apiManifestUrl+" "+e)}).catch(n)})}},{key:"_loadManifest",value:function(o){var a=this,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return new M(function(n,i){var r=new XMLHttpRequest;r.open("GET",o,!0),r.onload=function(){if(410===r.status)return 3<=s?void i("Manifest load responded with a 410. Giving up refreshing after "+s+" attempts"):(i("Manifest load responded with a 410. Attempting to refresh manifest URL"),void a._refreshLiveApiPlaylistUrl(++s).then(function(){a._manifestRefresh(a._manifestUrl,Math.max(1e3*a._manifest.minimumUpdatePeriod,3e3))}).catch(i));if(200===r.status)try{a._isPlaybackHLS()?a._manifest=new ws(r.response,o,n):a._manifest=new _s(r.response,o),a._hasLoadedManifest||(a._hasLoadedManifest=!0),a._livePoller.isForcePolling&&a._livePoller.unforcePolling();var e=3<a._noSegmentsLoadedCount[Ts]||3<a._noSegmentsLoadedCount[Es];a._isOnline||e||(a._isOnline=!0,a.fire(Ma.STREAM_ONLINE)),a._isOnline&&e&&a._atDurationEnd()&&(a._isOnline=!1,a.fire(Ma.STREAM_OFFLINE)),a._isPlaybackHLS()||n()}catch(e){i(e)}else{if(a._hasEnded)return void i("Live stream has ended");if(!a._hasLoadedManifest&&s<12)return void setTimeout(function(){a._loadManifest(o,++s).then(n).catch(i)},1500);a._livePoller.isForcePolling||a._livePoller.forcePolling(),(a._atDurationEnd()&&a._isOnline||!a._hasLoadedManifest)&&(a._isOnline=!1,a.fire(Ma.STREAM_OFFLINE));var t=Math.min(1e3*Math.pow(2,s)+1e3*Math.random(),5e3);setTimeout(function(){a._loadManifest(o,++s).then(n).catch(i)},t)}},r.onerror=function(){3<=s?i("DASH manifest failed to load. Giving up refreshing after "+s+" attempts."):(i("DASH manifest failed to load. Attempting to refresh manifest URL."),a._refreshLiveApiPlaylistUrl(++s).then(function(){a._manifestRefresh(a._manifestUrl,Math.max(1e3*a._manifest.minimumUpdatePeriod,3e3))}).catch(i))},r.send()})}},{key:"_loadManifestInit",value:function(n){var o=this;return new M(function(e,t){o._loadManifestFromExplcitRedirect(n).then(function(){o._setUpSorcerer(o._video),o._streams[Es]=o._sortStreams(o._manifest.videoRepresentations);var r=o._manifest.videoAdaptationSet.mimeType;if(r||(r="video/mp4"),o._streams[Es].forEach(function(e,t){var n=o._streams[Es][t];if(o._isPlaybackHLS()){var i=n.baseUrl+n.segmentList[0].uri;o._sorcerer.addStream(r+'; codecs="'+e.codecs+'"',i,!0)}else o._sorcerer.addStream(r+'; codecs="'+n.codecs+'"',n.segmentList.initSegment)}),o._isPlaybackHLS()?o._appendTsSegments(Es):o._appendSegments(Es),o._manifest.audioRepresentations&&!o._isPlaybackHLS()){o._hasAudioRepresentation=!0,o._streams[Ts]=o._sortStreams(o._manifest.audioRepresentations);var n=o._manifest.audioAdaptationSet.mimeType;o._streams[Ts].forEach(function(e,t){o._sorcerer.addStream(n+'; codecs="'+o._streams[Ts][t].codecs+'"',o._streams[Ts][t].segmentList.initSegment)}),o._appendSegments(Ts)}return o.fire(Ma.REPRESENTATIONS_AVAILABLE,o._streams),o._setupSorcererEvents(),o._checkForStreamSwitch(),o._manifestRefresh(o._manifestUrl,Math.max(1e3*o._manifest.minimumUpdatePeriod,3e3)),e()}).catch(function(e){t(e)})})}},{key:"_setUpSorcerer",value:function(e){this._sorcerer&&this._sorcerer.destroy(),this._sorcerer=new cs(e)}},{key:"_setupSorcererEvents",value:function(){var i=this;this._sorcerer.video.on("streamchange",function(e){i._streamChanging=!1;var t=i._streams[Es];t[e].bitrate=t[e].bandwidth;var n={index:e,streams:t};i.fire(Ra.STREAM_CHANGE,n)}),this.sorcerer.on("progress",this._handleProgress.bind(this)),this._sorcerer.on("downloadend",this._handleDownloadEnd.bind(this))}},{key:"setVideoSrc",value:function(e,t){this.videoSrc=e}},{key:"_handleDownloadEnd",value:function(e){if("string"==typeof e){var t=e.split("_");this._lastSegmentAppended[t[0]]=Number(t[2])}}},{key:"_handleStreamChange",value:function(e){this._streamChanging=!1;var t=this._streams[Es];t[e].bitrate=t[e].bandwidth;var n={index:e,streams:t};this.fire(Ra.STREAM_CHANGE,n)}},{key:"_handleProgress",value:function(){if(this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group){var e=this._streams[Es][this._sorcerer.video.activeStreamIndex],t=this._sorcerer.getAverageDownloadBitrate(this._options.tests.download_bitrate.data.duration);if(this._lastDownloadBitrate!==t&&0!==t){var n={speed:this._lastDownloadBitrate=t,bitrate:e.bitrate};this.fire(Ra.BANDWIDTH,n)}}}},{key:"_isPlaybackHLS",value:function(){return this._telecineVideo.currentFile.mime===As}},{key:"_loadHls",value:function(){this.fire(Ma.STREAM_ONLINE),this._checkHlsAvailability(5e3)}},{key:"_checkHlsAvailability",value:function(e){var t=this;if(!("number"==typeof ia.iOS&&ia.iOS<9)){var n=function(){t.fire(Ma.STREAM_OFFLINE),t._livePoller.forcePolling()};this._hlsAvailabilityCheckTimeout=setTimeout(function(){var e=new XMLHttpRequest;e.open("GET",t._video.src),e.onload=function(){200!==e.status&&n(),e.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&n()},e.onerror=function(){n()},e.send()},e)}}},{key:"_manifestRefresh",value:function(e,t){var n=this;this._manifestTimeout=setTimeout(function(){n.paused&&n._hasPlayed?n._pauseReset():n._loadManifest(e).then(function(){return n._streams[Es]=n._sortStreams(n._manifest.videoRepresentations),n._isPlaybackHLS()?n._appendTsSegments(Es):n._appendSegments(Es),n._hasAudioRepresentation&&!n._isPlaybackHLS()&&(n._streams[Ts]=n._sortStreams(n._manifest.audioRepresentations),n._appendSegments(Ts)),n._manifestRefresh(e,Math.max(1e3*n._manifest.minimumUpdatePeriod,3e3))}).catch(function(e){})},t)}},{key:"_segmentIndexCompare",value:function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}},{key:"_appendTsSegments",value:function(e){if(this._sorcerer&&this._sorcerer[e]){for(var t=this._sorcerer[e].activeStreamIndex,n=this._sorcerer[e].streams[t],i=this._streams[Es][t].baseUrl,r=this._streams[Es][t].segmentList,o=r.sort(this._segmentIndexCompare),a=0,s=0;s<o.length;s++){var l=o[s];if(!(l.index<r.startNumber)&&!(l.index<=this._lastSegmentAppended[e])){var u=e+"_"+t+"_"+l.index;n.addSegment(i+l.uri,{identifier:u}),a++}}0===a?this._noSegmentsLoadedCount[e]++:this._noSegmentsLoadedCount[e]=0}}},{key:"_appendSegments",value:function(e){if(this._sorcerer&&this._sorcerer[e]){for(var t=this._sorcerer[e].activeStreamIndex,n=this._sorcerer[e].streams[t],i=e===Es?this._streams[Es][t].segmentList:this._streams[Ts][t].segmentList,r=i.segments.sort(this._segmentIndexCompare),o=0,a=0;a<r.length;a++){var s=r[a];if(!(s.index<i.startNumber)&&!(s.index<=this._lastSegmentAppended[e])){var l=e+"_"+t+"_"+s.index;n.addSegment(s.url,{identifier:l}),o++}}0===o?this._noSegmentsLoadedCount[e]++:this._noSegmentsLoadedCount[e]=0}}},{key:"_checkForStreamSwitch",value:function(){if(!this._streamChanging){var e=this._abr.filterStreams(this._streams[Es]),t=this._abr.optimalStreamIndex(e,this._lastStreamIndex);if(t!==this._lastStreamIndex){var n=e.find(function(e){return e.index===t}),i=this._streams[Es];i[t].bitrate=i[t].bandwidth;var r={index:t,streams:i};this.fire(Ra.STREAM_TARGET_CHANGE,r),this._streamChanging=!0,this._sorcerer[Es].switchTo(n,!0),this._lastStreamIndex=t}}}},{key:"_checkForPlaybackGap",value:function(){this._video.buffered.length&&(this._bufferedIndex>this.buffered.length-1&&(this._bufferedIndex=this.buffered.length-1),this._video.currentTime<this._video.buffered.start(this._bufferedIndex)?this._video.currentTime=this._video.buffered.start(this._bufferedIndex):Math.floor(this._video.currentTime)+3<Math.floor(this._video.buffered.end(this._bufferedIndex))||this._video.buffered.length-1>this._bufferedIndex&&(this._bufferedIndex++,this._video.currentTime=this._video.buffered.start(this._bufferedIndex)))}},{key:"_atDurationEnd",value:function(){return this._video.currentTime+.5>this._video.duration}},{key:"getBitrateAtTime",value:function(e,t){if(!this._sorcerer)return 0;var n=this._sorcerer.streamIndexAtTime(e,t);return this._streams[t][n]?this._streams[t][n].bandwidth:0}},{key:"_timeSince",value:function(e){return Date.now()-e}},{key:"_sortStreams",value:function(e){var t=e.slice(0);return t.sort(function(e,t){return e.width*e.height*e.bandwidth-t.width*t.height*t.bandwidth}),t.forEach(function(e,t){e.index=t}),t}},{key:"onprogress",value:function(){this._isPlaybackHLS()||this._checkForPlaybackGap(),this._isPlaybackHLS()&&this._hlsAvailabilityCheckTimeout&&(clearTimeout(this._hlsAvailabilityCheckTimeout),this._hlsAvailabilityCheckTimeout=null,this._livePoller.unforcePolling())}},{key:"ondurationchange",value:function(){this._checkForPlaybackGap()}},{key:"ontimeupdate",value:function(){if(this._sorcerer){if(this.fire(Ra.DROPPED_FRAMES,this._sorcerer.getDroppedFrameTotal()),!this._options.tests.download_bitrate||this._options.tests.download_bitrate&&!this._options.tests.download_bitrate.group){var e=this._sorcerer[Es].activeStreamIndex;if(e){var t={speed:this._sorcerer.getCurrentSpeed({type:"average",howMany:3,weights:[1,2,5]}),bitrate:this._streams[Es][e].bitrate,speeds:this._sorcerer.getResponseSpeeds()};this.fire(Ra.BANDWIDTH,t)}}!this._isOnline&&this._atDurationEnd()&&this.fire(Ra.STREAM_OFFLINE),this._timeSince(this._timeSinceLastStreamSwitchCheck)>this.STREAM_SWITCH_CHECK_INTERVAL&&(this._checkForStreamSwitch(),this._timeSinceLastStreamSwitchCheck=Date.now())}}},{key:"onstalled",value:function(){this._isPlaybackHLS()&&this._checkHlsAvailability(3e4)}},{key:"onwaiting",value:function(){}},{key:"seekToTime",value:function(){}},{key:"pause",value:function(){No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"pause",this).call(this),this._isPlaybackHLS()&&!this._liveHls&&ia.iOS||this._pauseReset()}},{key:"play",value:function(){if(this._manifestRequested)this._manifestTimeout||this._isPlaybackHLS()?!ia.iOS&&this._liveHls&&this._isPlaybackHLS()&&this._manifestRefresh(this._manifestUrl,3e3):this._manifestRefresh(this._manifestUrl,3e3);else switch(this._telecineVideo.currentFile.mime){case xs:this._manifestRequested=!0,this._loadManifestInit(this.videoSrc);break;case As:this._liveHls&&!ia.iOS?(this._manifestRequested=!0,this._loadManifestInit(this.videoSrc)):(this._manifestRequested=!0,this._video.src=this.videoSrc,this._loadHls())}return this._sorcerer&&this._hasPlayed&&this._sorcerer.removeBuffer(),this._hasPlayed=!0,No(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"play",this).call(this)}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._abr.lock(this._restrictedStreamIndexes))}},{key:"videoWidth",get:function(){return this._stream?this._stream.width:this._video.videoWidth}},{key:"videoHeight",get:function(){return this._stream?this._stream.height:this._video.videoHeight}},{key:"duration",get:function(){return this._video.duration}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this._video.currentTime=e}},{key:"isLowerProfileAvailable",get:function(){return this._sorcerer?0<this._sorcerer[Es].activeStreamIndex:null}},{key:"sorcerer",get:function(){return this._sorcerer}},{key:"segmentLength",get:function(){return 3}}]),i}(),Ps=function(){var e="Shockwave Flash",t="application/x-shockwave-flash",n=window.navigator,i=0,r=!1,o=null;if(void 0!==n.plugins&&"object"===Do(n.plugins[e])){if((o=n.plugins[e].description)&&(void 0===n.mimeTypes||!n.mimeTypes[t]||n.mimeTypes[t].enabledPlugin)){r=!0,o=o.replace(/^.*\s+(\S+\s+\S+$)/,"$1");var a=parseInt(o.replace(/^(.*)\..*$/,"$1"),10),s=parseInt(o.replace(/^.*\.(.*)\s.*$/,"$1"),10);i=parseFloat(a+"."+s)}}else if(void 0!==window.ActiveXObject)try{var l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");l&&(o=l.GetVariable("$version"))&&(r=!0,o=o.split(" ")[1].split(","),i=parseFloat(parseInt(o[0],10)+"."+parseInt(o[1],10)))}catch(e){}return{installed:r,version:i}}(),Cs=function(e){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(Fo(this,o),!t.swfScanner||!t.swfScanner.swfUrl)throw new Error("The url to the swf is required to use the SWFScanner.");var n=Uo(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e,t)),i="flideo_"+ya().replace(/-/g,"_");return window[i]={onFlashEvent:function(e){return n.onEvent(e)}},n._swf=n.createSwf(n._options.swfScanner.swfUrl,i+".onFlashReady"),n._element.appendChild(n._swf),n._loaded=!1,n._volume=1,n._muted=!1,n._loadedPromise=new M(function(e,t){window[i].onFlashReady=function(){n._loaded=!0,n.attachVideoEvents(i+".onFlashEvent"),e()},setTimeout(t,1e4)}),n}return jo(o,Ba),Bo(o,null,[{key:"displayName",get:function(){return"SWFScanner"}},{key:"supported",get:function(){return Ps.installed&&10.1<=Ps.version}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4","video/x-flv"]}}]),Bo(o,[{key:"deactivate",value:function(){this._swf.parentElement.removeChild(this._swf)}},{key:"play",value:function(){var e=this;return this._loadedPromise.then(function(){return e._swf._play()})}},{key:"pause",value:function(){var e=this;this.onLoaded(function(){return e._swf._pause()})}},{key:"attachVideoEvents",value:function(n){var i=this;Object.keys(Pa).forEach(function(e){var t=Pa[e];i._swf.api_addEventListener(t,n)})}},{key:"createSwf",value:function(e,t){var n=document.createElement("object");n.setAttribute("type","application/x-shockwave-flash"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("data",e);var i={flashvars:"ready="+t,movie:e,allowfullscreen:"true",allowscriptaccess:"always",bgcolor:"#000000",wmode:"opaque",quality:"high",scalemode:"noscale"};for(var r in i){var o=document.createElement("param");o.setAttribute("name",r),o.setAttribute("value",i[r]),n.appendChild(o)}return n}},{key:"onEvent",value:function(e){"function"==typeof this["on"+e.type]&&!1===this["on"+e.type](e)||this.fire(e.type,e)}},{key:"onLoaded",value:function(e){this._loadedPromise=this._loadedPromise.then(e)}},{key:"onerror",value:function(){switch(this._swf.getError().code){case 1:return this.fire(Pa.ERROR,new TelecineError("MediaAbortedError","The user agent aborted the fetching of the media.")),!1;case 2:return this.fire(Pa.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")),!1;case 3:return this.fire(Pa.ERROR,new TelecineError("MediaDecodeError","The media could not be decoded.")),this._switchToNextFile(),!1;case 4:return this.fire(Pa.ERROR,new TelecineError("MediaSrcNotSupportedError","The media was not suitable.")),this._switchToNextFile(),!1;default:return this.fire(Pa.ERROR,new TelecineError("MediaUnknownError","An unknown error occurred.")),!1}}},{key:"buffered",get:function(){if(!this._loaded)return No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"buffered",this);var e=this._swf.getBuffered();return xa(e.start,e.end)}},{key:"currentFile",get:function(){return No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"currentFile",this)},set:function(n){var i=this,r=this._currentFile;Vo(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"currentFile",n,this),this.onLoaded(function(){var e=!i._swf.getPaused(),t=i._swf.getCurrentTime();i._swf.setSrc(n.src),i.fire(Ra.CURRENT_FILE_CHANGE,n),r&&(i._swf.setCurrentTime(t),e&&i._swf._play())})}},{key:"currentTime",get:function(){return this._loaded?this._swf.getCurrentTime():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"currentTime",this)},set:function(e){var t=this;this.onLoaded(function(){return t._swf.setCurrentTime(e)})}},{key:"duration",get:function(){return this._loaded?this._swf.getDuration():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"duration",this)}},{key:"ended",get:function(){return this._loaded?this._swf.getEnded():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"ended",this)}},{key:"loop",get:function(){return this._loaded?this._swf.getLoop():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"loop",this)},set:function(e){var t=this;this.onLoaded(function(){return t._swf.setLoop(e)})}},{key:"muted",get:function(){return this._muted},set:function(e){var t=this,n=!0===(this._muted=e)?0:this._volume;this.onLoaded(function(){return t._swf.setVolume(n)})}},{key:"paused",get:function(){return this._loaded?this._swf.getPaused():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"paused",this)}},{key:"videoWidth",get:function(){return this._loaded?this._swf.getVideoWidth():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"videoWidth",this)}},{key:"videoHeight",get:function(){return this._loaded?this._swf.getVideoHeight():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"videoHeight",this)}},{key:"volume",get:function(){return this._loaded?this._swf.getVolume():No(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"volume",this)},set:function(e){var t=this;this._volume=e,this.onLoaded(function(){return t._swf.setVolume(e)})}}]),o}(),Os=new Io,Rs=new Io,TelecineFile=function(){function TelecineFile(e,t){var n=e.src,i=e.mime,r=e.id,o=void 0===r?ya():r,a=e.priority,s=void 0===a?0:a,l=e.metadata,u=void 0===l?{}:l;if(Fo(this,TelecineFile),!n)throw new TypeError("Must provide a src for the file.");if(!i)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:i,enumerable:!0},id:{value:""+o,enumerable:!0},metadata:{value:u,enumerable:!0}}),this.video=t,this.priority=s,this.src=n}return Bo(TelecineFile,[{key:"priority",get:function(){return Os.get(this)},set:function(e){if(!("number"==typeof(e=parseInt(e,10))&&isFinite(e)&&Math.floor(e)===e&&0<=e))throw new TypeError("The file priority must be an integer greater than or equal to 0.");Os.set(this,e)}},{key:"src",get:function(){return Rs.get(this)},set:function(e){Rs.set(this,e),this.video.fire(Ra.FILE_SRC_UPDATE,this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=e}}]),TelecineFile}(),Ms=["disabled","hidden","showing"],Is=["subtitles","captions","descriptions","chapters","metadata"],Ds=["ar","fa","he","iw","ku","ps","sd","ur","yi"],Fs=new Io,Bs=new Io,TelecineTextTrack=function(){function TelecineTextTrack(e,t){var n=e.kind,i=e.src,r=void 0===i?null:i,o=e.label,a=void 0===o?"":o,s=e.language,l=void 0===s?"":s,u=e.id,c=void 0===u?ya():u;if(Fo(this,TelecineTextTrack),-1===Is.indexOf(n))throw ua(12,"SYNTAX_ERR","Syntax Error");la(this),Object.defineProperties(this,{kind:{value:n,enumerable:!0},label:{value:a,enumerable:!0},language:{value:l,enumerable:!0},id:{value:""+c,enumerable:!0},rtl:{value:-1!==Ds.indexOf(l.substr(0,2)),enumerable:!0}}),this.video=t,this.src=r,this._modeHasBeenSet=!1,Fs.set(this,"disabled")}return Bo(TelecineTextTrack,[{key:"dispatchEvent",value:function(e){this.fire(e,{target:this})}},{key:"mode",get:function(){return Fs.get(this)},set:function(e){if(-1<Ms.indexOf(e)){if(this._modeHasBeenSet=!0,Fs.get(this)===e)return;Fs.set(this,e),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,e),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return Bs.get(this)},set:function(e){Bs.set(this,e),this.video.fire(Ra.TEXT_SRC_UPDATE,this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}}]),TelecineTextTrack}(),qs=function(){function n(e,t){Fo(this,n),this._cdms=e.cdms,this._lrToken=e.lr_token,this._userId=e.user,this._assetId=e.asset,this._useHls=t,this._licenseUrl=null,this._keySession=null,this._preferredKeySystem=null,this._encryptedEventName=null,this._boundGenerateRequest=this._generateRequest.bind(this)}return Bo(n,[{key:"init",value:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this._video=e._video,this._scanner=e,this._canHandleEME()?(this._licenseRequestMetadata=this._getLicenseRequestHeader(),this._getKeySystems(t).then(function(e){if(e.forEach(function(e){e.keySystem&&(n._preferredKeySystem=e)}),!n._preferredKeySystem)return n._scanner.fire(Ra.EME_UNSUPPORTED),!1;var t=n._getCdmFromSystem(n._preferredKeySystem);return n._encryptedEventName="encrypted",n._licenseUrl=t.license_url,n._useHls&&(n._certificateUrl=t.certificate_url,n._encryptedEventName="webkitneedkey"),n._video.addEventListener(n._encryptedEventName,n._boundGenerateRequest),n._useHls?n._video.webkitSetMediaKeys(n._preferredKeySystem.keySystem):n._video.mediaKeys?(n._keySession=n._video.mediaKeys.createSession(),n._keySession.addEventListener("message",function(e){return n._getLicense(e)})):(n._keySession=n._preferredKeySystem.keySystem.createSession(),n._keySession.addEventListener("message",function(e){return n._getLicense(e)}),n._video.setMediaKeys(n._preferredKeySystem.keySystem)),!0})):(this._scanner.fire(Ra.EME_UNSUPPORTED),!1)}},{key:"destroy",value:function(){this._keySession&&this._keySession.sessionId&&this._keySession.close(),this._video.removeEventListener(this._encryptedEventName,this._boundGenerateRequest)}},{key:"_generateRequest",value:function(n){var i=this;return"com.apple.fps.1_0"===this._preferredKeySystem.name?(this._loadFairPlayCertificate().then(function(e){i._contentId="assetId="+i._assetId;var t=i._concatInitDataIdAndCertificate(n.initData,i._contentId,e);return i._keySession=i._preferredKeySystem.keySystem.createSession("video/mp4",t),i._keySession.addEventListener("webkitkeymessage",function(e){return i._getLicense(e)},!1),e}).catch(function(e){i._scanner.fire(e.error,e.payload)}),!0):!this._keySession.sessionId&&!this._activeKeySession&&(this._activeKeySession=this._keySession.generateRequest(n.initDataType,n.initData).catch(function(){i._scanner.fire(Ra.DRM_FAILURE)}),!0)}},{key:"_getLicense",value:function(s){var l=this;return new M(function(i,r){l._activeKeySession=null;var o=new XMLHttpRequest;o.keySession=s.target,o.responseType="arraybuffer",o.open("POST",l._licenseUrl),o.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(l._licenseRequestMetadata)));var e=s.message;if("com.microsoft.playready"===l._preferredKeySystem.name){var t=l._unpackPlayReadyRequest(s.message),n=t[0];Object.keys(n).forEach(function(e){o.setRequestHeader([e],n[e])}),e=t[1]}if("com.apple.fps.1_0"===l._preferredKeySystem.name){var a=btoa(String.fromCharCode.apply(null,e));e="spc="+(a=encodeURIComponent(a))+"&"+l._contentId,o.setRequestHeader("Content-type","application/x-www-form-urlencoded")}o.onload=function(){if(403!==o.status)if(400<=o.status)r({error:"drmfailure"});else try{l._scanner.fire(Ra.DRM_AUTH_SUCCESS);var e=new Uint8Array(o.response),t=e.buffer;"com.apple.fps.1_0"===l._preferredKeySystem.name&&(t=l._unpackFairPlayLicenseResponse(btoa(String.fromCharCode.apply(null,e)))),o.keySession.update(t),i()}catch(e){r("Error updating key session: "+e)}else{var n=JSON.parse(o.getResponseHeader("x-dt-error-message"));r({error:"drmauthfailure",payload:{text:n.error,code:n.error_code}})}},o.onerror=r,o.send(e)}).catch(function(e){l._scanner.fire(e.error,e.payload)})}},{key:"_canHandleEME",value:function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys)}},{key:"_concatInitDataIdAndCertificate",value:function(e,t,n){"string"==typeof t&&(t=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0,r=e.length;i<r;i++)n[i]=e.charCodeAt(i);return n}(t));var i=0,r=new ArrayBuffer(e.byteLength+4+t.byteLength+4+n.byteLength),o=new DataView(r);new Uint8Array(r,i,e.byteLength).set(e),i+=e.byteLength,o.setUint32(i,t.byteLength,!0),i+=4;var a=new Uint8Array(r,i,t.byteLength);return a.set(t),i+=a.byteLength,o.setUint32(i,n.byteLength,!0),i+=4,new Uint8Array(r,i,n.byteLength).set(n),new Uint8Array(r,0,r.byteLength)}},{key:"_loadFairPlayCertificate",value:function(){var e=this;return new M(function(t,n){var i=new XMLHttpRequest;i.responseType="arraybuffer",i.open("GET",e._certificateUrl),i.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(e._licenseRequestMetadata))),i.onload=function(){if(403!==i.status)if(400<=i.status)n({error:"drmfailure"});else try{t(new Uint8Array(i.response))}catch(e){n(e)}else{var e=JSON.parse(i.getResponseHeader("x-dt-error-message"));n({error:"drmauthfailure",payload:{text:e.error,code:e.error_code}})}},i.onerror=n,i.send()})}},{key:"_getCdmFromSystem",value:function(t){var n=this,i=null;return Object.keys(this._cdms).forEach(function(e){t.name===n._cdms[e].id&&(i=n._cdms[e])}),i}},{key:"_unpackFairPlayLicenseResponse",value:function(e){var t=window.atob(e.trim());return"<ckc>"===t.substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6)),new Uint8Array(atob(t).split("").map(function(e){return e.charCodeAt(0)}))}},{key:"_unpackPlayReadyRequest",value:function(e){for(var t=String.fromCharCode.apply(null,new Uint16Array(e)),n=(new DOMParser).parseFromString(t,"application/xml"),i={},r=n.getElementsByTagName("HttpHeader"),o=0;o<r.length;++o){var a=r[o].querySelector("name"),s=r[o].querySelector("value");i[a.textContent]=s.textContent}var l=n.querySelector("Challenge");return[i,e=new Uint8Array(atob(l.textContent).split("").map(function(e){return e.charCodeAt(0)}))]}},{key:"_getLicenseRequestHeader",value:function(){var e={},t=window.screen.availWidth+"x"+window.screen.availHeight,n=window.devicePixelRatio;return e.merchant="vimeo",e.sessionId=JSON.stringify({ua:navigator.userAgent,token:this._lrToken,resolution:t,pixelRatio:n}),e.userId=this._userId,e}},{key:"_getKeySystems",value:function(e){var i=this,t=e.audio||[],n=e.video||[],r={persistentState:"optional",sessionTypes:["temporary"]};n.length&&(r.videoCapabilities=n.map(function(e){return{contentType:e}})),t.length&&(r.audioCapabilities=t.map(function(e){return{contentType:e}}));var o=Object.keys(this._cdms).map(function(e){var t=i._cdms[e].id;if(i._useHls){var n=null;try{n=new window.WebKitMediaKeys(t)}catch(e){}return M.resolve({name:t,keySystem:n})}return navigator.requestMediaKeySystemAccess(t,[r,{}]).then(function(e){return e.createMediaKeys()}).catch(function(e){}).then(function(e){return{name:t,keySystem:e}})});return M.all(o)}}]),n}(),Ns=new Io,TelecineVideo=function(){function TelecineVideo(e){var t=this,n=e.files,i=e.id,r=void 0===i?ya():i,o=e.title,a=void 0===o?null:o,s=e.subtitle,l=void 0===s?null:s,u=e.metadata,c=void 0===u?{}:u,d=e.textTracks,f=void 0===d?ma():d,h=e.externalDisplayFiles,v=void 0===h?{}:h;if(Fo(this,TelecineVideo),!n||!Array.isArray(n))throw new TypeError("Must provide files for the video.");la(this);var p=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return e.getFileById=pa,e}(n.map(function(e){return e instanceof TelecineFile?(e.video=t,e):new TelecineFile(e,t)})),m=ma(f.map(function(e){return e instanceof TelecineTextTrack?(e.video=t,e):new TelecineTextTrack(e,t)}));Object.keys(v).forEach(function(e){!v[e]||v[e]instanceof TelecineFile||(v[e]=new TelecineFile(v[e],t))}),Object.defineProperties(this,{id:{value:""+r,enumerable:!0},title:{value:a,enumerable:!0},subtitle:{value:l,enumerable:!0},metadata:{value:c,enumerable:!0},files:{value:p,enumerable:!0},textTracks:{value:m,enumerable:!0},externalDisplayFiles:{value:v,enumerable:!0}}),c.drm&&(this._drmHandler=new qs(c.drm,c.useHls))}return Bo(TelecineVideo,[{key:"deactivate",value:function(){var t=this;this._drmHandler&&this._drmHandler.destroy(),this.textTracks.forEach(function(e){return t.currentScanner.removeTextTrack(e)})}},{key:"drmHandler",get:function(){return this._drmHandler||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(e){this.currentScanner.currentFile=e}},{key:"currentScanner",get:function(){return Ns.get(this)},set:function(t){var n=this;this.currentScanner&&this.currentScanner.constructor.supportsTextTracks&&this.textTracks.forEach(function(e){return n.currentScanner.removeTextTrack(e)}),t.constructor.supportsTextTracks&&this.textTracks.forEach(function(e){return t.addTextTrack(e)}),Ns.set(this,t)}}]),TelecineVideo}(),js="pending",Us="started",Vs="ended",Hs="started",Ws=function(){function t(e){Fo(this,t),la(this),this.liveEvent=e,this._forcedPoll=!1,this._setupPolling()}return Bo(t,[{key:"forcePolling",value:function(){this.isForcePolling||(this._forcedPoll=!0,this._setupPolling())}},{key:"unforcePolling",value:function(){this._forcedPoll=!1}},{key:"_setupPolling",value:function(){this._shouldPollApp()?this._pollApp():this._shouldPoll()&&this._pollLiveApi()}},{key:"_shouldPoll",value:function(){return(this.liveEvent.status!==Vs||!this.liveEvent.archive||this.liveEvent.archive.status===Hs)&&(!!this.isForcePolling||this.liveEvent.status!==Us)}},{key:"_shouldPollApp",value:function(){return!this.liveEvent.sessionUrl||this.liveEvent.status===js&&null===this.liveEvent.id}},{key:"_request",value:function(r){return new M(function(t,n){var i=new XMLHttpRequest;i.open("GET",r,!0),i.onload=function(){if(200!==i.status)return n(i.status);try{var e=JSON.parse(i.response);return t(e)}catch(e){return n(new Error("Failed to parse request response: "+r+" "+e))}},i.onerror=function(){return n(new Error("Request error: "+r))},i.send()})}},{key:"_getSessionUrl",value:function(){var n=this;return new M(function(t,e){n._request(n.liveEvent.sessionRefreshUrl).then(function(e){n.liveEvent.sessionUrl=e.url,t(e.url)}).catch(e)})}},{key:"_pollLiveApi",value:function(){var i=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(!(3<t))return this._request(this.liveEvent.sessionUrl).then(function(e){if(e.status!==i.liveEvent.status){var t="liveevent"+e.status;try{i.fire(t,e)}catch(e){}}if(e.archive&&(!i.liveEvent.archive||e.archive.status!==i.liveEvent.archive.status)){var n="livearchive"+e.archive.status;i.fire(n,e)}i.liveEvent=Object.assign(i.liveEvent,e),i._shouldPoll()&&setTimeout(i._pollLiveApi.bind(i),5e3)}).catch(function(e){if("number"==typeof e&&410===e)return i._getSessionUrl.then(function(){setTimeout(i._pollLiveApi.bind(i,++t),5e3)})})}},{key:"_pollApp",value:function(){var t=this;return this._request(this.liveEvent.appPollUrl).then(function(e){return null!==e.ingest.session_id?(t.liveEvent.id=e.ingest.session_id,t._getSessionUrl().then(t._pollLiveApi.bind(t))):setTimeout(t._pollApp.bind(t),5e3)})}},{key:"isForcePolling",get:function(){return this._forcedPoll}}]),t}(),zs=function(){function i(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Fo(this,i),this._element=e,this._scanners=t,this._options=n,this._video=null,this._textTracks=ma(),this._properties={},this._currentScanner=new Ba,this._blacklistedScanners=[],this._activeEffects=[],this._options.liveEvent&&this.initLiveEvent(this._options.liveEvent),la(this)}return Bo(i,[{key:"supportsEffect",value:function(e){var t=this;return!!e.supported&&e.supportedScanners.some(function(e){return t._getScannerName(t._currentScanner)===e.displayName})}},{key:"getEffectByName",value:function(t){var n=this,i=null;return this._activeEffects.forEach(function(e){t===n._getEffectName(e)&&(i=e)}),i}},{key:"activateEffect",value:function(e,t){var n=new e(this,t);return n.activate(),this._activeEffects.push(n),n}},{key:"deactivateEffect",value:function(n){var i=this;this._activeEffects.some(function(e,t){return e.constructor===n&&(e.deactivate(),i._activeEffects.splice(t,1),!0)})}},{key:"deactivateEffects",value:function(){var t=this;this._activeEffects.forEach(function(e){return t.deactivateEffect(e.constructor)})}},{key:"play",value:function(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");var e=this._currentScanner.play();return this._properties.paused=!1,e}},{key:"pause",value:function(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this._currentScanner.pause(),this._properties.paused=!0,this}},{key:"getBitrateAtTime",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"video";return"MediaSourceScanner"!==this._getScannerName(this._currentScanner)&&"LiveScanner"!==this._getScannerName(this._currentScanner)?0:"audio"===t&&this._currentScanner._streams[t].length<=1?0:this._currentScanner.getBitrateAtTime(e,t)}},{key:"showExternalDisplayPicker",value:function(e){return this._currentScanner.showExternalDisplayPicker(e)}},{key:"supportsPresentationMode",value:function(e){return-1!==this.supportedPresentationModes.indexOf(e)}},{key:"addCuePoint",value:function(e,t){return this._currentScanner.addCuePoint(e,t)}},{key:"removeCuePoint",value:function(e){return this._currentScanner.removeCuePoint(e)}},{key:"removeAllCuePoints",value:function(){return this._currentScanner.removeAllCuePoints()}},{key:"_findScanner",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).textTrackSupport,t=void 0!==e&&e,n=this._video.files.map(function(e){return e.mime}),i=this._scanners,r=Array.isArray(i),o=0;for(i=r?i:i[dn.iterator]();;){var a;if(r){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}var s=a;if(s.supported)if(!t||s.supportsTextTracks)if(-1===this._blacklistedScanners.indexOf(this._getScannerName(s)))if(s.supportedVideoTypes.some(function(e){return-1!==n.indexOf(e)}))return s}return t?(this.fire(Pa.ERROR,new TelecineError("TextTracksNotSupported","None of the scanners support text tracks in this browser.")),this._blacklistedScanners=[],this._findScanner()):null}},{key:"_initScanner",value:function(e,t){var n=this;if(this._currentScanner.constructor!==e||this._currentScanner.video!==t){this._currentScanner.deactivate();var i=new e(this._element,this._options);Object.keys(Fa).forEach(function(e){var t=Fa[e];i.on(t,function(e){return n._handleEvent(t,e,i)})}),this._currentScanner=i,t.currentScanner=i,this._currentScanner.video=t;for(var r=Object.keys(this._properties),o=0;o<r.length;o++){var a=r[o];"paused"!==a?"currentTime"!==a&&(this._currentScanner[a]=this._properties[a]):!1===this._properties.paused&&this._currentScanner.play()}this.fire(Ra.SCANNER_CHANGE,this._getScannerName(this._currentScanner))}}},{key:"_updateScanner",value:function(){if(null!==this._video){var e=this._findScanner({textTrackSupport:0<this._video.textTracks.length});e?this._initScanner(e,this._video):this.fire(Pa.ERROR,new TelecineError("FilesNotPlayable","None of the files could be played in this browser."))}}},{key:"_handleEvent",value:function(t,e,n){if(n===this._currentScanner){switch(t){case Pa.ERROR:return void(e instanceof TelecineError&&this.fire(Pa.ERROR,e));case Ra.SCANNER_ERROR:this.fire(Pa.ERROR,new TelecineError("ScannerError","The current scanner can no longer be used because "+e.reason)),this._blacklistedScanners.push(this._getScannerName(this._currentScanner)),this._updateScanner([]);break;case Ra.FILE_ERROR:this.fire(Pa.ERROR,new TelecineError("FileError","The current file can no longer be used because "+e.reason)),this._currentScanner._switchToNextFile();break;case Ra.DOWNLOAD_ERROR:this.fire(Pa.ERROR,new TelecineError("DownloadError",e)),this._currentScanner._switchToNextFile();break;case Ra.EME_UNSUPPORTED:this.fire(Pa.ERROR,new TelecineError("DRMFailure",{text:null,code:"emeunsupported"}));break;case Ra.DRM_FAILURE:this.fire(Pa.ERROR,new TelecineError("DRMFailure",{text:null,code:null}));break;case Ra.DRM_AUTH_FAILURE:this.fire(Pa.ERROR,new TelecineError("DRMFailure",{text:e.text,code:e.code}));break;case Ra.DRM_AUTH_SUCCESS:this.fire(Ra.DRM_AUTH_SUCCESS);break;case Pa.TIME_UPDATE:this._properties.currentTime=this._currentScanner.currentTime;break;case Ra.MEDIA_URL_EXPIRED:this.fire(Pa.ERROR,new TelecineError("MediaUrlExpired",e));break;case Ia.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case Pa.ENDED:this._properties.paused=!0;break;case Pa.WAITING:this.fire(Pa.WAITING)}this._activeEffects.forEach(function(e){"function"==typeof e["on"+t]&&e["on"+t]()}),this.fire(t,e)}}},{key:"_getScannerName",value:function(e){return e instanceof Ba?e.constructor.displayName:e.prototype.constructor.displayName}},{key:"_getEffectName",value:function(e){return e instanceof zo?e.constructor.displayName:e.prototype.constructor.displayName}},{key:"initLiveEvent",value:function(e){var n=this;this._options.livePoller&&(this._options.livePoller=null);var i=new Ws(e);Object.keys(Ma).forEach(function(e){var t=Ma[e];i.on(t,function(e){n.fire(t,e)})}),this._options.livePoller=i}},{key:"supportsSettingVolume",get:function(){return this._scanners.some(function(e){return e.supported&&e.supportsSettingVolume})}},{key:"supportsPlaybackRate",get:function(){return this._currentScanner.constructor.supportsPlaybackRate}},{key:"supportsTextTracks",get:function(){return this._scanners.some(function(e){return e.supported&&e.supportsTextTracks})}},{key:"activeEffects",get:function(){return this._activeEffects}},{key:"isLowerProfileAvailable",get:function(){return this._currentScanner.isLowerProfileAvailable}},{key:"buffered",get:function(){return this._currentScanner.buffered}},{key:"manifestLoadDurations",get:function(){return this._currentScanner.manifestLoadDurations?this._currentScanner.manifestLoadDurations:[]}},{key:"successfulSegments",get:function(){return this._currentScanner.successfulSegments?this._currentScanner.successfulSegments:[]}},{key:"failedSegments",get:function(){return this._currentScanner.failedSegments?this._currentScanner.failedSegments:[]}},{key:"cuePoints",get:function(){return this._currentScanner.cuePoints}},{key:"currentFile",get:function(){return this._currentScanner.currentFile},set:function(t){if("string"==typeof t&&(t=this._files.filter(function(e){return e.id===t})[0]),!t)throw new TelecineError("FileNotValid","The file is not valid.");this._currentScanner.currentFile=t}},{key:"currentScanner",get:function(){return this._getScannerName(this._currentScanner)}},{key:"currentTime",get:function(){return this._currentScanner.currentTime},set:function(e){this._properties.currentTime=e,this._currentScanner.currentTime=e}},{key:"duration",get:function(){return this._currentScanner.duration}},{key:"ended",get:function(){return this._currentScanner.ended}},{key:"externalDisplayAvailable",get:function(){return this._currentScanner.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this._currentScanner.externalDisplayActive}},{key:"loop",get:function(){return this._currentScanner.loop},set:function(e){this._properties.loop=e,this._currentScanner.loop=e}},{key:"muted",get:function(){return this._currentScanner.muted},set:function(e){this._properties.muted=!!e,this._currentScanner.muted=!!e}},{key:"playsinline",get:function(){return this._currentScanner.playsinline},set:function(e){this._properties.playsinline=!!e,this._currentScanner.playsinline=!!e}},{key:"paused",get:function(){return this._currentScanner.paused}},{key:"defaultPlaybackRate",get:function(){return this._currentScanner.defaultPlaybackRate},set:function(e){this._properties.defaultPlaybackRate=e,this._currentScanner.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._currentScanner.playbackRate},set:function(e){this._properties.playbackRate=e,this._currentScanner.playbackRate=e}},{key:"preload",get:function(){return this._currentScanner.preload},set:function(e){this._properties.preload=e,this._currentScanner.preload=e}},{key:"presentationMode",get:function(){return this._currentScanner.presentationMode},set:function(e){this._currentScanner.presentationMode=e}},{key:"supportedPresentationModes",get:function(){return this._currentScanner.supportedPresentationModes}},{key:"video",get:function(){return this._video},set:function(e){this._video&&this._video.deactivate(),this._blacklistedScanners=[],this._video=new TelecineVideo(e),this._updateScanner()}},{key:"videoWidth",get:function(){return this._currentScanner.videoWidth}},{key:"videoHeight",get:function(){return this._currentScanner.videoHeight}},{key:"volume",get:function(){return this._currentScanner.volume},set:function(e){if(e<0||1<e)throw new TelecineError("IndexSizeError","Failed to set the 'volume' property: The volume provided ("+e+") is outside of the range [0, 1].");this._properties.volume=e,this._currentScanner.volume=e}}]),i}(),Gs=60,Ks=500,Ys=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Fo(this,i);var n=Uo(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n._activated=!1,n._camera=null,n._scene=null,n._renderer=null,n._animationFrame=null,n.isUserInteracting=!1,n._onMouseDownMouseX=0,n._onMouseDownMouseY=0,n._coordinates={lat:0,long:0},n._previousCoordinates={lat:0,long:0},n._onMouseDownCoordinates={lat:0,long:0},n._phi=0,n._theta=0,n._distance=Ks,n._video=n._telecine._currentScanner._video,n._rotation=0,n._gyroVector={x:0,y:0},n._offset={lat:0,long:0},n._writeSpeeds={videoFps:n._options.fps,motionRenderSpeed:Gs},n._maxTimeBetweenWrites=1e3/n._writeSpeeds.videoFps,n._motionTimeouts=[],n._movingAutomatically=!1,n._deviceMotionHasOccurred=!1,n._updateFromGyroscopePending=!1,n._keysPressed={up:!1,down:!1,left:!1,right:!1},n}return jo(i,zo),Bo(i,[{key:"isUserInteracting",set:function(e){e!==this._isUserInteracting&&((this._isUserInteracting=e)?this._options.isMobile||this._telecine.fire(Ia.MOTION_START):this._options.isMobile||this._telecine.fire(Ia.MOTION_END))},get:function(){return this._isUserInteracting}}],[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[Ya,ms]}}]),Bo(i,[{key:"activate",value:function(){var i=this;return new M(function(e,t){if(window.THREE)e();else{var n=document.createElement("script");n.src=i._options.threeUrl,document.body.appendChild(n),n.onload=function(){e()}}}).then(function(){return i._initialize()})}},{key:"_initialize",value:function(){this._activated=!0,this._camera=new THREE.PerspectiveCamera(this._options.fieldOfView,this._video.clientWidth/this._video.clientHeight,1,2*Ks),this._camera.target=new THREE.Vector3(0,0,0),this._initializeAutoMovement(this._options.directorTimeline),this._scene=new THREE.Scene;var e=new THREE.SphereBufferGeometry(Ks,120,80);e.scale(-1,1,1),this._texture=new THREE.VideoTexture(this._video),this._texture.minFilter=THREE.LinearFilter,this._texture.format=THREE.RGBFormat,"top-bottom"===this._options.stereoMode&&(this._texture.offset.y=.5,this._texture.repeat.set(1,.5)),"left-right"===this._options.stereoMode&&(this._texture.offset.x=.5,this._texture.repeat.set(.5,1));var t=new THREE.MeshBasicMaterial({map:this._texture}),n=new THREE.Mesh(e,t);this._scene.add(n);try{this._renderer=new THREE.WebGLRenderer}catch(e){return void this._telecine._currentScanner.fire(Ia.SPATIAL_UNSUPPORTED)}this._renderer.setPixelRatio(window.devicePixelRatio),this._output=document.createElement("div"),this._output.appendChild(this._renderer.domElement),this._element.appendChild(this._output),this._hideOutput(),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),this._startRendering(),this._telecine._currentScanner.paused||this._showOutput()}},{key:"onplay",value:function(){this._activated&&(this._showOutput(),this.adjustRenderSize())}},{key:"deactivate",value:function(){this._output&&this._element.removeChild(this._output),this._stopRendering(),this._activated=!1}},{key:"snapToCenter",value:function(){var t=this;this._motionTimeouts.forEach(function(e){return clearTimeout(e)});for(var n=((180<=this._coordinates.long?360:0)-this._coordinates.long)/11,i=(0-this._coordinates.lat)/11,e=function(e){t._motionTimeouts.push(setTimeout(function(){0===e&&(t._movingAutomatically=!0,t._options.isMobile||(t._maxTimeBetweenWrites=1e3/t._writeSpeeds.motionRenderSpeed)),49===e&&(t._movingAutomatically=!1,t._options.isMobile||(t._maxTimeBetweenWrites=1e3/t._writeSpeeds.videoFps)),t._updateViewpoint(t._coordinates.lat+i/Math.pow(1.1,e),t._coordinates.long+n/Math.pow(1.1,e)),t._offset.lat=THREE.Math.radToDeg(t._gyroVector.x)+t._coordinates.lat+i/Math.pow(1.1,e),t._offset.long=THREE.Math.radToDeg(t._gyroVector.y)+t._coordinates.long+i/Math.pow(1.1,e)},e*t._maxTimeBetweenWrites))},r=this._rotation=0;r<50;r++)e(r)}},{key:"activateStereoRendering",value:function(){this._stereo||(this._stereo=new THREE.StereoCamera,this._stereo.aspect=.5,this._renderer.setSize(this._video.clientWidth,this._video.clientHeight),this.adjustRenderSize(),"mono"!==this._options.stereoMode&&this._buildStereoAssets(),this._renderStereoScene())}},{key:"deactivateStereoRendering",value:function(){this._renderer.render(this._scene,this._camera),this._stereo=null,this.adjustRenderSize(),this._update()}},{key:"toggleStereoRendering",value:function(){this._stereo?this.deactivateStereo():this.activateStereo()}},{key:"isStereo",value:function(){return!!this._stereo}},{key:"_buildStereoAssets",value:function(){for(var e in this._stereoAssets={left:{scene:new THREE.Scene,geometry:new THREE.SphereBufferGeometry(Ks,120,80),texture:new THREE.VideoTexture(this._video)},right:{scene:new THREE.Scene,geometry:new THREE.SphereBufferGeometry(Ks,120,80),texture:new THREE.VideoTexture(this._video)}},this._stereoAssets)this._stereoAssets[e].texture.minFilter=THREE.LinearFilter,this._stereoAssets[e].texture.format=THREE.RGBFormat,this._stereoAssets[e].texture.offset.y=.5,this._stereoAssets[e].texture.repeat.set(1,.5),this._stereoAssets[e].material=new THREE.MeshBasicMaterial({map:this._stereoAssets[e].texture}),this._stereoAssets[e].mesh=new THREE.Mesh(this._stereoAssets[e].geometry,this._stereoAssets[e].material),this._stereoAssets[e].geometry.scale(-1,1,1),this._stereoAssets[e].scene.add(this._stereoAssets[e].mesh)}},{key:"_initializeAutoMovement",value:function(e){e&&e[0]&&void 0!==e[0].p&&"undefined"!==e[0].y&&this._updateViewpoint(e[0].p,e[0].y)}},{key:"_renderStereoScene",value:function(){this._scene.updateMatrixWorld(),null===this._camera.parent&&this._camera.updateMatrixWorld(),this._stereo.update(this._camera);var e=this._renderer.getSize();this._renderer.autoClear&&this._renderer.clear(),this._renderer.setScissorTest(!0);var t=this._stereoAssets?{right:this._stereoAssets.right.scene,left:this._stereoAssets.left.scene}:{right:this._scene,left:this._scene};this._renderer.setScissor(0,0,e.width/2,e.height),this._renderer.setViewport(0,0,e.width/2,e.height),this._renderer.render(t.right,this._stereo.cameraR),this._renderer.setScissor(e.width/2,0,e.width/2,e.height),this._renderer.setViewport(e.width/2,0,e.width/2,e.height),this._renderer.render(t.left,this._stereo.cameraL),this._renderer.setScissorTest(!1)}},{key:"_updateViewpoint",value:function(e,t){this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,e%=360,this._coordinates.lat=Math.max(-85,Math.min(85,e)),t=0<=(t%=360)?t:360+t,this._coordinates.long=t}},{key:"makeContact",value:function(e){this.isUserInteracting=!0,this._motionTimeouts.forEach(function(e){return clearTimeout(e)}),this._movingAutomatically=!1,this._contactPoint={x:e.x,y:e.y},this._onMouseDownCoordinates.long=this._coordinates.long,this._onMouseDownCoordinates.lat=this._coordinates.lat,this._motionStart={long:this._coordinates.long,lat:this._coordinates.lat},this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)}},{key:"move",value:function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;var t=this._motionStart.lat-.2*(this._contactPoint.y-e.y),n=.2*(this._contactPoint.x-e.x)+this._motionStart.long;this._updateViewpoint(t,n)}},{key:"moveWheel",value:function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;var t=this._coordinates.lat-.1*e.y,n=this._coordinates.long+.1*e.x;this._updateViewpoint(t,n)}},{key:"moveDevice",value:function(e,t,n,i){this._updateFromGyroscopePending=!0;var r=new THREE.Quaternion,o=window.orientation;null===o&&(o=this._video.clientWidth>this._video.clientHeight?90:0),e=e?THREE.Math.degToRad(e):0,t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0;var a=o?THREE.Math.degToRad(o):0,s=new THREE.Vector3(0,0,1),l=new THREE.Euler,u=new THREE.Quaternion,c=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));l.set(t,e,-n,"YXZ"),r.setFromEuler(l),r.multiply(c),r.multiply(u.setFromAxisAngle(s,-a)),this._gyroVector=(new THREE.Euler).setFromQuaternion(r,"YXZ"),this._rotation=this._gyroVector.z,this.isUserInteracting||this._movingAutomatically||this._updateViewpoint(THREE.Math.radToDeg(this._gyroVector.x)-this._offset.lat,-THREE.Math.radToDeg(this._gyroVector.y)+this._offset.long),this._deviceMotionHasOccurred||(this.snapToCenter(),this._telecine.fire(Ia.MOTION_START),this._deviceMotionHasOccurred=!0)}},{key:"releaseContact",value:function(e){if(this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)-this._coordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long,this.isUserInteracting=!1,this._motionStart&&!e){var t=Math.hypot(this._coordinates.long-this._motionStart.long,this._coordinates.lat-this._motionStart.lat);this._moveDueToMomentum(t)}}},{key:"abandonMotion",value:function(){this.isUserInteracting=!1,this._motionStart=null}},{key:"keyPress",value:function(e){this._keyIsDown()||(this.isUserInteracting=!0,this._motionTimeouts&&this._motionTimeouts.forEach(function(e){return clearTimeout(e)})),this._keysPressed[e]||(this._keysPressed[e]=!0)}},{key:"keyUp",value:function(e){this._keysPressed[e]=!1,this._keyIsDown()||(this.isUserInteracting=!1,this._moveDueToMomentum(1/0))}},{key:"_moveFromKeyPress",value:function(){var t=this;Object.keys(this._keysPressed).forEach(function(e){if(t._keysPressed[e])switch(e){case"up":t._updateViewpoint(t._coordinates.lat+2,t._coordinates.long);break;case"down":t._updateViewpoint(t._coordinates.lat-2,t._coordinates.long);break;case"left":t._updateViewpoint(t._coordinates.lat,t._coordinates.long-2);break;case"right":t._updateViewpoint(t._coordinates.lat,t._coordinates.long+2)}})}},{key:"_keyIsDown",value:function(){var t=this;return Object.keys(this._keysPressed).map(function(e){return t._keysPressed[e]}).some(function(e){return e})}},{key:"_moveDueToMomentum",value:function(i){var r=this;20<=i&&function(){var n={long:r._coordinates.long-r._previousCoordinates.long,lat:r._coordinates.lat-r._previousCoordinates.lat};i===1/0&&(n.long/=2,n.lat/=2);for(var e=function(t){r._motionTimeouts.push(setTimeout(function(){1===t&&(r._movingAutomatically=!0),49===t&&(r._movingAutomatically=!1,r._maxTimeBetweenWrites=1e3/r._writeSpeeds.videoFps);var e=2/Math.pow(t,1.5);r._offset.lat=THREE.Math.radToDeg(r._gyroVector.x)+r._coordinates.lat+n.lat,r._offset.long=THREE.Math.radToDeg(r._gyroVector.y)+r._coordinates.long+n.long,r._updateViewpoint(r._coordinates.lat+n.lat*e,r._coordinates.long+n.long*e)},t*r._maxTimeBetweenWrites))},t=1;t<50;t++)e(t)}()}},{key:"onseeked",value:function(){this._activated&&this._update()}},{key:"onresize",value:function(){this.adjustRenderSize(),this.isUserInteracting=!1}},{key:"_update",value:function(){this._phi=THREE.Math.degToRad(90+this._coordinates.lat),this._theta=THREE.Math.degToRad(this._coordinates.long),this._camera.position.x=this._distance*Math.sin(this._phi)*Math.cos(this._theta),this._camera.position.y=this._distance*Math.cos(this._phi),this._camera.position.z=this._distance*Math.sin(this._phi)*Math.sin(this._theta),this._camera.lookAt(this._camera.target),this._camera.rotation.z+=this._rotation,this._stereo?this._renderStereoScene():this._renderer.render(this._scene,this._camera),this._telecine.fire(Ia.CAMERA_UPDATE,{lon:this._coordinates.long,lat:this._coordinates.lat})}},{key:"adjustRenderSize",value:function(){this._camera.aspect=Math.max(1/3,Math.min(3,this._video.clientWidth/this._video.clientHeight)),this._distance=Math.min(Ks/2,this._options.dimensions.width/this._options.dimensions.height/this._camera.aspect*Ks/2);var e=wa(this._video.clientWidth,this._video.clientHeight,this._camera.aspect,1);this._camera.aspect=e.width/e.height,this._camera.updateProjectionMatrix(),this._renderer.setSize(e.width,e.height),this._output.style.paddingTop=e.top+"px",this._renderer.render(this._scene,this._camera)}},{key:"getRendererSize",value:function(){return{height:this._renderer.domElement.clientHeight,width:this._renderer.domElement.clientWidth}}},{key:"_startRendering",value:function(){var e=this;this._interval&&window.clearInterval(this._interval),this.adjustRenderSize();var t=1e3/Gs;this._interval=window.setInterval(function(){e._renderFrame(),e._keyIsDown()&&e._moveFromKeyPress()},t)}},{key:"_stopRendering",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=null),this._motionTimeouts&&this._motionTimeouts.forEach(function(e){return clearTimeout(e)})}},{key:"_renderFrame",value:function(){this._requestRenderAnimationFrame()}},{key:"_requestRenderAnimationFrame",value:function(){var e=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame);var t=this._movingAutomatically||this.isUserInteracting||this._updateFromGyroscopePending||this._keyIsDown();this._animationFrame=window.requestAnimationFrame(function(){(!e._telecine._currentScanner.paused&&!e._telecine._currentScanner._ranIntoBuffer||t)&&(e._update(),e._updateFromGyroscopePending=!1)})}},{key:"_showOutput",value:function(){this._styleOutput({backgroundColor:"#000",display:"block"})}},{key:"_hideOutput",value:function(){this._styleOutput({backgroundColor:"#000",display:"none"})}},{key:"_styleOutput",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.backgroundColor,n=e.display;this._output.style.cssText="position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:"+t+";width:100%;height:100%;text-align:center;display:"+n}},{key:"currentCoordinates",get:function(){return this._coordinates},set:function(e){var t=Ho(e,2),n=t[0],i=t[1];if(90<n||n<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(i<0||360<i)throw new RangeError("Longitude should be a float between 0 and 360.");this._updateViewpoint(n,i),this._update()}},{key:"fieldOfView",get:function(){return this._camera.fov},set:function(e){this._camera.fov=e,this._camera.updateProjectionMatrix(),this._renderer.render(this._scene,this._camera)}}],[{key:"frustumSurfaceArea",value:function(e,t,n){var i=2*Ks*2*Math.sin(Math.PI/180*(e/2));return i*(i*t/n)/(4*Math.PI*Math.pow(Ks,2))}}]),i}(),Xs="LIVE_SET_STATUS",$s="LIVE_ARCHIVE_SET_STATUS",Qs="LIVE_UPDATE",Js=function(e){return{type:Xs,payload:e}},Zs=function(e){return{type:Qs,payload:e}};function el(e){return e.replace(/(_\w)/g,function(e){return e[1].toUpperCase()})}function tl(e){return function n(i,r){return Object.keys(r).reduce(function(e,t){return r[t]&&"object"===Kn(r[t])?e[i(t)]=n(i,r[t]):e[i(t)]=r[t],e},{})}(el,e)}var nl="CONFIG_LOAD",il=function(e){return{type:nl,payload:Qn({},tl(e))}};function rl(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=t.type,i=t.payload;switch(n){case nl:var r=i.video.liveEvent;return Qn({},e,{liveStatus:r?r.status:null,liveArchiveStatus:r&&r.archive?r.archive.status:null});case Qs:return Qn({},e,{liveStatus:i?i.status:null,liveArchiveStatus:i&&i.archive?i.archive.status:null});case Xs:return Qn({},e,{liveStatus:i});case $s:return Qn({},e,{liveArchiveStatus:i});default:return e}}var ol=function(e){return!!e.ui.liveEvent.liveStatus&&null!==e.ui.liveEvent.liveStatus},al=function(e){return ol(e)&&e.ui.liveEvent.liveStatus===ui.pending},sl=function(e){return ol(e)&&e.ui.liveEvent.liveStatus===ui.active},ll=function(e){return ol(e)&&e.ui.liveEvent.liveStatus===ui.started},ul=function(e){return ol(e)&&e.ui.liveEvent.liveStatus===ui.ended},cl=function(e){return ol(e)&&!ul(e)},dl=function(e){return ol(e)&&e.ui.liveEvent.liveArchiveStatus===li},fl=Object.freeze({default:rl,liveExists:ol,isLivePending:al,isLiveActive:sl,isLiveStarted:ll,isLiveEnded:ul,liveInProgress:cl,isLiveArchived:dl});function hl(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=t.type,i=t.payload;switch(n){case nl:return Qn({},e,i.video.liveEvent);case Qs:return Qn({},e,i);default:return e}}var vl=function(e){return ol(e)&&e.liveEvent.playback?e.liveEvent.playback.dash_noredirect:null},pl=function(e){return ol(e)&&e.liveEvent.playback?e.liveEvent.playback.hls:null},ml=function(e){return ol(e)&&e.liveEvent.ingest?e.liveEvent.ingest.scheduledStartTime:null},gl=Object.freeze({default:hl,dashLiveUrl:vl,hlsLiveUrl:pl,scheduledLiveStartTime:ml});function yl(e,t){if(!document.getElementById(e)){var n=document.createElement("script");n.setAttribute("id",e),n.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(n)}}var _l=function(){return{id:"error",title:"Player error",message:"The player is having trouble. We’ll have it back up and running as soon as possible.",modal:!0,final:!0}},bl=Object.freeze({BrowserNotSupported:function(){return{id:"not-supported",title:"Unsupported viewing environment",message:'Your system is having trouble playing this video. For more information, see our <a href="https://help.vimeo.com/hc/en-us/articles/115015677227-Troubleshoot-player-error-messages" target="_blank" rel="noopener">Help Center</a>.',deferred:!0,final:!0}},DRMFailure:function(){return{id:"drm-failure",title:"Rights issue",message:"We’re having trouble authorizing playback for this video. ",final:!0}},FilesNotPlayable:function(){return{id:"not-supported",title:"Unsupported viewing environment",message:'Your system is having trouble playing this video. For more information, see our <a href="https://help.vimeo.com/hc/en-us/articles/115015677227-Troubleshoot-player-error-messages" target="_blank" rel="noopener">Help Center</a>.',deferred:!0,final:!0}},MediaSrcNotSupportedError:function(){return{id:"not-supported",final:!1}},MediaDecodeError:function(){return{id:"decode",final:!1}},MediaNetworkError:function(){return{id:"network",title:"Network error",message:'A network hiccup interrupted playback. Please <a href="javascript:window.location.reload()" rel="noopener">reload the player</a> and try again.',final:!0}},MediaUnknownError:function(){return{id:"unknown",title:"Browser error",message:'We’re having trouble playing this video file. Please <a href="javascript:window.location.reload()" rel="noopener">reload the player</a> and try again.',final:!0}},FileError:function(){return{id:"telecine-file-error",final:!1}},DownloadError:function(){return{id:"telecine-download-error",final:!1}},MediaUrlExpired:function(){return{id:"media-url-expired",title:"Playback error",message:'We’re having trouble playing this video. Please <a href="javascript:window.location.reload()" rel="noopener">reload the player</a> and try again.',final:!1}},ScannerError:function(){return{id:"scanner-error",final:!1}},PlayerError:_l});function wl(e){var t=e.fps;return"metadata"in e&&(t=e.metadata.fps),30<t}function kl(e){return e.quality||e.metadata.quality}function Sl(e){return"string"!=typeof e&&(e=kl(e)),parseInt(e,10)}function El(e){return 720<=Sl(e)}function Tl(e){var t=Ut(e).filter(wl).map(kl);return function(e){return!(-1!==t.indexOf(kl(e))&&!wl(e))}}function xl(n){return function(e){if(!n.length)return!0;var t="number"!=typeof e.id?parseInt(e.id,10):e.id;return-1!==n.indexOf(t)}}function Al(e){return"object"!==(void 0===e?"undefined":Kn(e))?0:"fps"in e?e.fps:"metadata"in e&&"fps"in e.metadata?e.metadata.fps:0}function Ll(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"desc";return function(e,t){var n=Sl(e),i=Al(e),r=Sl(t),o=Al(t);return"asc"===a?n-r||i-o:r-n||o-i}}function Pl(e){var t=kl(e),n={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(var i in n)t=t.replace(i,n[i]);return t}var Cl="app.vimeo.com/",Ol="key_live_jpj6Duy53e6MhounkriNljdgsBhGbf0d";function Rl(e,t){return function(e){var t,n={feature:1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,$deeplink_path:Cl+e,$always_deeplink:!0,ref:"player",context:"player"},i=[];for(var r in n)i.push(encodeURIComponent(r)+"="+encodeURIComponent(n[r]));return t=i.join("&"),"https://bnc.lt/a/"+Ol+"?"+t}("videos/"+e,t)}function Ml(m,g,t){var s,r,o,a,c=t.querySelector(".vp-video"),l=t.querySelector(".vp-telecine"),d=null,u=null,e=!1,f=m.config.embed.playsinline&&(Te.mobileAndroid||10<=Te.iOS),h=!m.config.embed.playsinline&&(Te.mobileAndroid||Te.iOS&&!Te.iPad),n=8<=Te.iOS&&!Te.iPad,i=!1,v=!1,p=!1,y=!1,_=!1,b=!1,w=!1,k=!1,S=!1,E=!1,T=!1,x=!0,A=null,L=!1,P=!1,C=!1,O=!1,R=!1,M=null,I=!1,D=!1,F=[];function B(){m.events.fire(si.bufferStarted,{initial:!0}),_=b=!0}function q(){_&&(m.events.fire(si.bufferEnded),_=b=!1)}function N(e){l.classList.remove("invisible"),m.events.fire(si.playInitiated),B()}function j(){if("disable"!==m.config.video.privacy&&m.config.video.spatial&&Te.iOS&&!D||l.classList.remove("invisible"),A)return m.events.fire(si.error,A),void m.preview.show();if(v=i=!0,L)m.preview.show();else{if(d.off(Pa.PLAY,N),!y){if(m.config.video.spatial&&Te.iOS&&!D)return D=!0,m.events.fire(oi.showOverlay,"app-redirect",{redirectUrl:m.doNotTrackEnabled?"https://itunes.apple.com/us/app/apple-store/id425194759?mt=8":Rl(m.config.video.id,"player-spatial-redirect"),title:null,buttonText:"Watch in the Vimeo app",ignoreText:null,bottomText:"360 not supported in this browser",newWindow:!m.config.embed.on_site}),void d.once(Pa.PLAY,N);m.events.fire(si.playInitiated),B(),y=!0,d.play(),!m.config.user.progress||e||!m.config.embed.settings.playbar||m.config.embed.autoplay||m.config.embed.time||(d.currentTime=m.config.user.progress,m.config.user.progress=0)}g.get(ll)&&d.paused&&(m.events.fire(si.controlbarBufferStarted),_=!0),h&&(C=!0,m.events.fire(oi.forceFullscreen)),T&&U()}}function U(){S||L||(E=b=!1,v&&d.paused&&(s&&(d.currentTime=s,s=null),d.play()))}function V(e,t){var n=e.length-1;if(1<e.length)for(var i=0,r=e.length;i<r;i++)if(e.start(i)<=t&&e.end(i)>=t){n=i;break}return n}function H(e){if(!x&&d.buffered&&0<d.buffered.length){e=e||d.currentTime;var t=V(d.buffered,e),n=d.buffered.end(t),i=n/d.duration;if(m.events.fire(si.loadProgress,n,d.duration,i),_&&v&&n===d.duration)return void U()}}function W(e){for(var t=e.target,n=t.activeCues,i=[],r=void 0,o=0,a=n.length;o<a;o++)""!==n[o].text.replace(/^\s+|\s+$/gm,"")&&((r=document.createElement("span")).appendChild(n[o].getCueAsHTML()),i.push({html:r.innerHTML.replace("\n","<br>"),text:n[o].text}));m.events.fire(si.cueChanged,t,i)}function z(){var e=m.config.request,t=e.signature,n=e.timestamp,i=e.expires,r=g.get("liveEvent");return wo(r)?null:Object.assign({},r,{appPollUrl:"https://"+m.config.vimeo_url+"/live_event/status?clip_id="+m.config.video.id,playlistRefreshUrl:"https://"+m.config.player_url+"/live/"+m.config.video.id+"/playlist/refresh?signature="+t+"&time="+n+"&expires="+i,sessionRefreshUrl:"https://"+m.config.player_url+"/live/"+m.config.video.id+"/session/refresh?signature="+t+"&time="+n+"&expires="+i})}function G(e){switch(e){case ui.started:if(Z(),l.classList.remove("invisible"),m.events.fire(si.liveEventStarted),Te.android||Te.iOS)return;m.events.fire(si.playButtonPressed);break;case ui.ended:m.events.fire(si.liveEventEnded),m.events.fire(si.ended);break;case ui.active:m.events.fire(si.liveEventActive)}}function K(){var e="none";("metadata"===m.config.request.flags.preload_video||h||8<=Te.iOS)&&(e="metadata"),"auto"===m.config.request.flags.preload_video&&(e="metadata","MediaSourceScanner"===d.currentScanner&&(e="auto")),d.preload=e,m.events.on(si.mousedOver,function(){m.config.request&&"metadata_on_hover"===m.config.request.flags.preload_video&&!y&&m.verifyConfig().then(function(){return d.preload="metadata",!0}).catch(function(e){})})}function Y(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return m.config.embed.on_site||Te.android||Te.iOS||Te.windowsPhone||m.config.video.vod||!e?null:t.length&&-1===t.indexOf(e)?null:(m.events.fire(si.forcedQuality,e),e)}function X(e){if("auto"===e)return d.video.currentFile.restrictedStreamIndexes=[],void(I=!1);var t=Ut(m.config.request.files.dash.streams).filter(xl(F)).sort(Ll("asc")).map(function(e){return e.quality}).indexOf(e);-1!==t&&(sr.captureBreadcrumb("Switched to "+e,{},"video"),d.video.currentFile.restrictedStreamIndexes=[t],I=t)}function $(){var e=m.config.request.files,t=!!(m.config.request.ab_tests&&m.config.request.ab_tests.live_hls&&m.config.request.ab_tests.live_hls.group);if(e.hls&&(Te.iOS||t)){var n=e.hls.default_cdn,i=e.hls.cdns[n].url?e.hls.cdns[n].url:g.get(pl,null);return{id:"hls-"+n+"-"+m.config.video.id,src:i,mime:ri.hlsLive,priority:t?1:2,metadata:{cdn:n,origin:e.hls.cdns[n].origin,quality:"sd"}}}return null}function Q(){var e=[],t=function(){var e=m.config.request.files;if(!e.dash)return null;var t=e.dash.default_cdn,n=e.dash.cdns[t].url?e.dash.cdns[t].url:g.get(vl,null),i=!!(m.config.request.ab_tests&&m.config.request.ab_tests.live_hls&&m.config.request.ab_tests.live_hls.group);return{id:"dash-"+t+"-"+m.config.video.id,src:n,mime:g.get(dl)?ri.dash:ri.dashMpd,priority:i?2:1,metadata:{cdn:t,origin:e.dash.cdns[t].origin,quality:"sd"}}}();t&&e.push(t);var n=$();return n&&e.push(n),e}function J(){if(g.get(ll)||g.get(dl))return yl("m3u8-parser",m.config.request.urls.m3u8_parser_url),yl("muxjs",m.config.request.urls.muxer_url),Q();var e=m.config.request.files,t=Ut(e.progressive).filter(xl(F)).filter(Tl(e.progressive)),n=t.some(El);Te.mobileAndroid&&(n=!1);var i="720p";if(n){var r=Ut(t).map(kl);-1!==r.indexOf("1080p")&&-1===r.indexOf("720p")&&(i="1080p")}var o=m.config.request.cookie.hd||m.config.video.default_to_hd?i:"360p",a=t.map(function(e){return e.quality}),s=Y(m.config.embed.quality,a),l=function(e){var t=e.files,n=void 0===t?[]:t,i=e.preference,r=void 0===i?"360p":i,o=e.priorityOffset,a=void 0===o?0:o;(n=Ut(n)).sort(Ll());var s=n.map(kl);if(r){-1===s.indexOf(r)&&(s.push(r),s.sort(function(e,t){return Sl(t)-Sl(e)}));var l=s.indexOf(r),u=s.splice(0,l);u.reverse(),s.push.apply(s,u)}return n.map(function(e){return{id:e.id,src:e.url,mime:e.mime,priority:s.indexOf(e.quality)+1+a,metadata:{profile:e.profile,cdn:e.cdn,origin:e.origin,quality:e.quality,fps:e.fps}}})}({files:t,preference:m.config.request.cookie.quality||s||o,priorityOffset:2}),u=m.config.request.drm&&Te.browser.safari;if(e.hls&&(Te.iPhone||Te.iPad)||u){var c=e.hls.default_cdn,d=e.hls.cdns[c].url;if(0<F.length){var f=/\/(((\d+),?)+)\/master\.m3u8/.exec(d);null!==f&&(d=d.replace(f[1],F.join(",")))}l.push({id:"hls-"+c+"-"+m.config.video.id,src:d,mime:ri.hls,priority:2,metadata:{cdn:c,origin:e.hls.cdns[c].origin,quality:"sd"}})}if(e.dash&&!u)for(var h in e.dash.cdns){var v=e.dash.cdns[h].url;if(0<F.length){var p=/\/(((\d+),?)+)\/master\.json/.exec(v);null!==p&&(v=v.replace(p[1],F.join(",")))}l.push({id:"dash-"+h+"-"+m.config.video.id,src:v,mime:ri.dash,priority:h===e.dash.default_cdn?1:2,metadata:{cdn:h,origin:e.dash.cdns[h].origin,quality:"sd"}})}return l}function Z(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(!(g.get(al)||g.get(sl)||g.get(ul)&&!g.get(dl))&&(!g.get(ll)||e)){var t,n;D=!1,t=m.config.video.file_codecs,n=[],null!==t&&(0<t.hevc.sdr.length||0<t.hevc.hdr.length)&&(n=Te.hdr&&0<t.hevc.hdr.length?t.hevc.hdr:Te.hevc&&0<t.hevc.sdr.length?t.hevc.sdr:t.avc),m.events.fire(si.hevcRestrictedStreams,n),F=n;var i=J(),r="text_tracks"in m.config.request?m.config.request.text_tracks.map(function(e){return{id:e.id,src:e.url,kind:e.kind,label:e.label,language:e.lang}}):[];if(d.video&&!e)return i.forEach(function(e){var t=d.video.files.getFileById(e.id);t&&(t.src=e.src)}),void r.forEach(function(e){var t=d.video.textTracks.getTrackById(e.id);t&&(t.src=e.src)});var o=Dn(c);if(d.video={id:m.config.video.id,title:m.config.video.title,subtitle:"from "+m.config.video.owner.name,files:i,textTracks:r,externalDisplayFiles:{AirPlay:function(){var e=m.config.request.files;if(e.hls){if(g.get(ll))return $();var t=e.hls.default_cdn,n=e.hls.cdns[t].url;return e.hls.cdns[t].captions&&(n=e.hls.cdns[t].captions),{src:n,mime:ri.hls,metadata:{cdn:m.config.request.files.hls.cdn,origin:m.config.request.files.hls.origin,quality:"sd"}}}return null}()},metadata:{thumbnail:m.config.video.thumbs[640],useHls:m.config.request.drm&&Te.browser.safari,drm:m.config.request.drm,percentShown:Ys.frustumSurfaceArea(m.config.video.spatial.fov,o.width,o.height)}},d.playsinline=f,d.muted=m.config.embed.muted,0!==r.length)if(d.video.textTracks.forEach(function(t){t.on("cuechange",W),t.on("modechange",function(e){C&&"showing"===t.mode&&m.events.fire(si.captionsChanged,t)})}),null===m.config.request.cookie.captions||"null"===m.config.request.cookie.captions){if(m.config.video.lang){var a=m.config.request.lang.split(/[-_]/),s=Jn(a,1)[0],l=m.config.video.lang.split(/[-_]/);if(s!==Jn(l,1)[0]){var u=m.config.request.lang+".subtitles";if(Zn(u,d.video.textTracks).track){return void m.events.fire(oi.turnCaptionsOn,u,!0)}}}m.events.fire(oi.turnCaptionsOff)}else{m.events.fire(oi.turnCaptionsOn,m.config.request.cookie.captions,!0)}else{m.events.fire(oi.turnCaptionsOff,!0)}}}function ee(e,t,n,i){if(p){var r=new XMLHttpRequest;r.open("DELETE",e+"/plays/"+t+"/"+n+"?token="+i,!1),r.send(),p=!1}}function te(){if(m.config.embed.autoplay){if(g.get(ol)&&!g.get(ll))return;if(g.get(ol)&&Te.iOS&&!m.config.embed.muted)return;i=!0,m.events.fire(si.playButtonPressed)}}return l.classList.add("invisible"),n&&l.classList.add("hide-webkit-controls"),m.config.video.live_event&&t.classList.add("live-background"),m.config.embed.transparent&&t.classList.add("transparent"),g.watch("ui.video.scaleFactor",function(e){1<e?l.classList.add("vp-telecine-cover"):l.classList.remove("vp-telecine-cover")}),function(){var e=void 0;m.config.request.ab_tests&&m.config.request.ab_tests.bba&&(e=m.config.request.ab_tests.bba.group);var t=50;Te.spatialPlayback&&m.config.video.spatial&&(t=35);var n=[ms,Ls,Ya,Cs],i=void 0===m.config.video.file_codecs?null:m.config.video.file_codecs;d=new zs(l,n,{externalDisplays:[AirPlayExternalDisplay],swfScanner:{swfUrl:m.config.request.urls.flideo},mediaSourceScanner:{maxPreloadStreamIndex:void 0,shouldUseBBA:e,droppedFrameSwitchPercent:t},liveEvent:z(),tests:m.config.request.ab_tests,fileCodecs:i}),Object.keys(Pa).forEach(function(e){var t=Pa[e];t!==Pa.TIME_UPDATE&&t!==Pa.PROGRESS&&t!==Pa.SUSPEND&&t!==Pa.ERROR&&d.on(t,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};sr.captureBreadcrumb(t,e,"video event")})}),d.on(Ra.SCANNER_CHANGE,function(){K(),setTimeout(function(){m.events.fire(d.supportsSettingVolume?oi.enableVolume:oi.disableVolume),m.events.fire(d.supportsTextTracks?oi.enableCaptions:oi.disableCaptions)},0),sr.captureBreadcrumb("Scanner changed to "+d.currentScanner,{},"video")}),d.on(Ra.CURRENT_FILE_CHANGE,function(e){sr.captureBreadcrumb("Current file changed",{id:e.id,mime:e.mime,src:e.src,metadata:e.metadata},"video");var t=e.metadata.quality;if(e.mime===ri.dash){var n=m.config.request.files.dash.streams.map(function(e){return e.quality});X(t=Y(m.config.embed.quality,n)||"auto")}m.events.fire(si.qualityChanged,t,!0)}),d.on(Ra.STREAM_CHANGE,function(e){var t=e.index,n=e.streams,i=n[t],r=m.config.request.files.dash.streams.find(function(e){return e.id===parseInt(i.id,10)});void 0!==r?(i.profile=r.profile,i.quality=r.quality,i.fps=r.fps):(i.profile=null,i.quality=i.height+"p",i.fps=i.framerate),sr.captureBreadcrumb("Stream changed",i,"video"),m.events.fire(si.streamChanged,i,t,n)}),d.on(Ra.STREAM_BUFFER_START,function(e){var t=e.hasLowerStreamIndex;sr.captureBreadcrumb("Started buffering",{hasLowerStreamIndex:t},"video"),m.events.fire(si.ranIntoBuffer,t)}),d.on(Ra.STREAM_BUFFER_END,function(){sr.captureBreadcrumb("Stopped buffering",{},"video"),m.events.fire(si.playbackResumed)}),d.on(Ra.BANDWIDTH,function(e){m.events.fire(si.adaptiveBandwidth,e)}),d.on(Ra.CUE_POINT,function(e){m.events.fire(si.cuepoint,e)}),d.on(Ia.MOTION_START,function(){m.events.fire(si.spatialMotionStart)}),d.on(Ia.MOTION_END,function(){m.events.fire(si.spatialMotionEnd)}),d.on(Ra.DROPPED_FRAMES,function(e){m.events.fire(si.droppedFrames,e)}),d.on(Ra.DOWNLOAD_END,function(e){m.events.fire(si.segmentDownloaded,e)}),d.on(Ra.STREAM_TARGET_CHANGE,function(e){var t,n=e.streams[e.index],i=m.config.request.files.dash.streams.find(function(e){return e.id===parseInt(n.id,10)});void 0!==i&&(n.profile=i.profile,n.quality=i.quality,n.fps=i.fps);var r=[n,e.index,e.streams];(t=m.events).fire.apply(t,[si.streamTargetChange].concat(r))}),d.on(Ra.AV_DURATION_MISMATCH,function(e){m.events.fire(si.videoDurationMismatch,e)}),d.on(Ma.STREAM_ONLINE,function(){m.events.fire(si.liveStreamOnline)}),d.on(Ma.STREAM_OFFLINE,function(){m.events.fire(si.liveStreamOffline)}),d.on(Ma.REPRESENTATIONS_AVAILABLE,function(e){m.config.request.files.dash.streams=e.video.map(function(e){return{quality:e.height+"p"}}),m.events.fire(si.liveRepresentationsAvailable,e)}),d.on(Ma.EVENT_STARTED,function(e){g.dispatch(Zs(e)),g.dispatch(Js(ui.started))}),d.on(Ma.EVENT_ENDED,function(e){return g.dispatch(Js(ui.ended))}),d.on(Ma.EVENT_ACTIVE,function(){return g.dispatch(Js(ui.active))}),m.events.fire(si.telecineReady)}(),g.watch("ui.liveEvent.liveStatus",G),K(),d.on(Pa.LOADED_METADATA,function(e){T=!0;var t=d.duration;isFinite(t)&&0<t&&(m.config.video.duration=t),m.config.video.video_width=d.videoWidth,m.config.video.video_height=d.videoHeight}),d.on(Pa.LOADED_DATA,function(){0===d.currentTime&&d.paused&&q()}),d.on(Pa.DURATION_CHANGE,function(e){var t=d.duration;isFinite(t)&&(0<m.config.video.duration&&(t<m.config.video.duration-1||t>m.config.video.duration+1)||(m.config.video.duration=t))}),d.on(Pa.WAITING,function(){"LiveScanner"!==d.currentScanner&&k||B()}),d.on(Pa.CAN_PLAY,function(){q(),"LiveScanner"!==d.currentScanner&&(m.config.embed.autoplay||v||i&&!y)&&U()}),d.on(Pa.CAN_PLAY_THROUGH,function(){q(),"LiveScanner"!==d.currentScanner&&(i&&!y&&U(),(b||v&&d.paused)&&U())}),d.on(Pa.PROGRESS,function(e){H()}),m.events.on(si.playButtonPressed,j).on(si.pauseButtonPressed,function(){v=!1,d.pause(),g.get(ol)&&_&&q()}).on(si.becameInactive,function(){window.location.search.indexOf("autopause=0")<0&&!d.paused&&!m.config.embed.settings.background&&(v=!1,m.events.fire(si.pauseButtonPressed))}),d.on(Pa.ERROR,function(e){e&&("NotAllowedError"===e.name||Te.iOS&&"AbortError"===e.name)&&(d.pause(),0===d.currentTime&&m.events.fire(oi.reset))}),d.on(Pa.PLAY,function(e){x=!1,l.classList.remove("invisible"),m.events.fire(si.played,d.currentTime)}),d.on(Pa.PAUSE,function(e){b||S||E||m.events.fire(si.paused,d.currentTime,d.ended)}),d.on(Pa.PLAYING,function(e){H(),w=!0}),d.on(Pa.TIME_UPDATE,function(e){var t=d.currentTime;if(w&&_&&0<t&&(w=!1,q()),0<d.buffered.length&&!_){var n=V(d.buffered,t),i=d.buffered.end(n);if(!C&&0<t&&t<d.duration&&i===t)return void B()}if(!x){var r=d.duration,o=t/r,a=d.playbackRate;m.events.fire(si.playProgress,t,r,o,a),s&&s<t&&(s=null)}u&&(u.classList.add("hidden"),u=null)}),d.on(Pa.ENDED,function(e){if(!S)if(m.config.embed.loop)d.play();else{if(C&&m.events.fire(si.fullscreenButtonPressed),i=v=!1,P)return;if(g.get(ll))return;m.events.fire(si.ended,e)}}),d.on(Ra.DRM_AUTH_SUCCESS,function(e){p=!0}),m.events.on(si.playInitiated,function(){d.once(Pa.TIME_UPDATE,function(){return m.events.fire(si.firstTimeUpdate)})}),m.events.on(si.hudDisplayed,function(){P=!0}),m.events.on(si.hudHidden,function(){P=!1,d.ended&&m.events.fire(si.ended)}),m.events.on(si.bufferStarted,function(){S||m.events.fire(ei.bufferStarted)}),function(){var o=!1;function e(e){if(!o)if(sr.captureBreadcrumb(e.name,{message:e.message},"telecine error","error"),"TextTracksNotSupported"!==e.name){var t=bl[e.name];if("function"==typeof t){var n=t();if(A=n.deferred?n.id:null,"DRMFailure"===e.name){var i=m.config.request.dynamic_drm_translation_map,r=e.message.code;i&&r&&i[r]&&(n.title=i[r].title,n.message=i[r].msg),sr.captureBreadcrumb("DRM failure",e,"video")}m.events.fire(si.error,n.id,n)}}else m.events.fire(oi.disableCaptions)}ar(function(){o=!0}),d.on(Pa.ERROR,e),m.events.on("test-error",e)}(),m.events.on(oi.changeLoop,function(e){var t=!!e&&(!Te.iOS||10<=Te.iOS);m.config.embed.loop=t,d.loop=t}),m.events.fire(oi.changeLoop,m.config.embed.loop),m.events.on(si.scrubbingStarted,function(){L||(B(),v=!d.paused,S=!0,d.pause())}),m.events.on(si.scrubbingEnded,function(e){S=!1,e||U()}),m.events.on(oi.seek,function(e,t){L||(t||(t=(d.duration||m.config.video.duration)*qn(e,0,1)),t=qn(t,0,d.duration||m.config.video.duration),y||(m.events.fire(si.playButtonPressed),v=i=y=!0),d.currentTime=t)}),d.on(Pa.SEEKING,function(){k=!0},!1),d.on(Pa.SEEKED,function(){H();var e=d.currentTime,t=d.duration;m.events.fire(si.seeked,e,t,e/t),k=!1},!1),m.events.on(oi.setTime,function(e,t){e=qn(e,0,d.duration||m.config.video.duration),d.currentTime=e}),function(){m.events.on(oi.changeVolume,function(e,t,n){n&&(e+=d.volume),d.volume=qn(e,0,1),d.muted=0===d.volume,m.events.fire(si.volumeChanged,qn(e,0,1),t)}),d.on(Pa.VOLUME_CHANGE,function(){return m.events.fire(si.volumeChanged,d.volume,!0)});var e=m.config.embed.muted?0:m.config.request.cookie.volume;m.events.fire(oi.changeVolume,e,!0)}(),function(){m.events.on(oi.changeQuality,function(t,e){if(d.video.currentFile.mime===ri.dash||g.get(ll))e=!0,X(t);else{var n=Ut(m.telecine.video.files).filter(xl(F)).filter(function(e){return e.metadata.quality===t});n.sort(Ll()),0<n.length&&(x=!0,d.video.currentFile=n[0])}m.events.fire(si.qualityChanged,t,e)});var t=d.playbackRate;d.on(Pa.RATE_CHANGE,function(e){d.playbackRate!==t&&(m.events.fire(si.playbackRateChanged,d.playbackRate,t),t=d.playbackRate)}),m.events.on(oi.changePlaybackRate,function(e){d.defaultPlaybackRate=e,d.playbackRate=e}),m.events.on(si.loadVideo,function(){d.defaultPlaybackRate=1,d.playbackRate=1})}(),function(){function n(){L=!0,y&&!R&&(v=v||!d.paused,d.pause(),m.events.fire(si.paused,d.currentTime))}function i(){L=!1,v&&!R&&(C||O||!h||m.events.fire(oi.forceFullscreen),U())}m.events.on(si.overlayOpened,n),m.events.on(si.overlayClosed,i),m.events.on(si.menuVisibilityChanged,function(e,t){t.isCentered()&&(t.isVisible()?n():i())})}(),m.events.on(si.popupOpened,function(e){y&&!R&&(v=!d.paused,d.pause())}),m.events.on(si.popupClosed,function(e){R||U()}),m.events.on(si.didEnterFullscreen,function(e,t){l.classList.remove("hide-webkit-controls"),e&&(O=!0),e||(y||Te.browser.safari||(d.poster=m.preview.getThumbnail()),C=!0,setTimeout(function(){d.video.textTracks.forEach(function(e){"hidden"===e.mode&&(e.mode="showing")})},500)),t||!Te.windowsPhone||Te.browser.edge||m.events.fire(oi.toggleNativeControls,!0)}),m.events.on(si.didExitFullscreen,function(e){d.poster="",e||d.pause(),y||l.classList.add("invisible"),O=C=!1,n&&l.classList.add("hide-webkit-controls"),d.video.textTracks.forEach(function(e){"showing"===e.mode&&(e.mode="hidden")})}),m.events.on(si.playInitiated,function(){d.poster=""}),m.events.on(oi.toggleNativeControls,function(e){if(e)return d.controls=!0,void t.classList.add("native-controls");d.controls=!1,t.classList.remove("native-controls")}),m.events.on(si.signatureExpired,function(){s=d.currentTime}),m.events.on(si.requestConfigReloaded,function(e){Z(!1)}),m.events.on(si.configChanged,function(e,t){g.get(ol)&&d.initLiveEvent(z()),Z(e),te()}),m.events.on(oi.reset,function(){x=!0,q(),d.paused||(d.pause(),m.events.fire(si.paused,d.currentTime)),m.preview.show(),l.classList.add("invisible"),v=y=!1,A=null,setTimeout(function(){d.currentTime=0},300)}),m.events.on(oi.turnCaptionsOn,function(e,t){if(!M||M.id!==e){var n=d.video.textTracks.getTrackById(e),i=!0;if(!n){var r=Zn(e,d.video.textTracks);n=r.track,i=r.exactMatch}n!==M&&setTimeout(function(){d.video.textTracks.forEach(function(e){e.mode=e===n?"hidden":"disabled"}),m.events.fire(si.captionsChanged,n,t||!i),M=n},0)}}).on(oi.turnCaptionsOff,function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];setTimeout(function(){d.video.textTracks.forEach(function(e){e.mode="disabled"}),m.events.fire(si.cueChanged),M&&(M=null,m.events.fire(si.captionsChanged,null,e))},0)}),d.on(Ca.AVAILABLE,function(e){var t=e.type;if(!m.config.request.drm)switch(t){case"AirPlay":m.events.fire(si.airPlayAvailable)}}),d.on(Ca.UNAVAILABLE,function(e){var t=e.type;if(!m.config.request.drm)switch(t){case"AirPlay":m.events.fire(si.airPlayNotAvailable)}}),d.on(Ca.ACTIVATED,function(e){var t=e.type;switch(R=!0,t){case"AirPlay":m.events.fire(si.airPlayActivated)}}),d.on(Ca.DEACTIVATED,function(e){var t=e.type;switch(R=!1,t){case"AirPlay":m.events.fire(si.airPlayDeactivated)}}),m.events.on(si.airPlayButtonPressed,function(){d.showExternalDisplayPicker("AirPlay")}),function(){var e=d.presentationMode;function t(){!d.supportsPresentationMode("picture-in-picture")||Te.spatialPlayback&&m.config.video.spatial?m.events.fire(si.pictureInPictureNotAvailable):m.events.fire(si.pictureInPictureAvailable)}d.on(Pa.PLAY,function(){T?t():d.once(Pa.LOADED_METADATA,t)}),d.on(Ra.PRESENTATION_MODE_CHANGE,function(t){"inline"===e&&"picture-in-picture"===t&&m.events.fire(si.pictureInPictureActivated),"picture-in-picture"===e&&"inline"===t&&m.events.fire(si.pictureInPictureDeactivated),e=t,d.video.textTracks.forEach(function(e){"picture-in-picture"===t&&"hidden"===e.mode&&(e.mode="showing"),"inline"===t&&"showing"===e.mode&&(e.mode="hidden")})}),m.events.on(oi.activatePictureInPicture,function(){d.supportsPresentationMode("picture-in-picture")&&(d.presentationMode="picture-in-picture")}),m.events.on(oi.deactivatePictureInPicture,function(){d.supportsPresentationMode("picture-in-picture")&&(d.presentationMode="inline")})}(),m.events.on(si.enteredTinyMode,function(){e=!0}).on([si.enteredMiniMode,si.enteredNormalMode],function(){e=!1}),r=0,o=null,a=function(){o&&(m.events.fire(oi.changeColor,o),o=null)},m.events.on(oi.setEffect,function(e){if(d.deactivateEffects(),"ascii"!==e&&"ascii-color"!==e){if("ascii"!==e&&"ascii-color"!==e){var t=[];!1!==I&&t.push(I),d.video.currentFile.restrictedStreamIndexes=t}a(),m.element.setAttribute("data-filter",e)}else{if(d.supportsEffect(gs)){d.activateEffect(gs,{color:"ascii-color"===e,fps:r||d.video.currentFile.metadata.fps});try{var n=m.config.request.files.dash.streams;n.sort(Ll("asc"));var i=m.config.request.files.dash.streams.indexOf(n[0]);d.video.currentFile.restrictedStreamIndexes=[i]}catch(e){}return m.element.setAttribute("data-filter",e),"ascii"===e?(o||(o=m.config.embed.color),void m.events.fire(oi.changeColor,"#46d439")):void a()}m.events.fire(oi.setEffect,"none")}}).on(si.streamChanged,function(e,t,n){r=e.fps}),Z(),function(){if(Te.spatialPlayback){var e=null,t=function(){e&&(d.deactivateEffect(Ys),e=null,m.events.fire(oi.toggleSpatialPlayback,e)),m.config.video.spatial&&(m.config.request.drm||d.supportsEffect(Ys)&&(e=d.activateEffect(Ys,{threeUrl:m.config.request.urls.three_js,fps:m.config.video.fps,fieldOfView:m.config.video.spatial.fov,directorTimeline:m.config.video.spatial.director_timeline,projection:m.config.video.spatial.projection,stereoMode:m.config.video.spatial.stereo_mode,initialView:m.config.video.spatial.initial_view,isMobile:Te.android,dimensions:m.config.embed.on_site?{width:1080,height:540}:{width:640,height:360}}),m.events.fire(oi.toggleSpatialPlayback,e)))};m.events.fire(oi.attachSpatialPlaybackEvents),t(),m.events.on(si.configChanged,t),d.on(Pa.SEEKED,function(){return m.events.fire(oi.revealSpatialControls)}),d.on(Pa.PLAY,function(){return m.events.fire(oi.revealSpatialControls)}),d.on(Ia.CAMERA_UPDATE,function(e){return m.events.fire(si.cameraUpdate,e)}),d.on(Ia.SPATIAL_UNSUPPORTED,function(){e&&(d.deactivateEffect(Ys),e=null,m.events.fire(oi.toggleSpatialPlayback,e)),y?m.events.fire(ei.spatialFailure,L):m.events.once(si.firstTimeUpdate,function(){m.events.fire(ei.spatialFailure,L)})})}else m.events.once(si.firstTimeUpdate,function(){m.config.video.spatial&&m.events.fire(ei.spatialUnsupported,L)})}(),ar(function(){var e=m.config.request.drm;e&&ee(e.hoover_url,e.user,e.asset,e.hoover_token)}),m.events.on(si.loadVideo,function(){var e=m.config.request&&m.config.request.drm;e&&ee(e.hoover_url,e.user,e.asset,e.hoover_token)}),m.ready().then(function(){return setTimeout(function(){return te()},0),0<m.config.embed.time&&m.events.fire(oi.setTime,m.config.embed.time,m.config.embed.time/d.duration),null}).catch(function(e){}),m.events.fire(si.videoModuleReady),{telecine:d}}var Il=t(function(e){!function(){var r,d=0,i=0,f={},h={};function v(e,t,n){return"_root"==t?n:e!==n?(i=e,r||(r=i.matches?i.matches:i.webkitMatchesSelector?i.webkitMatchesSelector:i.mozMatchesSelector?i.mozMatchesSelector:i.msMatchesSelector?i.msMatchesSelector:i.oMatchesSelector?i.oMatchesSelector:m.matchesSelector)).call(e,t)?e:e.parentNode?(d++,v(e.parentNode,t,n)):void 0:void 0;var i}function p(e,t,n,i){if(f[e.id])if(t)if(i||n)if(i){if(f[e.id][t][n])for(var r=0;r<f[e.id][t][n].length;r++)if(f[e.id][t][n][r]===i){f[e.id][t][n].splice(r,1);break}}else delete f[e.id][t][n];else f[e.id][t]={};else for(var o in f[e.id])f[e.id].hasOwnProperty(o)&&(f[e.id][o]={})}function o(e,t,n,i){if(this.element){e instanceof Array||(e=[e]),n||"function"!=typeof t||(n=t,t="_root");var r,o,a,s,l,u=this.id;for(r=0;r<e.length;r++)i?p(this,e[r],t,n):(f[u]&&f[u][e[r]]||m.addEvent(this,e[r],c(e[r])),o=this,a=e[r],s=t,l=n,f[o.id]||(f[o.id]={}),f[o.id][a]||(f[o.id][a]={}),f[o.id][a][s]||(f[o.id][a][s]=[]),f[o.id][a][s].push(l));return this}function c(t){return function(e){!function(e,t,n){if(f[e][n]){var i,r,o=t.target||t.srcElement,a={},s=0,l=0;for(i in d=0,f[e][n])f[e][n].hasOwnProperty(i)&&(r=v(o,i,h[e].element))&&m.matchesEvent(n,h[e].element,r,"_root"==i,t)&&(d++,f[e][n][i].match=r,a[d]=f[e][n][i]);for(t.stopPropagation=function(){t.cancelBubble=!0},s=0;s<=d;s++)if(a[s])for(l=0;l<a[s].length;l++){if(!1===a[s][l].call(a[s].match,t))return m.cancel(t);if(t.cancelBubble)return}}}(u,e,t)}}}function m(e,t){if(!(this instanceof m)){for(var n in h)if(h[n].element===e)return h[n];return h[++i]=new m(e,i),h[i]}this.element=e,this.id=t}m.prototype.on=function(e,t,n){return o.call(this,e,t,n)},m.prototype.off=function(e,t,n){return o.call(this,e,t,n,!0)},m.matchesSelector=function(){},m.cancel=function(e){e.preventDefault(),e.stopPropagation()},m.addEvent=function(e,t,n){var i="blur"==t||"focus"==t;e.element.addEventListener(t,n,i)},m.matchesEvent=function(){return!0},e.exports&&(e.exports=m),window.Gator=m}()}),Dl=Il.addEvent,Fl=void 0===window.PointerEvent&&void 0!==window.MSPointerEvent,Bl={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointerover:"MSPointerOver",pointerout:"MSPointerOut"},ql="onmspointerenter"in document,Nl="onmspointerleave"in document;Il.addEvent=function(e,t,n){Fl&&Bl[t]&&(t=Bl[t]),"transitionend"===t&&(Dl(e,"webkitTransitionEnd",n),Dl(e,"otransitionend",n)),"mouseenter"===t&&(t="mouseover"),"mouseleave"===t&&(t="mouseout"),"MSPointerEnter"!==t||ql||(t="MSPointerOver"),"MSPointerLeave"!==t||Nl||(t="MSPointerOut"),Dl(e,t,n)},Il.matchesEvent=function(e,t,n,i,r){return!("mouseenter"===e||"mouseleave"===e||!ql&&"MSPointerEnter"===e||!Nl&&"MSPointerLeave"===e)||(o=t,a=n,s=i,!(l=r).relatedTarget||(!s||o===a)&&a!==l.relatedTarget&&!a.contains(l.relatedTarget));var o,a,s,l};var jl="alert-displayed",Ul="alert-hidden",Vl="captions-enabled",Hl="captions-disabled",Wl="error-link-pressed",zl="mediasession-play",Gl="mediasession-pause",Kl="mediasession-seekforward",Yl="mediasession-seekbackward",Xl="slate-displayed",$l="video-buffer-end",Ql="video-buffer-start",Jl="video-can-start",Zl="video-duration-mismatch",eu="video-ended",tu="video-exit",nu="video-fullscreen-change",iu="video-load-failure",ru="video-manifest-loaded",ou="video-manifest-timeout",au="video-minute-watched",su="video-paused",lu="video-played",uu="video-playback-error",cu="video-playback-rate-changed",du="video-playback-resumed",fu="video-ran-into-buffer",hu="video-ready",vu="video-start-attempt",pu="video-start-failure",mu="video-start-time",gu="video-stream-change",yu="video-switch-back-to-auto",_u="video-switch-from-auto",bu="video-seek",wu="video-seeked";function ku(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function Su(e){return ku()-e}function Eu(e){return Tu()-e}function Tu(){return parseInt(ku()/1e3,10)}function xu(e){var t=e.getHours(),n=e.getMinutes(),i=12<=t?"PM":"AM";return(t=(t%=12)||12)+":"+(n=n<10?"0"+n:n)+" "+i}var Au=function(){function t(e){Yn(this,t),this.player=e,this._reset(),this._setUpPlayerEvents()}return Xn(t,[{key:"_reset",value:function(){this.rebufferCount=0,this.rebufferDuration=0,this.rebufferPercent=0,this.playbackFailure=!1,this.sessionLength=0,this.playerStartupTime=-1,this.startupRequestTime=null,this._lastScaleCheck=null,this._lastScale=null,this._scaleDurations={satisfied:0,tolerable:0,frustrated:0}}},{key:"_setUpPlayerEvents",value:function(){var t=this;this.player.events.on(si.playInitiated,function(){-1===t.playerStartupTime&&(t.startupRequestTime=ku())}),this.player.events.on(si.playProgress,function(){-1===t.playerStartupTime&&(t.playbackInitTime=ku(),t.playerStartupTime=Su(t.startupRequestTime)),t._trackScaling()}),this.player.events.on(si.bufferStarted,function(){-1!==t.playerStartupTime&&(t.rebufferCount++,t.rebufferStartTime=ku())}),this.player.events.on(si.bufferEnded,function(){-1!==t.playerStartupTime&&(t.rebufferDuration+=Su(t.rebufferStartTime))}),this.player.events.on(si.error,function(e){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{final:!0}).final&&(t.playbackFailure=!0)}),this.player.events.on(si.configChanged,function(){t._reset()})}},{key:"_trackScaling",value:function(){var e=this.player.element.querySelector(".vp-video").getBoundingClientRect(),t=this.player.telecine.videoWidth,n=this.player.telecine.videoHeight;if(0!==t||0!==n){var i="satisfied",r="tolerable",o="frustrated",a=i;if(e.width>t&&e.height>n&&(t/e.width<.4?a=i:t/e.width<1?a=r:1<t/e.width&&(a=o)),this._lastScaleCheck){var s=Su(this._lastScaleCheck);this._scaleDurations[this._lastScale]+=s}this._lastScale=a,this._lastScaleCheck=ku()}}},{key:"overallScore",get:function(){return Math.min(this.failureScore,this.startupTimeScore,this.rebufferScore,this.videoQualityScore)}},{key:"failureScore",get:function(){return this.playbackFailure?0:1}},{key:"startupTimeScore",get:function(){return-1===this.playerStartupTime?null:8e3<this.playerStartupTime||-1===this.playerStartupTime?0:2e3<this.playerStartupTime?.5:1}},{key:"rebufferScore",get:function(){return this.playbackInitTime?(this.rebufferPercent=this.rebufferDuration/Su(this.playbackInitTime),4<=this.rebufferCount||.12<=this.rebufferPercent?0:this.rebufferCount<4&&0!==this.rebufferCount?this.rebufferPercent<.12?.5:0:1):null}},{key:"videoQualityScore",get:function(){var n=this;if(-1===this.playerStartupTime)return null;switch(this._trackScaling(),Object.keys(this._scaleDurations).reduce(function(e,t){return n._scaleDurations[e]>n._scaleDurations[t]?e:t})){case"satisfied":return 1;case"tolerable":return.5;case"frustrated":return 0}return null}}]),t}(),Lu=500,Pu=function(){function n(e,t){Yn(this,n),e.doNotTrackEnabled||(this.player=e,this.store=t,this.playerLoadTime=Tu(),this.endpoint=this._getFresnelEndpoint(),this.startAttemptLogged=!1,this.startupTimeLogged=!1,this.startPlayTime=null,this.currentlyBuffering=!1,this.lastBufferTime=null,this.totalBufferDuration=0,this.qualityPickedLogged=!1,this.backToAutoLogged=!1,this.lastVideoBitrate=null,this.lastAudioBitrate=null,this.currentQuality="auto",this.currentStream={},this.lastProfileId=null,this.lastTargetProfileId=null,this.currentlyPlaying=!1,this.playedTo=0,this.autoplayType=this.player.config.embed.autoplay,this.akamaiEdgeIp=null,this.quicVersion=null,this.akamaiCacheDebug=null,this.lastIntervalTime=ku(),this.bufferCount=0,this.isScrubbing=!1,this.currentMinuteWatchedTime=0,this.totalMinutesWatched=0,this.hasEnded=!1,this.droppedFramePercent=0,this.droppedFrames=0,this.forcedEmbedQuality="none",this.sessionPlaybackDuration=0,this.fullscreen=!1,this.qualityUpSwitchCount=0,this.qualityDownSwitchCount=0,this.stayedOnAuto=!0,this.livestreamOnline=!1,this.playedProfiles={},this.profiles={},this.speeds=[],this.bufferOccupancies=[],this.targetProfiles={},this.targetProfileId={},this.previousCaptionsID=null,this.score=new Au(this.player),this.endpoint&&(setInterval(this._updatePlaybackDuration.bind(this),Lu),this._initializeEvents(),this._initMinuteWatchedTimer()))}return Xn(n,[{key:"_initializeEvents",value:function(){var n=this;this.player.events.on(si.playInitiated,this._onPlayInitiated.bind(this)),this.player.events.on(si.playProgress,this._onPlayProgress.bind(this)),this.player.events.on(si.played,this._onPlayed.bind(this)),this.player.events.on(si.bufferStarted,this._onBufferStarted.bind(this)),this.player.events.on(si.bufferEnded,this._onBufferEnded.bind(this)),this.player.events.on(si.ranIntoBuffer,this._onRanIntoBuffer.bind(this)),this.player.events.on(si.playbackResumed,this._onPlaybackResumed.bind(this)),this.player.events.on(si.error,this._onError.bind(this)),this.player.events.on(si.errorLinkPressed,this._onErrorLinkPressed.bind(this)),this.player.events.on(si.didEnterFullscreen,this._onEnterFullscreen.bind(this)),this.player.events.on(si.didExitFullscreen,this._onExitFullscreen.bind(this)),this.player.events.on(si.droppedFrames,this._onDroppedFrames.bind(this)),this.player.events.on(si.ended,this._onEnded.bind(this)),this.player.events.on(si.liveEventEnded,this._onLiveEventEnded.bind(this)),this.player.events.on(si.adaptiveBandwidth,this._onAdaptiveBandwidth.bind(this)),this.player.events.on(si.streamChanged,this._onStreamChanged.bind(this)),this.player.events.on(si.streamTargetChange,this._onStreamTargetChange.bind(this)),this.player.events.on(si.forcedQuality,this._onForcedQuality.bind(this)),this.player.events.on(si.alertVisibilityChanged,this._onAlertVisibilityChanged.bind(this)),this.player.events.on(si.configChanged,this._resetMetrics.bind(this)),this.player.events.on(si.segmentDownloaded,this._onSegmentDownloaded.bind(this)),this.player.events.on(si.overlayOpened,this._onOverlayOpened.bind(this)),this.player.events.on(si.scrubbingStarted,this._onScrubbingStarted.bind(this)),this.player.events.on(si.scrubbingEnded,this._onScrubbingEnded.bind(this)),this.player.events.on(si.playbackRateChanged,this._onPlaybackRateChanged.bind(this)),this.player.events.on(si.videoDurationMismatch,this._onVideoDurationMismatch.bind(this)),this.player.events.on(oi.changeQuality,this._onChangeQuality.bind(this)),this.player.events.on(oi.seek,this._onSeek.bind(this)),this.player.events.on(oi.turnCaptionsOn,this._onCaptionsEnabled.bind(this)),this.player.events.on(oi.turnCaptionsOff,this._onCaptionsDisabled.bind(this)),new M(function(e,t){n.player.telecine&&e(),n.player.events.on(si.telecineReady,function(){e()})}).then(function(){n._send(hu),n.player.telecine.on(Ra.MANIFEST_TIMEOUT,n._onManifestTimeout.bind(n)),n.player.telecine.on(Pa.CAN_PLAY,n._onCanPlay.bind(n)),n.player.telecine.on(Ra.MANIFEST_LOADED,n._onManifestLoaded.bind(n)),n.player.telecine.on(Ra.BUFFER_OCCUPANCY,n._onBufferOccupancyChange.bind(n)),n.player.telecine.on(Pa.PAUSE,n._onPaused.bind(n)),n.player.telecine.on(Ma.STREAM_ONLINE,n._onLivestreamOnline.bind(n)),n.player.telecine.on(Ma.STREAM_OFFLINE,n._onLivestreamOffline.bind(n)),n.player.telecine.on(Da.MEDIASESSION_PLAY,n._onMediaSessionPlay.bind(n)),n.player.telecine.on(Da.MEDIASESSION_PAUSE,n._onMediaSessionPause.bind(n)),n.player.telecine.on(Da.MEDIASESSION_SEEK_FORWARD,n._onMediaSessionSeekForward.bind(n)),n.player.telecine.on(Da.MEDIASESSION_SEEK_BACKWARD,n._onMediaSessionSeekBackward.bind(n))}).catch(function(){}),ar(function(e){n._onVideoExit()})}},{key:"_initMinuteWatchedTimer",value:function(){var e=this,t=Math.floor(60*Math.random());setInterval(function(){e.currentlyPlaying&&(!e.store.get(ol)||e.store.get(cl)||e.livestreamOnline)&&(e.currentMinuteWatchedTime++,0!==e.totalMinutesWatched?60<=e.currentMinuteWatchedTime&&(e.currentMinuteWatchedTime=0,e.totalMinutesWatched++,e._send(au)):e.currentMinuteWatchedTime===t&&(e.currentMinuteWatchedTime=0,e.totalMinutesWatched++,e._send(au)))},1e3)}},{key:"_onLivestreamOnline",value:function(){this.livestreamOnline=!0}},{key:"_onLivestreamOffline",value:function(){this.livestreamOnline=!1}},{key:"_onMediaSessionPlay",value:function(){this._send(zl)}},{key:"_onMediaSessionPause",value:function(){this._send(Gl)}},{key:"_onMediaSessionSeekForward",value:function(){this._send(Kl)}},{key:"_onMediaSessionSeekBackward",value:function(){this._send(Yl)}},{key:"_getBufferState",value:function(){var e=[];if(this.player.telecine)for(var t=this.player.telecine.buffered,n=0;n<t.length;n++)e.push([t.start(n),t.end(n)]);return e}},{key:"_updatePlaybackDuration",value:function(){this.currentlyPlaying&&(this.sessionPlaybackDuration+=Su(this.lastIntervalTime)/1e3),this.lastIntervalTime=ku()}},{key:"_onPaused",value:function(){this.currentlyPlaying&&(this.currentlyPlaying=!1,this._send(su))}},{key:"_isVOD",value:function(){return!!this.player.config.video.vod&&0!==this.player.config.video.vod}},{key:"_getOrigin",value:function(){var e=document.createElement("a");return e.href=this.player.config.request.referrer,e.origin||e.protocol.replace(":","")+"://"+e.host}},{key:"_getFresnelEndpoint",value:function(){var e="?session-id="+this.player.config.request.session,t=this.player.config.request.flags.log_to_es||this.player.config.user.mod?"&es=1":"";return this.player.config.request.urls.fresnel+e+t}},{key:"_onVideoExit",value:function(){this.currentlyBuffering&&(this.totalBufferDuration+=Su(this.lastBufferTime)/1e3);var e={startup:this.score.startupTimeScore,rebuffer:this.score.rebufferScore,failure:this.score.failureScore,quality:this.score.videoQualityScore,overall:this.score.overallScore};this.startAttemptLogged&&this._send(tu,{vxs:e},!1)}},{key:"_getGlobalProperties",value:function(){var e=this.player.telecine.video?this.player.telecine.video.currentFile:{},t=e.id,n=void 0===t?0:t,i=e.mime,r=void 0===i?ri.h264:i,o=e.metadata,a=(o=void 0===o?{}:o).profile,s=void 0===a?null:a,l=!1,u=!1,c=this._getProfileUsage(),d=this._getBufferOccupancy();switch(r){case ri.dash:0===e.restrictedStreamIndexes.length&&(l=!0),it(this.player.config,"request.files.dash.separate_av")&&(u=!0);var f=this.currentStream,h=f.id;n=void 0===h?0:h;var v=f.profile;s=void 0===v?null:v;break;case ri.hls:l=!0}var p={account_type:this.player.config.video.owner?this.player.config.video.owner.account_type:null,app_id:this.player.config.embed.app_id?this.player.config.embed.app_id:null,audio_bitrate:this.player.telecine.getBitrateAtTime(this.player.telecine.currentTime,"audio"),auto:l,autoplay:!!this.autoplayType,average_buffer_occupancy:d.average||0,average_speed:c.average_speed||0,background:!!this.player.config.embed.settings.background,buffer_count:this.bufferCount,buffer_duration:Math.round(100*this.totalBufferDuration)/100,buffer_ratio:this._getBufferRatio(),cdn:e.metadata?e.metadata.cdn:"akamai",client_time:ku(),clip_id:this.player.config.video.id,context:this.player.config.embed.context,current_buffer_occupancy:this.bufferOccupancies[this.bufferOccupancies.length-1],delivery:"live"!==ci[r]?ci[r]:"dash",device_pixel_ratio:window.devicePixelRatio||1,drm:this.player.config.request.drm||!1,dropped_frames:this.droppedFrames,dropped_frame_percent:this.droppedFramePercent,embed:!this.player.config.embed.on_site,ended:this.hasEnded,forced_embed_quality:this.forcedEmbedQuality,fullscreen:this.fullscreen,highest_available_profile:c.highest_available_profile?String(c.highest_available_profile):null,highest_profile:c.highest_profile?String(c.highest_profile):null,is_beta:0<=this.player.config.request.build.player.indexOf("beta"),is_buffering:this.currentlyBuffering,is_mod:!!this.player.config.user.mod,is_spatial:!(!Te.spatialPlayback||!this.player.config.video.spatial),is_stereo:Te.spatialPlayback&&this.player.config.video.stereo_mode&&"mono"!==this.player.config.video.stereo_mode,live:this.store.get(cl)||!1,logged_in:!!this.player.config.user.logged_in,looping:!!this.player.config.embed.loop,max_buffer_occupancy:isFinite(d.max)?d.max:0,max_speed:isFinite(c.max_speed)?c.max_speed:0,min_buffer_occupancy:isFinite(d.min)?d.min:0,min_speed:isFinite(c.min_speed)?c.min_speed:0,minutes_watched:this.totalMinutesWatched,most_used_profile:c.most_used_profile?String(c.most_used_profile):null,origin:e.metadata?e.metadata.origin:"",playback_rate:this.player.telecine.playbackRate,player_width:this.player.element.querySelector(".vp-video").getBoundingClientRect().width,player_height:this.player.element.querySelector(".vp-video").getBoundingClientRect().height,profile_id:s?String(s):null,quality:this.currentStream?this.currentStream.quality:null,quality_downswitch_count:this.qualityDownSwitchCount,quality_upswitch_count:this.qualityUpSwitchCount,quality_switch_count:this.qualityUpSwitchCount+this.qualityDownSwitchCount,referrer:this._getOrigin(),resume_time:this.player.config.user.progress||null,separate_av:u,session_id:this.player.config.request.session,session_playback_duration:Math.round(100*this.sessionPlaybackDuration)/100,stayed_on_auto:this.stayedOnAuto,ttfb:this._getTimeToFirstByte(),version:this.player.config.request.build.js,video_bitrate:this.player.telecine.getBitrateAtTime(this.player.telecine.currentTime,"video"),video_duration:this.player.config.video.duration,video_file_id:Number.isInteger(Number(n))?parseInt(n,10):null,video_time:this.player.telecine.currentTime,vod:this._isVOD(),vuid:Ao("vuid")};if(this.player.config.request.ab_tests)for(var m in this.player.config.request.ab_tests){var g=this.player.config.request.ab_tests[m];for(var y in p[m+"_test"]=1,p[m+"_group"]=g.group,g.data)p[m+"_data_"+y]=g.data[y]}return p}},{key:"_send",value:function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=this._getGlobalProperties();for(var r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);i.name=e,i.event_time=this.player.config.request.timestamp+Eu(this.playerLoadTime);var o=[i],a=JSON.stringify(o);if(!navigator.sendBeacon||!navigator.sendBeacon(this.endpoint,a)){var s=new XMLHttpRequest;s.open("POST",this.endpoint,n),s.setRequestHeader("Content-Type","text/plain"),s.send(a)}}},{key:"_getProfileUsage",value:function(){var i=this,e={},r=ku(),t=Ll("asc"),n="MediaSourceScanner"===this.player.telecine.currentScanner,o=[];"HTMLScanner"===this.player.telecine.currentScanner&&(o=it(this.player.config,"request.files.progressive")||it(this.player.config,"request.files.hls")||[]),n&&(o=it(this.player.config,"request.files.dash.streams",[]));var a=Ut(o).sort(t).map(function(e){return e.profile}),s=-1,l=0,u=null;if(Object.keys(this.profiles).forEach(function(e){var t=a.indexOf(parseInt(e,10));s<t&&(s=t);var n=i.profiles[e].reduce(function(e,t){return((t.end||r)-t.start)/1e3+e},0);l<n&&(l=n,u=e)}),e.highest_profile=a[s],e.highest_available_profile=a[a.length-1],e.most_used_profile=u,n){e.max_speed=Math.round(Math.max.apply(Math,this.speeds))/1e3,e.min_speed=Math.round(Math.min.apply(Math,this.speeds))/1e3;var c=this.speeds.reduce(function(e,t){return e+t},0);e.average_speed=Math.round(c/this.speeds.length)/1e3}return e}},{key:"_getBufferOccupancy",value:function(){var e={};if(0<this.bufferOccupancies.length){e.max=Math.max.apply(Math,this.bufferOccupancies),e.min=Math.min.apply(Math,this.bufferOccupancies);var t=this.bufferOccupancies.reduce(function(e,t){return e+t},0);e.average=Math.round(t/this.bufferOccupancies.length*100)/100}return e}},{key:"_getTimeToFirstByte",value:function(){var e=-1;if(void 0!==window.performance&&"function"==typeof window.performance.getEntriesByType){var t=window.performance.getEntriesByType("resource");if(t){var n=t.filter(function(e){return".m4s"===e.name.split("?")[0].substr(-4)});e=n.map(function(e){return e.responseStart-e.connectStart}).reduce(function(e,t){return e+t},0)/(n.length||1)}}return e}},{key:"_getBufferRatio",value:function(){var e=this.totalBufferDuration/(this.totalBufferDuration+this.sessionPlaybackDuration)*100;return isNaN(e)?0:Math.round(100*e)/100}},{key:"_onPlayInitiated",value:function(){var i=this;this.startAttemptLogged||this.player.performDelegateAction(ai.playLog,function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i.autoplayType=t.continuous?1:i.player.config.embed.autoplay;var n=Te.iOS||Te.iPhone||Te.windowsPhone||Te.browser.bb10||Te.mobileAndroid||Te.android;i.autoplayType=i.livestreamOnline&&!n?1:i.player.config.embed.autoplay,i._send(vu),i.startAttemptLogged=!0,i.startPlayTime=ku()})}},{key:"_onPlayed",value:function(e){this.currentlyPlaying=!0,this.isScrubbing||this._send(lu)}},{key:"_onPlayProgress",value:function(e){if(this.playedTo=e,!this.startupTimeLogged){this.startupTimeLogged=!0;var t={time:Su(this.startPlayTime)/1e3};this.akamaiEdgeIp&&(t.akamai_edge_ip=this.akamaiEdgeIp),this.quicVersion&&(t.quic_version=this.quicVersion),this.akamaiCacheDebug&&(t.akamai_cache_debug=this.akamaiCacheDebug),t.manifest_load_durations=this.player.telecine.manifestLoadDurations,t.successful_segment_count=this.player.telecine.successfulSegments.length,t.failed_segment_count=this.player.telecine.failedSegments.length,this._send(mu,t),this._captionsInitCheck()}}},{key:"_onCanPlay",value:function(){this.isScrubbing||this._send(Jl)}},{key:"_onManifestLoaded",value:function(){this._send(ru)}},{key:"_onBufferOccupancyChange",value:function(e){this.bufferOccupancies.push(e)}},{key:"_onBufferStarted",value:function(){this.startupTimeLogged&&!this.isScrubbing&&(this.lastBufferTime||(this.bufferCount++,this.lastBufferTime=ku(),this._send(Ql,{lower_profile_available:this.player.telecine.isLowerProfileAvailable})),this.currentlyBuffering=!0)}},{key:"_onBufferEnded",value:function(){if(this.lastBufferTime&&this.startupTimeLogged&&(!this.isScrubbing||this.currentlyBuffering)){var e=Su(this.lastBufferTime)/1e3;this.totalBufferDuration+=e,this._send($l,{duration:e}),this.currentlyBuffering=!1,this.lastBufferTime=null}else this.lastBufferTime=null}},{key:"_onRanIntoBuffer",value:function(e){this._send(fu,{lower_profile_available:e})}},{key:"_onPlaybackResumed",value:function(){this._send(du)}},{key:"_onEnterFullscreen",value:function(){this.fullscreen=!0,this._send(nu)}},{key:"_onExitFullscreen",value:function(){this.fullscreen=!1,this._send(nu)}},{key:"_onDroppedFrames",value:function(e){var t=e.dropped/e.total*100;this.droppedFramePercent=Math.round(100*t)/100,this.droppedFrames=e.dropped}},{key:"_onChangeQuality",value:function(e){"auto"!==e&&(this.stayedOnAuto=!1),this.player.telecine.video.currentFile.mime===ri.dash&&("auto"===e||this.qualityPickedLogged?"auto"===e&&this.qualityPickedLogged&&!this.backToAutoLogged&&(this._send(yu,{quality:this.currentQuality,auto:1}),this.backToAutoLogged=!0):(this._send(_u,{quality:e,auto:0}),this.qualityPickedLogged=!0),this.currentQuality=e)}},{key:"_onStreamChanged",value:function(e,t,n){var i=(this.currentStream=e).profile?e.profile:e.id,r=ku();if(this.profiles[i]=this.profiles[i]||[],this.lastProfileId){var o=this.profiles[this.lastProfileId].length-1;this.profiles[this.lastProfileId][o]&&(this.profiles[this.lastProfileId][o].end=r)}this.lastVideoBitrate&&(n[t].bitrate>this.lastVideoBitrate?this.qualityUpSwitchCount+=1:this.qualityDownSwitchCount+=1),this.profiles[i].push({start:r}),this.playedProfiles[i]={bitrate:n[t].bitrate,width:n[t].width,height:n[t].height},this._send(gu,{previous_audio_bitrate:this.lastAudioBitrate,previous_video_bitrate:this.lastVideoBitrate,previous_profile_id:String(this.lastProfileId)}),this.lastProfileId=i,this.lastVideoBitrate=n[t].bitrate,this.lastAudioBitrate=n[t].audioBitrate}},{key:"_onSeek",value:function(){this.currentlyPlaying=!1}},{key:"_captionsInitCheck",value:function(){this.previousCaptionsID||null!==this.player.config.request.cookie.captions&&"null"!==this.player.config.request.cookie.captions&&this._onCaptionsEnabled(this.player.config.request.cookie.captions)}},{key:"_onCaptionsEnabled",value:function(e){this.previousCaptionsID!==e&&(this.previousCaptionsID=e,this._send(Vl,{captions_id:String(e)}))}},{key:"_onCaptionsDisabled",value:function(){this.previousCaptionsID&&(this.previousCaptionsID=null,this._send(Hl))}},{key:"_onScrubbingStarted",value:function(){this._send(bu),this.isScrubbing=!0}},{key:"_onScrubbingEnded",value:function(){this.isScrubbing=!1,this._send(wu)}},{key:"_onEnded",value:function(e){this.currentlyPlaying=!1,this.hasEnded=!0,this._send(eu)}},{key:"_onLiveEventEnded",value:function(){this.currentlyBuffering&&(this.currentlyBuffering=!1,this.lastBufferTime=null,this._send($l,{duration:0}))}},{key:"_onAlertVisibilityChanged",value:function(e,t){e?this._send(jl):this._send(Ul)}},{key:"_onError",value:function(e){var t={error_type:e,error_reason:2<arguments.length&&void 0!==arguments[2]?arguments[2]:null};this.startupTimeLogged?this._send(uu,t):this.startAttemptLogged?this._send(pu,t):this._send(iu,t)}},{key:"_onErrorLinkPressed",value:function(e,t){this._send(Wl,{error_type:t,error_url:e})}},{key:"_onStreamTargetChange",value:function(e,t,n){var i=e.profile?e.profile:e.id,r=n[t].bitrate,o=ku();if(this.targetProfileId[i]=this.targetProfileId[i]||[],this.lastTargetProfileId){var a=this.targetProfileId[this.lastTargetProfileId].length-1;this.targetProfileId[this.lastTargetProfileId][a]&&(this.targetProfileId[this.lastTargetProfileId][a].end=o)}this.targetProfileId[i].push({start:o}),this.targetProfiles[i]={bitrate:r,width:n[t].width,height:n[t].height},this.lastTargetProfileId=i}},{key:"_onForcedQuality",value:function(e){this.forcedEmbedQuality=e}},{key:"_onAdaptiveBandwidth",value:function(e){var t=e.speed;this.speeds.push(t),500<this.speeds.length&&this.speeds.shift()}},{key:"_onSegmentDownloaded",value:function(e){e.identifier;var t=e.data.headers;"akamai-edge-ip"in t&&(this.akamaiEdgeIp=t["akamai-edge-ip"]),"quic-version"in t&&(this.quicVersion=t["quic-version"]),"x-vim-cachebc"in t&&(this.akamaiCacheDebug=t["x-vim-cachebc"])}},{key:"_onVideoDurationMismatch",value:function(e){this._send(Zl,{duration_difference:Math.round(100*e)/100})}},{key:"_onOverlayOpened",value:function(e){"email-capture"===e&&this._send(Xl,{slate_type:"email"})}},{key:"_onPlaybackRateChanged",value:function(e,t){this._send(cu,{previous_playback_rate:t})}},{key:"_onManifestTimeout",value:function(){this._send(ou)}},{key:"_resetMetrics",value:function(){this.startAttemptLogged=!1,this.startupTimeLogged=!1,this.qualityPickedLogged=!1,this.backToAutoLogged=!1,this.lastProfileId=null,this.lastTargetProfileId=null,this.lastAudioBitrate=null,this.lastVideoBitrate=null,this.currentlyPlaying=!1,this.playedTo=0,this.autoplayType=this.player.config.embed.autoplay,this.playerLoadTime=Tu(),this.endpoint=this._getFresnelEndpoint(),this.currentQuality="auto",this.akamaiEdgeIp=null,this.quicVersion=null,this.akamaiCacheDebug=null,this.bufferCount=0,this.currentMinuteWatchedTime=0,this.totalMinutesWatched=0,this.hasEnded=!1,this.droppedFramePercent=0,this.droppedFrames=0,this.currentlyBuffering=!1,this.fullscreen=!1,this.qualityUpSwitchCount=0,this.qualityDownSwitchCount=0,this.playedProfiles={},this.profiles={},this.speeds=[],this.bufferOccupancies=[],this.targetProfiles={},this.targetProfileId={},this.forcedEmbedQuality="none",this.sessionPlaybackDuration=0,this.stayedOnAuto=!0}}]),n}(),Cu=function(){function i(e,t,n){Yn(this,i),this.player=e,this.element=t,this.store=n,this.muxClient=null,this._canTrack()&&this._loadMuxEmbed()}return Xn(i,[{key:"_canTrack",value:function(){return!this.player.doNotTrackEnabled&&this.store.get(cl)}},{key:"_loadMuxEmbed",value:function(){var e=this,t="vp-mux-client";if(!document.getElementById(t)){var n=document.createElement("script");n.setAttribute("id",t),n.setAttribute("src",this.player.config.request.urls.mux_url),n.onreadystatechange=n.onload=function(){e.store.get("ui.liveEvent.isLiveStarted")&&e._monitor(),e._setUpPlayerEvents()},document.getElementsByTagName("head")[0].appendChild(n)}}},{key:"_setUpPlayerEvents",value:function(){var t=this;this.player.events.on(si.configChanged,function(){t._canTrack()&&t._monitor()}),this.store.watch("ui.liveEvent.isLiveStarted",function(e){e&&t._monitor()})}},{key:"_monitor",value:function(){if("undefined"!=typeof mux){var e=this.player.telecine.video?this.player.telecine.video.currentFile:{},t=this.element.querySelector(".vp-telecine").getElementsByTagName("video")[0];null!==this.muxClient&&mux.destroyMonitor(t),this.muxClient=mux.monitor(t,{debug:!1,data:{property_key:"dev"===this.player.config.request.build.js?"kghblrf3bb9uk33lv58ompm3k":"md0ig7ssl8unl2kpl0h6p0drn",player_name:"Vimeo Player",player_init_time:Date.now(),player_version:this.player.config.request.build.js,video_title:this.player.config.video.title,video_id:this.player.config.video.id,video_duration:1e3*this.player.config.video.duration,video_cdn:e.metadata?e.metadata.cdn:"akamai",video_stream_type:this.store.get(cl)?"live":"vod"}})}}}]),i}();function Ou(v,p){var l,u,m,r,c,t,d=30,i=0,f=1e3,g={};function h(){return Date.now?Date.now():(new Date).getTime()}function n(){l=!1,u=v.telecine?v.telecine.currentTime:0,c=r=m=0,t=!1}function y(r,o,a,s){v.verifyConfig().then(function(){var e=o;e.signature=v.config.request.signature,e.session=v.config.request.session,e.time=v.config.request.timestamp,e.expires=v.config.request.expires;var t=JSON.stringify(e),n="https://"+v.config.player_url+r;if(null===e.sessionTime&&(sr.captureBreadcrumb("sessionTime is null breadcrumbs",{endpoint:r,allParams:e}),sr.captureException("sessionTime is null when making stats request")),navigator.sendBeacon&&navigator.sendBeacon(n,t))return!0;var i=new XMLHttpRequest;return i.open("POST",n,!a),i.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),i.withCredentials=!0,i.onload=function(){200!==i.status&&s<2&&setTimeout(function(){y(r,o,a,s+1)},1e3)},i.send(t),i}).catch(function(e){})}function _(i,r,o){var a=v.telecine.currentFile||{},e=a.id,s=void 0===e?0:e,t=a.mime,l=void 0===t?ri.h264:t,n=a.metadata,u=(n=void 0===n?{}:n).profile,c=void 0===u?-1:u;if(l===ri.dash){var d=g,f=d.id;s=void 0===f?0:f;var h=d.profile;c=void 0===h?-1:h}v.performDelegateAction(ai.playLog,function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};y(i,{referrer:v.config.request.referrer,embed:!v.config.embed.on_site,context:v.config.embed.context,autoplay:n.continuous?2:v.config.embed.autoplay,loop:v.config.embed.loop?1:0,id:v.config.video.id,vodId:v.config.video.vod&&v.config.video.vod.id?v.config.video.vod.id:null,vodSaleId:v.config.video.vod&&v.config.video.vod.sale_id?v.config.video.vod.sale_id:null,sessionTime:Vn(m),videoShape:v.config.video.spatial?"mono"!==v.config.video.spatial.stereo_mode?2:1:0,spatialPlayback:(t=v.telecine.getEffectByName("ThreeSixtyEffect"),Te.spatialPlayback&&t?t.isStereo()?2:1:0),userId:v.config.user.id,userAccountType:v.config.user.account_type,userIsMod:v.config.user.mod?1:0,ownerId:v.config.video.owner.id,ownerAccountType:v.config.video.owner.account_type,privacy:v.config.video.privacy,rating:v.config.video.rating?v.config.video.rating.id:null,type:hi[v.telecine.currentScanner],videoFileId:Number.isInteger(Number(s))?s:0,delivery:ci[l],profileId:c,quality:a.metadata?a.metadata.quality:null,duration:Vn(v.config.video.duration),seconds:Vn(r),isLive:p.get(cl)?1:0,playbackRate:v.telecine.playbackRate},o)})}function b(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(v.playLoggingEnabled){var i=h();n&&i<r+f||(r=i,n&&!v.config.request.flags.partials||l||_("/log/partial",e,t))}}function w(e,t){if(!v.doNotTrackEnabled){t=t||{};var n={referrer:v.config.request.referrer,embed:!v.config.embed.on_site,context:v.config.embed.context,id:v.config.video.id,vodId:v.config.video.vod&&v.config.video.vod.id?v.config.video.vod.id:null,vodSaleId:v.config.video.vod&&v.config.video.vod.sale_id?v.config.video.vod.sale_id:null,userId:v.config.user.id,userAccountType:v.config.user.account_type,ownerId:v.config.video.owner?v.config.video.owner.id:0,duration:Vn(v.config.video.duration),seconds:Vn(v.telecine.currentTime),playbackRate:v.telecine.playbackRate};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);y("/log/"+e,n)}}return n(),function(){v.events.on(si.playProgress,function(e,t,n,i){var r=Math.floor(e);!l&&c+f<h()&&(u<e&&(m+=(e-u)/i),u=e),r%d==0&&b(e)}),v.events.on(si.playbackRateChanged,function(e,t){w("playback_rate_change",{oldPlaybackRate:t}),b(v.telecine.currentTime)}),v.events.on(si.playInitiated,function(){!t&&v.playLoggingEnabled&&(t=!0,_("/log/play",0))}),v.events.on(si.paused,function(e){v.telecine.ended||b(e)}),v.events.on(si.seeked,function(e,t,n){i=e,l||b(i)}),v.events.on(si.scrubbingStarted,function(){c=h(),l=!0}),v.events.on(si.scrubbingEnded,function(){u=v.telecine.currentTime,l=!1,b(i)}),v.events.on(si.prefsButtonPressed,function(){b(v.telecine.currentTime)}),v.events.on(si.ended,function(){m+=v.config.video.duration-u,b(v.config.video.duration,!1,!1)}),v.events.on(si.streamChanged,function(e){g=e});var o=[],a=!1,s=1e3;function e(){o.length&&v.performDelegateAction(ai.playLog,function(e){y("/log/spatial",{embed:!v.config.embed.on_site,id:v.config.video.id,context:v.config.embed.context,ownerId:v.config.video.owner?v.config.video.owner.id:0,referrer:v.config.request.referrer,vodId:v.config.video.vod&&v.config.video.vod.id?v.config.video.vod.id:null,vodSaleId:v.config.video.vod&&v.config.video.vod.sale_id?v.config.video.vod.sale_id:null,motionLog:JSON.stringify(o)},!1)})}v.events.on(si.spatialMotionStart,function(){a=!0,function e(){var t=v.telecine.getEffectByName("ThreeSixtyEffect").currentCoordinates,n=Math.round(100*t.lat)/100,i=Math.round(100*t.long)/100,r={sessionTime:m,videoTime:v.telecine.currentTime,coordinates:{lat:n,lon:i}};o.push(r),setTimeout(function(){a&&e()},s)}()}),v.events.on(si.spatialMotionEnd,function(){a=!1,e()}),v.events.on(si.loadVideo,function(){e(),o=[]}),ar(function(){v.telecine&&0<v.telecine.currentTime&&(b(v.telecine.currentTime,!0,!1),e())})}(),v.doNotTrackEnabled||([{type:"share_press",event:si.shareButtonPressed},{type:"facebook_press",event:si.facebookButtonPressed},{type:"twitter_press",event:si.twitterButtonPressed},{type:"tumblr_press",event:si.tumblrButtonPressed},{type:"email_press",event:si.emailButtonPressed},{type:"embed_press",event:si.embedButtonPressed},{type:"login_success",event:si.userLoggedIn},{type:"airplay",event:si.airPlayActivated},{type:"vod_press",event:si.vodButtonPressed},{type:"collection_press",event:si.collectionsButtonPressed},{type:"email_capture_submitted",event:si.emailCaptureSubmitted}].forEach(function(e){var t;v.events.on(e.event,(t=e.type,function(){w(t)}))}),v.events.on(si.outroDisplayed,function(e){var t={outroType:v.config.embed.outro,ownerAccountType:v.config.video.owner.account_type,playerWidth:v.element.clientWidth,playerHeight:v.element.clientHeight};e&&e.length&&(t.outroVideos=e.join(",")),w("outro_displayed",t)}).on(si.outroVideoPressed,function(e){w("outro_video_press",{ownerAccountType:v.config.video.owner.account_type,videoId:e})}).on(si.followButtonPressed,function(){w("outro_follow_press",{add:!v.config.user.following})}).on(si.outroCtaPressed,function(e){w("outro_cta_press",{ownerAccountType:v.config.video.owner.account_type,link:e})}).on(si.outroLinkPressed,function(e){w("outro_link_press",{ownerAccountType:v.config.video.owner.account_type,link:e})}).on(si.outroImagePressed,function(e){w("outro_image_press",{ownerAccountType:v.config.video.owner.account_type,link:e})}).on(si.likeButtonPressed,function(){w("like_press",{add:!v.config.user.liked})}).on(si.watchLaterButtonPressed,function(){w("watch_later_press",{add:!v.config.user.watch_later})}).on(si.popupOpened,function(e){0===e.indexOf("login-")&&w("login_attempt")}).on(si.captionsChanged,function(e,t){t||(e?w("text_track_change",{textTrackLanguage:e.language,textTrackKind:e.kind}):w("text_track_change"))}).on(si.badgePressed,function(e){1!==e&&12!==e||w("badge_press",{badgeId:e})}).on(si.overlayOpened,function(e){"email-capture"===e&&w("email_capture_displayed")}).on(si.overlayClosed,function(e){"email-capture"===e&&w("email_capture_dismissed")}).on(si.cardPressed,function(e){w("card_press",{ownerAccountType:v.config.video.owner.account_type,cardId:e,cardType:"link"})}).on(si.cardDisplayed,function(e,t){v.config.embed.editor||w("card_displayed",{ownerAccountType:v.config.video.owner.account_type,cardId:e,cardType:t.url?"link":"text"})})),v.events.on(si.configChanged,function(e){e&&n()}),v.events.fire(si.statsModuleReady),{}}function Ru(){return function(e){return function(){var s=e.apply(void 0,arguments),l=Rn();function t(e,t){return(e=[].concat(e)).map(function(e){return t(s.createGetter(e))})}return Qn({},s,{watch:function(e,a){return t(e,function(e){var n,i,r,t=l.get({selector:e,listener:a});if(!t){var o=(i=a,r=(n=e)(s.getState()),s.subscribe(function(){var e=n(s.getState());if(r!==e){var t=r;i(r=e,t,s.getState())}}));t=l.insert({selector:e,listener:a,unsubscribe:o})}return t.unsubscribe})},unwatch:function(e,n){return t(e,function(e){var t=l.get({selector:e,listener:n});return t&&t.unsubscribe()})}})}}}Function.prototype.toString.call(Object);var Mu=function(e,t){return null==e||e!=e?t:e};function Iu(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e){return function(){var i=e.apply(void 0,arguments);function n(){return t}var r=Ve(function(t){if(K(t))return t;var e=it(n(),t);return K(e)?e:function(e){return it(e,t)}});return Qn({},i,{getSelectors:n,createGetter:r,get:function(e,t){var n=(e=r(e))(i.getState());return void 0!==t&&(n=Mu(n,t)),n}})}}}var Du={settings:{}};function Fu(e,t){return e===t}function Bu(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Fu,n=null,i=null;return function(){return function(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var i=t.length,r=0;r<i;r++)if(!e(t[r],n[r]))return!1;return!0}(t,n,arguments)||(i=e.apply(null,arguments)),n=arguments,i}}var qu=function(l){for(var e=arguments.length,u=Array(1<e?e-1:0),t=1;t<e;t++)u[t-1]=arguments[t];return function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=0,r=t.pop(),o=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var n=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}(t),a=l.apply(void 0,[function(){return i++,r.apply(null,arguments)}].concat(u)),s=Bu(function(){for(var e=[],t=o.length,n=0;n<t;n++)e.push(o[n].apply(null,arguments));return a.apply(null,e)});return s.resultFunc=r,s.recomputations=function(){return i},s.resetRecomputations=function(){return i=0},s}}(Bu);function Nu(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=t.type,i=t.payload;switch(n){case nl:return Qn({},e,i.video);default:return e}}var ju=function(e){return e.video.width},Uu=function(e){return e.video.height},Vu=qu(ju,Uu,function(e,t){return t/e}),Hu=Object.freeze({default:Nu,width:ju,height:Uu,ratio:Vu}),Wu="PLAYER_RESIZE",zu=function(e,t){return{type:Wu,payload:{width:e,height:t}}},Gu={xxs:0,xs:390,sm:600,md:960,lg:1280,xl:1600,xxl:1920};function Ku(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case Wu:return Qn({},e,{width:t.payload.width,height:t.payload.height});default:return e}}var Yu=function(e){return yc(e)},Xu=function(e){return e.embed.transparent?Math.round(Math.min((e.ui.player.height-Yu(e))/Vu(e),e.ui.player.width)):e.ui.player.width},$u=function(e){return e.embed.transparent?Math.round(Math.min(e.ui.player.width*Vu(e)+Yu(e),e.ui.player.height)):e.ui.player.height},Qu=function(e){return Xu(e)},Ju=function(e){return $u(e)-Yu(e)},Zu=function(e){return(e.ui.player.width-Xu(e))/2},ec=function(e){return(e.ui.player.height-$u(e))/2},tc=qu(Xu,$u,Zu,ec,function(e,t,n,i){return{width:e,height:t,x:n,y:i}}),nc=function(e){var t=Qu(e),n=Ju(e),i=wo(e.embed.settings.customLogo)&&t<300||n<169,r=!wo(e.embed.settings.customLogo)&&(t<338||n<190);return i||r},ic=function(e){var t=Qu(e),n=wo(e.embed.settings.customLogo)&&t<375,i=!wo(e.embed.settings.customLogo)&&t<450;return n||i},rc=function(e){var t=Qu(e);return t>=Gu.xxs&&t<Gu.xs},oc=function(e){var t=Qu(e);return t>=Gu.xs&&t<Gu.sm},ac=function(e){var t=Qu(e);return t>=Gu.sm&&t<Gu.md},sc=function(e){var t=Qu(e);return t>=Gu.md&&t<Gu.lg},lc=function(e){var t=Qu(e);return t>=Gu.lg&&t<Gu.xl},uc=function(e){var t=Qu(e);return t>=Gu.xl&&t<Gu.xxl},cc=function(e){return Qu(e)>=Gu.xxl},dc=Object.freeze({breakpoints:Gu,default:Ku,innerBottom:Yu,layoutWidth:Xu,layoutHeight:$u,innerWidth:Qu,innerHeight:Ju,layoutX:Zu,layoutY:ec,layout:tc,isTinyMode:nc,isMiniMode:ic,mode:function(e){return nc(e)?"tiny":ic(e)?"mini":"normal"},xxs:rc,xs:oc,sm:ac,md:sc,lg:lc,xl:uc,xxl:cc,breakpoint:function(t){var n={xxs:rc,xs:oc,sm:ac,md:sc,lg:lc,xl:uc,xxl:cc};return Object.keys(Gu).find(function(e){return n[e](t)})}});function fc(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case Or:return Qn({},e,{width:t.payload.width,height:t.payload.height});default:return e}}var hc=Object.freeze({default:fc,scaleFactor:function(e){return Bn({width:e.ui.preview.width,height:e.ui.preview.height,elementWidth:Qu(e),elementHeight:Ju(e)}).scaleFactor}}),vc="CARDS_SET_SIZE",pc=function(e){return{type:vc,payload:e}};function mc(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case vc:return Qn({},e,{size:t.payload});default:return e}}var gc=function(e){return 0<e.ui.cards.size&&200<=e.ui.player.width&&e.ui.player.width<415},yc=function(e){return gc(e)?60:0},_c=Object.freeze({default:mc,isCarouselVisible:gc,isCardsThumbVisible:function(e){return 0<e.ui.cards.size&&300<=e.ui.player.width},getCarouselHeight:yc}),bc=Object.freeze({scaleFactor:function(e){return Bn({width:e.video.width,height:e.video.height,elementWidth:Qu(e),elementHeight:Ju(e)}).scaleFactor}}),wc=Object.freeze({size:function(e){return Math.max(10,Math.round(.045*Ju(e)))}}),kc=Object.freeze({isLinkTitleVisible:function(e){var t=e.ui;return 360<=t.player.width&&203<=t.player.height||415<=t.player.width},isLinkDescriptionVisible:function(e){var t=e.ui;return 360<=t.player.width&&340<=t.player.height||415<=t.player.width&&234<=t.player.height}}),Sc=Object.freeze({isEmailCaptureVisible:function(e){var t=e.ui;return 300<=t.player.width&&169<=t.player.height}}),Ec=function(e){return Qu(e)<415},Tc=Object.freeze({isPrefsMenuCentered:Ec,hasPrefsMenuCarousel:function(e){return Ec(e)||Te.touch}});function xc(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return{player:Ku(e.player,t),preview:fc(e.preview,t),cards:mc(e.cards,t),liveEvent:rl(e.liveEvent,t)}}var Ac=Object.freeze({default:xc,player:dc,preview:hc,video:bc,liveEvent:fl,cards:_c,outro:kc,overlay:Sc,controlbar:Tc,captions:wc});function Lc(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=Qn({},function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case nl:return Qn({},e,t.payload);default:return e}}(e,t),{embed:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Du,t=arguments[1],n=t.type,i=t.payload;switch(n){case nl:return Qn({},e,i.embed);default:return e}}(e.embed,t),video:Nu(e.video,t),liveEvent:hl(e.liveEvent,t)});return Qn({},n,{ui:xc(e.ui,t,n)})}var Pc=Object.freeze({default:Lc,video:Hu,liveEvent:gl,ui:Ac});function Cc(e,t,n){var i=!1,r=!1,s=!1,o=[];function a(e){n.style.fontSize=e+"px"}function l(){n.classList.add("hidden"),n.setAttribute("hidden","")}function u(){"picture-in-picture"!==e.telecine.presentationMode&&(n.classList.remove("hidden"),n.removeAttribute("hidden"))}function c(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];n.firstChild;)n.removeChild(n.firstChild);if(e.length){var a=document.createDocumentFragment();e.forEach(function(e){var t,r,n,i=document.createElement("span"),o=e.html;s&&(t=e.text.replace("\n","<br>").split(/<br ?\/?>/),r=t.reduce(function(e,t){return Math.max(e,t.replace(/<\/?\w>/g,"").length)},0),o=(n="+"+Array(r+3).join("-")+"+")+"<br>"+(t=t.map(function(e){var t=r-e.replace(/<\/?\w>/g,"").length,n=Math.floor(t/2),i=Math.ceil(t/2);return'<span class="bar">|</span>&nbsp;'+Array(n+1).join("&nbsp;")+e+Array(i+1).join("&nbsp;")+'&nbsp;<span class="bar">|</span>'})).join("<br>")+"<br>"+n),i.innerHTML=o,a.appendChild(i)}),n.appendChild(a)}}return e.events.on(si.cueChanged,function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(c(o=t),t.length)return i?void u():void(r=!0);l()}).on(si.captionsChanged,function(e){if(e)return n.setAttribute("lang",e.language),void n.setAttribute("dir",e.rtl?"rtl":"ltr");n.removeAttribute("dir"),n.removeAttribute("lang")}).on(si.playInitiated,function(){i=!0,r&&(r=!1,u())}).on(si.pictureInPictureActivated,function(){l()}).on(si.pictureInPictureDeactivated,function(){u()}).on(oi.reset,function(){i=!1,l()}).on(oi.setEffect,function(e){s="ascii"===e,c(o)}),t.watch("ui.captions.size",a),a(t.get("ui.captions.size")),e.events.on(si.controlBarVisibilityChanged,function(e){e?n.classList.add("with-controls"):n.classList.remove("with-controls")}),e.events.on(si.overlayOpened,function(){n.classList.add("invisible")}).on(si.overlayClosed,function(){n.classList.remove("invisible")}),e.events.on(si.ended,function(){"nothing"!==e.config.embed.outro&&n.classList.add("invisible")}).on([si.played,si.scrubbingStarted],function(){n.classList.remove("invisible")}),{}}var Oc=t(function(e){var n;(n={templates:{},render:function(e,t){return n.templates[e]?n.templates[e].call(n,t||{}):""},map:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},escape:function(e){return e.replace(/[&<>"'\/]/g,function(e){return n.map[e]})},helpers:{}}).templates.stream_studder=function(e){var t="<h3> ";return t+=this.render("icon_warning")||"",t+=' <span>Having issues? <button type="button" class="player-alert-button-link button-link" aria-label="Switch to auto" data-alert-autofocus data-close data-context="suggestion">Switch to Auto</button> for smoother streaming.</span></h3>'},n.templates.warning_alert=function(e){var t="<h3> ";return t+=this.render("icon_warning")||"",t+=" <span>"+e.strings.text+"<span></h3>"},n.templates.buffer_pattern=function(e){return'<pattern id="'+e.id+'" patternUnits="userSpaceOnUse" x="0" y="0" width="10" height="10" viewBox="0 0 10 10"><line x1="5" y1="-1" x2="-5" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /><line x1="10" y1="-1" x2="0" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /><line x1="15" y1="-1" x2="5" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /></pattern>'},n.templates.card=function(e){var t='<div class="card';return e.className&&(t+=" "+e.className),e.teaser&&(t+=" card-hasDetail"),t+='"> ',e.url&&(t+='<a class="card-link" href="'+e.url+'" target="_blank" rel="noopener">'),t+=' <div class="card-inner"> ',e.image&&(t+=' <div class="card-imageWrap js-cardImageWrap"><img class="card-image" src="'+e.image+'" alt=""></div> '),t+=' <div class="card-body"><h3 class="card-text card-text--title"><span>',t+=this.escape(e.headline)||"",t+="</span> ",e.url&&(t+=this.render("icon_card_arrow")||""),t+=" </h3> ",e.teaser&&(t+=' <p class="card-text card-text--detail"> ',t+=this.escape(e.teaser)||"",t+=" </p> "),t+=" </div></div> ",e.url&&(t+="</a>"),t+="</div>"},n.templates.compass=function(e){var t='<svg viewBox="0 0 36 36"> ';return 1==e.version?t+=' <circle class="compass-background" r="18" cx="18" cy="18"></circle><path class="compass-slice" transform="rotate(-45, 18, 18)" d="M0,0 m18,18 l12,0 A12,12 0 0,0 18,6 z"/><circle fill="none" class="compass-ring" stoke-width="3" r="14.5" cx="18" cy="18"></circle><polygon class="compass-dimple" points="16,3.5 18,1 20,3.5"/> ':t+=' <circle class="compass-background" r="18" cx="18" cy="18"></circle><path class="compass-slice" transform="rotate(-30, 18, 18)" d="M0,0 m18,18 l13,0 A13,13 0 0,0 11.500000000000004,6.741669750802297 z"/><circle class="compass-centercircle" r="3" cx="18" cy="18"></circle><path class="compass-line" stroke-linecap="round" d="M0,18 L36,18 z" /> ',t+="</svg>"},n.templates.controlbar_trailer=function(e){var t='<button type="button" class="play trailer rounded-box" title="'+e.strings.playTrailer+'" aria-label="'+e.strings.playTrailer+'"><div><span class="play-icon">';return t+=this.render("icon_play")||"",t+="</span><p>"+e.text+"</p></div></button>",e.vimeoLogo.show&&(t+=' <div class="logo"> ',e.vimeoLogo.showLink&&(t+=' <a href="'+e.vimeoLogo.url+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=' title="'+e.strings.watchOnVimeo+'" aria-label="'+e.strings.watchOnVimeo+'" data-clip-link> '),t+=this.render("logo")||"",e.vimeoLogo.showLink&&(t+=" </a> "),t+=" </div>"),t+="",e.customLogo&&(t+=' <div class="custom-logo',e.customLogo.sticky&&(t+=" sticky"),t+='" style="width:'+e.customLogo.width+"px;height:"+e.customLogo.height+'px"> ',e.customLogo.showLink&&(t+='<a href="'+e.customLogo.url+'" target="_blank" rel="noopener">'),t+=' <img src="'+e.customLogo.img+'" alt=""> ',e.customLogo.showLink&&(t+="</a>"),t+=" </div>"),t+=""},n.templates.controlbar=function(e){var t='<button type="button" class="play rounded-box state-'+e.playState+'" title="'+e.strings.play+'" data-title-play="'+e.strings.play+'" data-title-pause="'+e.strings.pause+'" data-title-replay="'+e.strings.replay+'" aria-label="'+e.strings.play+'"><div class="tiny-bars"><svg width="100%" height="100%" viewBox="0 0 65 40"><defs><clipPath id="rounded-border"><rect height="100%" width="100%" x="0" y="0" rx="5"/></clipPath> ';return t+=this.render("buffer_pattern",{id:"tiny-buffer"})||"",t+=' </defs><g clip-path="url(#rounded-border)"><rect class="buffer hidden" height="3" width="110%" x="0" y="37" fill="url(#tiny-buffer)"/><rect class="loaded" height="3" width="0" x="0" y="37" fill="#666"/><rect class="played fill" height="3" width="0" x="0" y="37"/></g></svg></div><div class="play-icon">',t+=this.render("icon_play")||"",t+='</div><div class="pause-icon">',t+=this.render("icon_pause")||"",t+='</div><div class="replay-icon">',t+=this.render("icon_replay")||"",t+='</div></button><div class="play-bar rounded-box"> ',t+=this.render("live_status")||"",t+=this.render("live_viewer_count")||"",t+=' <div class="vp-progress"><div class="loaded',e.rawDuration<60&&(t+=" short-video"),t+='" role="progressbar" aria-label="'+e.strings.loadedBar+'" aria-valuemin="0" aria-valuemax="'+e.rawDuration+'" aria-valuenow="0"></div><div class="played" role="progressbar" aria-label="'+e.strings.playedBar+'" aria-valuemin="0" aria-valuemax="'+e.rawDuration+'" aria-valuenow="0"></div><div class="cuepoints"></div><div class="thumb-preview invisible hidden" role="presentation" aria-hidden="true"><div class="thumb"></div></div><div class="ghost-timecode invisible hidden" role="presentation" aria-hidden="true"><div class="box">00:00</div></div><div class="timecode" role="presentation" aria-hidden="true"><div class="box">'+e.duration+"</div></div></div> ",e.volume&&(t+=' <div class="volume" role="slider" title="'+e.strings.volume+'" aria-label="'+e.strings.volume+'" aria-valuemin="0" aria-valuemax="1" tabindex="0"><div></div><div></div><div></div><div></div><div></div></div> '),e.ccButton&&(t+=' <button type="button" class="toggle cc '+(e.ccOn?"on":"off")+'" title="'+e.strings.captions+'"> ',t+=this.render("icon_cc")||"",t+=" </button> "),e.prefsButton&&(t+=' <button type="button" class="vp-prefs js-prefs" title="'+e.strings.prefs+'" aria-label="'+e.strings.prefs+'"> ',t+=this.render("icon_gear")||"",t+=" </button> "),t+=' <button type="button" class="hidden toggle effect off" title="'+e.strings.effect+'"><svg viewBox="0 0 210 200" version="1.1"><g fill="none" fill-rule="evenodd"><circle class="red" fill="#f00" cx="63.5" cy="136.5" r="63.5"/><circle class="blue" fill="#2653ff" cx="146.5" cy="136.5" r="63.5"/><circle class="green" fill="#0f0" cx="104.5" cy="63.5" r="63.5"/></g></svg></button> ',e.airplayButton&&(t+=' <button type="button" class="toggle airplay off hidden" title="'+e.strings.airPlay+'" data-title-off="'+e.strings.airPlay+'" data-title-on="'+e.strings.airPlayOff+'" hidden> ',t+=this.render("icon_airplay")||"",t+=" </button> "),e.stereoscopicButton&&(t+=' <button type="button" class="toggle stereoscopic off" title="'+e.strings.stereoscopic+'" data-title-off="'+e.strings.stereoscopic+'" data-title-on="'+e.strings.stereoscopicOff+'"> ',t+=this.render("icon_stereoscopic")||"",t+=" </button> "),t+=' <button type="button" class="pip hidden enter" title="'+e.strings.pipEnter+'" data-title-enter="'+e.strings.pipEnter+'" data-title-return="'+e.strings.pipReturn+'" hidden> ',t+=this.render("icon_pip")||"",t+=' </button><button type="button" class="fullscreen',e.fullscreenButton||(t+=" only-in-fullscreen"),t+='" title="'+e.strings.enterFullscreen+'" data-title-fullscreen="'+e.strings.enterFullscreen+'" data-title-unfullscreen="'+e.strings.exitFullscreen+'" aria-label="'+e.strings.fullscreen+'"><div class="fullscreen-icon">',t+=this.render("icon_fullscreen")||"",t+='</div><div class="unfullscreen-icon">',t+=this.render("icon_unfullscreen")||"",t+="</div></button> ",e.vimeoLogo.show&&(t+=' <div class="logo"> ',e.vimeoLogo.showLink&&(t+=' <a href="'+e.vimeoLogo.url+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=' title="'+e.strings.watchOnVimeo+'" aria-label="'+e.strings.watchOnVimeo+'" data-clip-link> '),t+=this.render("logo")||"",e.vimeoLogo.showLink&&(t+=" </a> "),t+=" </div> "),t+="</div> ",e.customLogo&&(t+=' <div class="custom-logo',e.customLogo.sticky&&(t+=" sticky"),t+='" style="max-width:'+e.customLogo.width+"px;height:"+e.customLogo.height+'px"> ',e.customLogo.showLink&&(t+='<a href="'+e.customLogo.url+'" target="_blank" rel="noopener">'),t+=' <img src="'+e.customLogo.img+'" alt=""> ',e.customLogo.showLink&&(t+="</a>"),t+=" </div>"),t+=' <div class="vp-menubar js-menubar"></div>'},n.templates.debug_panel=function(e){var t="<div class='vp-stats-debug-values'> ";return t+=this.render("debug_values",e)||"",t+="</div>",e.hideCloseButton||(t+='<button type="button" class="stats-debug-close" aria-label="Close stats debug panel">',t+=this.render("icon_close")||"",t+="</button>"),t+='<input type="text" class="stats-debug-code">',e.isCopyDisabled||(t+='<button type="button" class="vp-copy-session vp-copy-session-hidden js-copySessionButton"><span class="vp-copy-label">Copy Debug Key</span></button>'),t+=""},n.templates.debug_values=function(e){var t='<p><span class="stats-debug-label">Clip ID:</span><span class="stats-debug-value stats-debug-clip-id">'+e.clipId+"</span></p>";return e.isDash&&e.profileId&&(t+='<p><span class="stats-debug-label">Profile ID:</span><span class="stats-debug-value stats-debug-profile-id">'+e.profileId+"</span></p>"),t+='<p><span class="stats-debug-label">Delivery:</span><span class="stats-debug-value stats-debug-delivery">'+e.delivery+"</span></p>",e.resolution&&(t+='<p><span class="stats-debug-label">Playing:</span><span class="stats-debug-value stats-debug-resolution">'+e.resolution+"</span></p>"),t+='<p><span class="stats-debug-label">Embed size:</span><span class="stats-debug-value stats-debug-dimensions">'+e.embedSize+"</span></p>",e.isDash&&(t+='<p><span class="stats-debug-label">Separate AV:</span><span class="stats-debug-value stats-debug-test-group">'+e.separateAudioVideo+"</span></p>"),t+="",e.testGroup&&(t+='<p><span class="stats-debug-label">Tests:</span><span class="stats-debug-value stats-debug-test-group">'+e.testGroup+"</span></p>"),t+="",(e.isDash||e.isLive)&&(t+='<p><span class="stats-debug-label">Dropped frames:</span><span class="stats-debug-value stats-debug-dropped-frames">'+e.droppedFrames+" / "+e.totalFrames+" - "+e.droppedFramesPercent+"</span></p>"),t+="",e.isLive&&(t+='<p><span class="stats-debug-label">Live Latency:</span><span class="stats-debug-value stats-debug-live-latency">'+e.liveLatency+"</span></p>"),t+="",(e.isDash||e.isLive)&&(t+='<p><span class="stats-debug-label">Bandwidth:</span><span class="stats-debug-value stats-debug-bandwidth">'+e.bandwidthKbps+'</span><span class="stats-debug-bandwidth-minmax"> (<span class="stats-debug-value stats-debug-bandwidth-min">'+e.bandwidthMinKbps+'</span><span class="stats-debug-value stats-debug-bandwidth-max">'+e.bandwidthMaxKbps+'</span>) </span></p><div class="stats-debug-time-series"> '+e.bandwidthSeriesSvg+"</div>"),t+="",e.displayBufferOccupancy&&(t+='<p><span class="stats-debug-label">Buffer Occupancy:</span><span class="stats-debug-value stats-debug-buffer-percent">'+e.bufferOccupancyPercent+'</span></p><div class="stats-debug-buffer-occupancy"> '+e.bufferOccupancySvg+"</div>"),t+="",e.sessionId&&(t+='<p><span class="stats-debug-label">Debug Key:</span><br><span class="stats-debug-value stats-debug-session-id">'+e.sessionId+"</span></p>"),t},n.templates.icon_airplay=function(e){return'<svg class="airplay-icon" viewBox="0 0 44 36" tabindex="-1"><polygon class="fill" points="0,0 44,0 44,27 34.5,27 31,23 40,23 40,4 4,4 4,23 13,23 9.5,27 0,27"/><polygon class="fill" points="7,36 22,18 37,36"/></svg>'},n.templates.icon_back=function(e){return'<svg class="icon-back" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M0 32l32 32v-20h32l0-24h-32v-20z"/></svg>'},n.templates.icon_broken_heart=function(e){return'<svg class="unlike-icon" viewBox="0 0 110 81" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M82.496 1c-14.594 0-23.198 10.043-25.948 14.48l-6.77 10.727 13.661 8.543-13.661 12.535 5.695 15.348-9.686-15.348 11.389-11.975-11.969-7.402s4.22-14.27 4.621-15.521c.782-2.438.782-2.438-.813-3.289-5.516-2.944-12.608-8.098-21.509-8.098-16.299 0-27.506 15.037-27.506 27.885 0 12.795 12.562 22.558 22.245 27.592 9.186 4.771 30.601 18.349 32.755 24.523 2.154-6.174 23.57-19.752 32.753-24.523 9.684-5.034 22.247-14.797 22.247-27.592 0-12.848-11.208-27.885-27.504-27.885z"/></svg>'},n.templates.icon_card_arrow=function(e){return'<svg class="card-arrow" viewBox="0 0 10 10" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="10 8.337 10 0 1.663 0 1.663 1.603 7.263 1.603 0 8.866 1.134 10 8.397 2.737 8.397 8.337"/></svg>'},n.templates.icon_cc=function(e){return'<svg viewBox="0 0 20 14" tabindex="-1"><path class="fill" fill-rule="evenodd" clip-rule="evenodd" d="M17 0h-14c-1.657 0-3 1.343-3 3v8c0 1.656 1.343 3 3 3h14c1.657 0 3-1.344 3-3v-8c0-1.657-1.343-3-3-3zm-7.271 8.282c-.145.923-.516 1.686-1.105 2.268-.597.591-1.369.89-2.294.89-1.138 0-2.049-.402-2.706-1.195-.647-.786-.975-1.866-.975-3.215 0-1.458.372-2.603 1.105-3.403.65-.708 1.487-1.067 2.487-1.067 1.33 0 2.321.482 2.947 1.435.34.53.526 1.072.553 1.611l.013.236h-1.984l-.044-.169c-.092-.355-.207-.622-.343-.793-.239-.298-.591-.443-1.076-.443-.483 0-.856.209-1.14.641-.298.455-.449 1.12-.449 1.977 0 .851.156 1.49.466 1.898.298.395.666.588 1.122.588.469 0 .814-.16 1.058-.491.138-.183.255-.472.351-.856l.042-.17h2.013l-.041.258zm7.582 0c-.145.923-.516 1.686-1.104 2.268-.598.591-1.369.89-2.294.89-1.139 0-2.049-.402-2.707-1.195-.646-.785-.975-1.865-.975-3.214 0-1.458.372-2.603 1.106-3.403.649-.708 1.485-1.067 2.486-1.067 1.33 0 2.32.482 2.946 1.435.34.53.526 1.072.554 1.611l.012.236h-1.9829999999999999l-.043-.169c-.092-.355-.208-.623-.344-.793-.238-.298-.591-.443-1.076-.443-.483 0-.856.209-1.139.641-.299.455-.45 1.12-.45 1.977 0 .851.157 1.49.467 1.898.299.395.666.588 1.121.588.469 0 .814-.16 1.058-.491.138-.183.256-.472.352-.856l.042-.17h2.012l-.041.257z"/></svg>'},n.templates.icon_check=function(e){return'<svg class="check-icon" viewBox="0 0 12 12"><path class="fill" d="M10.9 2.9l-.7-.7c-.2-.2-.6-.2-.8-.1L5 6.6 2.6 4.1c-.2-.1-.6-.1-.7 0l-.8.8c-.1.1-.1.5 0 .7l3.1 3.1c.4.4 1 .4 1.4 0l5.1-5.1c.3-.2.3-.6.2-.7z"/></svg>'},n.templates.icon_clock=function(e){return'<svg class="watch-later-icon" viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill hour-hand" points="9.64,4.68 10.56,4.68 11.28,11.21 8.93,11.21 9.64,4.68" /><polyline class="fill minute-hand" points="14.19,13.65 13.7,14.14 8.58,10.4 10.44,8.5 14.19,13.65" /><circle class="stroke" cx="10" cy="10" r="8" stroke-width="2" /></svg>'},n.templates.icon_close_new=function(e){return'<svg class="icon-close-new" viewBox="0 0 16 16" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M8.001 9.416l6.437 6.437a.497.497 0 0 0 .713-.001l.7-.7a.503.503 0 0 0 .002-.714L9.416 8.001l6.437-6.436a.497.497 0 0 0-.001-.713l-.7-.7a.503.503 0 0 0-.714-.002L8.001 6.587 1.565.15a.497.497 0 0 0-.713.001l-.7.7a.503.503 0 0 0-.002.714L6.587 8 .15 14.438a.497.497 0 0 0 .001.713l.7.7a.503.503 0 0 0 .714.002L8 9.416z"/></svg>'},n.templates.icon_close=function(e){return'<svg class="icon-close" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M60 48.796l-16.812-16.796 16.812-16.796-11.204-11.204-16.796 16.804-16.804-16.804-11.196 11.204 16.796 16.796-16.796 16.796 11.196 11.204 16.804-16.804 16.796 16.804z"/></svg>'},n.templates.icon_collections=function(e){return'<svg class="collections-icon" viewBox="0 0 24 24" tabindex="-1"><path class="fill" d="M24 12c0-.3-.1-.6-.4-.8l-2.7-2.3 2.4-1c.4-.1.7-.5.7-.9 0-.3-.1-.6-.4-.8l-7-6c-.1-.1-.4-.2-.6-.2-.1 0-.3 0-.4.1l-15 6c-.3.1-.6.5-.6.9 0 .3.1.6.4.8l2.7 2.3-2.4 1c-.4.1-.7.5-.7.9 0 .3.1.6.4.8l2.7 2.3-2.4 1c-.4.1-.7.5-.7.9 0 .3.1.6.4.8l7 6c.1.1.4.2.6.2.1 0 .3 0 .4-.1l15-6c.4-.1.6-.5.6-.9 0-.3-.1-.6-.4-.8l-2.7-2.3 2.4-1c.4-.1.7-.5.7-.9zm-8.2-9.8l5.3 4.5-12.9 5.1-5.3-4.5 12.9-5.1zm5.3 14.5L8.2 21.8l-5.3-4.5 1.9-.8 2.6 2.2c.1.2.4.3.6.3.1 0 .3 0 .4-.1l10.5-4.2 2.2 2zm-12.9.1l-5.3-4.5 1.9-.8 2.6 2.2c.1.2.4.3.6.3.1 0 .3 0 .4-.1l10.5-4.2 2.3 1.9-13 5.2z"/></svg>'},n.templates.icon_embed=function(e){return'<svg class="embed-icon" viewBox="0 0 55 48" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="16.019,16.385 11.968,13.131 0,24.543 12.082,35.955 16.132,32.703 7.439,24.543"/><polygon class="fill" points="42.92,13.131 38.868,16.384 47.561,24.542 38.981,32.701 43.033,35.955 55,24.542"/><polygon class="fill" points="24.083,39.221 28.76,39.221 36.243,8.351 31.566,8.351"/></svg>'},n.templates.icon_facebook=function(e){return'<svg class="facebook-icon" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M35.992 64h-11.992v-32h-8v-11.028l8-0.004-0.013-6.497c0-8.997 2.44-14.471 13.037-14.471h8.824v11.030h-5.514c-4.127 0-4.325 1.541-4.325 4.418l-0.016 5.52h9.918l-1.169 11.028-8.741 0.004-0.008 32z"/></svg>'},n.templates.icon_follow=function(e){return'<svg class="icon icon-follow" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid" tabindex="-1"><defs><clipPath id="icon-mask--check"><rect x="0" y="0" width="24" height="24" /></clipPath></defs><path class="icon-path icon-path--plus fill" d="M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"/><path class="icon-path icon-path--check fill" d="M9 21.035l-9-8.638 2.791-2.87 6.156 5.874 12.21-12.436 2.843 2.817z" clip-path="url(#icon-mask--check)"/><path class="icon-path icon-path--close fill" d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"/></svg>'},n.templates.icon_fullscreen=function(e){return'<svg viewBox="0 0 12 12" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(90)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(180)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(270)" /></svg>'},n.templates.icon_gear=function(e){return'<svg class="icon-gear" viewBox="0 0 19 16" preserveAspectRatio="xMidYMid" tabindex="-1"><defs><clipPath id="icon-gear-mask-hd"><polygon points="19 9.422 19 0 0 0 0 16 4.996 16 6 9.422 19 9.422"/></clipPath><clipPath id="icon-gear-mask-4k"><polygon points="19 0 0 0 0 16 .656 16 7.641 9.422 19 9.422"/></clipPath></defs><g class="icon-gear-group"><path class="icon-gear-cog fill" d="M8.75,0 L7.25,0 C6.69771525,0 6.25,0.44771525 6.25,1 L6.25,1.71 C6.24203899,2.03670262 6.03616565,2.32571712 5.73,2.44 C5.22486505,2.64787629 4.75048268,2.92375823 4.32,3.26 C4.06726048,3.46530794 3.71530155,3.4969447 3.43,3.34 L2.81,3 C2.57947626,2.86645499 2.30519371,2.83041629 2.04799634,2.89987835 C1.79079898,2.96934041 1.57195122,3.13856029 1.44,3.37 L1.44,3.37 L0.69,4.67 C0.438460777,5.14101477 0.601355467,5.72655514 1.06,6 L1.06,6 L1.68,6.36 C1.95609578,6.53006064 2.1022252,6.84996558 2.05,7.17 C1.97585362,7.71080372 1.97585362,8.25919628 2.05,8.8 C2.1022252,9.12003442 1.95609578,9.43993936 1.68,9.61 L1.06,10 C0.828560291,10.1319512 0.65934041,10.350799 0.589878348,10.6079963 C0.520416285,10.8651937 0.556454987,11.1394763 0.69,11.37 L0.69,11.37 L1.44,12.67 C1.72842942,13.137733 2.34023095,13.2851012 2.81,13 L2.81,13 L3.43,12.64 C3.71530155,12.4830553 4.06726048,12.5146921 4.32,12.72 C4.75048268,13.0562418 5.22486505,13.3321237 5.73,13.54 C6.03616565,13.6542829 6.24203899,13.9432974 6.25,14.27 L6.25,15 C6.25,15.5522847 6.69771525,16 7.25,16 L8.75,16 C9.30228475,16 9.75,15.5522847 9.75,15 L9.75,14.29 C9.75796101,13.9632974 9.96383435,13.6742829 10.27,13.56 C10.7751349,13.3521237 11.2495173,13.0762418 11.68,12.74 C11.9327395,12.5346921 12.2846984,12.5030553 12.57,12.66 L13.19,13.02 C13.4205237,13.153545 13.6948063,13.1895837 13.9520037,13.1201217 C14.209201,13.0506596 14.4280488,12.8814397 14.56,12.65 L14.56,12.65 L15.31,11.35 C15.5746773,10.8743026 15.4102265,10.2742794 14.94,10 L14.94,10 L14.32,9.64 C14.0439042,9.46993936 13.8977748,9.15003442 13.95,8.83 C14.0241464,8.28919628 14.0241464,7.74080372 13.95,7.2 C13.8977748,6.87996558 14.0439042,6.56006064 14.32,6.39 L14.94,6.03 C15.1714397,5.89804878 15.3406596,5.67920102 15.4101217,5.42200366 C15.4795837,5.16480629 15.443545,4.89052374 15.31,4.66 L15.31,4.66 L14.56,3.36 C14.426372,3.13025585 14.2067828,2.96315821 13.9497298,2.89561144 C13.6926768,2.82806466 13.4193087,2.86562606 13.19,3 L13.19,3 L12.57,3.36 C12.2846984,3.5169447 11.9327395,3.48530794 11.68,3.28 C11.2495173,2.94375823 10.7751349,2.66787629 10.27,2.46 C9.96383435,2.34571712 9.75796101,2.05670262 9.75,1.73 L9.75,1 C9.75,0.73478351 9.64464316,0.480429597 9.45710678,0.292893219 C9.2695704,0.10535684 9.01521649,-8.8817842e-16 8.75,0 Z M10.5,8 C10.5,9.38071187 9.38071187,10.5 8,10.5 C6.61928813,10.5 5.5,9.38071187 5.5,8 C5.5,6.61928813 6.61928813,5.5 8,5.5 C9.38071187,5.5 10.5,6.61928813 10.5,8 Z" /></g><g class="icon-gear-text icon-gear-text-hd"><polygon class="fill" points="10.17 12.38 10.46 10.43 12.22 10.43 11.36 16 9.6 16 9.95 13.76 8.09 13.76 7.77 16 6.01 16 6.85 10.43 8.61 10.43 8.32 12.38"/><path class="fill" d="M17.82,11.23 C17.65,10.98 17.32,10.43 15.93,10.43 L13.37,10.43 L12.51,16 L15.09,16 C16.1538092,16.0719871 17.159097,15.5065128 17.65,14.56 C18.1567595,13.5192032 18.2181336,12.3169925 17.82,11.23 Z M15.9,14.42 C15.6125419,14.6349311 15.2582986,14.7412041 14.9,14.72 L14.48,14.72 L14.9,11.72 L15.35,11.72 C15.6806309,11.6794538 16.0108877,11.7981978 16.24,12.04 C16.4818058,12.8447587 16.357466,13.7151373 15.9,14.42 Z"/></g><g class="icon-gear-text icon-gear-text-4k"><polygon class="fill" points="11.82 10.29 13.58 10.29 13.19 12.17 13.19 12.17 15.19 10.27 17.48 10.27 14.75 12.62 16.36 16 14.36 16 13.36 13.78 12.76 14.32 12.39 16 10.63 16"/><path class="fill" d="M7.86,14.9 L5.31,14.9 L5.61,13.41 L8.78,10.41 L10.36,10.41 L9.72,13.51 L10.44,13.51 L10.18,14.87 L9.45,14.87 L9.22,16 L7.63,16 L7.86,14.9 Z M8.19,13.54 L8.54,12 L8.54,12 L6.94,13.58 L8.19,13.54 Z"/></g></svg>'},n.templates.icon_heart=function(e){return'<svg class="like-icon" viewBox="0 0 110 81" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M82.496 1c-14.698 0-25.969 11.785-27.496 13.457-1.526-1.672-12.798-13.457-27.494-13.457-16.299 0-27.506 15.037-27.506 27.885 0 12.795 12.562 22.558 22.245 27.592 9.186 4.771 30.601 18.349 32.755 24.523 2.154-6.174 23.57-19.752 32.755-24.523 9.684-5.034 22.245-14.797 22.245-27.592 0-12.848-11.206-27.885-27.504-27.885z"/></svg>'},n.templates.icon_line_arrow=function(e){return'<svg class="icon-lineArrow" viewBox="0 0 24 15"><polygon class="fill" points="21 0 24 3.057 12 15 0 3.057 3 0 12 9"/></svg>'},n.templates.icon_live_viewers=function(e){return'<svg width="12px" height="14px" viewBox="0 0 12 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Live-tag/viewers" transform="translate(-5.000000, -4.000000)" fill="#FFFFFF"><g id="Icon/viewers-person"><circle id="Oval-8" cx="11" cy="7" r="3"></circle><path d="M9,12 L13,12 C15.209139,12 17,13.790861 17,16 L17,18 L5,18 L5,16 C5,13.790861 6.790861,12 9,12 Z" id="Rectangle-25"></path></g></g></g></svg>'},n.templates.icon_lock=function(e){return'<svg viewBox="0 0 46 76" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill bolt" d="M5,42v-15C8,5 39,5 42,27v30h-7v-30C32,14 15,14 12,27v15z"/><rect class="fill" x="0" y="41" height="35" width="46" rx="4" ry="4"/></svg>'},n.templates.icon_mail=function(e){return'<svg class="mail-icon" viewBox="0 0 72 72" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M71.754,57.6C71.9,57.169,72,56.718,72,56.241V16.759c0-0.453-0.092-0.881-0.225-1.291l-23.487,19.86L71.754,57.6z"/><path class="fill" d="M35.999,40.118l6.187-4.971l3.131-2.516L68.9,12.693c-0.387-0.113-0.789-0.193-1.213-0.193H4.312c-0.424,0-0.827,0.08-1.215,0.194l23.599,19.949l3.132,2.517L35.999,40.118z"/><path class="fill" d="M67.688,60.5c0.405,0,0.791-0.074,1.164-0.18L45.157,37.843l-9.159,7.361l-9.145-7.351L3.15,60.322C3.522,60.426,3.907,60.5,4.312,60.5H67.688z"/><path class="fill" d="M0.226,15.468C0.092,15.878,0,16.307,0,16.759v39.482c0,0.478,0.099,0.929,0.247,1.356l23.476-22.261L0.226,15.468z"/></svg>'},n.templates.icon_pause=function(e){return'<svg viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><rect class="fill" width="6" height="20" x="0" y="0" /><rect class="fill" width="6" height="20" x="12" y="0" /></svg>'},n.templates.icon_pip=function(e){return'<svg class="pip-icon" viewBox="0 0 16 12"><polygon class="fill" points="6 8 1 8 1 1 14 1 14 6 15 6 15 0 0 0 0 9 6 9 6 8"/><rect class="fill" x="7" y="7" width="9" height="5"/><polyline class="fill enter" transform="translate(4, 4) rotate(180) translate(-4, -4)" points="5.33 2 5.33 3 3.67 3 5.67 5 5 5.67 3 3.67 3 5.33 2 5.33 2 2"/><polyline class="fill return" points="5.33 2 5.33 3 3.67 3 5.67 5 5 5.67 3 3.67 3 5.33 2 5.33 2 2"/></svg>'},n.templates.icon_play=function(e){return'<svg viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="1,0 20,10 1,20" /></svg>'},n.templates.icon_prev=function(e){return'<svg class="icon-prev" viewBox="0 0 27 48" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M7.243,24L26.414,4.828c0.781-0.781,0.781-2.047,0-2.828L25,0.586 c-0.781-0.781-2.047-0.781-2.828,0L0.879,21.879c-1.172,1.172-1.172,3.071,0,4.243l21.293,21.293c0.781,0.781,2.047,0.781,2.828,0 L26.414,46c0.781-0.781,0.781-2.047,0-2.828L7.243,24z"/></svg>'},n.templates.icon_replay=function(e){return'<svg viewBox="-387 605 16 16" preserveAspectRatio="xMidYMid"><path class="fill" d="M-387 606v4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1h-1.5c1.1-1.2 2.7-2 4.5-2 3.3 0 6 2.7 6 6s-2.7 6-6 6c-2.3 0-4.4-1.3-5.4-3.4-.2-.5-.8-.7-1.3-.5-.5.2-.7.8-.5 1.3 1.3 2.8 4.2 4.6 7.2 4.6 4.4 0 8-3.6 8-8s-3.6-8-8-8c-2.3 0-4.5 1-6 2.7V606c0-.6-.4-1-1-1s-1 .4-1 1z"></path></svg>'},n.templates.icon_share=function(e){return'<svg class="share-icon" viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="20,0 0,12 5,15 17,4 7,16 7,19 9,17 14,20"/></svg>'},n.templates.icon_spin=function(e){return'<svg class="vp-spin-trace" viewBox="0 0 50 50"><circle cx="50%" cy="50%" r="20"></circle></svg><svg class="vp-spin-circle" viewBox="0 0 50 50"><circle cx="50%" cy="50%" r="20"></circle></svg>'},n.templates.icon_stereoscopic=function(e){return'<svg viewBox="0 0 20 13" tabindex="-1"><path class="fill" d="M 18.74,0 1.2,0 C 0.55,0 0,0.57 0,1.27 L 0,11.73 C 0,12.43 0.55,13 1.23,13 L 6,13 c 0.54,0 1,-0.32 1.16,-0.79 L 8.55,8.74 C 8.79,8.16 9.35,7.75 10,7.75 c 0.65,0 1.21,0.41 1.45,0.99 l 1.39,3.47 c 0.19,0.47 0.62,0.79 1.11,0.79 l 4.79,0 C 19.45,13 20,12.43 20,11.73 L 20,1.27 C 20,0.57 19.45,0 18.74,0 M 5.22,8.58 C 4,8.58 3,7.55 3,6.29 3,5 4,4 5.22,4 6.44,4 7.43,5 7.43,6.29 7.43,7.55 6.44,8.58 5.22,8.58 m 9.56,0 C 13.56,8.58 12.57,7.55 12.57,6.29 12.57,5.03 13.56,4 14.78,4 16,4 17,5.03 17,6.29 17,7.55 16,8.58 14.78,8.58 Z" /></svg>'},n.templates.icon_tumblr=function(e){return'<svg class="tumblr-icon" viewBox="0 0 12 20" tabindex="-1"><path class="fill" d="M7.865,19.958 C3.629,19.958 2.02,16.834 2.02,14.627 L2.02,8.105 L0,8.105 L0,5.527 C3.027,4.436 3.756,1.705 3.927,0.149 C3.938,0.042 4.022,0 4.07,0 L6.994,0 L6.994,5.084 L10.987,5.084 L10.987,8.105 L6.979,8.105 L6.979,14.318 C6.993,15.149 7.291,16.287 8.815,16.287 C8.843,16.287 8.872,16.287 8.9,16.286 C9.43,16.272 10.14,16.118 10.511,15.941 L11.471,18.788 C11.11,19.317 9.481,19.932 8.015,19.957 C7.964,19.958 7.915,19.958 7.865,19.958"/></svg>'},n.templates.icon_twitter=function(e){return'<svg class="twitter-icon" viewBox="0 0 274 223" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M85.98,222 C54.305,222 24.822,212.715 0,196.801 C4.388,197.319 8.853,197.584 13.38,197.584 C39.658,197.584 63.843,188.617 83.039,173.574 C58.495,173.121 37.781,156.905 30.644,134.621 C34.068,135.276 37.582,135.627 41.196,135.627 C46.312,135.627 51.267,134.942 55.974,133.66 C30.314,128.508 10.981,105.838 10.981,78.662 C10.981,78.426 10.981,78.191 10.985,77.957 C18.548,82.158 27.196,84.681 36.391,84.972 C21.341,74.914 11.438,57.746 11.438,38.287 C11.438,28.008 14.204,18.373 19.032,10.089 C46.696,44.023 88.025,66.353 134.641,68.692 C133.685,64.587 133.188,60.306 133.188,55.91 C133.188,24.935 158.302,-0.178 189.279,-0.178 C205.411,-0.178 219.988,6.634 230.22,17.535 C242.996,15.019 255,10.351 265.837,3.924 C261.649,17.021 252.756,28.013 241.175,34.955 C252.521,33.599 263.331,30.584 273.39,26.123 C265.87,37.371 256.36,47.25 245.402,55.158 C245.51,57.563 245.564,59.982 245.564,62.414 C245.564,136.533 189.148,222 85.98,222"/></svg>'},n.templates.icon_unfullscreen=function(e){return'<svg viewBox="0 0 12 12" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) "/><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(90)" /><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(180)" /><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(270)" /></svg>'},n.templates.icon_vod_download=function(e){return'<svg class="vod-download-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M21.707 24.707l-5 5c-.39.39-1.024.39-1.414 0l-5-5c-.39-.39-.39-1.024 0-1.414l1.06-1.06c.392-.392 1.025-.392 1.415 0L14 23.462V15c0-.552.448-1 1-1h2c.552 0 1 .448 1 1v8.464l1.232-1.232c.39-.39 1.024-.39 1.414 0l1.06 1.06c.392.39.392 1.025 0 1.415z"/><path class="fill" d="M27.894 12.31c.063-.43.106-.864.106-1.31 0-4.97-4.03-9-9-9-3.6 0-6.7 2.12-8.138 5.175C10.175 6.75 9.368 6.5 8.5 6.5 6.015 6.5 4 8.515 4 11c0 .445.067.874.187 1.28C1.76 13.05 0 15.318 0 18c0 3.314 2.686 6 6 6h1c0-2.42 1.718-4.436 4-4.9V15c0-2.21 1.79-4 4-4h2c2.21 0 4 1.79 4 4v4.1c2.282.464 4 2.48 4 4.9h1c3.314 0 6-2.686 6-6 0-2.65-1.72-4.896-4.106-5.69z"/></svg>'},n.templates.icon_vod_rent=function(e){return'<svg class="vod-rent-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M23 11H9c-.552 0-1 .448-1 1v8c0 .552.448 1 1 1h14c.552 0 1-.448 1-1v-8c0-.552-.448-1-1-1z"/><path class="fill" d="M32 22V10c-2.76 0-5-2.24-5-5H5c0 2.76-2.24 5-5 5v12c2.76 0 5 2.24 5 5h22c0-2.76 2.24-5 5-5zm-6-1c0 1.105-.895 2-2 2H8c-1.105 0-2-.895-2-2V11c0-1.105.895-2 2-2h16c1.105 0 2 .895 2 2v10z"/></svg>'},n.templates.icon_vod_subscribe=function(e){return'<svg class="vod-subscribe-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M20 9v2c0 .552.448 1 1 1h10c.552 0 1-.448 1-1V1c0-.552-.448-1-1-1h-2c-.552 0-1 .448-1 1v4.445C24.98 2.01 20.523-.128 15.558.005 7.293.23.413 6.96.018 15.216-.42 24.41 6.905 32 16 32c8.47 0 15.404-6.583 15.964-14.912.04-.585-.413-1.088-1-1.088H28.96c-.514 0-.956.388-.994.9C27.506 23.107 22.326 28 16 28 9.217 28 3.748 22.37 4.01 15.53 4.246 9.284 9.47 4.147 15.72 4.003 19.38 3.92 22.674 5.483 24.926 8H21c-.552 0-1 .448-1 1z"/><path class="fill" d="M13 20v-8l8 4"/></svg>'},n.templates.icon_vod=function(e){return'<svg class="vod-icon" viewBox="0 0 21 23" tabindex="-1"><path class="fill" d="M19.602,4.716l-7.665-4.385C11.169-0.108,9.91-0.111,9.139,0.327L1.4,4.721C0.63,5.158,0,6.234,0,7.112v8.776c0,0.878,0.63,1.955,1.398,2.393l0.526,0.3l7.176,4.09c0.77,0.438,2.028,0.438,2.798,0l7.702-4.39c0.77-0.438,1.4-1.516,1.4-2.393V7.112C21,6.234,20.37,5.156,19.602,4.716z M7.336,15.761L7.337,7.24l8.008,4.26L7.336,15.761z"/></svg>'},n.templates.icon_warning=function(e){return'<svg class="warning-icon" tabindex="-1" width="36" height="32.326" viewBox="287.915 380.297 36 32.326"><path d="M309.646 382.963c-2.052-3.555-5.41-3.555-7.462 0L288.79 406.16c-2.05 3.555-.372 6.463 3.732 6.463h26.786c4.104 0 5.783-2.908 3.73-6.463l-13.392-23.197zm-2 23.224c0 .983-.804 1.788-1.788 1.788-.983 0-1.788-.805-1.788-1.788 0-.984.805-1.79 1.788-1.79s1.79.805 1.788 1.79zm-.317-7.76c-.254 2.604-.916 4.735-1.472 4.735-.557 0-1.22-2.13-1.477-4.735-.255-2.604-.464-5.72-.464-6.925 0-1.204.87-2.19 1.935-2.19 1.066 0 1.936.986 1.936 2.19s-.205 4.32-.457 6.925z"/></svg>'},n.templates.live_status=function(e){return'<div class="vp-live-status"><div class="vp-live-status-circle offline"></div><span>LIVE</span></div>'},n.templates.live_viewer_count=function(e){var t='<div class="vp-live-viewer-count"><div class="vp-live-viewer-count-person"> ';return t+=this.render("icon_live_viewers")||"",t+=' </div><span class="vp-live-viewer-count-value">0</span></div>'},n.templates.logo=function(e){return'<svg viewBox="0 0 140 40" preserveAspectRatio="xMidYMid" role="img" aria-label="Vimeo" tabindex="-1"><title>Vimeo</title><g><path class="fill logo-v" d="M31.277 18.832c-.14 3.052-2.27 7.229-6.39 12.531-4.259 5.536-7.863 8.306-10.811 8.306-1.825 0-3.371-1.687-4.633-5.059l-2.529-9.275c-.938-3.372-1.943-5.06-3.019-5.06-.234 0-1.054.494-2.458 1.477l-1.474-1.901c1.546-1.358 3.071-2.717 4.572-4.078 2.062-1.783 3.609-2.72 4.642-2.814 2.438-.234 3.938 1.433 4.502 5.001.608 3.851 1.03 6.246 1.266 7.182.704 3.195 1.476 4.791 2.321 4.791.657 0 1.641-1.037 2.954-3.108 1.312-2.072 2.015-3.649 2.109-4.732.188-1.789-.516-2.686-2.109-2.686-.75 0-1.522.173-2.318.514 1.54-5.044 4.481-7.495 8.823-7.355 3.22.095 4.737 2.184 4.552 6.266z"/><path class="fill logo-i" d="M50.613 28.713c-1.313 2.484-3.119 4.733-5.417 6.748-3.143 2.718-6.285 4.076-9.425 4.076-1.456 0-2.57-.469-3.343-1.406-.773-.938-1.137-2.153-1.09-3.653.045-1.548.526-3.938 1.441-7.173.914-3.232 1.373-4.967 1.373-5.201 0-1.218-.423-1.828-1.266-1.828-.282 0-1.079.494-2.393 1.477l-1.618-1.901c1.501-1.358 3.001-2.717 4.502-4.078 2.017-1.783 3.518-2.72 4.504-2.814 1.546-.14 2.684.314 3.411 1.367.726 1.052.996 2.417.81 4.098-.61 2.852-1.268 6.472-1.972 10.864-.046 2.01.681 3.014 2.182 3.014.656 0 1.827-.693 3.518-2.083 1.406-1.156 2.555-2.243 3.447-3.262l1.336 1.755zm-6.12-25.016c-.047 1.168-.633 2.288-1.76 3.361-1.266 1.212-2.767 1.82-4.501 1.82-2.672 0-3.963-1.166-3.869-3.499.045-1.213.76-2.381 2.144-3.501 1.384-1.119 2.919-1.68 4.609-1.68.984 0 1.805.387 2.462 1.155.656.772.961 1.553.915 2.344z"/><path class="fill logo-m" d="M94.543 28.713c-1.314 2.484-3.117 4.733-5.416 6.748-3.145 2.718-6.285 4.076-9.426 4.076-3.051 0-4.527-1.687-4.432-5.06.045-1.501.338-3.306.877-5.415.539-2.108.832-3.748.879-4.921.049-1.779-.492-2.673-1.623-2.673-1.223 0-2.682 1.456-4.375 4.362-1.788 3.05-2.754 6.003-2.894 8.861-.095 2.02.103 3.568.592 4.645-3.272.096-5.565-.444-6.873-1.617-1.171-1.032-1.708-2.742-1.614-5.135.045-1.501.276-3.001.69-4.502.414-1.5.644-2.837.69-4.011.095-1.734-.54-2.604-1.9-2.604-1.177 0-2.444 1.339-3.806 4.011-1.361 2.673-2.113 5.465-2.253 8.371-.094 2.627.074 4.456.503 5.486-3.219.096-5.505-.582-6.857-2.035-1.122-1.214-1.634-3.06-1.539-5.54.044-1.214.258-2.911.645-5.084.386-2.175.603-3.87.647-5.087.093-.841-.119-1.263-.633-1.263-.281 0-1.079.475-2.393 1.424l-1.687-1.901c.234-.184 1.71-1.545 4.432-4.078 1.969-1.828 3.306-2.766 4.009-2.812 1.219-.095 2.204.409 2.954 1.511s1.126 2.38 1.126 3.834c0 .469-.047.915-.14 1.336.703-1.077 1.523-2.017 2.463-2.814 2.156-1.874 4.572-2.931 7.245-3.166 2.298-.187 3.938.352 4.925 1.617.795 1.033 1.17 2.511 1.125 4.433.329-.28.681-.586 1.056-.915 1.078-1.267 2.133-2.273 3.164-3.023 1.736-1.267 3.541-1.97 5.418-2.112 2.25-.187 3.867.35 4.852 1.611.844 1.028 1.219 2.5 1.127 4.415-.047 1.309-.363 3.213-.949 5.712-.588 2.501-.879 3.936-.879 4.31-.049.982.047 1.659.279 2.034.236.373.797.559 1.689.559.656 0 1.826-.693 3.518-2.083 1.406-1.156 2.555-2.243 3.447-3.262l1.337 1.757z"/><path class="fill logo-e" d="M120.922 28.642c-1.361 2.249-4.033 4.495-8.02 6.743-4.971 2.856-10.012 4.284-15.125 4.284-3.797 0-6.52-1.267-8.16-3.797-1.172-1.735-1.734-3.797-1.688-6.189.045-3.797 1.736-7.407 5.064-10.832 3.658-3.75 7.973-5.627 12.945-5.627 4.596 0 7.033 1.873 7.314 5.615.188 2.384-1.125 4.842-3.938 7.368-3.004 2.76-6.781 4.515-11.328 5.263.842 1.169 2.109 1.752 3.799 1.752 3.375 0 7.059-.855 11.045-2.574 2.859-1.207 5.111-2.461 6.754-3.76l1.338 1.754zm-15.969-7.345c.045-1.259-.469-1.89-1.547-1.89-1.406 0-2.83.969-4.283 2.906-1.451 1.936-2.201 3.789-2.248 5.562-.025 0-.025.305 0 .911 2.295-.839 4.287-2.122 5.971-3.849 1.357-1.491 2.06-2.707 2.107-3.64z"/><path class="fill logo-o" d="M140.018 23.926c-.189 4.31-1.781 8.031-4.783 11.169-3.002 3.137-6.73 4.706-11.186 4.706-3.705 0-6.52-1.195-8.441-3.585-1.404-1.777-2.182-4.001-2.32-6.668-.236-4.029 1.217-7.729 4.361-11.101 3.377-3.746 7.619-5.618 12.732-5.618 3.281 0 5.766 1.102 7.457 3.301 1.594 2.015 2.32 4.614 2.18 7.796zm-7.95-.264c.047-1.269-.129-2.434-.527-3.49-.4-1.057-.975-1.587-1.725-1.587-2.391 0-4.361 1.293-5.906 3.877-1.316 2.115-2.02 4.371-2.111 6.766-.049 1.176.164 2.21.633 3.104.514 1.032 1.242 1.549 2.182 1.549 2.109 0 3.914-1.244 5.416-3.735 1.267-2.068 1.945-4.23 2.038-6.484z"/></g></svg>'},n.templates.menu_list_panel=function(e){var t='<div class="vp-panel vp-panel-open vp-panel--'+e.id+'"><div class="vp-panel-title"><button type="button" class="vp-panel-button js-panelTitleButton" tabindex="0"><span class="vp-panel-button-text">'+e.title+'</span><span class="vp-panel-stat"><span class="vp-panel-stat-text js-panelStatText">'+e.active+"</span> ";t+=this.render("icon_line_arrow")||"",t+=' </span></button></div><div class="vp-panel-itemsWrap"><ul class="vp-panel-items js-panelItems"> ';for(var n=0;n<e.items.length;n++)t+=' <li class="vp-panel-item',e.items[n].active&&(t+=" vp-panel-item-on"),t+='" tabindex="0" role="menuitemradio" aria-checked="',e.items[n].active?t+="true":t+="false",t+='"> '+e.items[n].label+" </li> ";return t+=' </ul><div class="vp-indicator"></div></div></div>'},n.templates.menu=function(e){var t='<div class="vp-menu vp-menu-hidden vp-menu-invisible" role="menu" hidden><button type="button" class="vp-menu-close js-menuClose" aria-label="'+e.strings.close+'">';return t+=this.render("icon_close_new")||"",t+="</button></div>"},n.templates.outer=function(e){var t='<div class="vp-player-layout"><div class="vp-player-inner"><div class="vp-video-wrapper"><div class="vp-video"><div class="vp-telecine"></div></div><div class="vp-preview"></div><div class="vp-shade vp-shade-invisible"></div><div class="vp-spin vp-spin-invisible"> ';return t+=this.render("icon_spin")||"",t+=' </div></div><div class="vp-text-alert-wrapper hidden"><div class="vp-alert-text"></div><div class="vp-alert-time"><div class="vp-live-start-time-title"></div><div class="vp-live-start-time-body"></div><div class="vp-live-start-time-footer"></div></div></div><div class="vp-target"></div><div class="vp-captions hidden with-controls" hidden aria-live="assertive"><span></span></div><div class="vp-cards-wrapper"><div class="vp-cards"></div></div><div class="vp-outro-wrapper hidden" hidden><div class="vp-outro" role="dialog" aria-live="assertive"></div></div><div class="vp-controls-wrapper"><div class="vp-title" role="contentinfo"></div><div class="vp-controls"></div><div class="vp-sidedock hidden" role="toolbar" hidden></div></div><div class="vp-overlay-wrapper hidden" hidden><div class="vp-overlay-bg"></div><div class="vp-overlay-cell"><div class="vp-overlay" role="dialog" aria-live="assertive"></div><div class="vp-overlay-icon-wrapper hidden"><div class="vp-overlay-icon"></div></div><div class="vp-overlay-logo logo"></div></div><nav><button type="button" class="vp-nav-prevButton js-back cloaked" aria-label="'+e.strings.back+'">',t+=this.render("icon_prev")||"",t+='</button><button type="button" class="vp-nav-closeButton js-close" aria-label="'+e.strings.close+'">',t+=this.render("icon_close_new")||"",t+='</button></nav></div><div class="notification-wrapper hidden" hidden><div class="notification-cell"><div class="notification" role="dialog" aria-live="assertive"></div></div></div><div class="stats-debug rounded-box hidden" aria-hidden="true" hidden></div></div></div>'},n.templates.sidedock=function(e){var t="";return e.vodButton&&(t+=' <div class="box" data-vod-expiring="'+e.vodPurchaseInfo.expiring+'" data-vod-purchased="'+e.purchased+'"><button type="button" class="vod-button rounded-box',e.purchased&&(t+=" on"),e.vodPurchaseInfo.expiring&&(t+=" expiring"),t+='" data-product-id="'+e.vodPurchaseInfo.product_id+'"><div class="vod-button-inner"><span class="vod-label">'+e.vodDisplayLabel+"</span> ",t+=this.render("icon_vod")||"",t+=' </div></button></div><div class="sidedock-inner">'),e.likeButton&&(t+=' <div class="box"><label class="rounded-box hidden like-label" role="presentation"><span>'+(e.liked?e.strings.unlike:e.strings.like)+'</span></label><button type="button" class="like-button rounded-box',e.liked&&(t+=" on"),t+='" aria-label="',e.loggedOut?t+=""+e.strings.likeLoggedOut:t+=""+(e.liked?e.strings.unlike:e.strings.like),t+='" data-label-add="'+e.strings.like+'" data-label-add-logged-out="'+e.strings.likeLoggedOut+'" data-label-remove="'+e.strings.unlike+'"> ',t+=this.render("icon_heart")||"",t+=" </button></div>"),e.watchLaterButton&&(t+=' <div class="box"><label class="rounded-box hidden watch-later-label" role="presentation"><span>'+(e.addedToWatchLater?e.strings.watchLaterRemove:e.strings.watchLaterAdd)+'</span></label><button type="button" class="watch-later-button rounded-box',e.addedToWatchLater&&(t+=" on"),t+='" aria-label="',e.loggedOut?t+=""+e.strings.watchLaterLoggedOut:t+=""+(e.addedToWatchLater?e.strings.watchLaterRemove:e.strings.watchLaterAdd),t+='" data-label-add="'+e.strings.watchLaterAdd+'" data-label-add-logged-out="'+e.strings.watchLaterAddLoggedOut+'" data-label-remove="'+e.strings.watchLaterRemove+'"> ',t+=this.render("icon_clock")||"",t+=" </button></div>"),e.collectionsButton&&(t+=' <div class="box"><label class="rounded-box hidden collections-label" role="presentation"><span>'+e.strings.collections+'</span></label><button type="button" class="collections-button rounded-box" aria-label="'+e.strings.collections+'"> ',t+=this.render("icon_collections")||"",t+=" </button></div>"),e.shareButton&&(t+=' <div class="box"><label class="rounded-box hidden share-label" role="presentation"><span>'+e.strings.share+'</span></label><button type="button" class="share-button rounded-box" aria-label="'+e.strings.share+'"> ',t+=this.render("icon_share")||"",t+=" </button></div>"),e.vodButton&&(t+=" </div>"),t+=""},n.templates.app_redirect=function(e){var t='<div class="vp-overlay-content"> ';return e.strings.title&&(t+=' <div class="app-redirect-title">'+e.strings.title+"</div> "),e.hideRedirectButton||(t+=' <div class="'+(e.strings.title?"":"app-redirect--topspace")+'"><a class="app-redirect-button" href="'+e.redirectUrl+'" role="button"',e.newWindow&&(t+=' data-new-window="1" target="_blank" rel="noopener"'),t+=">"+e.strings.buttonText+"</a></div> "),e.strings.ignoreText&&(t+=' <div class="app-redirect-ignore">'+e.strings.ignoreText+"</div> "),e.strings.bottomText&&(t+=' <div class="app-redirect-bottom-text">'+e.strings.bottomText+"</div> "),t+="</div>"},n.templates.email_capture=function(e){var t='<div class="vp-email-capture-wrapper"><div class="vp-email-capture"> ';return e.customLogo&&(t+=' <div class="vp-email-capture-logoWrap"><img src="',t+=this.escape(e.customLogo)||"",t+='" alt="" class="vp-email-capture-logo"></div> '),t+=' <h1 class="vp-email-capture-title">',t+=this.escape(e.text)||"",t+="</h1> ",e.subtitle&&(t+=' <p class="vp-email-capture-subtitle">',t+=this.escape(e.subtitle)||"",t+="</p> "),t+=' <form class="vp-email-capture-form" action="'+e.action+'" method="post" novalidate><div class="vp-validation-bubble hidden"><div class="vp-validation-bubble-arrowClipper"><div class="vp-validation-bubble-arrow"></div></div><div class="vp-validation-bubble-message"></div></div><input class="vp-email-capture-form-input vp-email-capture-form-input--email" type="email" name="email" placeholder="'+e.strings.email+'" aria-label="'+e.strings.email+'" required aria-required="true"><input class="vp-email-capture-form-input" type="text" name="name" placeholder="'+e.strings.fullName+'" aria-label="'+e.strings.fullName+'" pattern="^[^!@#$%^*+=?<>]+$" maxlength="180"><input type="hidden" name="referrer" value="'+e.referrer+'"><input type="hidden" name="signature" value=""><input type="hidden" name="time" value=""><input type="hidden" name="expires" value=""><div class="vp-email-capture-form-buttons"><input class="vp-email-capture-form-button vp-email-capture-form-button--reset" type="button" value="'+e.strings.nothanks+'"> ',e.allowSkip&&(t+=' <input class="vp-email-capture-form-button vp-email-capture-form-button--cancel" type="button" value="'+e.strings.nothanks+'"> '),t+=' <input class="vp-email-capture-form-button vp-email-capture-form-button--submit" type="submit" value="'+e.strings.submit+'"></div></form></div><div class="vp-email-capture-confirm vp-email-capture-confirm-hidden"><div class="vp-email-capture-confirm-box"><h1 class="vp-email-capture-confirm-title">',t+=this.escape(e.confirmation)||"",t+="</h1></div></div></div>"},n.templates.error=function(e){var t='<div class="vp-overlay-content error"> ';return e.title&&(t+=" <h1>"+e.title+"</h1> "),e.message&&(t+=" <p>"+e.message+"</p> "),t+="</div>"},n.templates.help=function(e){var t='<div class="vp-overlay-content help"><h1>'+e.strings.title+'</h1><dl><div class="volume-up secondary"><dt class="arrow">↑</dt><dd>'+e.strings.volumeUp+'</dd></div><div class="volume-down secondary"><dt class="arrow">↓</dt><dd>'+e.strings.volumeDown+'</dd></div><div class="scrub-forward secondary"><dt class="arrow">→</dt><dd>'+e.strings.scrubForward+'</dd></div><div class="scrub-backwards secondary"><dt class="arrow">←</dt><dd>'+e.strings.scrubBackwards+'</dd></div><div class="like"><dt>L</dt><dd>'+e.strings.like+'</dd></div><div class="share"><dt>S</dt><dd>'+e.strings.share+'</dd></div><div class="watch-later"><dt>W</dt><dd>'+e.strings.watchLater+'</dd></div><div class="toggle-captions"><dt>C</dt><dd>'+e.strings.captions+'</dd></div><div class="toggle-prefs"><dt>H</dt><dd>'+e.strings.prefs+'</dd></div><div class="fullscreen"><dt>F</dt><dd>'+e.strings.fullscreen+"</dd></div> ";return e.onSite||(t+='<div class="view-on-vimeo"><dt>V</dt><dd>'+e.strings.viewOnVimeo+"</dd></div>"),t+=" </dl></div>"},n.templates.outro_email=function(e){var t='<div class="outro-bg"';return e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--email outro-shade js-outro-content"></div>'},n.templates.outro_image=function(e){var t='<div class="outro-content outro-content--image js-outro-content"> ';return e.url&&(t+='<a class="outro-imageLink js-imageLink" href="'+e.url+'" target="_blank" rel="noopener">'),e.bgimage&&(t+='<div class="outro-image" style="background-image: url('+e.bgimage+');"',e.alt_text&&(t+=' aria-label="',t+=this.escape(e.alt_text)||"",t+='" role="img"'),t+="></div>"),e.url&&(t+="</a>"),t+="</div>"},n.templates.outro_link=function(e){var t='<div class="outro-bg"';return e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--link outro-shade js-outro-content"><div class="outro-linkWrapper js-outro-linkWrapper"> ',e.title&&(t+='<h1 class="outro-textTitle js-outro-title">',t+=this.escape(e.title)||"",t+="</h1>"),e.description&&(t+='<p class="outro-textDescription js-outro-text">',t+=this.escape(e.description)||"",t+="</p>"),e.text&&e.url&&(t+=' <div class="outro-buttonWrap"><a class="outro-button js-cta" href="'+e.url+'" target="_blank" rel="noopener" title="',t+=this.escape(e.text)||"",t+='"><span>',t+=this.escape(e.text)||"",t+="</span></a></div> "),e.text2&&e.url2&&(t+=' <div class="outro-linkWrap js-outro-linkWrap"><a class="outro-link js-link" href="'+e.url2+'" target="_blank" rel="noopener" title="',t+=this.escape(e.text2)||"",t+='">',t+=this.escape(e.text2)||"",t+="</a></div> "),t+=" </div></div>"},n.templates.outro_nothing=function(e){return'<div class="outro-bg"></div><div class="outro-content outro-content--nothing outro-shade js-outro-content"></div>'},n.templates.outro_share=function(e){var t='<div class="outro-bg"';return e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--share outro-shade js-outro-content"></div><nav class="panel-nav"><button type="button" class="vp-nav-prevButton js-back cloaked" aria-label="'+e.strings.back+'">',t+=this.render("icon_prev")||"",t+="</button></nav>"},n.templates.outro_staticimage=function(e){var t='<div class="outro-content outro-content--staticImage js-outro-content"><div class="outro-staticImageWrapper"> ';return e.url&&(t+='<a class="outro-staticImageLink" href="'+e.url+'" target="_blank" rel="noopener">'),t+=' <img class="outro-staticImage" src="'+e.svg_url+'"> ',e.url&&(t+="</a>"),t+=" </div></div>"},n.templates.outro_text=function(e){return'<div class="outro-content outro-content--text outro-shade js-outro-content"><div class="outro-textWrapper"><div class="outro-text">'+e.text+"</div></div></div>"},n.templates.outro_videos=function(e){var t='<div class="outro-bg"';e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--videos outro-shade js-outro-content"> ';for(var n=0,i=e.contexts.length;n<i;n++){var r=e.contexts[n];t+=' <div class="outro-videosSection outro-videosSection--'+r.videos.length,r.promoted&&(t+=" outro-videosSection--promoted"),t+='"><div class="outro-videosHeaderWrapper"><header class="outro-videosHeader"><h1 class="outro-videosTitle">'+r.context+"</h1> ",e.showFollowButton&&!r.promoted&&(t+=' <div class="outro-followWrap js-outro-followWrap"><button type="button" class="outro-follow js-outro-follow" aria-label="'+e.strings.follow+'" aria-pressed="',e.following?t+="true":t+="false",t+='"> ',t+=this.render("icon_follow")||"",t+=' <span class="outro-follow-text" data-label-follow="'+e.strings.follow+'" data-label-following="'+e.strings.following+'" data-label-unfollow="'+e.strings.unfollow+'"></span></button></div> '),t+=' </header></div><ul class="outro-videos outro-videos--'+r.videos.length+'"> ';for(var o=0,a=r.videos.length;o<a;o++)t+=' <li><a class="outro-videoLink js-videoLink',1==n&&(t+=" hovered"),t+='" href="'+r.videos[o].url+'"',e.target&&(t+=' target="_blank" rel="noopener"'),t+=' data-video-id="'+r.videos[o].id+'" aria-label="',t+=this.escape(r.videos[o].fullTitle)||"",t+='" title="',t+=this.escape(r.videos[o].fullTitle)||"",t+='"><div class="outro-imgWrapper"><img src="'+r.videos[o].thumbnail+'" alt="" width="295" height="166"></div><header class="outro-videoHeader"><h1 class="outro-videoTitle">',t+=this.escape(r.videos[o].title)||"",t+="</h1> ",r.videos[o].byline&&(t+=' <h2 class="outro-videoByline">',t+=this.escape(r.videos[o].byline)||"",t+="</h2> "),t+=" </header></a> ";t+=" </ul></div> "}return t+="</div>"},n.templates.outro_vod=function(e){var t='<div class="outro-content outro-content--vod outro-shade js-outro-content"><div class="outro-vodWrapper"><h1 class="outro-vodHeader"><a href="'+e.url+'" target="_blank" rel="noopener">';t+=this.escape(e.title)||"",t+="</a></h1> ";var n=e.countries,i=e.country;if(this.helpers.isAvailableInCountry(n,i))if(e.purchased)t+=' <a class="outro-vodButton outro-vodButton--watch js-vod-watch" role="button" href="'+e.url+'" target="_blank" rel="noopener">'+e.strings.watch+"</a> ";else{if(!e.isComingSoon){t+=' <ul class="outro-vod"> ';for(var r=0,o=e.buttons.length;r<o;r++){t+=' <li class="outro-vod-item"><a class="outro-vodButton outro-vodButton--'+e.buttons[r].type+' js-vod-button" role="button" href="'+e.url+"#buy="+e.buttons[r].product_id+'" target="_blank" rel="noopener" data-product-id="'+e.buttons[r].product_id+'" role="button"><div class="outro-vodIcon"> ',"buy"===e.buttons[r].type?t+=this.render("icon_vod_download")||"":"rent"===e.buttons[r].type?t+=this.render("icon_vod_rent")||"":"subscribe"===e.buttons[r].type?t+=this.render("icon_vod_subscribe")||"":t+=this.render("icon_vod")||"",t+=" </div> ";var a=e.currency,s=e.buttons[r];t+=" <p>"+this.helpers.formatVodLabel(e.translationMap,"outro_string",a,s)+"</p></a></li> "}t+=" </ul> "}(e.isPreorder||e.isComingSoon)&&(t+=" <p>"+e.strings.preRelease+"</p> ")}return t+=" </div></div>"},n.templates.password=function(e){return'<div class="vp-overlay-content password form"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><form action="'+e.action+'" method="post" novalidate><div class="vp-validation-bubble hidden"><div class="vp-validation-bubble-arrow-clipper"><div class="vp-validation-bubble-arrow"></div></div><div class="vp-validation-bubble-message"></div></div><input type="password" name="password" placeholder="'+e.strings.password+'" required aria-required="true" aria-label="'+e.strings.password+'"><input type="submit" value="'+e.strings.watch+'"></form></div>'},n.templates.private_locked=function(e){return'<div class="vp-overlay-content login"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><a href="'+e.action+'" class="popup" target="_blank" rel="noopener" role="button" aria-label="'+e.strings.logInLabel+'">'+e.strings.logIn+"</a></div>"},n.templates.private_unlocked=function(e){return'<div class="vp-overlay-content form unlocked"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><button type="button">'+e.strings.watch+"</button></div>"},n.templates.share=function(e){var t='<div class="vp-share-wrapper js-share"><section class="vp-share-screen vp-share-screen--share'+(e.embedOnly?" cloaked":"")+' js-share-screen"><h1 class="vp-share-title vp-share-title--share">'+e.strings.share+'</h1><ul class="vp-share-buttons"><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--facebook js-facebook" href="'+e.playerShareUrl+'/facebook" target="_blank" rel="noopener" title="'+e.strings.facebook+'" role="button" aria-label="'+e.strings.facebook+'">';return t+=this.render("icon_facebook")||"",t+='</a><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--twitter js-twitter" href="'+e.playerShareUrl+'/twitter" target="_blank" rel="noopener" title="'+e.strings.twitter+'" role="button" aria-label="'+e.strings.twitter+'">',t+=this.render("icon_twitter")||"",t+='</a><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--tumblr js-tumblr" href="'+e.playerShareUrl+'/tumblr" target="_blank" rel="noopener" title="'+e.strings.tumblr+'" role="button" aria-label="'+e.strings.tumblr+'">',t+=this.render("icon_tumblr")||"",t+="</a> ",e.url&&(t+=' <li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--email js-email" href="mailto:?subject=',t+=encodeURIComponent(e.strings.emailSubject)||"",t+="&amp;body=",t+=encodeURIComponent(e.strings.emailBody)||"",t+='" title="'+e.strings.email+'" role="button" aria-label="'+e.strings.email+'">',t+=this.render("icon_mail")||"",t+="</a> "),t+=" </ul> ",e.embed&&(t+=' <ul class="vp-share-buttons"><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--embed js-embed" href="'+e.url+'#share" target="_blank" rel="noopener" title="'+e.strings.embedCode+'" role="button" aria-label="'+e.strings.embedCode+'">',t+=this.render("icon_embed")||"",t+="</a></li></ul> "),e.url&&(t+=' <p class="vp-share-footnote vp-share-footnote--share"><a class="clip_url" href="'+e.shareUrl+'" target="_blank" rel="noopener">'+e.shareUrl+"</a></p> "),t+=" </section> ",e.embed&&(t+=' <section class="vp-share-screen vp-share-screen--embed'+(e.embedOnly?"":" cloaked")+' js-embed-screen"><div class="vp-share-embedWrapper"><h1 class="vp-share-title vp-share-title--embed">'+e.strings.embedTitle+'</h1><p class="vp-share-subtitle vp-share-subtitle--embed">'+e.strings.embedSubtitle+'</p><div class="vp-share-embedCode form"><div><input class="vp-share-embedInput" type="text" name="embed_code" title="Embed code" value="'+e.embedCode+'" spellcheck="false" aria-readonly="true"',e.readOnly&&(t+=" readonly"),t+="></div> ",e.copyButton&&(t+=' <button type="button" class="vp-share-embedCopy js-embedCopy" data-clipboard-text=\''+e.embedCode+"' data-label=\""+e.strings.copy+'" data-success-label="'+e.strings.copySuccess+'">'+e.strings.copy+"</button> "),t+=" </div> ",e.customizeEmbed&&(t+=' <p class="vp-share-footnote vp-share-footnote--embed">'+e.strings.customize+"</p> "),t+=" </div></section> "),t+="</div>"},n.templates.threesixty_reminder=function(e){var t='<div class="intro-wrap text-only"><div> ';return e.showArrows&&(t+=' <div class="key-wrapper"><div class="key-row"><div class="key"><div class="arrow arrow-top"></div></div></div><div class="key-row"><div class="key"><div class="arrow arrow-left"></div></div><div class="key"><div class="arrow arrow-down"></div></div><div class="key"><div class="arrow arrow-right"></div></div></div></div> '),t+=" <div>"+e.text+"</div></div></div>"},n.templates.time_series_graph=function(e){return'<svg width="'+e.width+'" height="'+e.height+'" viewBox="0 0 '+e.width+" "+e.height+'"><g><polyline stroke="white" fill="none" points="'+e.points+'"></polyline></g><g> '+e.markers+" </g></svg>"},n.templates.title_byline_badge=function(e){var t="";return e.displayBadge&&(t+="&nbsp;",e.link&&(t+='<a tabindex="-1" href="'+e.link+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">"),t+=' <span class="byline-badge '+e.cssClass+'">'+e.cssClass+"</span>",e.link&&(t+="</a>"),t+=""),t+=""},n.templates.title_owner_byline=function(e){var t="";return e.linkToOwner?(t+='<a href="'+e.ownerLink+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">",t+=this.escape(e.owner)||"",t+="</a>"):(t+='<span class="user">',t+=this.escape(e.owner)||"",t+="</span>"),t+=""},n.templates.title=function(e){var t='<header class="vp-title-header"> ';return e.badge&&(t+=' <div class="badge',e.badge.shadow&&(t+=" shadow"),t+='"> ',e.badge.link&&(t+='<a href="'+e.badge.link+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">"),t+=' <img src="'+e.badge.img+'"',e.badge.offset&&(t+=' style="margin-top:'+e.badge.offset.y+"px;margin-left:"+e.badge.offset.x+'px"'),t+=' width="'+e.badge.width+'" height="'+e.badge.height+'" alt="'+e.badge.name+' Badge"> ',e.badge.link&&(t+="</a>"),t+=" </div> "),e.showPortrait&&(t+=' <div class="portrait" aria-hidden="true"> ',e.linkToOwner&&(t+='<a tabindex="-1" href="'+e.ownerLink+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">"),t+=' <img src="'+e.portraitImg+'" alt="" width="60" height="60"> ',e.linkToOwner&&(t+="</a>"),t+=" </div> "),t+=' <div class="headers"> ',e.showTitle&&(t+=" <h1> ",e.showTitleLink&&(t+='<a href="'+e.titleLink+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=" data-clip-link>"),t+=this.escape(e.title)||"",e.showTitleLink&&(t+="</a>"),e.is360&&(t+='<div class="threesix-badge-title">360</div>'),e.hasHDR&&(t+='<div class="hashdr-badge-title">HDR</div>'),t+=" </h1> "),e.showByline&&(t+=' <div class="sub-title"><h2 class="byline-from">'+e.strings.byline+"</h2> ",e.is360&&!e.showTitle&&(t+=' <div class="threesix-badge-byline">360</div> '),e.hasHDR&&!e.showTitle&&(t+=' <div class="hashdr-badge-byline">HDR</div> '),t+=" </div> "),!e.is360||e.showByline||e.showTitle||(t+=' <div class="threesix-badge-loner">360</div> '),!e.hasHDR||e.showByline||e.showTitle||(t+=' <div class="hashdr-badge-loner">HDR</div> '),t+=" </div></header>"},e.exports?e.exports=n:window.Aftershave=n}),Rc="Expected a function";var Mc=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(Rc);return U(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Cr(e,t,{leading:i,maxWait:t,trailing:r})};function Ic(t,r,o){var a=o.querySelector(".vp-player-layout");function s(){var e=Dn(o),t=e.width,n=e.height;return r.dispatch(zu(t,n))}function l(e){t.events.fire(si.spaceChanged,[{bottom:e}])}function u(e){var t=Cn(Gn,Math.round),n=t(e.x),i=t(e.y),r=t(e.width),o=t(e.height);!function e(t,n,i){if(void 0!==i)t.style[n]=i;else if(Pn(n))t.setAttribute("style",n);else for(var r in n)e(t,r,n[r])}(a,{left:n,top:i,width:r,height:o})}!function(){r.watch("ui.player.layout",u),r.watch("ui.player.innerBottom",l);var e,t,n,i=Mc(s,16);e=o,t=i,(n=document.createElement("iframe")).classList.add("vp-resize-iframe"),n.onload=function(){return n.contentWindow.onresize=function(){return t(e)}},e.appendChild(n),s()}()}function Dc(e){var o=e.element,t=e.delegate,a=void 0===t?{}:t,n=e.cssLoadedPromise,i=void 0===n?M.resolve(null):n,s=(e.name,Ct(Lc,Ot(Ru(),Iu(Pc),function(){for(var e=arguments.length,l=Array(e),t=0;t<e;t++)l[t]=arguments[t];return function(s){return function(e,t,n){var i,r=s(e,t,n),o=r.dispatch,a={getState:r.getState,dispatch:function(e){return o(e)}};return i=l.map(function(e){return e(a)}),o=Ot.apply(void 0,i)(r.dispatch),Rt({},r,{dispatch:o})}}}.apply(void 0,[])))),l=_n(),v=new yr({events:l}),r=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)});o.classList.add("player-"+r),o.classList.add("loading"),o.id||(o.id="player"+r),o.innerHTML=Oc.render("outer",{strings:{back:"Back",close:"Close overlay"}});var u=o.querySelector(".vp-telecine");if(Te.iOS){var c=document.createElement("video");u.appendChild(c);try{c.setAttribute("muted",""),c.setAttribute("playsinline",""),c.load()}catch(e){sr.captureException(e)}}var d=null,f=null,h=null,p=null,m=null,g=null,y=null,_={},b=void 0,w=new M(function(e,t){b=e}).then(function(){return l.fire(si.ready),null}),k={get config(){return v.config},set config(e){v.config=e},get delegate(){return a},set delegate(e){a=e},ready:function(e){if(!e)return w;w.then(function(){return e()}).catch(function(e){sr.captureException(e)})},get sessionId(){return v.config.request.session}};function S(e){var t=e.old,n=e.loaded;if(!t);if(window.parent!==window){var i="Private Video on Vimeo";n.view!==vi.main&&n.view!==vi.privateUnlocked||(i=n.video.title+" from "+n.video.owner.name+" on Vimeo"),document.title=i,history&&history.replaceState&&n.video&&t&&history.replaceState({id:n.video.id},"","/video/"+n.video.id+window.location.search)}if(n.view!==vi.main&&n.view!==vi.privateUnlocked)throw new Error("Config not authorized: "+n.view);t&&t.embed&&t.embed.color!==n.embed.color&&l.fire(oi.changeColor,n.embed.color),p&&p.reset();var r=!t||!t.video||t.video.id!==n.video.id||t.video.version.current!==n.video.version.current;return m=null,s.dispatch(il(n)),l.fire(oi.reset),l.fire(si.configChanged,r,n),e}function E(e){if("opacity"===e.propertyName){var t=document.querySelector(".vp-placeholder");t&&(Il(t).off("transitionend",E),t.parentNode.removeChild(t))}}function T(){window.requestAnimationFrame(function(){var e;(e=document.querySelector(".vp-placeholder"))&&(Il(e).on("transitionend",E),e.classList.add("vp-placeholder-fadeout")),o.classList.remove("loading")}),b()}function x(e){return i.then(function(){if(P(e),f&&f.resetThumbnail(),"function"!=typeof _.authorizationHandler)throw new Error("Config was not authorized.");return _.authorizationHandler(T)}).then(function(e){v.config=e;return m=null,s.dispatch(il(v.config)),l.fire(oi.reset),l.fire(si.configChanged,!0,v.config),e})}function A(){var e=document.location.hash,t=function(e){var t=e.match(/\ba?t=([0-9hms:]+)/);null!==t&&(e=t[1]);var n=!1,i=0,r=0,o=0;if((t=e.match(/^([0-9]+)$/))&&t.length&&(n=!0,o=t[1]),!1===n&&null!==(t=e.match(/^(?:([0-9]+)h)?(?:([0-9]+)m)?(?:([0-9]+)s)?/))&&""!==t[0]){n=!0;var a=Jn(t,4),s=a[1];i=void 0===s?0:s;var l=a[2];r=void 0===l?0:l;var u=a[3];o=void 0===u?0:u}if(!1===n&&null!==(t=e.match(/^([0-9:]+)/))){n=!0;var c=e.split(":").reverse(),d=Jn(c,3);o=d[0];var f=d[1];r=void 0===f?0:f;var h=d[2];i=void 0===h?0:h}return n?60*parseInt(i,10)*60+60*parseInt(r,10)+parseInt(o,10):null}(e);null!==t&&(v.config.embed.time=qn(t,0,v.config.video.duration),-1!==e.indexOf("at=")&&history&&history.replaceState&&history.replaceState("","",window.location.pathname+window.location.search))}function L(e){var t,n,i,r;A(),l.on(si.userLogIn,function(t){v.reload().then(function(e){if(!v.config.user.logged_in)return l.fire(si.loginFailure),e;switch(l.fire(si.userLoggedIn,t),t){case"like":v.config.user.liked&&l.fire(si.liked);break;case"watch-later":v.config.user.watch_later&&l.fire(si.addedToWatchLater);break;case"private":l.fire(si.privateUnlocked)}return e}).catch(function(e){sr.captureException(e)})}),l.on(si.userLoggedOut,function(){v.reload().catch(function(e){sr.captureException(e)})}),t=o.querySelector(".vp-shade"),n=o.querySelector(".vp-spin"),i=void 0,l.on(si.bufferStarted,function(){clearTimeout(i),i=setTimeout(function(){t.classList.remove("vp-shade-invisible"),n.classList.remove("vp-spin-invisible")},600)}),l.on(si.bufferEnded,function(){clearTimeout(i),t.classList.add("vp-shade-invisible"),n.classList.add("vp-spin-invisible"),f.hide()}),new Ic(r=e,s,o),f=new To(r,s,o.querySelector(".vp-preview")),d=new Ml(r,s,o.querySelector(".vp-video-wrapper")),new Cc(r,s,o.querySelector(".vp-captions")),new Pu(r,s),new Ou(r,s),new Cu(r,o,s),p=new Co(r),P(r)}function P(e){h||(h=new lr(e),Object.keys(h).forEach(function(e){if("function"!=typeof h[e]){var t={enumerable:!0,get:h[e].get};h[e].set&&(t.set=h[e].set),Object.defineProperty(k,e,t)}else Object.defineProperty(k,e,{enumerable:!0,value:h[e]})}))}var C={get store(){return s},get config(){return v.config},get element(){return o},get events(){return l},get uuid(){return r},get externalApi(){return k},get telecine(){return it(d,"telecine")},get preview(){return f},get doNotTrackEnabled(){return v.config.embed.dnt||v.config.request.flags.dnt},get playLoggingEnabled(){return v.config.embed.log_plays&&v.config.request.flags.plays},init:function(e,t){return g||(_=t,g=v.load(e).then(S).catch(function(e){return x(C)}).then(function(){return sr.setUp(v.config),null}).then(function(){return"function"==typeof _.initializationHandler?M.resolve(t.initializationHandler()):null}).then(function(){return L(C),"function"==typeof _.postInitializationHandler?M.resolve(t.postInitializationHandler()):null}).then(function(){return M.all([f.thumbnailPromise,i])}).then(T).catch(function(e){sr.captureException(e)}))},loadVideo:function(e,t){if(y===e&&m)return m;if(t.video_version){var n=v.config.video.version.available;if(!n||!Array.isArray(n))return M.reject("No available video versions");if(-1===(n=n.map(function(e){return e.id})).indexOf(t.video_version))return M.reject("Invalid version id specified")}return l.fire(si.loadVideo),y=e,o.classList.add("loading"),m=v.load(e,t).then(S).catch(function(e){return sr.captureException(e),x(C)}).then(function(e){var t=f.loadThumbnail();return M.resolve(t)}).then(T)},performDelegateAction:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=void 0;if(a&&a[e.will]&&!1===(r=(t=a)[e.will].apply(t,[v.config.video.id].concat(i))))return;n.apply(void 0,[v.config.video.id].concat(i,[r])),a&&a[e.did]&&a[e.did]()},ready:function(){return w},verifyConfig:function(){return v.verify()},updatePhpTokens:function(){return new M(function(t,n){var e=v.config.user,i=e.vimeo_api_client_token,r=e.vimeo_api_interaction_tokens,o=!1;if(i)try{o=0<=Eu(JSON.parse(atob(i.split(".")[1])).exp)}catch(e){return void n("Failed to parse PHP client token expiration")}if(r)try{var a=JSON.parse(atob(r.likes.split(".")[1])).exp,s=JSON.parse(atob(r.watch_later.split(".")[1])).exp,l=JSON.parse(atob(r.following.split(".")[1])).exp;o=0<=Eu(a)||0<=Eu(s)||0<=Eu(l)}catch(e){return void n("Failed to parse PHP interaction tokens expiration")}if(o){var u=v.config.request,c=u.signature,d=u.session,f=u.timestamp,h=u.expires;jn("https://"+v.config.player_url+"/video/"+v.config.video.id+"/token/refresh?signature="+c+"&session="+d+"&time="+f+"&expires="+h).then(function(e){return e=JSON.parse(e),v.config.user.vimeo_api_client_token=e?e.vimeo_api_client_token:null,v.config.user.vimeo_api_interaction_tokens=e?e.vimeo_api_interaction_tokens:null,t()}).catch(function(e){n("Failed to refresh JWT token: "+e)})}else t()})}};return C}var Fc=t(function(P){!function(r,a,o){var t=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&7<=parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10),s=function(){var e=a.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},n={};for(var i in t)for(var r=0,o=t[i].length;r<o;r++)if(t[i][r]in e||t[i][r]in a||"on"+t[i][r].toLowerCase()in a){n[i]=t[i][r];break}return n}(),l={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},i=[],u={},c=null;function d(){var t=Array.prototype.slice.apply(arguments),e=t.shift();u[e].forEach(function(e){"function"==typeof e&&e.apply(e,t)})}function e(n){return function(e,t){-1!==i.indexOf(e)&&n.call(this,e,t)}}function f(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var n=e.getElementsByTagName("video");n[0]&&(t=n[0])}return t}Object.keys(l).forEach(function(e){i.push(l[e]),u[l[e]]=[]});var h=null,v=null,p=function(){},m=[],g=!1,y=!1,n=-1!==navigator.userAgent.indexOf("Chrome"),_=-1!==navigator.userAgent.indexOf("Android"),b=-1!==navigator.userAgent.indexOf("Safari"),w=-1!==navigator.userAgent.indexOf("Apple");function k(t){var n=f(t);if(n&&n.webkitEnterFullscreen){try{n.readyState<n.HAVE_METADATA?(n.addEventListener("loadedmetadata",function e(){n.removeEventListener("loadedmetadata",e,!1);try{n.webkitEnterFullscreen(),v=!!n.getAttribute("controls")}catch(e){return A("cannot_enter_fullscreen",t)}},!1),n.load()):(n.webkitEnterFullscreen(),v=!!n.getAttribute("controls")),h=n}catch(e){return A("not_supported",t)}return!0}return A(void 0===s.request?"not_supported":"not_enabled",t)}function S(){L.element||(x(),E())}function E(){o&&"webkitfullscreenchange"===s.change&&r.removeEventListener("resize",S,!1)}n&&_&&(g=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0),b&&w&&!n&&!_&&(y=parseFloat(navigator.userAgent.replace(/^.*Version\/(\d+)\.(\d+).*$/,"$1.$2"))||!0);var T=function(e){var t=m[m.length-1];t&&(e!==t.element&&e!==h||!t.hasEntered)&&("VIDEO"===e.tagName&&(h=e),1===m.length&&L.onenter(L.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0,d(l.ENTER,L.element))},x=function(){!h||v||t||(h.setAttribute("controls","controls"),h.removeAttribute("controls")),v=h=null;var e=m.pop();e&&(e.exit.call(e.element),d(l.EXIT,e.element),!o&&c&&0===r.scrollY&&r.scrollTo(0,c),L.element||(m.forEach(function(e){e.exit.call(e.element),d(l.EXIT,e.element)}),m=[],L.onexit()))},A=function(e,t){if(0<m.length){var n=m.pop();t=t||n.element,n.error.call(t,e),L.onerror(t,e),d(l.ERROR,t,e)}},L={request:function(t,e,n,i){if(t=t||a.body,m.push({element:t,enter:e||p,exit:n||p,error:i||p}),void 0===s.request)return k(t);if(o&&!1===a[s.enabled])return k(t);if(!1!==g&&g<32)return k(t);if(o&&void 0===s.enabled)return s.enabled="webkitFullscreenEnabled",t[s.request](),void setTimeout(function(){a[s.element]?a[s.enabled]=!0:(a[s.enabled]=!1,k(t))},250);try{!o&&r&&(c=r.scrollY),t[s.request](),5.1<=y&&setTimeout(function(){a[s.element]||A(o?"not_enabled":"not_allowed",t)},100)}catch(e){A("not_enabled",t)}},exit:function(){E(),!a[s.exit]&&L.element?L.element[s.exit]():a[s.exit]()},toggle:function(e,t,n,i){L.element?L.exit():L.request(e,t,n,i)},videoEnabled:function(e){if(L.enabled)return!0;var t=f(e=e||a.body);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},on:e(function(e,t){u[e].push(t)}),off:e(function(e,t){var n=u[e].indexOf(t);-1<n&&u[e].splice(n,1)}),onenter:p,onexit:p,onchange:p,onerror:p};try{Object.defineProperties(L,{element:{enumerable:!0,get:function(){return h&&h.webkitDisplayingFullscreen?h:a[s.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"===s.exit&&!o||!(!1!==g&&g<32)&&(a[s.enabled]||!1)}}})}catch(e){L.element=null,L.enabled=!1}s.change&&a.addEventListener(s.change,function(e){if(L.onchange(L.element),d(l.CHANGE,L.element),L.element){var t=m[m.length-2];t&&t.element===L.element?x():(T(L.element),o&&"webkitfullscreenchange"===s.change&&r.addEventListener("resize",S,!1))}else x()},!1),a.addEventListener("webkitbeginfullscreen",function(e){var t=!0;if(0<m.length)for(var n=0,i=m.length;n<i;n++){if(f(m[n].element)===e.srcElement){t=!1;break}}t&&m.push({element:e.srcElement,enter:p,exit:p,error:p}),L.onchange(e.srcElement),d(l.CHANGE,L.srcElement),T(e.srcElement)},!0),a.addEventListener("webkitendfullscreen",function(e){L.onchange(e.srcElement),d(l.CHANGE,e.srcElement),x(e.srcElement)},!0),s.error&&a.addEventListener(s.error,function(e){A("not_allowed")},!1),P.exports?P.exports=L:r.BigScreen=L}(window,document,self!==top)});function Bc(e,t,o,a){var s=!1;a="function"==typeof t?o:a,o="function"==typeof t?t:o;var n=function(e){var t=!0;if(e.changedTouches){var n=e.changedTouches[0].pageX-window.pageXOffset,i=e.changedTouches[0].pageY-window.pageYOffset,r=document.elementFromPoint(n,i);null!==r&&this.contains(r)&&(t=o.call(this,e))}return"function"==typeof a&&a.call(this,e),s=!0,t},i=function(e){if(!s)return o.call(this,e);s=!1};(t="function"==typeof t?null:t)?Il(e).on("click",t,i).on("touchend",t,n):Il(e).on("click",i).on("touchend",n)}function qc(t,n){var e,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=[],o=void 0,a=void 0,s=!1;function l(){return o.classList.contains("vp-menu-carousel")}function u(){var t=1<r.length&&!l();r.forEach(function(e){e.setCollapsible(t),e.resetCarousel(l())})}function c(e){r.push(e),o.appendChild(e.element),u(),e.on("open",d),e.on(["open","close"],f),e.on(["openEnd","closeEnd"],h),e.on("select",m)}function d(e){r.filter(function(e){return e.isOpen()}).forEach(function(e){return e.close()})}function f(e){s=!0,_()}function h(e){s=!1}function v(){return n&&"true"===n.getAttribute("aria-expanded")}function p(e){v()||(e=e||n.contains(document.activeElement),n.setAttribute("aria-expanded","true"),o.removeAttribute("hidden"),t.events.fire(si.menuVisibilityChanged,!0,a),y(),u(),o.classList.remove("vp-menu-hidden"),window.requestAnimationFrame(function(){o.classList.remove("vp-menu-invisible"),e&&b()[0].focus()}))}function m(){l()||g()}function g(){v()&&(n.setAttribute("aria-expanded","false"),t.events.fire(si.menuVisibilityChanged,!1,a),o.classList.add("vp-menu-invisible"))}function y(){var e=Dn(o),t=window.getComputedStyle(o),n=parseFloat(t.fontSize);if(e.bottom-o.scrollHeight<10){var i=e.bottom-10;return o.style.height=i/n+"em",void o.classList.add("vp-menu-scroll")}o.style.height="auto",o.classList.remove("vp-menu-scroll")}function _(){y(),s&&requestAnimationFrame(_)}function b(){return r.reduce(function(e,t){return e.concat(t.getTabindexItems())},[])}return(e=document.createElement("div")).innerHTML=Oc.render("menu",{strings:{close:"Close menu"}}),o=e.children[0],i.forEach(c),Bc(o,".js-menuClose",g),Il(window).on("resize",y),Il(o).on("transitionend",function(e){this===o&&"opacity"===e.propertyName&&o.classList.contains("vp-menu-invisible")&&(o.classList.add("vp-menu-hidden"),o.setAttribute("hidden",""))}),Il(document).on("click",function(e){null!==n&&(!v()||n.contains(e.target)||o.contains(e.target)||g())}),window.addEventListener("blur",g,!1),a={element:o,button:n,isCentered:function(){return o.classList.contains("vp-menu-center")},isVisible:v,show:p,hide:g,toggle:function(e){return v()?(g(),!1):(p(e),!0)},setPanelModes:u,addPanel:c,getPanel:function(t){return r.find(function(e){return e.id===t})},getTabindexItems:b,destroy:function(){Il(window).off("resize",y)}}}function Nc(r){_n(this);var o=this,a={x:0,y:0},s={x:0,y:0},l={x:0,y:0},u=void 0,c=void 0,d=void 0,i=0;function f(e){r.style[Te.transitionProperty+"Duration"]=e}function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r.children.length-1,i=-Math.round(e/v());return Math.min(Math.max(i,t),n)}function n(){return!1}function v(){var e=r.children[0],t=getComputedStyle(e);return e.offsetWidth+parseInt(t.marginLeft,10)+parseInt(t.marginRight,10)}function p(e){var t=[e.clientX,e.clientY],n=t[0],i=t[1];if(e.targetTouches&&0<e.targetTouches.length){var r=[e.touches[0].pageX,e.touches[0].pageY];n=r[0],i=r[1]}return{x:n,y:i}}function m(e){e.stopImmediatePropagation();var i,t=p(e),n=t.x,r=t.y;s.x=n-a.x,s.y=r-a.y,u=!1,i=e,(d=function(e){var t=e?"on":"off",n={pointerdown:["pointermove","pointerup"],MSPointerDown:["pointermove","pointerup"],touchstart:["touchmove","touchend"],mousedown:["mousemove","mouseup"]};Il(window)[t](n[i.type][0],g),Il(window)[t](n[i.type][1],y)})(!0),f("0ms")}function g(e){var t=p(e),n=t.x,i=t.y;if(l.x=a.x,l.y=a.y,a.x=n-s.x,a.y=i-s.y,Math.abs(a.x-l.x)>=.15*Math.abs(a.y-l.y))return e.preventDefault(),u=!0,o.fire("touchMove"),c=Date.now(),void k(a.x);d(!1),_(h(a.x))}function y(e){if(e.stopImmediatePropagation(),d(!1),u){e.preventDefault();var t=a.x-l.x,n=Date.now()-c+1;return a.x+=50*t/n,_(h(a.x)),void o.fire("touchEnded")}!function(e){e.preventDefault();var t=zn(e.target,r.children);if(-1!==t){if(t!==i)return _(t);o.fire("tap",t)}}(e)}function _(e){w(e),o.fire("slide",e)}function b(){w(i,"0ms")}function w(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=v();-1!==e&&0<n&&(f(t),a.x=-e*n,k(a.x))}function k(e){var t=h(e,-1,r.children.length);t!==i&&(o.fire("focus",t),i=t),r.style[Te.transformProperty]="translateX("+e+"px)"}return{setUp:function(e){var t;Il(r).on(Te.pointerEvents?"pointerdown":["touchstart","mousedown"],m),Il(r).on("click","a",n),Il(window).on("resize",b),b(),void 0!==(t=e)&&w(t,"0ms")},show:function(e){w(Wn(e))},resize:b,destroy:function(){Il(r).off(Te.pointerEvents?"pointerdown":["touchstart","mousedown"],m),Il(r).off("click","a",n),Il(window).off("resize",b),r.style.removeProperty(Te.transformProperty)},on:this.on}}function jc(n){var e,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=_n(),i=t.id,o=t.items,a=void 0,s=void 0,l=void 0,u=!1,c=void 0,d=void 0;function f(e){var t=Ut(a.querySelectorAll(".vp-panel-item"));return t[e]||t}function h(){return a.classList.contains("vp-panel-collapsible")}function v(){return a.classList.contains("vp-panel-open")}function p(){if(h()){r.fire("open",c),n.events.fire(si.menuPanelOpened,!0,c),s.removeAttribute("hidden"),a.classList.add("vp-panel-open");var e=window.getComputedStyle(a),t=parseFloat(e.fontSize);a.style.height=a.scrollHeight/t+"em";var i=Te.transitionProperty+"Delay";f().forEach(function(e,t){var n=40*t+100;e.style[i]=n+"ms",e.classList.add("vp-panel-item-in")})}}function m(){h()&&(r.fire("close",c),n.events.fire(si.menuPanelClosed,!1,c),a.classList.remove("vp-panel-open"),a.style.removeProperty("height"))}function g(e){return e.preventDefault(),v()?m():p()}function y(e){r.fire("select",o[e].id)}function _(e){r.fire("select",o[e].id)}function b(e){if(!u){var t=zn(e.target,f());r.fire("select",o[t].id)}}function w(e){if("keypress"===e.type&&13===e.which||"keydown"===e.type&&32===e.which){var t=zn(e.target,f());if(-1!==t)return r.fire("select",o[t].id),!1}return null}function k(){return o.find(function(e){return e.active})}return t=Object.assign(t,{get active(){return k()?k().label:""}}),(e=document.createElement("div")).innerHTML=Oc.render("menu_list_panel",t),a=e.children[0],s=a.querySelector(".js-panelItems"),(l=new Nc(s)).on("slide",y),l.on("tap",_),Bc(a,".js-panelTitleButton",g),Bc(a,"li",b),Il(a).on("keydown",w),Il(a).on("keypress",w),Il(a).on("transitionend",function(e){e.target===a&&(v()?r.fire("openEnd",c):(s.setAttribute("hidden",""),f().forEach(function(e,t){e.classList.remove("vp-panel-item-in")}),r.fire("closeEnd",c)))}),c={id:i,element:a,setCollapsible:function(e){e!==h()&&(a.classList.toggle("vp-panel-open",!e),a.classList.toggle("vp-panel-collapsible",e),e?s.setAttribute("hidden",""):(s.removeAttribute("hidden"),a.style.removeProperty("height")))},resetCarousel:function(e){if(u=e,d=a.querySelector(".vp-indicator"),l.destroy(),d.classList.remove("vp-indicator-visible"),u){var t=o.findIndex(function(e){return e.active});l.setUp(t),l.on("touchMove",function(){d.classList.add("vp-indicator-inactive")}),l.on("touchEnded",function(){d.classList.remove("vp-indicator-inactive")}),d.classList.add("vp-indicator-visible")}},pinTitle:function(){a.classList.add("vp-panel-pinTitle")},isOpen:v,open:p,close:m,setActiveItem:function(t){var e=o.findIndex(function(e){return e.active});if(-1!==e){o[e].active=!1;var n=f(e);n.classList.remove("vp-panel-item-on"),n.setAttribute("aria-checked","false")}var i=o.findIndex(function(e){return""+e.id==""+t});if(-1!==i){o[i].active=!0;var r=f(i);r.classList.add("vp-panel-item-on"),r.setAttribute("aria-checked","true"),a.querySelector(".js-panelStatText").innerHTML=o[i].label}d.classList.remove("vp-indicator-inactive")},setTitleStat:function(e){k()&&"auto"!==k().id||(a.querySelector(".js-panelStatText").innerHTML=e)},getTabindexItems:function(){return Ut(a.querySelectorAll('.vp-panel-collapsible button[tabindex="0"], .vp-panel-open li[tabindex="0"]'))},on:r.on,off:r.off}}function Uc(e,t,n){return e=String(e),new Array(t-e.length+1).join(n||"0")+e}function Vc(e,t){var n=Math.floor(e/3600%60),i=Math.floor(e/60%60);if(e=Math.floor(e%60),t){var r=e+" second"+(1===e?"":"s");return 0<i&&(r=i+" minute"+(1===i?"":"s")+", "+r),0<n&&(r=n+" hour"+(1===n?"":"s")+", "+r),r}return(0<n?n+":":"")+Uc(i,2)+":"+Uc(e,2)}function Hc(g,c,d){var n,y,u,f,h,_,b,v,p,m,w,k,S,E,T,x,A,L,P,C,O,i,R,M,I,D,r=!1,F=!1,B=!1,o=!1,l=!1,q=!1,e=!1,N=!1,j=!1,t=!1,U=!1,V=!0,H=!1,W=!1,a=null,s=null,z=[],G=null,K=null,Y=null,X=!1,$=!1,Q=c.get(ll),J=[],Z=[],ee=g.config.embed.autoplay&&g.config.request.flags.autohide_controls,te=[{id:.5,label:"0.5x"},{id:1,label:"Normal"},{id:1.25,label:"1.25x"},{id:1.5,label:"1.5x"},{id:2,label:"2x"}];function ne(){s=a=null}function ie(){if(!s){var e=Dn(b).left,t=parseInt(window.getComputedStyle(b,"").borderLeftWidth,10);s=e+t}return s}function re(){if(!a){var e=Dn(b).right,t=parseInt(window.getComputedStyle(b,"").borderRightWidth,10);a=e-t}return a}function oe(e){var t=ie(),n=re()-t,i=e-t;return g.config.user.progress&&i<=10&&!F?0:qn(i/n,0,1)}function ae(e){var t=z,n=Array.isArray(t),i=0;for(t=n?t:t[Symbol.iterator]();;){var r;if(n){if(i>=t.length)break;r=t[i++]}else{if((i=t.next()).done)break;r=i.value}var o=r,a=Dn(o),s=a.left,l=a.right;if(s<=e&&e<=l)return parseFloat(o.getAttribute("data-time"))/g.config.video.duration}return oe(e)}function se(e,t){F&&!U&&(t=t||g.config.video.duration*e||0,window.requestAnimationFrame(function(){le(e,t),ue(e,t)}))}function le(e,t){(!c.get(ol)||H&&0!==t)&&(c.get(cl)&&(e=100),k.style.left=Math.min(Vn(100*e),100)+"%",S.innerHTML=Vc(t),k.style.display="block")}function ue(e,t){c.get(cl)&&(e=100);var n=Math.min(Vn(100*e),100);m.style.width=n+"%",m.setAttribute("aria-valuenow",Vn(t)),m.setAttribute("aria-valuetext",Vc(Math.round(t),!0)+" played"),h.setAttribute("width",n+"%")}function ce(e,t){c.get(cl)&&(e=100);var n=Math.min(Vn(100*e),100);p.style.width=n+"%",p.setAttribute("aria-valuenow",Vn(t)),p.setAttribute("aria-valuetext",Vc(t,!0)+" loaded"),f.setAttribute("width",n+"%")}function de(){return F=!0,W&&(V=!1,d.classList.add("invisible"),_e(),pe()),y.classList.contains("state-playing")?(g.events.fire(si.pauseButtonPressed),fe()):(g.events.fire(si.playButtonPressed),he()),!Te.android}function fe(){H=!1,y.classList.remove("state-playing"),y.classList.add("state-paused");var e=y.getAttribute("data-title-play");y.setAttribute("title",e),y.setAttribute("aria-label",e)}function he(){H=!0,W&&_e(),y.classList.remove("state-paused"),y.classList.add("state-playing");var e=y.getAttribute("data-title-pause");y.setAttribute("title",e),y.setAttribute("aria-label",e)}function ve(){V&&(r||(F&&t||o||ee)&&(B||(!X&&!$||o)&&(o&&g.config.view===vi.privateUnlocked||e||l||(V=!1,g.events.fire(si.controlBarVisibilityChanged,V),d.classList.add("invisible")))))}function pe(){V||o||(d.classList.remove("hidden"),d.removeAttribute("hidden"),setTimeout(function(){V=!0,g.events.fire(si.controlBarVisibilityChanged,V),d.classList.remove("invisible")},0))}function me(e){return Z.push(e),v.appendChild(e.element),e}function ge(t){Z=Z.filter(function(e){return e!==t}),v.removeChild(t.element),t.destroy()}function ye(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;if(L){var n,t=e/(1/P.length),i=Math.ceil(t),r=t%1;r<=.33&&(n="fill1"),.33<r&&r<=.66&&(n="fill2"),P.forEach(function(e,t){e.classList.remove("fill0"),e.classList.remove("fill1"),e.classList.remove("fill2"),t===i-1&&r&&r<=.66?e.classList.add(n):i-1<t&&e.classList.add("fill0")}),L.setAttribute("aria-valuenow",e.toFixed(3)),L.setAttribute("aria-valuetext",Math.round(100*e)+"%")}}function _e(){if(g.config.view===vi.main||g.config.view===vi.privateUnlocked){var e=g.config.embed.settings,t={show:e.logo,showLink:!!g.config.video.url,url:g.config.video.url},n=function(){if(!g.config.embed.settings.custom_logo)return null;var e=g.config.embed.settings.custom_logo,t=e.img;return 2<=Te.devicePixelRatio&&(t=t.replace(/(mw|mh)=(\d+)/g,function(e,t,n){return t+"="+2*parseInt(n,10)})),{showLink:null!==e.url,url:pr(e.url),img:t,sticky:e.sticky,width:e.width,height:e.height}}();if(!g.config.embed.settings.watch_trailer||F||H||g.config.embed.autoplay||!g.config.embed.on_site){var i=!g.telecine||g.telecine.supportsSettingVolume,r=!g.telecine||g.telecine.supportsTextTracks,o="text_tracks"in g.config.request&&g.config.request.text_tracks.length,a={targetBlank:0===g.config.embed.on_site,playState:H?"playing":"paused",volume:i&&e.volume,ccButton:r&&o,ccOn:null!==K,prefsButton:!0,airplayButton:Te.airPlay,stereoscopicButton:"disable"!==g.config.video.privacy&&Te.stereoscopic&&g.config.video.spatial,fullscreenButton:e.fullscreen,vimeoLogo:t,duration:Vc(g.config.video.duration),rawDuration:g.config.video.duration,strings:{play:"Play",pause:"Pause",loadedBar:"loaded",playedBar:"played",volume:"Volume (use up/down arrow keys to change)",captions:"Choose captions",prefs:"Settings",effect:"Choose an effect to apply to the video",airPlay:"Choose an AirPlay device",airPlayOff:"Turn off AirPlay",pipEnter:"Enter Picture-in-Picture",pipReturn:"Exit Picture-in-Picture",fullscreen:"Fullscreen",enterFullscreen:"Enter full screen",exitFullscreen:"Exit full screen",watchOnVimeo:"Watch on vimeo.com",stereoscopic:"Enable stereoscopic playback",stereoscopicOff:"Disable stereoscopic playback"}};if(n&&(a.customLogo=n),g.config.video.live_event&&Te.iOS&&(a.prefsButton=!1),d.classList.remove("trailer"),W=!1,d.innerHTML=Oc.render("controlbar",a),y=d.querySelector(".play"),u=y.querySelector(".buffer"),f=y.querySelector(".loaded"),h=y.querySelector(".played"),_=d.querySelector(".play-bar"),b=d.querySelector(".vp-progress"),v=d.querySelector(".js-menubar"),p=_.querySelector(".loaded"),m=_.querySelector(".played"),w=_.querySelector(".cuepoints"),k=d.querySelector(".timecode"),S=k.querySelector(".box"),E=d.querySelector(".ghost-timecode"),T=E.querySelector(".box"),x=d.querySelector(".thumb-preview"),A=d.querySelector(".thumb"),(L=d.querySelector(".volume"))&&(P=Ut(L.querySelectorAll("div")),ye(g.config.request.cookie.volume)),O=d.querySelector(".play-bar .cc"),C=d.querySelector(".js-prefs"),Y=d.querySelector(".effect"),R=d.querySelector(".pip"),Te.airPlay&&(M=d.querySelector(".airplay")),Te.stereoscopic&&g.config.video.spatial&&(I=d.querySelector(".stereoscopic")),D=d.querySelector(".fullscreen"),B=!1,F||Se(),V&&g.events.fire(si.controlBarVisibilityChanged,V),ee&&ve(),be(),c.get(cl)){var s=d.querySelector(".vp-live-status");s.style.display="block";var l=s.querySelector(".vp-live-status-circle");Q?(l.classList.remove("offline"),l.classList.add("online"),C&&C.classList.remove("hidden")):(l.classList.add("offline"),l.classList.remove("online"),C&&C.classList.add("hidden")),S.style.cursor="default",b.classList.add("disabled")}}else!function(e,t){d.classList.add("trailer");var n={vimeoLogo:e,text:g.config.video.vod.button_text||"Watch Trailer",strings:{playTrailer:"Play Trailer",watchOnVimeo:"Watch on vimeo.com"}};t&&(n.customLogo=t);d.innerHTML=Oc.render("controlbar_trailer",n),y=d.querySelector(".play"),W=!0}(t,n)}}function be(){if(c.get(cl)){var e=H&&0<g.config.duration;k.style.display=e?"block":"none"}}function we(){var o;function a(e){if(U=!1,o===e.pointerId&&!1!==e.isPrimary){var t=e.clientX;e.targetTouches&&0<e.targetTouches.length&&(t=e.targetTouches[0].clientX,e.preventDefault());var n=ae(t);se(n),g.events.fire(oi.seek,n)}}function s(e){var t=e.type;"pointerup"===t||"MSPointerUp"===t?Il(d).off("pointermove",".vp-progress",a).off("pointerup",".vp-progress",s):"touchend"===e.type?Il(d).off("touchmove",a).off("touchend",s):Il(document).off("mousemove",a).off("mouseup",s),g.events.fire(si.scrubbingEnded),g.element.classList.remove("scrubbing")}g.events.on(si.playProgress,function(e,t,n){U&&(0===g.config.embed.time||0<g.config.embed.time&&e>=g.config.embed.time)&&(U=!1),l||se(n,e)}),g.events.on(si.scrubbingStarted,function(e){l=!0,q=e}),g.events.on(si.scrubbingEnded,function(){q=l=!1}),g.events.on(si.seeked,function(e,t,n){q&&se(n)}),c.get(ol)&&!c.get(ul)||(Il(d).on(Te.pointerEvents?"pointerdown":["touchstart","mousedown"],".vp-progress",function(e){if(!e.button||2!==e.button){g.element.classList.add("scrubbing"),g.events.fire(si.scrubbingStarted);var t=e.type;if("pointerdown"===t||"MSPointerDown"===t){o=e.pointerId;try{e.target.msSetPointerCapture?e.target.msSetPointerCapture(o):e.target.setPointerCapture(o)}catch(e){}Il(d).on("pointermove",".vp-progress",a).on("pointerup",".vp-progress",s)}else"touchstart"===t?Il(d).on("touchmove",a).on("touchend",s):Il(document).on("mousemove",a).on("mouseup",s);var n=e.clientX;e.targetTouches&&0<e.targetTouches.length&&(n=e.targetTouches[0].clientX,e.preventDefault());var i=ae(n);if(F)se(i);else{var r=g.config.video.duration*i;le(i,r),ue(i,r),U=!0}return g.events.fire(oi.seek,i,null),!1}}),g.events.on(oi.setTime,function(e,t){e=qn(e,0,g.config.video.duration),t||(t=e/g.config.video.duration),window.requestAnimationFrame(function(){le(t,e),ue(t,e)})}))}function ke(e){var t=Dn(g.element.querySelector(".vp-player-inner")),n=Dn(e.button),i=Dn(e.element.parentElement),r=Dn(e.element),o=0,a=n.right-n.width/2+r.width/2;a<i.right&&(o=i.right-a);var s=window.getComputedStyle(e.element),l=parseFloat(s.fontSize);if(e.isCentered()){var u=t.right-i.right,c=t.bottom-i.bottom,d=(t.width-r.width)/2,f=(t.height-r.height)/2;e.element.style.right=(d-u)/l+"em",e.element.style.bottom=(f-c)/l+"em"}else e.element.style.right=o/l+"em",e.element.style.bottom=i.height/l+"em"}function Se(){var e=g.config.user.progress,t=e/g.config.video.duration;!e||g.config.embed.autoplay||g.config.embed.time||W||(le(t,e),ue(t,e),U=!0)}function Ee(){c.get(ol)&&!c.get(ul)&&(g.events.on(si.liveStreamOnline,function(){Q=!0,_e()}),g.events.on(si.liveStreamOffline,function(){Q=!1,_e()}))}return _e(),Bc(d,".play, .replay",de),g.events.on([si.playInitiated,si.playButtonPressed],he),g.events.on([si.pauseButtonPressed,si.paused,oi.reset],fe),g.events.on(si.error,function(e){"telecine-file-error"!==e&&fe()}),g.events.on(si.played,function(){he()}),g.events.on(si.ended,function(){U=!1,fe(),se(1)}),g.events.on(si.overlayOpened,function(e){"not-supported"===e&&fe()}),c.get(ol)&&!Q&&(y.classList.add("hidden"),g.events.once(si.liveStreamOnline,function(){y.classList.remove("hidden")})),we(),g.events.on([si.bufferStarted,si.controlbarBufferStarted],function(){u.setAttribute("class",u.getAttribute("class").replace(/\s+hidden/,"")),e=!0,ee||pe()}),g.events.on([si.bufferEnded,si.controlbarBufferEnded],function(){p.classList.remove("hidden"),c.get(cl)&&m.classList.remove("hidden"),u.setAttribute("class",u.getAttribute("class")+" hidden"),e=!1}),function(){var e=void 0,o=null;function a(){return e||(e=g.verifyConfig().then(function(e){return Eo(e.thumb_preview.url)})),e.then(function(e){var t=g.config.request.thumb_preview;return A.style.backgroundImage||(A.style.width=t.frame_width/2+"px",A.style.height=t.frame_height/2+"px",A.style.backgroundImage="url("+t.url+")",A.style.backgroundSize=t.width/2+"px "+t.height/2+"px"),e})}function t(e){if(e.target===_){var t=oe(e.clientX);se(t),g.events.fire(oi.seek,t)}}function s(e){return E.classList.contains("hidden")||(x.classList.remove("hidden"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){x.classList.remove("invisible")})})),e}function n(h){if(g.config.request.thumb_preview&&null===o){var e=Dn(b).width,t=document.querySelector(".player").clientHeight;if(!(o=215<=t&&185<=e))return void x.classList.add("hidden");a().then(s).catch(function(){})}if(j){var n=function(e){var t=z,n=Array.isArray(t),i=0;for(t=n?t:t[Symbol.iterator]();;){var r;if(n){if(i>=t.length)break;r=t[i++]}else{if((i=t.next()).done)break;r=i.value}var o=r,a=Dn(o),s=a.left,l=a.right,u=a.width;if(s<=e&&e<=l)return{clientX:s+u/2,snappedTo:o}}return{clientX:e,snappedTo:null}}(h.clientX),i=n.clientX,r=n.snappedTo,v=oe(i),p=g.config.video.duration*v;z.forEach(function(e){return e.classList.toggle("active",e===r)}),g.config.request.thumb_preview&&o&&a().then(function(e){var t,n,i,r,o,a=(t=p,n=g.config.video.duration/g.config.request.thumb_preview.frames,i=Math.min(g.config.request.thumb_preview.frames-1,Math.ceil(t/n)),r=i%g.config.request.thumb_preview.columns,o=Math.floor(i/g.config.request.thumb_preview.columns),[-r*g.config.request.thumb_preview.frame_width/2,-o*g.config.request.thumb_preview.frame_height/2]),s=Jn(a,2),l=s[0],u=s[1];return window.requestAnimationFrame(function(){A.style.backgroundPosition=l+"px "+u+"px"}),e}).catch(function(){}),window.requestAnimationFrame(function(){T.innerHTML=Vc(p);var e,t,n,i,r,o,a,s,l,u,c,d,f=(100*v).toFixed(3);E.style.left=f+"%",e=v,o=Dn(y).left,a=Dn(_).right,s=Dn(x).width,l=o+Math.ceil(s/2),u=a-Math.ceil(s/2),c=ie(),d=re()-c,t=Jn([(l-c)/d,(u-c)/d],2),n=t[0],i=t[1],r=(100*Math.max(n,Math.min(i,e))).toFixed(3),x.style.left=r+"%",h.clientX>re()+10&&!x.contains(document.elementFromPoint(h.clientX,h.clientY))&&m()})}}function m(){E&&(E.classList.add("invisible"),x.classList.add("invisible")),j=!1,Il(_).off("click",t)}c.get(ol)&&!c.get(ul)||Il(d).on("mouseenter",".vp-progress",function(e){j||N||(E.classList.remove("hidden"),j=!0,n(e),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){E.classList.remove("invisible")})}),g.config.request.thumb_preview&&o&&a().then(s).catch(function(){}),Il(_).on("click",t))}).on("mousemove",".play-bar",n).on("mouseleave",".play-bar",m),Il(d).on("transitionend",".ghost-timecode",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(E.classList.add("hidden"),x.classList.add("hidden"))},!1),g.events.on(si.mousedOut,m),g.events.on(si.configChanged,function(){e=null})}(),function(){var r;function o(e){var t=e.clientX;e.targetTouches&&(t=e.targetTouches[0].clientX,e.preventDefault());var n=s(t);g.events.fire(oi.changeVolume,n),ye(n)}function a(e){N=!1,g.events.fire(si.volumeScrubbingEnded),g.element.classList.remove("scrubbing");var t=e.type;"pointerup"===t||"MSPointerUp"===t?Il(d).off("pointermove",".volume",o).off("pointerup",".volume",a):"touchend"===e.type?Il(document).off("touchmove",o).off("touchend",a):Il(document).off("mousemove",o).off("mouseup",a),L.setAttribute("tabindex",L.getAttribute("data-tabindex")),L.removeAttribute("data-tabindex")}function s(e){var t=Dn(L).left;return qn((e-t)/(Dn(L).right-t),0,1)}Il(d).on("mousemove",".volume",function(e){var t=e.srcElement;if(-1===P.indexOf(t)){var n=Dn(L),i=e.clientX,r=n.bottom-2;if(t=document.elementFromPoint(i,r),-1===P.indexOf(t))return}t.classList.add("hover"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t.classList.remove("hover"),t.classList.add("animate")})})}),Il(d).on("transitionend",".volume div",function(e){"height"===e.propertyName&&this.classList.remove("animate")}),Il(document).on("contextmenu",".volume",function(){this.blur()}),Il(d).on(Te.pointerEvents?"pointerdown":["touchstart","mousedown"],".volume",function(e){if(1===e.which){L.setAttribute("data-tabindex",L.getAttribute("tabindex")),L.removeAttribute("tabindex"),N=!0,g.element.classList.add("scrubbing"),g.events.fire(si.volumeScrubbingStarted);var t=e.type;if("pointerdown"===t||"MSPointerDown"===t){r=e.pointerId;try{e.target.msSetPointerCapture?e.target.msSetPointerCapture(r):e.target.setPointerCapture(r)}catch(e){}Il(d).on("pointermove",".volume",o).on("pointerup",".volume",a)}else"touchstart"===t?Il(document).on("touchmove",o).on("touchend",a):Il(document).on("mousemove",o).on("mouseup",a);var n=e.clientX;e.targetTouches&&(n=e.targetTouches[0].clientX);var i=s(n);g.events.fire(oi.changeVolume,i),ye(i)}}),g.events.on(si.volumeChanged,function(e){!N&&P&&ye(e)}).on([oi.enableVolume,oi.disableVolume],function(){_e()})}(),Bc(d,".cc",function(){g.events.fire(si.ccButtonPressed)}),g.events.on(si.ccButtonPressed,function(e){i?i.toggle(e):(i=me(function(e){var i=[];"text_tracks"in g.config.request&&(g.config.request.text_tracks.forEach(function(e){var t="CC"===e.label.substring(e.label.length-2),n="captions"!==e.kind||t?"":" CC";i.push({label:e.label+n,id:""+e.id,active:K===""+e.id})}),i.push({label:"None",id:"off",active:null===K}));var t=new jc(g,{items:i,id:"cc",title:"Closed Captions"});return t.on("select",function(e){"off"!==e?g.events.fire(oi.turnCaptionsOn,e):g.events.fire(oi.turnCaptionsOff)}),new qc(g,e,[t])}(O))).show(e)}),g.events.on(si.captionsChanged,function(e){if(e)return t=e.id,K=t,i&&i.getPanel("cc")&&(i.getPanel("cc").setActiveItem(t),setTimeout(function(){i.hide()},100)),void(O&&(O.classList.add("on"),O.classList.remove("off")));var t;K=null,i&&i.getPanel("cc")&&(i.getPanel("cc").setActiveItem("off"),setTimeout(function(){i.hide()},100)),O&&(O.classList.add("off"),O.classList.remove("on"))}).on(si.controlBarVisibilityChanged,function(e){e||i&&i.hide()}).on([oi.enableCaptions,oi.disableCaptions],function(){_e()}),function(){var r=void 0,s=void 0,l=null;function u(){if(g.telecine.video.currentFile.mime===ri.dash){var e=g.config.request.files.dash.streams,t=Ut(e).sort(Ll()).filter(Tl(e)).filter(xl(J)).map(function(e){var t=kl(e);return{id:t,label:Pl(e),active:r===t}});return t.unshift({id:"auto",label:"Auto",active:!r||"auto"===r}),t}var n,i=g.telecine.video.files;return Ut(i).filter((n="progressive",function(e){return ci[e.mime]===n})).filter(Tl(i)).sort(Ll()).filter(xl(J)).map(function(e){return{label:kl(e),id:kl(e),active:r===e.metadata.quality}})}Bc(d,".js-prefs",function(){g.events.fire(si.prefsButtonPressed)}),g.events.on(si.prefsButtonPressed,function(e){if(C){if(!G)return void(G=me(function(){var e=[],t=new jc(g,{id:"quality",title:"Quality",items:l||u()});if(t.on("select",function(e){g.events.fire(oi.changeQuality,e)}),s&&t.setTitleStat(s),t.pinTitle(),e.push(t),g.telecine.supportsPlaybackRate&&g.config.embed.settings.speed){var n=te.map(function(e){return e.active=e.id===g.telecine.playbackRate,e}),i=new jc(g,{id:"speed",title:"Speed",items:n});i.on("select",function(e){g.events.fire(oi.changePlaybackRate,e)}),i.pinTitle(),e.push(i)}var r=new qc(g,C,e);function o(e){r.element.classList.toggle("vp-menu-center",e),g.events.fire(si.menuCentered,r.isCentered(),r)}function a(e){r.element.classList.toggle("vp-menu-carousel",e),r.setPanelModes()}return c.watch("ui.controlbar.isPrefsMenuCentered",o),c.watch("ui.controlbar.hasPrefsMenuCarousel",a),o(c.get("ui.controlbar.isPrefsMenuCentered")),a(c.get("ui.controlbar.hasPrefsMenuCarousel")),r}())).show(e);G.toggle(e)}}),g.events.on(si.qualityChanged,function(e){r=e,G&&G.getPanel("quality")&&G.getPanel("quality").setActiveItem(e)}),g.events.on(si.streamChanged,function(e){var t=e.quality||e.height+"p";s=t,G&&G.getPanel("quality")&&G.getPanel("quality").setTitleStat(Pl(e))}),g.events.on(si.playbackRateChanged,function(e){G&&G.getPanel("speed")&&G.getPanel("speed").setActiveItem(e)}),g.events.on(si.liveRepresentationsAvailable,function(e){var t,n=e.video.map(function(e){return e.height.toString()});r=null,(t=n.sort(Ll()).map(function(e){var t=e+"p";return{id:t,label:t,active:r===t}})).unshift({id:"auto",label:"Auto",active:!r||"auto"===r}),l=t,G&&(ge(G),G=null)}),g.events.on(si.hevcRestrictedStreams,function(e){J=e})}(),function(){var e=document.createElement("a");if(e.style.cssText="-moz-filter:blur(2px);-webkit-filter:blur(2px);filter:blur(2px);",!(e.style.length<1||g.config.embed.settings.background)){var a=null;Bc(d,".effect",function(){return g.events.fire(si.effectButtonPressed)}),g.events.on(si.effectButtonPressed,function(e){if(Y.classList.remove("hidden"),!a){var t=new jc(g,{id:"effect",title:"Effect",items:(n=[{label:"Soporific",id:"aden"},{label:"Escutcheon",id:"earlybird"},{label:"Pluvious",id:"hudson"},{label:"Moribund",id:"inkwell"},{label:"Fecundity",id:"mayfair"},{label:"Jejune",id:"toaster"},{label:"None",id:"none",active:!0}],i=Te.browser.safari,r=g.telecine.supportsEffect(gs),o=ci[g.telecine.video.currentFile.mime],!i&&"dash"===o&&r&&n.unshift({label:"ASCII",id:"ascii"}),n)});return t.on("select",function(e){return g.events.fire(oi.setEffect,e)}),void(a=me(new qc(g,Y,[t]))).show(e)}var n,i,r,o;a.toggle(e)}),g.events.on(oi.setEffect,function(e){if(a.getPanel("effect").setActiveItem(e),"none"===e)return Y.classList.add("off"),void Y.classList.remove("on");Y.classList.add("on"),Y.classList.remove("off")}),g.events.on(si.ready,function(){g.telecine.on(Ra.SCANNER_CHANGE,function(){a&&(ge(a),a=null),G&&(ge(G),G=null)})})}}(),Bc(d,".pip",function(){"picture-in-picture"!==g.telecine.presentationMode?g.events.fire(oi.activatePictureInPicture):g.events.fire(oi.deactivatePictureInPicture)}),g.events.on(si.pictureInPictureAvailable,function(){R&&(R.classList.remove("hidden"),R.hidden=!1,ne())}).on(si.pictureInPictureNotAvailable,function(){R&&(R.classList.add("hidden"),R.hidden=!0,ne())}).on(si.pictureInPictureActivated,function(){$=!0,R&&(R.classList.add("return"),R.classList.remove("enter"),R.setAttribute("title",R.getAttribute("data-title-return")))}).on(si.pictureInPictureDeactivated,function(){$=!1,R&&(R.classList.add("enter"),R.classList.remove("return"),R.setAttribute("title",R.getAttribute("data-title-enter")))}),Te.airPlay&&(Bc(d,".airplay",function(){g.events.fire(si.airPlayButtonPressed)}),g.events.on(si.airPlayAvailable,function(){M&&(M.classList.remove("hidden"),M.hidden=!1,ne())}).on(si.airPlayNotAvailable,function(){M&&(M.classList.add("hidden"),M.hidden=!0,ne())}).on(si.airPlayActivated,function(){X=!0,M&&(M.classList.remove("off"),M.classList.add("on"),M.setAttribute("title",M.getAttribute("data-title-on"))),pe()}).on(si.airPlayDeactivated,function(){X=!1,M&&(M.classList.remove("on"),M.classList.add("off"),M.setAttribute("title",M.getAttribute("data-title-off")))})),Bc(d,".fullscreen",function(){g.events.fire(si.fullscreenButtonPressed)}),g.events.on(si.didEnterFullscreen,function(){r=!1,d.classList.remove("tiny"),D&&D.setAttribute("title",D.getAttribute("data-title-unfullscreen"))}),g.events.on(si.didExitFullscreen,function(e){if(D){var t=D.cloneNode(!0);D.parentNode.replaceChild(t,D),(D=t).setAttribute("title",D.getAttribute("data-title-fullscreen"))}e||(r=!0),n&&d.classList.add("tiny")}),g.events.on([si.mousedOver,si.scrubbingStarted,oi.changeVolume],pe).on([si.mousedOut,si.mouseTimeout],ve).on(si.willEnterFullscreen,function(){B=!1,ve()}).on(si.willExitFullscreen,function(){B=!1}).on(si.targetTimeReached,function(){t=!0,ve()}).on(oi.changeVolume,function(e,t){t||pe()}),Il(d).on(["pointerenter","pointerleave","mouseenter","mouseleave"],[".play",".play-bar",".custom-logo",".vp-menu"],function(e){"pointerType"in e?"mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(B="pointerenter"===e.type||"MSPointerEnter"===e.type):Te.touch||(B="mouseover"===e.type)}),Il(d).on("transitionend",function(e){this===d&&"opacity"===e.propertyName&&d.classList.contains("invisible")&&(d.classList.add("hidden"),d.setAttribute("hidden",""))}),g.events.on(si.overlayOpened,function(e){if("not-supported"!==e&&"private-unlocked"!==e&&"help"!==e)o=!0,ve();else for(var t=d.querySelectorAll("a, button, input, [tabindex]"),n=0,i=t.length;n<i;n++){var r=t[n].getAttribute("tabindex");r&&t[n].setAttribute("data-tabindex",r),t[n].setAttribute("tabindex","-1")}}).on(si.overlayClosed,function(){o=!1,pe();for(var e=d.querySelectorAll("[tabindex]"),t=0,n=e.length;t<n;t++){var i=e[t].getAttribute("data-tabindex");i&&"null"!==i?e[t].setAttribute("tabindex",i):e[t].removeAttribute("tabindex"),e[t].removeAttribute("data-tabindex")}}),g.events.on(si.outroDisplayed,function(){d.classList.add("controls-outro")}).on(si.outroHidden,function(){d.classList.remove("controls-outro")}),function(){function t(){Z.filter(function(e){return e.isVisible()}).forEach(function(e){return e.hide()})}g.events.on([si.menuCentered,si.menuVisibilityChanged],function(e,t){ke(t),t.isCentered()&&t.isVisible()&&d.classList.add("controls-centerMenu"),t.isCentered()&&t.isVisible()||d.classList.remove("controls-centerMenu")}).on(si.didExitFullscreen,t).on(si.controlBarVisibilityChanged,function(e){e||t()}),Il(window).on("resize",function(){Z.forEach(ke)})}(),g.events.on(si.configChanged,function(e,t){Ee(),we(),_e(),g.config.view===vi.privateUnlocked&&pe(),ne()}),g.events.on(oi.reset,function(){window.requestAnimationFrame(function(){be(),le(0,g.config.video.duration),ue(0,0),ce(0,0)}),pe(),t=r=U=N=l=B=F=!1,i&&(ge(i),i=null),G&&(ge(G),G=null)}),Il(window).on("resize",function(){ne()}),Se(),g.events.on(si.enteredTinyMode,function(){n=!0,d.classList.add("tiny")}).on(si.enteredMiniMode,function(){n=!1,d.classList.remove("tiny")}).on(si.enteredNormalMode,function(){n=!1,d.classList.remove("tiny")}),function(){if(g.config.embed.on_site){var i=new Io;g.events.on(si.cuePointAdded,function(e){if(e.data.visible){var t=document.createElement("div");t.setAttribute("id","cuepoint-"+e.id),t.setAttribute("data-time",e.time),t.classList.add("cuepoint"),t.classList.add("out"),t.appendChild(document.createElement("div"));var n=e.time/g.config.video.duration*100;t.style.left=n+"%",i.set(e,t),w.appendChild(t),z=Ut(d.querySelectorAll(".cuepoint")),window.requestAnimationFrame(function(){return t.classList.remove("out")})}}),g.events.on(si.cuePointRemoved,function(e){var t=i.get(e);t&&(i.delete(e),t.classList.add("out"))}),Il(d).on("transitionend",".cuepoint",function(e){this.classList.contains("out")&&(w.removeChild(this),z=Ut(d.querySelectorAll(".cuepoint")))})}}(),I&&(Bc(d,".stereoscopic",function(){g.events.fire(si.stereoscopicButtonPressed)}),I.classList.remove("hidden"),I.hidden=!1),Ee(),g.events.on(si.playInitiated,function(){g.events.on(si.loadProgress,function(e,t,n){r||window.requestAnimationFrame(function(){ce(n,e)})}),F=!0;var e=g.config.embed.time||g.telecine.currentTime;se(e/g.config.video.duration,e),U=!0}),g.events.fire(si.controlBarModuleReady),{}}var Wc=function(){function s(e,t){var n=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;Yn(this,s),_n(this),this.version=i,this.visible=!1;var r=this._wrap=document.createElement("div");r.classList.add("compass-wrapper"),r.innerHTML=Oc.render("compass",{version:i}),r.classList.add("cloaked"),e.appendChild(r),t&&r.addEventListener("click",t),this._layerSlice=r.querySelector(".compass-slice"),this._lineSlice=r.querySelector(".compass-line");var o=function(){n._mouseIn=!0},a=function(e){return function(){setTimeout(function(){n._mouseIn||(n.fade(),n._mouseIn=!1)},e)}};Il(this._wrap).on("mousein",o).on("pointerin",o).on("mouseout",a(1e3)).on("pointerout",a(1e3)),a(2500)()}return Xn(s,[{key:"setAngle",value:function(e,t){var n=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame);var i=0;1===this.version?i=-45:2===this.version&&(i=-30);var r=""+(i+t),o=(e+85)/170;this._animationFrame=window.requestAnimationFrame(function(){n._layerSlice.setAttribute("transform","rotate("+r+", 18, 18)"),n._lineSlice&&n._lineSlice.setAttribute("d",n._getLinePath(o,18))})}},{key:"_getLinePath",value:function(e,t){var n=2*t-Math.round(2*t*e),i=(2*t-2*Math.sqrt(2*n*t-Math.pow(n,2)))/2;return"M"+(i+5)+","+n+" L"+(2*t-i-5)+","+n+" z"}},{key:"reveal",value:function(){var e=this;this._wrap.classList.remove("cloaked"),window.requestAnimationFrame(function(){e._wrap.classList.add("in")}),this.visible=!0}},{key:"fade",value:function(){this._wrap.classList.add("fade"),this.visible=!0}},{key:"hide",value:function(){var t=this;this._wrap.classList.remove("in"),this._wrap.classList.remove("fade"),this._wrap.classList.add("leaving");Il(this._wrap).on("transitionend",function e(){"opacity"===event.propertyName&&(t._wrap.classList.remove("leaving"),t._wrap.classList.add("cloaked"),t.visible=!1),Il(t._wrap).off("transitionend",e)})}},{key:"updatePosition",value:function(e){if(e){var t=Dn(e);if(t.height<265)return this._wrap.classList.remove("align-bottom"),void this._wrap.classList.add("hidden");if(t.height<336)return this._wrap.classList.remove("hidden"),void this._wrap.classList.add("align-bottom");this._wrap.classList.remove("hidden"),this._wrap.classList.remove("align-bottom")}}},{key:"getWrapper",value:function(){return this._wrap}}]),s}(),zc=55,Gc=45;function Kc(d,o,f){var n,a,s,e,t,l=2e3,u=4500,i=null,c=Te.touch?u:l,h=!0,v=!0,p=!1,m=null,g=null,y=[],_=!1,b=null,w=null,k=!0,S=!1,r=!1,E=!1,T=!1,x=1.75,A=f.querySelector(".vp-target"),L=f.querySelector(".vp-sidedock"),P=f.querySelector(".vp-controls"),C=f.querySelector(".vp-title"),O=f.querySelector(".vp-video"),R=d.config.embed.autoplay&&d.config.request.flags.autohide_controls;function M(){clearTimeout(i),i=null}function I(){T&&(clearTimeout(i),i=setTimeout(F,c))}function D(){Fc.element&&Fc.element.classList.contains("js-player-fullscreen")&&(p||(f.classList.add("player-cursor-hide"),p=v=!0))}function F(e){(S||k)&&(E||(M(),document.activeElement&&document.body.classList.contains("showfocus")&&(L.contains(document.activeElement)||P.contains(document.activeElement))||(d.events.fire(e?si.mousedOut:si.mouseTimeout),v=!0,Te.spatialPlayback&&d.config.video.spatial||(A.classList.add("hidden"),A.setAttribute("hidden","")),h=!0,D())))}function B(){S&&k||(d.events.fire(si.mousedOver),A.classList.remove("hidden"),A.removeAttribute("hidden")),I()}function q(){S||k?f.removeAttribute("tabindex"):S||k||r||f.setAttribute("tabindex","0")}function N(){d.events.on([si.playProgress,si.seeked],function e(t){x<=t&&null===i&&(d.events.fire(si.targetTimeReached),d.events.off([si.playProgress,si.seeked],e))})}function j(){O.classList.remove("threesixty-video"),d.element.classList.remove("grabbable"),d.element.classList.remove("grabbing"),m&&m.hide()}function U(){var e=function(e){return function(){g&&e.apply(void 0,arguments)}};d.events.on(oi.revealSpatialControls,e(function(){d.element.classList.add("grabbable"),m&&m.updatePosition(d.element),!m||m.visible||g.isStereo()||m.reveal()})),d.events.on(si.ended,e(function(){j()})),d.events.on(si.cameraUpdate,e(function(e){m&&m.setAngle(e.lat,e.lon)})),d.events.on(si.playInitiated,e(function(){d.config.video.spatial&&function(){function n(e){b&&(b.innerHTML=Oc.render("threesixty_reminder",e))}var e=d.telecine.getEffectByName("ThreeSixtyEffect");d.config.embed.settings.spatial_compass?(m||(m=new Wc(d.element.querySelector(".vp-controls-wrapper"),function(){e.snapToCenter()})),m.updatePosition(d.element),m.reveal()):m&&m.hide();d.events.once(si.firstTimeUpdate,function(){var e=d.config.embed.cards,t=e&&e.length&&e[0].timecode<15;t||(y.push(setTimeout(function(){n({showArrows:!1,text:Te.android?"Look around":"Click and drag to look around"}),z(b),H(b),setTimeout(function(){return W(b)},3e3)},7e3)),Te.android||y.push(setTimeout(function(){n({showArrows:!1,text:Te.android?"Look around":"Use arrow keys to see more"}),z(b),H(b),setTimeout(function(){return W(b)},3e3)},14e3)))}),function(){var e=f;if(b)return;var t=b=document.createElement("div");t.classList.add("cloaked"),t.classList.add("player-alert-round"),t.classList.add("player-alert-round--top"),t.classList.add("player-alert-round--threesixty"),e.appendChild(t)}()}()})),d.events.on(si.stereoscopicButtonPressed,e(function(){V()}));var t=null,n=e(function(e){_||(_=!0,e.preventDefault(),d.element.classList.add("grabbing"),w={x:e.clientX,y:e.clientY},g.makeContact(w))}),i=e(function(e){_&&(V(),g.move({x:e.clientX,y:e.clientY}))}),r=e(function(e){_&&(d.element.classList.remove("grabbing"),g.releaseContact(!1),_=!1)}),o=e(function(e){e.preventDefault(),g.isUserInteracting||(g.isUserInteracting=!0),null!==t&&clearTimeout(t),V(),t=setTimeout(function(){d.element.classList.remove("player-cursor-hide"),d.element.classList.add("grabbable"),g.isUserInteracting=!1},500),d.element.classList.add("player-cursor-hide"),d.element.classList.remove("grabbable"),g.moveWheel({x:e.deltaX,y:e.deltaY})}),a=e(function(e){_||(_=!0,g.makeContact({x:e.touches[0].clientX,y:e.touches[0].clientY}))}),s=e(function(e){_&&(e.preventDefault(),V(),g.move({x:e.touches[0].clientX,y:e.touches[0].clientY}))}),l=e(function(e){g.releaseContact(!0),_=!1}),u=e(function(e){_||V(),g.moveDevice(e.alpha,e.beta,e.gamma,e.orientation)}),c=e(function(e){_=!1,d.element.classList.remove("grabbing"),g.abandonMotion()});d.events.once(si.playInitiated,function(){d.store.watch("ui.player.layout",function(){m&&m.updatePosition(d.element),g&&g.adjustRenderSize(),_=!1}),Te.android&&window.addEventListener("deviceorientation",u,!1),Te.pointerEvents?(Il(A).on("pointerdown",n),window.addEventListener("pointermove",i),window.addEventListener("pointerup",r),window.addEventListener("pointerleave",c)):(Il(A).on("touchstart",a).on("mousedown",n).on("wheel",o),window.addEventListener("touchmove",s),window.addEventListener("mousemove",i),window.addEventListener("mouseup",r),window.addEventListener("touchend",l),window.addEventListener("mouseleave",c))})}function V(){y.forEach(function(e){return clearTimeout(e)}),y=[]}function H(e){e&&(e.classList.remove("cloaked"),window.requestAnimationFrame(function(){e.classList.add("in")}))}function W(n){n&&(n.classList.add("leaving"),window.requestAnimationFrame(function(){Il(n).on("transitionend",function e(t){"opacity"===t.propertyName&&(n.classList.remove("in"),n.classList.remove("leaving"),n.classList.add("cloaked"),Il(n).off("transitionend",e))})}))}function z(e){60<Dn(L).width?e.classList.add("player-alert-bumpdown"):e.classList.remove("player-alert-bumpdown")}return function(){var s=!0;function t(){B()}function n(e){if(c=l,v)v=!1;else if(p&&(f.classList.remove("player-cursor-hide"),p=!1),0!==e.screenX&&e.screenX!==screen.width-1&&0!==e.screenY&&e.screenY!==screen.height-1){if(s=!0,Te.spatialPlayback&&d.config.video&&d.config.video.spatial){var t=Dn(d.element),n=e.clientX-t.left,i=e.clientY-t.top,r=4*Gc,o=i>d.element.clientHeight-zc,a=n>d.element.clientWidth-Gc&&i<r;if(_||!o&&!a)return}h&&B(),I()}else M(),D(),s&&(F(!0),s=!1)}function i(){F(!0)}function r(e){var t=P.contains(e.target)||L.contains(e.target),n=m&&m.getWrapper().contains(e.target);S&&k||n?t||!S&&!k||F(!0):B()}Te.pointerEvents?Il(f).on("pointerenter",function(e){if("mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)return c=l,t();c=u,r(e)}).on("pointermove",function(e){if("mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)return n(e)}).on("pointerleave",function(e){if("mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)return i()}):Il(f).on("touchmove",function(){c=u,I()}).on("touchend",r).on("mouseenter",t).on("mousemove",n).on("mouseleave",i)}(),d.events.on(si.played,function(e){R||0===e||B()}).on(si.paused,B).on([si.bufferEnded,si.scrubbingEnded,si.volumeChanged,si.menuPanelOpened],I).on(si.playInitiated,function(){T=!0}),d.events.on(si.menuVisibilityChanged,function(e){e&&I()}),d.events.on(si.overlayOpened,q).on(si.controlBarVisibilityChanged,function(e){k=e,q()}).on(si.sidedockVisibilityChanged,function(e){S=e,q()}),d.events.on(si.outroDisplayed,function(){E=!0,B()}).on(si.outroHidden,function(){E=!1}),a=n=!1,s=0,d.events.on(si.menuVisibilityChanged,function(e){a=e}),Il(f).on(Te.pointerEvents?"pointerup":"click",function(t){if(!a&&2!==t.button&&t.target.classList&&((e=t.target).classList.contains("vp-title")||e.classList.contains("vp-target")||C.contains(e.parentNode)&&"HEADER"===e.parentNode.tagName||O.contains(e))&&!L.contains(e)){var e,n=("pointerup"===t.type||"MSPointerUp"===t.type)&&"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE,i=T&&Te.spatialPlayback&&d.config.video.spatial&&g;if(Te.touch||n){var r=-1!==d.telecine.supportedPresentationModes.indexOf("inline")&&!Te.mobileAndroid;if(!i){if(T&&r)return;return void d.events.fire(si.playButtonPressed)}}1==++s&&setTimeout(function(){if(i){var e=w&&w.x===t.clientX&&w.y===t.clientY;return 1===s&&e&&!Te.mobileAndroid&&d.events.fire(d.telecine.paused?si.playButtonPressed:si.pauseButtonPressed),1!==s&&d.telecine.getEffectByName("ThreeSixtyEffect").snapToCenter(),void(s=0)}if(1===s){if(o.get(ol)&&!o.get(ll))return;d.events.fire(d.telecine.paused?si.playButtonPressed:si.pauseButtonPressed)}else d.events.fire(si.fullscreenButtonPressed);s=0},200)}}),Il(f).on("mousedown",".vp-video-wrapper",function(e){var t;if(!n)return A.classList.remove("hidden"),A.removeAttribute("hidden"),2!==e.button&&document.createEvent&&((t=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),A.dispatchEvent(t)),!1}).on("contextmenu",".vp-video",function(e){return A.classList.remove("hidden"),A.removeAttribute("hidden"),!1}),d.events.on(oi.toggleNativeControls,function(e){if(e)return n=!0,void A.classList.add("hidden");n=!1,A.classList.remove("hidden")}),Te.touch||(Il(f).on("focus","a, button, input, [tabindex]",function(){t=this,clearTimeout(e),e=null,document.activeElement===this&&B()}),Il(f).on("blur","a, button, input, [tabindex]",function(){document.activeElement===this&&(e=setTimeout(F,50))}),f.addEventListener("focus",function(e){B(),t&&t.focus()},!1),d.events.on(si.overlayOpened,function(){r=!0,f.removeAttribute("tabindex")}),d.events.on(si.overlayClosed,function(){r=!1})),d.events.on(si.didEnterFullscreen,function(e){D(),E&&B()}).on(si.didExitFullscreen,function(e){h=!0,e?F():(B(),M())}),N(),d.events.on(oi.reset,function(){k=v=h=!0,T=S=!1,N(),M()}),d.events.on(oi.attachSpatialPlaybackEvents,U),d.events.on(oi.toggleSpatialPlayback,function(e){j(),g=e,V()}),{}}var Yc,Xc="markers",$c="dropped_frames",Qc="total_frames",Jc="bandwidth",Zc="streams",ed="files",td="video_dims",nd="min_bandwidth",id="max_badwidth",rd="buffer_occupancy",od="scanner",ad=["clip_id","profile_id","player_size",$c,Qc,Jc,Xc,Zc,ed,td,nd,id,rd,od],sd="upswitch",ld="downswitch",ud="scannerchange",cd="filechange",dd="bufferstart",fd="stalled",hd=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};Yn(this,n),this.player=e,this.seriesStore={},this.telecineHandlers={},this.onDataChange=t}return Xn(n,[{key:"init",value:function(){this._clearAllFields(),this._attachTelecineEventHandlers(),this._watchPlayerSize(),this._setDefaults()}},{key:"reset",value:function(){this._clearAllFields(),this._setDefaults(),this.onDataChange()}},{key:"setToSeries",value:function(e,t){return this.seriesStore[e]=[t],this.onDataChange(),this.seriesStore[e]}},{key:"addToSeries",value:function(e,t){this.seriesStore[e].push(t);return 500<this.seriesStore[e].length&&this.seriesStore[e].splice(0,25),this.onDataChange(),this.seriesStore[e]}},{key:"getCurrent",value:function(e){return this.seriesStore[e].slice(-1)[0]}},{key:"getFirst",value:function(e){return this.seriesStore[e][0]}},{key:"getSeries",value:function(e){return this.seriesStore[e]}},{key:"addMarker",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};n.videoTime=this.player.telecine.currentTime,n.time=Date.now(),this.addToSeries(Xc,{type:e,title:t,data:n})}},{key:"_attachTelecineEventHandlers",value:function(){var n=this;new M(function(e,t){n.player.telecine&&e(),n.player.events.on(si.telecineReady,function(){e()})}).then(function(){n.player.telecine.on(Ra.BANDWIDTH,n._onBandwidthChange.bind(n)),n.player.telecine.on(Ra.BUFFER_OCCUPANCY,n._onBufferOccupancyChange.bind(n)),n.player.telecine.on(Ra.CURRENT_FILE_CHANGE,n._onFileChange.bind(n)),n.player.telecine.on(Ra.DROPPED_FRAMES,n._onDroppedFrames.bind(n)),n.player.telecine.on(Pa.ENDED,n._onEnded.bind(n)),n.player.telecine.on(Ra.SCANNER_CHANGE,n._onScannerChange.bind(n)),n.player.telecine.on(Pa.SEEKED,n._onSeeked.bind(n)),n.player.telecine.on(Pa.STALLED,n._onStalled.bind(n)),n.player.telecine.on(Ra.STREAM_BUFFER_START,n._onStreamBufferStart.bind(n)),n.player.telecine.on(Ra.STREAM_CHANGE,n._onStreamChange.bind(n))}).catch(function(){})}},{key:"_watchPlayerSize",value:function(){var r=this;this.player.store.watch("ui.player.layout",function(e){var t=r.getCurrent(td),n=r._getVideoDimensionsString(e);r.addToSeries(td,n);var i=t?"Resized from "+t+" to "+n:"Resized to "+n;r.addMarker("resize",i)})}},{key:"_getVideoDimensionsString",value:function(e){var t=Math.round(e.width)+"px",n=Math.round(e.height)+"px",i=window.devicePixelRatio&&1<window.devicePixelRatio?"@"+window.devicePixelRatio+"x":"";return t&&n?parseInt(t,10)+"×"+parseInt(n,10)+" "+i:""}},{key:"_clearAllFields",value:function(){this.seriesStore=ad.reduce(function(e,t){return e[t]=[],e},{})}},{key:"_setDefaults",value:function(){var e=this.player.telecine.currentFile;this.addToSeries(ed,e);var t=this.player.telecine.currentScanner;this.addToSeries(od,t),this.setToSeries(nd,0),this.setToSeries(id,0);var n=this.player.store.get("ui.player.layout"),i=this._getVideoDimensionsString(n);this.addToSeries(td,i)}},{key:"_onBandwidthChange",value:function(e){var t=Math.round(100*e.speed)/100;this.addToSeries(Jc,{videoTime:this.player.telecine.currentTime,time:Date.now(),value:t});var n=this.getCurrent(id),i=this.getCurrent(nd);(!i||t<i)&&this.setToSeries(nd,t),(!n||n<t)&&this.setToSeries(id,t)}},{key:"_onDroppedFrames",value:function(e){var t=e.dropped,n=e.total;this.setToSeries(Qc,n),this.setToSeries($c,t)}},{key:"_onSeeked",value:function(){this.addMarker("seeked","Seeked to "+this.player.telecine.currentTime)}},{key:"_onEnded",value:function(){this.addMarker("ended","Ended")}},{key:"_onStreamChange",value:function(e){var t=e.index,n=e.streams[t],i=this.player.config.request.files.dash.streams.find(function(e){return e.id===parseInt(n.id,10)}),r={profile:void 0!==i?i.profile:null,quality:void 0!==i?i.quality:n.height+"p",bitrate:n.bitrate,framerate:n.framerate,height:n.height,width:n.width},o=this.getCurrent(Zc),a=o?o.bitrate:null;if(a!==r.bitrate&&null!==a){var s=this._getResolutionString(o),l=this._getResolutionString(r);r.bitrate<a?this.addMarker(ld,"Downswitch from "+s+" to "+l):a<r.bitrate&&this.addMarker(sd,"Upswitch from "+s+" to "+l)}this.addToSeries(Zc,r)}},{key:"_onFileChange",value:function(){var e=this.getCurrent(ed),t=this.player.telecine.currentFile;this.addToSeries(ed,t);var n=t.metadata.cdn,i=e?e.metadata.cdn:null,r=e?ci[e.mime]:null,o=ci[t.mime],a="CDN to "+n+"/"+o;i&&(a="CDN from "+i+"/"+r+" to "+n+"/"+o),this.addMarker(cd,a)}},{key:"_onBufferOccupancyChange",value:function(e){var t=Math.round(1e3*e)/1e3;this.addToSeries(rd,{videoTime:this.player.telecine.currentTime,time:Date.now?Date.now():(new Date).getTime(),value:t})}},{key:"_onScannerChange",value:function(){var e=this.getCurrent(od),t=this.player.telecine.currentScanner;this.setToSeries(od,t),e&&this.addMarker(ud,"Scanner change to "+t)}},{key:"_onStreamBufferStart",value:function(){this.addMarker(dd,"Buffering")}},{key:"_onStalled",value:function(){this.addMarker(fd,"Stalled")}},{key:"_getResolutionString",value:function(e){return e.width+"×"+e.height+"@"+Math.round(e.framerate)+" "+Math.round(e.bitrate/1e3).toLocaleString()+" Kbps"}}]),n}(),vd=($n(Yc={},"seeked","#0088cc"),$n(Yc,"ended","#503873"),$n(Yc,sd,"#5a9e02"),$n(Yc,ld,"#d93636"),$n(Yc,"resize","#FF8A00"),$n(Yc,ud,"#e9ff00"),$n(Yc,cd,"#b5d3e2"),$n(Yc,dd,"#e812e0"),$n(Yc,fd,"#f44283"),Yc),pd=function(){function i(e,t){var n=this;Yn(this,i),this.element=e,this.player=t,this.initTime=new Date,this.templateExtra={openLinkText:"Open Link",openLinkDisabled:!1,openLinkHref:null};this.debugcollect=new hd(t,function(){n.updateDebugValues()}),this.debugcollect.init(),this.attachEvents(),this.openLinkNum=0,this.active=!1,this.hiddenInTinyMode=!1,this.copied=!1,this.sessionId=null}return Xn(i,[{key:"render",value:function(){if(this.active){var e=this._getTemplateData();this.element.innerHTML=Oc.render("debug_panel",e)}}},{key:"updateDebugValues",value:function(){if(this.active){var e=this._getTemplateData();this.element.querySelector(".vp-stats-debug-values").innerHTML=Oc.render("debug_values",e)}}},{key:"resetData",value:function(){this.debugcollect.reset(),this.render()}},{key:"attachEvents",value:function(){var e=this;this.player.events.on(si.debugButtonPressed,function(){e.element.classList.contains("hidden")?e.showPanel():e.hidePanel()}),Bc(this.element,".js-copySessionButton",this._copySessionId.bind(this)),this.player.events.on(si.configChanged,function(){e.resetData()}),Bc(this.element,".stats-debug-close",function(){e.hidePanel()}),this.player.store.watch("ui.player.mode",this.toggleVisibility.bind(this))}},{key:"hidePanel",value:function(){this.element.classList.add("hidden"),this.element.setAttribute("hidden",""),this.element.setAttribute("aria-hidden","true"),this.player.events.fire(si.hudHidden),this.active=!1}},{key:"showPanel",value:function(){this.element.classList.remove("hidden"),this.element.removeAttribute("hidden"),this.element.setAttribute("aria-hidden","false"),this.player.events.fire(si.hudDisplayed),this.active=!0,this.render()}},{key:"toggleVisibility",value:function(e){if("tiny"===e&&this.active)return this.hiddenInTinyMode=!0,void this.hidePanel();this.hiddenInTinyMode&&(this.showPanel(),this.hiddenInTinyMode=!1)}},{key:"_getTemplateData",value:function(){var e=this.debugcollect.getCurrent(ed);if(!e)return{};var t=e.metadata,n=this.debugcollect.getCurrent(od),i="MediaSourceScanner"===n,r="LiveScanner"===n,o=this.debugcollect.getCurrent(Zc),a=this.debugcollect.getCurrent(Jc),s=new Date(1e3*this.player.config.request.timestamp),l=new Date(new Date-this.initTime+1e3*this.player.config.request.timestamp),u=this.debugcollect.getCurrent(td),c=o?o.profile+", "+Pl(o):null,d=ci[e.mime]+", cdn: "+t.cdn,f=o?o.width+"×"+o.height+"@"+Math.round(o.framerate)+" "+Math.round(o.bitrate/1e3).toLocaleString()+" Kbps":null,h=!(!this.player.config.request.files||!this.player.config.request.files.dash)&&this.player.config.request.files.dash.separate_av,v=this._getTestGroups(),p=this.debugcollect.getCurrent(Qc)||0,m=this.debugcollect.getCurrent($c)||0,g=0!==p?(m/p*100).toFixed(2)+"%":0,y=(this.player.telecine.duration-this.player.telecine.currentTime).toFixed(2)+" seconds",_=a?Math.floor(a.value/1e3).toLocaleString()+" Kbps":0,b=Math.floor(this.debugcollect.getCurrent(nd)/1e3).toLocaleString()+" Kbps",w=Math.floor(this.debugcollect.getCurrent(id)/1e3).toLocaleString()+" Kbps",k=i||r?this._getBandwidthSeries():null,S=i||r?this._getGraphSVG(k):null,E=i&&this.player.config.request.ab_tests&&this.player.config.request.ab_tests.bba&&this.player.config.request.ab_tests.bba.group,T=this.debugcollect.getCurrent(rd),x=T?Math.floor(100*T.value).toLocaleString()+"%":0,A=E?this._getBufferOccupancySeries():null,L=E?this._getGraphSVG(A):null;return{sessionId:this.sessionId,clipId:this.player.config.video.id,isCopyDisabled:!!this.player.doNotTrackEnabled||this.player.config.embed.settings.background,hideCloseButton:!!this.player.config.embed.settings.background,delivery:d,resolution:f,embedSize:u,isDash:i,isLive:r,profileId:c,separateAudioVideo:h,testGroup:v,totalFrames:p,droppedFrames:m,droppedFramesPercent:g,liveLatency:y,bandwidthKbps:_,bandwidthMinKbps:b,bandwidthMaxKbps:w,startTime:s,debugTime:l,displayBufferOccupancy:E,bufferOccupancyPercent:x,bandwidthSeriesSvg:S,bufferOccupancySvg:L,openLinkText:this.templateExtra.openLinkText,openLinkDisabled:this.templateExtra.openLinkDisabled,openLinkHref:this.templateExtra.openLinkHref}}},{key:"_getTestGroups",value:function(){var t=this;return Object.keys(this.player.config.request.ab_tests).map(function(e){return e+": "+t.player.config.request.ab_tests[e].group}).join(", ")}},{key:"_getBandwidthSeries",value:function(){return{timeSeries:this.debugcollect.getSeries(Jc),max:this.debugcollect.getCurrent(id)}}},{key:"_getBufferOccupancySeries",value:function(){return{timeSeries:this.debugcollect.getSeries(rd)}}},{key:"_getGraphSVG",value:function(e){for(var t,n,i,r=e.timeSeries,o=e.max||1,a=r.length,s=a<100?0:a-100,l=r[s],u=r[a-1],c=l?l.time:0,d=u?u.time:0,f=[],h=s;h<a;h++){var v=r[h],p=(v.time-c)/(d-c)*250,m=14-14*v.value/o;isNaN(m)&&(m=0),isNaN(p)&&(p=0),f.push(p+","+(t=m,n=0,i=14,Math.min(Math.max(t,n),i)))}var g={height:14,width:250,points:f.join(" "),markers:this._getMarkerSvgPart(c,d)};return Oc.render("time_series_graph",g)}},{key:"_getMarkerSvgPart",value:function(i,r){var e=this.debugcollect.getSeries(Xc)||[];return 0===e.length?null:e.map(function(e){var t=e.data.time;if(t<i||r<t)return"";var n=(t-i)/(r-i)*250;return isNaN(n)&&(n=0),"<g>\n                <title>"+e.title+'</title>\n                <line class="stats-debug-marker" x1="'+n+'" y1="0" x2="'+n+'" y2="14" stroke-width="1" stroke="'+vd[e.type]+'" />\n            </g>'}).join("")}},{key:"_copySessionId",value:function(){var e=this;if(!this.isCopied){var t=this.element.querySelector(".vp-copy-label"),n=document.createElement("textarea");if(n.value=this.player.config.request.session,this.element.appendChild(n),n.select(),document.execCommand("copy")){t.innerHTML="Copied",this.element.removeChild(n),this.isCopied=!0;var i=setTimeout(function(){t.innerHTML="Copy Debug Key",clearTimeout(i),e.isCopied=!1},2e3)}else this.element.querySelector(".js-copySessionButton").style.display="none",this.element.removeChild(n),this.sessionId=this.player.config.request.session,this.updateDebugValues()}}}]),i}(),md=function(){function t(e){Yn(this,t),this.alertTextElement=e.querySelector(".vp-text-alert-wrapper"),this.alertContentElement=this.alertTextElement.querySelector(".vp-alert-text")}return Xn(t,[{key:"show",value:function(e){this.alertContentElement.innerHTML=e,this.alertContentElement.classList.remove("hidden"),this.alertTextElement.classList.remove("hidden")}},{key:"hide",value:function(){this.alertContentElement.classList.add("hidden"),this.alertTextElement.classList.add("hidden")}}]),t}(),gd=function(){function t(e){Yn(this,t),this.alertTextElement=e.querySelector(".vp-text-alert-wrapper"),this.alertContentTitle=this.alertTextElement.querySelector(".vp-live-start-time-title"),this.alertContentTime=this.alertTextElement.querySelector(".vp-live-start-time-body"),this.alertContentFooter=this.alertTextElement.querySelector(".vp-live-start-time-footer")}return Xn(t,[{key:"show",value:function(e,t,n){this.alertContentTitle.innerHTML=e,this.alertContentTime.innerHTML=t,this.alertContentFooter.innerHTML=n,this.alertContentTitle.classList.remove("hidden"),this.alertContentTime.classList.remove("hidden"),this.alertContentFooter.classList.remove("hidden"),this.alertTextElement.classList.remove("hidden")}},{key:"hide",value:function(){this.alertContentTitle.classList.add("hidden"),this.alertContentTime.classList.add("hidden"),this.alertContentFooter.classList.add("hidden"),this.alertTextElement.classList.add("hidden")}}]),t}(),yd=function(){function i(e,t,n){Yn(this,i),this.textAlert=new md(e),this.timeAlert=new gd(e),this.player=t,this.store=n,this.startTime=new Date(this.store.get(ml,null)),this._setUpLiveEvents(),this._checkStatus()}return Xn(i,[{key:"hide",value:function(){this.textAlert.hide(),this.timeAlert.hide()}},{key:"_checkStatus",value:function(){(this.store.get(al)||this.store.get(sl))&&this._onLiveEventActive(),this.store.get(ul)&&this._onLiveStreamEnded()}},{key:"_setUpLiveEvents",value:function(){this.player.events.on(si.liveEventActive,this._onLiveEventActive.bind(this)),this.player.events.on(si.liveStreamOnline,this._onLiveStreamOnline.bind(this)),this.player.events.on(si.liveStreamOffline,this._onLiveStreamOffline.bind(this)),this.player.events.once(si.liveEventEnded,this._onLiveStreamEnded.bind(this))}},{key:"_onLiveEventActive",value:function(){6e4<this._timeToEventStart()?(this.textAlert.hide(),this._displayTimeAlert()):(this.timeAlert.hide(),this.textAlert.show("This event hasn't started yet"))}},{key:"_displayTimeAlert",value:function(){var e=this._timeToDisplayText();this.timeAlert.show(e[0],e[1],e[2]),(this.store.get(al)||this.store.get(sl))&&setTimeout(this._checkStatus.bind(this),3e4)}},{key:"_timeToEventStart",value:function(){return this.startTime-new Date}},{key:"_timeToDisplayText",value:function(){var e=this._timeToEventStart(),t=(e/6e4).toFixed(0),n=(e/36e5).toFixed(0),i=(e/864e5).toFixed(0),r=(new Date).toDateString()===this.startTime.toDateString();return 1<i||!r?["This event is scheduled for",["January","February","March","April","May","June","July","August","September","October","November","December"][this.startTime.getMonth()]+" "+this.startTime.getDate(),"at "+xu(this.startTime)]:1<n&&r?["This event is scheduled for","Today","at "+xu(this.startTime)]:["This event will start in",t+" "+(1<t?"minutes":"minute"),""]}},{key:"_onLiveStreamOnline",value:function(){this.hide()}},{key:"_onLiveStreamOffline",value:function(){this.textAlert.show("Live stream offline"),Te.iOS&&Fc.element&&(this.player.events.fire(si.willExitFullscreen),Fc.exit())}},{key:"_onLiveStreamEnded",value:function(){this.textAlert.show("Live event ended")}}]),i}();function _d(e,s){var l,u=s.querySelector(".notification");function t(e,t){if(null!==s.parentElement.offsetParent){s.classList.remove("hidden"),s.removeAttribute("hidden"),s.setAttribute("data-name",e);var n,i,r,o=(i="watchlater"===(n=e)||"unwatchlater"===n?.5:.4,r=s.clientHeight,s.clientHeight>s.clientWidth&&(r=s.clientWidth),{height:Math.round(r*i),width:Math.round(r*i*1.6)}),a="width:"+o.width+"px;height:"+o.height+"px";u.style.cssText=a,u.innerHTML=t,"watchlater"!==e&&"unwatchlater"!==e||function(e,t){var n=e.querySelector(".hour-hand"),i=e.querySelector(".minute-hand");if(n&&i){var r=t?1:-1,o=new Date,a=Math.abs(o.getHours()-12),s=o.getMinutes(),l=s/60*360-135,u=a/12*360+s/60*5,c=u+45*r,d=l+540*r;n.style[Te.transformProperty]="rotate("+u+"deg)",i.style[Te.transformProperty]="rotate("+l+"deg)",window.requestAnimationFrame(function(){e.classList.add("animate"),Te.browser.firefox||Te.browser.opera||window.requestAnimationFrame(function(){n.style[Te.transformProperty]="rotate("+c+"deg)",i.style[Te.transformProperty]="rotate("+d+"deg)"})})}}(u,"watchlater"===e),clearTimeout(l),s.classList.remove("animate"),window.requestAnimationFrame(function(){s.classList.remove("invisible"),l=setTimeout(c,750)})}}function c(){s.classList.add("animate"),s.classList.add("invisible")}function n(){s.classList.remove("animate"),s.classList.remove("invisible"),s.classList.add("hidden"),s.setAttribute("hidden",""),s.removeAttribute("data-name"),u.innerHTML="",u.classList.remove("filled"),u.classList.remove("animate"),e.events.fire(si.notificationHidden)}return Il(s).on("transitionend",function(e){u.contains(e.target)&&"height"===e.propertyName?setTimeout(c,100):e.target===s&&"opacity"===e.propertyName&&window.requestAnimationFrame(n)}),e.events.on(si.liked,function(e){e||t("like",Oc.render("icon_heart"))}),e.events.on(si.unliked,function(e){e||t("unlike",Oc.render("icon_broken_heart"))}),e.events.on(si.addedToWatchLater,function(e){e||t("watchlater",Oc.render("icon_clock"))}),e.events.on(si.removedFromWatchLater,function(e){e||t("unwatchlater",Oc.render("icon_clock"))}),e.events.fire(si.notificationModuleReady),{}}var bd=kn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),wd=/[&<>"']/g,kd=RegExp(wd.source);var Sd=function(e){return(e=Je(e))&&kd.test(e)?e.replace(wd,bd):e};function Ed(o,a){var n=_n(),s=!1;function t(e){Nn(e,"facebook",{width:580,height:400})}function i(e){Nn(e,"twitter",{width:550,height:420})}function r(e){Nn(e,"tumblr",{width:540,height:600})}var e={get events(){return n},setup:function(){a.classList.remove("vp-share-embed-active","vp-share-embed-only"),o.config.embed.settings.share&&o.config.embed.settings.share.embed_only&&a.classList.add("vp-share-embed-only");var e=a.querySelector(".js-embedCopy");e&&(e.style.width=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2;t=Object.keys(t).map(function(e){return t[e]});var i=e.cloneNode();i.style.visibility="hidden",i.style.padding=0,e.parentElement.appendChild(i);var r=t.map(function(e){return i.innerText=e,i.clientWidth}),o=Math.max.apply(Math,r),a=window.getComputedStyle(e),s=parseFloat(a.fontSize);return e.parentElement.removeChild(i),(o+n)/s+"em"}(e,["Copy","Copied!"])),o.events.on(si.facebookButtonPressed,t).on(si.twitterButtonPressed,i).on(si.tumblrButtonPressed,r)},destroy:function(){o.events.off(si.facebookButtonPressed,t).off(si.twitterButtonPressed,i).off(si.tumblrButtonPressed,r)},getShareData:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=o.config.video.title,n=o.config.video.owner.name,i=o.config.video.share_url;return s=document.queryCommandSupported&&document.queryCommandSupported("copy"),e.template=Oc.render("share",{url:o.config.video.url,shareUrl:i,playerShareUrl:"https://"+o.config.player_url+"/video/"+o.config.video.id+"/share",title:t,owner:n,embed:"public"===o.config.video.embed_permission&&o.config.embed.settings.embed,embedOnly:o.config.embed.settings.share&&o.config.embed.settings.share.embed_only,embedCode:Sd(o.config.video.embed_code),copyButton:s||Te.flash.installed,customizeEmbed:!!o.config.video.url,readOnly:!Te.touch,strings:{share:"Share",facebook:"Share on Facebook",twitter:"Share on Twitter",tumblr:"Share on Tumblr",email:"Share via Email",emailSubject:"Check out “"+t+"” from "+n+" on Vimeo",emailBody:"Check out “"+t+"” from "+n+" on Vimeo.\n\nThe video is available for your viewing pleasure at "+i+"\n\nIf you like this video, make sure you share it, too!\n\nVimeo is filled with lots of amazing videos. See more at https://vimeo.com.",embedCode:"Get embed code",embedTitle:"Embed",embedSubtitle:"Add this video to your site with the embed code below.",copy:"Copy",copySuccess:"Copied!",customize:'<a href="'+o.config.video.url+'#embed" target="_blank" rel="noopener">Customize this embed</a> on Vimeo'}}),o.config.embed.settings.share&&o.config.embed.settings.share.embed_only&&(e.wrapperClass="embed-only"),e},showShareView:function(){a.querySelector(".js-share-screen").classList.remove("cloaked"),a.classList.remove("vp-share-embed-active"),n.fire(si.shareViewShown)},showEmbedView:function(){o.config.embed.settings.share.embed_only||(a.querySelector(".js-embed-screen").classList.remove("cloaked"),a.classList.add("vp-share-embed-active")),n.fire(si.embedViewShown)}};return function(){var t;function r(){o.events.fire(si.embedCodeCopied);var e=a.querySelector(".js-embedCopy");e.innerHTML=e.getAttribute("data-success-label"),clearTimeout(t),t=setTimeout(function(){e.innerHTML=e.getAttribute("data-label")},2e3)}Il(a).on("transitionend",".js-share-screen",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(n.fire(si.embedViewEnd),this.classList.add("cloaked"))}).on("transitionend",".js-embed-screen",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(n.fire(si.shareViewEnd),this.classList.add("cloaked"),Un(a))}).on("copy","input[name=embed_code]",function(){o.events.fire(si.embedCodeCopied)}),Bc(a,".js-facebook",function(){return o.events.fire(si.facebookButtonPressed,this.href),In(),!1}),Bc(a,".js-twitter",function(){return o.events.fire(si.twitterButtonPressed,this.href),In(),!1}),Bc(a,".js-tumblr",function(){return o.events.fire(si.tumblrButtonPressed,this.href),In(),!1}),Bc(a,".js-email",function(){return o.events.fire(si.emailButtonPressed),window.top.location=this.href,In(),!1}),Bc(a,".js-embed",function(){return o.events.fire(si.embedButtonPressed),e.showEmbedView(),In(),!1}),Bc(a,".js-embedCopy",function(){if(s){a.querySelector("input[name=embed_code]").select();try{document.execCommand("copy")&&r()}catch(e){}return document.activeElement.blur(),!1}}),Te.touch?Il(a).on("focus","input[name=embed_code]",function(){var e=this;setTimeout(function(){e.setSelectionRange(0,9999),e.setAttribute("readonly","readonly")},0)}).on("blur","input",function(){this.removeAttribute("readonly")}):Il(a).on("click","input[name=embed_code]",function(){this.setSelectionRange(0,9999)}),n.on(si.embedViewShown,function(){function e(){var e=a.querySelector(".js-embedCopy");new ZeroClipboard(e,{moviePath:o.config.request.urls.zeroclip_swf,trustedDomains:["*"],allowScriptAccess:"always"}).on("complete",r)}if(!s&&Te.flash.installed){var t="zc_script_loaded";if(!document.getElementById(t)){var n,i=document.createElement("script");return i.setAttribute("id",t),i.setAttribute("src",o.config.request.urls.zeroclip_js),i.onreadystatechange=i.onload=function(){n||e(),n=!0},void document.getElementsByTagName("head")[0].appendChild(i)}e()}})}(),e}function Td(a,s){var e=_n(),n=void 0;function l(e){if("yes"===e.form.getAttribute("data-bubble")){e.form.setAttribute("data-bubble","no");var t=s.querySelector(".vp-validation-bubble");t.querySelector(".vp-validation-bubble-message").innerHTML=e.validationMessage||"There is an error with this input.";var n=Dn(e),i=Dn(e.form);t.style.left=n.left-i.left+"px",t.style.top=n.height+1+"px",t.classList.remove("hidden"),e.focus(),window.requestAnimationFrame(function(){t.classList.add("vp-validation-bubble-animate")}),r()}}function r(e){var t=s.querySelector(".vp-validation-bubble");if(t){if(e)return clearTimeout(n),void t.classList.remove("vp-validation-bubble-animate");clearTimeout(n),n=setTimeout(function(){t.classList.remove("vp-validation-bubble-animate")},5e3)}}function u(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).showBubble,t=void 0===e||e,n=s.querySelector("input[type=email]"),i=s.querySelector("input[type=text]");return n.setAttribute("aria-invalid","false"),n.setCustomValidity(""),n.checkValidity&&!n.checkValidity()?(n.setAttribute("aria-invalid","true"),n.validity.valueMissing&&n.setCustomValidity("Please enter your email."),n.validity.typeMismatch&&n.setCustomValidity("Please enter a valid email."),t&&l(n),!1):(i.setAttribute("aria-invalid","false"),i.setCustomValidity(""),i.checkValidity&&!i.checkValidity()?(i.setAttribute("aria-invalid","true"),i.validity.typeMismatch&&i.setCustomValidity("Please enter a valid name."),!1):(r(!0),!0))}var c=function(){e.fire(si.emailCaptureEnd)};function t(t){if(!u())return!1;var n=t.querySelector("input[type=email]"),i=t.querySelector("input[type=submit]"),r={signature:"signature",time:"timestamp",expires:"expires"};function o(e){i.classList.remove("loading"),n.setCustomValidity("Uh oh. There was a problem. Please try again."),n.setAttribute("aria-invalid","true"),l(n)}Object.keys(r).forEach(function(e){t.querySelector("input[name="+e+"]").value=a.config.request[r[e]]}),i.classList.add("loading"),function(e,t,n){Un(s);var i=Ut(e.querySelectorAll("input")).map(function(e){return e.name?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):encodeURIComponent(e.value)}).join("&"),r=new XMLHttpRequest;r.open(e.method,e.action+window.location.search,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.withCredentials=!0,r.timeout=3e3,r.onload=function(){var e;try{e=JSON.parse(r.responseText)}catch(e){}t(e,r)},r.onerror=function(e){n(e)},r.send(i)}(t,function(e,t){var n,i;!1!==e?(a.config.embed.email=null,a.events.fire(si.emailCaptureSuccess),n=s.querySelector(".vp-email-capture"),i=s.querySelector(".vp-email-capture-confirm"),n.classList.add("vp-email-capture-invisible"),i.classList.remove("vp-email-capture-confirm-hidden"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){i.classList.add("in"),setTimeout(c,2250)})})):o(t.status)},o)}var i={get events(){return e},getData:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=a.config.embed.email||{},i=t.custom_logo||n.custom_logo;if(i)var r=So({width:150,height:75,baseUrl:i,webpSupport:a.config.request.flags.webp});return e.template=Oc.render("email_capture",{allowSkip:t.allow_skip||n.allow_skip,customLogo:r,text:t.text||n.text||"",action:"https://"+a.config.player_url+"/video/"+a.config.video.id+"/submit-email",confirmation:t.confirmation||n.confirmation||"Thanks! Your email was successfully submitted.",referrer:a.config.request.referrer,strings:{email:"Email address",fullName:"Name (optional)",nothanks:"No thanks",submit:"Submit"}}),e.modal=!0,e.logo=!1,e.preventBackgroundClose=!0,e.noblur=t.noblur,e}};return Bc(s,".vp-email-capture-form-button--cancel",function(){c()}),Bc(s,".vp-email-capture-form-button--reset",function(){a.events.fire(si.playButtonPressed)}),Bc(s,".vp-email-capture-form-button--submit",function(){this.form.classList.add("vp-email-capture-form-submitted"),this.form.setAttribute("data-bubble","yes"),u()}),Il(s).on("submit",".vp-email-capture-form",function(){return a.events.fire(si.emailCaptureSubmitted),t(this),!1}).on(["focus","input"],".vp-email-capture-form-input[type=email]",function(){u({showBubble:!1})}),i}function xd(u,o,a){var s,l,c,e,d=a.querySelector(".vp-outro"),f=null,h=!1,v=!1,t=!1,i=!1,r=10,p=!1,n=Mc(E,250),m=250;function g(e,t){return-1!==t.indexOf(e)}function y(){return g(u.config.embed.outro,["vod"])?(f=_(c="vod"),!0===i&&k(),M.resolve(f)):(p=!0,jn("https://"+u.config.player_url+"/video/"+u.config.video.id+"/outro?on_site="+u.config.embed.on_site+"&type="+u.config.embed.outro+"&email="+(u.config.embed.email?1:0),{withCredentials:!0}).then(function(e){return JSON.parse(e)}).then(function(e){return c=e.type,(f=_(c,e.data))&&(f.bgimage&&Eo(f.bgimage),f.contexts&&f.contexts.forEach(function(e){e.videos.forEach(function(e){Eo(e.thumbnail)})})),f}))}function _(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=ko(u.element.clientWidth*Te.devicePixelRatio,u.element.clientHeight*Te.devicePixelRatio),i=t.width,r=t.height;if(n.img_base&&(n.bgimage=So({width:i,height:r,baseUrl:n.img_base,webpSupport:u.config.request.flags.webp})),g(e,["vod"])){var o=void 0!==u.config.video.vod.is_preorder?u.config.video.vod.is_preorder:!!u.config.video.vod.date_available,a=u.config.video.vod.is_coming_soon,s=u.config.video.vod.date_available_formatted_datetime||u.config.video.vod.date_available,l="Coming soon to Vimeo On Demand.";a&&s&&(l="Coming soon to Vimeo On Demand on "+s+"."),o&&(l="Pre-order now. Watch on "+s+"."),n={purchased:u.config.user.purchased,title:u.config.video.vod.feature_title,url:u.config.video.vod.url,currency:u.config.request.currency,countries:u.config.video.vod.countries,country:u.config.request.country,buttons:u.config.video.vod.purchase_options,translationMap:u.config.request.dynamic_translation_map,isPreorder:o,isComingSoon:a,releaseDate:s,strings:{watch:o?"Watch on "+s:"Watch Now",preRelease:l}}}return g(e,["videos","threevideos","promoted"])&&(u.config.user.following=n.following,(n={contexts:Array.isArray(n)?n:[n],owner:u.config.video.owner.id,bgimage:n.bgimage,following:n.following}).contexts&&n.contexts.forEach(function(t){t.videos.forEach(function(e){e.fullTitle=e.title,e.byline="",e.owner.id!==n.owner&&(e.fullTitle=e.title+" from "+e.owner.name,e.byline="from "+e.owner.name),e.thumbnail_base&&(e.thumbnail=So({width:Math.round(i/t.videos.length),height:Math.round(r/t.videos.length),baseUrl:e.thumbnail_base,webpSupport:u.config.request.flags.webp,crop:!0}))})})),g(e,["link"])&&(n.url=pr(n.url),n.url2=pr(n.url2)),g(e,["share"])&&(n.strings={back:"Back"}),n}function b(e){d.classList.toggle("outro--link-medium",e)}function w(e){d.classList.toggle("outro--link-large",e)}function k(){if(h=!0,g(c,["beginning"]))return d.innerHTML="",void u.events.fire(oi.reset);if(null!==f||p){if(g(c,["videos","threevideos","promoted"])){if(0===f.contexts.reduce(function(e,t){return e+t.videos.length},0))return;f.showFollowButton=!u.config.user.owner&&u.config.user.logged_in,f.strings={follow:"Follow",following:"Following",unfollow:"Unfollow"}}f&&(f.target=!u.config.embed.on_site);var e,t,n,i,r=c;g(c,["threevideos","promoted"])&&(r="videos"),d.innerHTML=Oc.render("outro_"+r,f),d.setAttribute("data-type",r),a.classList.remove("hidden"),a.removeAttribute("hidden"),v=!0,g(c,["videos","threevideos"])?function(){var e=document.querySelector(".js-outro-followWrap");if(e){var t=window.getComputedStyle(e),n=parseFloat(t.fontSize);e.style.width=e.clientWidth/n+"em"}}():g(c,["link"])?(o.watch("ui.outro.isLinkTitleVisible",b),o.watch("ui.outro.isLinkDescriptionVisible",w),b(o.get("ui.outro.isLinkTitleVisible")),w(o.get("ui.outro.isLinkDescriptionVisible"))):g(c,["share"])?(n=a.querySelector(".js-outro-content"),i=s.getShareData(),n.innerHTML=i.template,s.setup()):g(c,["email"])&&(e=a.querySelector(".js-outro-content"),t=l.getData({},f),e.innerHTML=t.template),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){a.classList.add("in"),E()})})}else y().then(function(){return k()}).catch(function(){})}function S(){if(v)return s.destroy(),v=t=h=!1,void window.requestAnimationFrame(function(){a.classList.remove("in"),u.events.fire(si.outroHidden),T()});h&&(h=!1,u.events.fire(si.outroHidden))}function E(){if(!t&&a.clientWidth){Il(window).off("resize",n),t=!0;var i=[];f&&f.contexts&&f.contexts.forEach(function(e){e.videos&&e.videos.forEach(function(e){var t=e.id,n=d.querySelector('[data-video-id="'+t+'"]');n&&0<n.clientWidth&&i.push(t)})}),u.events.fire(si.outroDisplayed,i)}}function T(){Il(window).off("resize",n),Il(window).on("resize",n)}return u.events.on(si.playProgress,function(e,t,n){i=!1,!p&&null===f&&t-r<=e&&y().catch(function(){})}),u.events.on(si.playInitiated,function(){g(u.config.embed.outro,["nothing","beginning"])&&(c=u.config.embed.outro,f=!1)}),u.events.on(si.ended,function(){e=setTimeout(function(){u.events.fire(oi.showOutro)},m)}),u.events.on(si.loadVideo,function(){clearTimeout(e)}),u.events.on(oi.showOutro,function(e,t){u.performDelegateAction(ai.showOutro,function(){e&&(c=e,f=null,p=!1),t&&t.data&&(f=_(e,t.data)),i=!0,k()})}),u.events.on(oi.hideOutro,function(){S()}),Il(a).on("click",".js-videoLink",function(e){u.events.fire(si.outroVideoPressed,parseInt(this.getAttribute("data-video-id"),10))}),Il(a).on("click",".js-cta",function(e){u.events.fire(si.outroCtaPressed,this.href)}),Il(a).on("click",".js-link",function(e){u.events.fire(si.outroLinkPressed,this.href)}),Il(a).on("click",".js-imageLink",function(e){u.events.fire(si.outroImagePressed,this.href)}),Il(a).on("transitionend",function(e){a.classList.contains("in")||(a.classList.add("hidden"),a.setAttribute("hidden",""))},!1),u.events.on([si.played,si.seeked,si.scrubbingStarted],S),u.events.on(si.outroDisplayed,function(){u.element.classList.add("player-outroVisible")}).on(si.outroHidden,function(){u.element.classList.remove("player-outroVisible")}),Bc(a,".js-outro-follow",function(){u.events.fire(si.followButtonPressed)}),Il(a).on("mouseleave",".js-outro-follow",function(e){var t=document.querySelector(".js-outro-follow");t&&t.classList.remove("outro-follow--activated")}),u.events.on(si.followed,function(){var e=document.querySelector(".js-outro-follow");e&&(e.setAttribute("aria-pressed",!0),e.classList.add("outro-follow--activated"))}),u.events.on(si.unfollowed,function(){var e=document.querySelector(".js-outro-follow");e&&e.setAttribute("aria-pressed",!1)}),u.events.on(oi.showOverlay,function(){setTimeout(function(){a.classList.add("hidden")},150)}),u.events.on(si.overlayClosed,function(){a.classList.contains("in")&&a.classList.remove("hidden")}),u.events.on(oi.reset,function(){f=null,p=!1}),Bc(a,".js-vod-button",function(){var e=this.getAttribute("data-product-id");return u.events.fire(si.vodButtonPressed,e),!1}),Bc(a,".js-vod-watch",function(){if(!("date_available"in u.config.video.vod))return S(),u.events.fire(si.vodButtonPressed),!1}),d&&((s=new Ed(u,d)).events.on(si.embedViewShown,function(){u.config.embed.settings.share.embed_only||(a.querySelector(".js-back").classList.remove("cloaked"),a.classList.add("embed-active"))}).on(si.shareViewShown,function(){a.classList.remove("embed-active")}),Bc(a,".js-back",function(){return s.showShareView(),!1}),s.events.on(si.shareViewEnd,function(){a.querySelector(".js-back").classList.add("cloaked")})),d&&(l=new Td(u,d)),T(),{}}function Ad(u,e,o){var n,i,r,a,s=o.querySelector(".vp-overlay-cell"),l=o.querySelector(".vp-overlay"),c=o.querySelector(".vp-overlay-icon-wrapper"),d=c.querySelector(".vp-overlay-icon"),f=o.querySelector(".vp-overlay-logo"),h=!1,v=null,p=null,m=new Ed(u,l),g=new Td(u,l),y=!1,t=!1;function _(){var e=Dn(o),t=Dn(l),n=Dn(f),i=t.bottom+(e.height-t.bottom)/2;return e.height-i-n.height/2+"px"}function b(){var e=Dn(o),t=Dn(l),n=Dn(c),i=e.height/2,r=t.bottom+(e.height-t.bottom)/2;return{top:i-n.height/2+"px",transform:"translateY("+(r-i)+"px)"}}function w(e,t){o.setAttribute("data-name",e),l.innerHTML=t.template,Te.iOS&&Fc.element&&(u.events.fire(si.willExitFullscreen),Fc.exit()),t.noblur||In(r=document.activeElement),t.modal&&(o.classList.add("modal"),o.setAttribute("data-modal","true")),t.preventBackgroundClose&&o.setAttribute("data-background-close","false"),t.wrapperClass&&o.classList.add(t.wrapperClass),t.icon.type&&(t.logo&&(f.classList.remove("hidden"),c.classList.add("cloaked"),window.requestAnimationFrame(function(){f.innerHTML=Oc.render("logo"),f.style.bottom=_()})),c.classList.remove("hidden"),d.innerHTML=t.icon.html,window.requestAnimationFrame(function(){var e=b();c.style.top=e.top,c.style[Te.transformProperty]=e.transform}),o.setAttribute("data-icon",t.icon.type),c.setAttribute("data-icon",t.icon.type),d.setAttribute("data-icon",t.icon.type),"private-unlocked"===e&&d.classList.add("open")),o.classList.add("invisible"),o.classList.remove("hidden"),o.removeAttribute("hidden"),o.classList.add("in"),p=t,v=e,h=!0,u.events.fire(si.overlayOpened,e),u.element.classList.add("player-overlayVisible"),-1<["share","hd-not-allowed"].indexOf(e)&&Un(o),window.requestAnimationFrame(function(){o.classList.remove("invisible"),window.requestAnimationFrame(function(){l.classList.add("in"),s.classList.add("in")})})}function k(){l.classList.remove("in"),l.classList.add("out")}function S(e){if("true"!==o.getAttribute("data-modal")&&h){o.removeAttribute("data-background-close"),s.classList.remove("in"),s.classList.add("out"),k(),o.classList.remove("in"),o.classList.add("out"),clearTimeout(n),n=setTimeout(E,200),e&&e.preventDefault&&e.preventDefault();var t=o.querySelector(".js-back");t&&t.classList.add("cloaked"),m.destroy(),u.events.fire(si.overlayClosed,v),u.element.classList.remove("player-overlayVisible"),h=!1,p=v=null,window.requestAnimationFrame(function(){r&&(!function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document.activeElement,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;try{e.focus()}catch(e){t&&t(e)}}(r),r=null)})}}function E(){o.setAttribute("hidden",""),o.removeAttribute("data-name"),o.removeAttribute("data-icon"),o.classList.add("hidden"),o.classList.remove("out"),o.classList.remove("embed-active"),o.classList.remove("modal"),o.classList.remove("embed-only"),s.classList.remove("out"),s.classList.remove("in"),c.removeAttribute("data-icon"),c.classList.add("hidden"),c.classList.remove("animate"),d.removeAttribute("data-icon"),d.innerHTML="",f.classList.add("hidden"),l.classList.remove("out"),l.innerHTML="",u.events.fire(si.overlayCleared)}function T(){o.setAttribute("data-modal","false")}function x(e){if("yes"===e.form.getAttribute("data-bubble")){e.form.setAttribute("data-bubble","no");var t=o.querySelector(".vp-validation-bubble");t.querySelector(".vp-validation-bubble-message").innerHTML=e.validationMessage||"There is an error with this input.";var n=Dn(e),i=Dn(e.form);t.style.left=n.left-i.left+"px",t.style.top=n.height+1+"px",t.classList.remove("hidden"),e.focus(),window.requestAnimationFrame(function(){t.classList.add("vp-validation-bubble-animate")}),A()}}function A(e){var t=o.querySelector(".vp-validation-bubble");if(t){if(e)return clearTimeout(i),void t.classList.remove("vp-validation-bubble-animate");clearTimeout(i),i=setTimeout(function(){t.classList.remove("vp-validation-bubble-animate")},5e3)}}function L(e){var t=o.querySelector("input[type=password]");return t.form.classList.contains("submitted")?(t.setAttribute("aria-invalid","false"),t.setCustomValidity(""),t.checkValidity&&!t.checkValidity()?(t.setAttribute("aria-invalid","true"),t.validity.valueMissing&&t.setCustomValidity("Please enter the password."),e||x(t),!1):(A(!0),!0)):null}function P(){C(),c.classList.remove("cloaked"),c.classList.add("animate"),window.requestAnimationFrame(function(){c.style[Te.transformProperty]="translateY(-10px)"}),T(),k()}function C(){f.classList.add("animate")}function O(){d.classList.add("open")}function R(){d.classList.add("pulled-back")}function M(e){!e&&h&&"email-capture"===v?(t=h,T(),S()):e&&t&&(t=!1,u.events.fire(oi.showOverlay,"email-capture"))}function I(){var e=u.config.embed.email||{};if(u.telecine){var t=e.timecode||0;y=u.telecine.currentTime>t}e&&"before"===e.position&&!y&&D()}function D(){e.get("ui.overlay.isEmailCaptureVisible")?u.events.fire(oi.showOverlay,"email-capture"):t=!0}function F(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=u.config.embed.email||{};t&&"during"===t.position&&(e<t.timecode&&(y=!1),e>=t.timecode&&!y&&(y=!0,D()))}function B(){T(),S()}return u.events.on(oi.hideOverlay,function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).unmakeModal&&T(),S()}),u.events.on(oi.showOverlay,function(s){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=function(){var e,t,n,i,r,o,a={modal:!1,template:null,logo:!1,icon:{type:null,html:null}};switch(s){case"share":return w(s,m.getShareData(a,l)),void m.setup();case"private-locked":return void w(s,((o=a).icon={type:"lock",html:Oc.render("icon_lock")},o.modal=!0,o.logo=!0,o.template=Oc.render("private_locked",{action:"https://"+u.config.vimeo_url+"/log_in",strings:{title:"Private Video",subtitle:"Log in to watch (if you have permission)",logIn:"Log in",logInLabel:"Log in (opens in a new window)"}}),o));case"password":return void w(s,((r=a).icon={type:"lock",html:Oc.render("icon_lock")},r.template=Oc.render("password",{action:"https://"+u.config.player_url+"/video/"+u.config.video.id+"/check-password?referrer="+u.config.request.referrer,strings:{title:"Password Required",subtitle:"If you’ve got it, enter it below.",password:"Password",watch:"Watch Video"}}),r.modal=!0,r.logo=!!u.config.embed.settings.branding,r));case"private-unlocked":return void w(s,((i=a).icon={type:"lock",html:Oc.render("icon_lock")},i.template=Oc.render("private_unlocked",{strings:{title:"Private Video",subtitle:"You are logged in and have permission to watch (congrats).",watch:"Watch Video"}}),i));case"error":return void w(s,(n=l,(t=a).template=Oc.render("error",{title:n.title,message:n.message}),t.modal=!!n.modal,t.logo=!!n.logo,n.icon&&"lock"===n.icon&&(t.icon={type:"lock",html:Oc.render("icon_lock")}),t));case"help":return void w(s,((e=a).template=Oc.render("help",{onSite:u.config.embed.on_site,strings:{title:"Keyboard Shortcuts",volumeUp:"Volume up",volumeDown:"Volume down",scrubForward:"Scrub forward",scrubBackwards:"Scrub backwards",like:"Like",share:"Share",watchLater:"Watch Later",captions:"Toggle Captions",prefs:"Toggle Preferences Menu",fullscreen:"Toggle fullscreen",viewOnVimeo:"View on Vimeo"}}),e));case"email-capture":return void w(s,g.getData(a,l));case"app-redirect":return void w(s,function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.redirectUrl,i=t.title,r=t.buttonText,o=t.ignoreText,a=t.bottomText,s=t.newWindow,l=Hn(u.config.video.privacy,[ii.PRIVACY_HIDE_FROM_VIMEO,ii.PRIVACY_UNLISTED]);return e.template=Oc.render("app_redirect",{hideRedirectButton:l,redirectUrl:n,newWindow:s,strings:{title:i,buttonText:r,ignoreText:o,bottomText:a}}),e.modal=!1,e.logo=!1,e.preventBackgroundClose=!0,e}(a,l))}};if(h&&!l.nohide)return("share"!==v&&"help"!==v&&"hd-not-allowed"!==v||v!==s)&&(u.events.once(si.overlayCleared,e),T()),void S();e()}),Il(o).on("input","input",function(){this.form.classList.add("interacted")}).on(["focus","blur"],"input",function(){A(!0)}).on("transitionend",".vp-validation-bubble",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&this.classList.add("hidden")}),u.events.on([si.overlayCloseButtonPressed,si.played],S),u.events.on(si.privateUnlocked,function(){"private-locked"===v&&(T(),S())}),u.events.on(si.configChanged,function(){"share"===v&&(p=m.getShareData({modal:!1,template:null,logo:!1,icon:{type:null,html:null}}),l.innerHTML=p.template,m.setup())}),Il(window).on("resize",function(){if(h){f.style.bottom=_();var e=b();c.style.top=e.top,c.style[Te.transformProperty]=e.transform}}),Il(o).on("transitionend",".vp-overlay-logo",function(e){"opacity"===e.propertyName&&this.classList.contains("animate")&&(f.classList.add("hidden"),f.classList.remove("animate"))}),Il(o).on("transitionend",".vp-overlay-icon-wrapper",function(e){-1<e.propertyName.indexOf("transform")&&(""===this.style[Te.transformProperty]?(this.classList.remove("centered"),"lock"!==this.getAttribute("data-icon")||d.classList.contains("open")||d.querySelector("canvas")?R():setTimeout(O,100)):"translateY(-10px)"===this.style[Te.transformProperty]&&(c.classList.add("centered"),c.style[Te.transformProperty]=""))}),Il(o).on("transitionend",".vp-overlay-icon",function(e){-1<e.propertyName.indexOf("transform")&&(this.classList.contains("out")?(T(),S()):this.classList.contains("pulled-back")?(d.classList.add("out"),d.classList.remove("pulled-back")):this.classList.contains("open")&&R())}),e.watch("ui.overlay.isEmailCaptureVisible",M),u.events.on(si.ready,I),u.events.on(si.configChanged,I),u.events.on(si.playProgress,F),g.events.on(si.emailCaptureEnd,B),m.events.on(si.embedViewShown,function(){u.config.embed.settings.share.embed_only||(o.querySelector(".js-back").classList.remove("cloaked"),o.classList.add("embed-active"))}).on(si.shareViewShown,function(){o.classList.remove("embed-active")}),Bc(o,".js-back",function(){return m.showShareView(),!1}),m.events.on(si.shareViewEnd,function(){o.querySelector(".js-back").classList.add("cloaked")}),u.events.on(si.stereoscopicButtonPressed,function(){u.events.fire(oi.showOverlay,"app-redirect",{redirectUrl:u.doNotTrackEnabled?"https://play.google.com/store/apps/details?id=com.vimeo.android.videoapp&hl=en":Rl(u.config.video.id,"player-spatial-redirect"),title:"Headset viewing isn’t currently supported in mobile browsers.",buttonText:"Watch in the Vimeo app",ignoreText:null,bottomText:null,newWindow:!u.config.embed.on_site})}),Il(l).on("click",".app-redirect-ignore",function(){S()}),Il(l).on("click","[data-new-window]",function(e){return window.open(document.querySelector(".app-redirect-button").getAttribute("href")),!1}),Il(l).on("click",".popup",function(){return u.events.fire(oi.openPopup,"login-private-locked"),!1}),function(){function e(e){if(!L())return!1;var t=e.querySelector("input[type=password]"),n=e.querySelector("input[type=submit]");function i(e){n.classList.remove("loading"),t.setCustomValidity("Uh oh. There was a problem. Please try again."),t.setAttribute("aria-invalid","true"),x(t)}n.classList.add("loading"),function(e,t,n){Un(o);var i=Ut(e.querySelectorAll("input")).map(function(e){return e.name?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):encodeURIComponent(e.value)}).join("&"),r=new XMLHttpRequest;r.open(e.method,e.action+window.location.search,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.withCredentials=!0,r.timeout=3e3,r.onload=function(){var e;try{e=JSON.parse(r.responseText)}catch(e){}t(e,r)},r.onerror=function(e){n(e)},r.send(i)}(e,function(e,t){if(!1!==e){if(u.events.fire(si.passwordUnlocked,e),"icon-hidden"===window.getComputedStyle(s,":after").content)return T(),void S();P()}else i(t.status)},i)}Il(l).on("click",".password input[type=submit]",function(){this.form.classList.add("submitted"),this.form.setAttribute("data-bubble","yes"),L(!0)}).on("submit",".password form",function(){return e(this),!1}).on(["focus","input"],[".password input[type=email]",".password input[type=password]"],function(){L()})}(),Bc(l,".unlocked button",function(){0===Dn(d).width?(C(),T(),S()):P(),Te.iPad||Te.iPhone||u.events.once(si.overlayCleared,function(){u.events.fire(si.playButtonPressed)})}),a=void 0,u.events.on(si.error,function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{modal:!0,final:!0};if(!1!==t.final){a=e;var n={modal:!1,template:null,logo:!1,icon:{type:null,html:null}};if(n.modal=t.modal,n.template=Oc.render("error",{title:t.title,message:t.message}),h)return S(),void u.events.once(si.overlayCleared,function(){return w(e,n)});w(e,n)}}),Il(l).on("click",".error",function(e){u.events.fire(si.errorLinkPressed,e.target.href,a)}),u.events.on(si.configChanged,function(){window.requestAnimationFrame(function(){T(),S()})}),Bc(o,".js-close",function(){u.events.fire(si.overlayCloseButtonPressed)}),Il(o).on(["click","touchend"],[".vp-overlay-content",".js-share",".vp-overlay-logo"],function(e){e.stopPropagation()}).on(["click","touchend"],[".vp-overlay-cell","nav"],function(){return"false"===o.getAttribute("data-background-close")||(u.events.fire(si.overlayCloseButtonPressed),!1)}),u.events.on(oi.showOutro,function(){o.classList.add("hidden")}),u.events.on(si.outroHidden,function(){o.classList.contains("in")&&o.classList.remove("hidden")}),u.events.fire(si.overlayModuleReady),{}}var Ld=[".vp-title a"],Pd=[".vp-title a:hover"],Cd=["a",".button-link",".vp-overlay-wrapper .footnote.share a:hover",".vp-title h1",".vp-title span.user",".menu li:hover",".menu li.active",".outro-link:hover",".outro-videosTitle a:hover","li.vp-panel-item:hover","li.vp-panel-item-on",".vp-share-footnote a:hover",".card-link span",".vp-panel-collapsible .vp-panel-button:hover"],Od=["a:hover",".button-link:hover"],Rd=[".vp-overlay-wrapper .close:hover .fill",".vp-overlay-wrapper .back:hover .fill",".stats-debug-close:hover .fill",".stats-debug-copy:hover",".card-link:hover .fill"],Md=[".play-bar .on .fill",".play-bar a:hover .fill",".play-bar button:not(.toggle):hover .fill",".tiny-bars .fill",".vp-sidedock .on .fill",".controls-outro a:hover .fill",".card-link .fill",".vp-panel-collapsible .vp-panel-button:hover .fill"],Id=[".vp-sidedock .on:hover .fill"],Dd=[".play-bar .on .stroke",".vp-sidedock .on .stroke"],Fd=[".vp-sidedock .on:hover .stroke"],Bd=[".vp-sidedock button:hover",".vp-sidedock button.selected","&.touch-support .vp-sidedock button:active",".vp-controls .play:hover",".vp-controls .play-bar .played","&.no-playbar .play-bar button:not(.toggle):hover",".vp-controls.tiny .play-bar button:not(.toggle):hover",".vp-controls .volume div",".vp-overlay .buttons li",".vp-overlay .vp-overlay-content button",'.vp-overlay .vp-overlay-content input[type="submit"]','.vp-overlay .vp-overlay-content a[role="button"]',"li.vp-panel-item-on:before",".vp-controls .replay:hover",".vp-share-buttons li","button.vp-share-embedCopy",".outro-button","a.outro-vodButton",".vp-email-capture-form-button--submit",".vp-email-capture-checkIconWrapper"],qd=["li.vp-panel-item-on:before"],Nd=[".vp-overlay .vp-overlay-content button",'.vp-overlay .vp-overlay-content input[type="submit"]','.vp-overlay .vp-overlay-content a[role="button"]',".vp-sidedock button:hover",".vp-sidedock button.selected",".vp-sidedock button:hover .vod-label",".vp-sidedock button.selected .vod-label",".play:hover",".vp-share-footnote--embed a",".outro-button",".outro-button:hover",".vp-outro-wrapper .outro-link:hover","button.vp-share-embedCopy",".outro-vodWrapper a.outro-vodButton",".outro-vodWrapper a.outro-vodButton:hover","li.vp-panel-item:hover","li.vp-panel-item-on",".vp-panel-collapsible .vp-panel-button:hover"],jd=[".vp-controls .play:hover .fill",".vp-sidedock button:hover .fill",".vp-sidedock button.selected .fill",".play-bar a:hover .fill",".play-bar button:not(.toggle):hover .fill","&.no-playbar .play-bar button:not(.toggle):hover .fill",".vp-controls.tiny .play-bar button:not(.toggle):hover .fill",".vp-sidedock .on .fill",'.vp-share-wrapper a[role="button"] .fill',".outro-vodButton .fill",".vp-email-capture-checkIconWrapper .fill",".vp-panel-collapsible .vp-panel-button:hover .fill"],Ud=[".vp-controls .play:hover .stroke",".vp-sidedock button:hover .stroke",".vp-sidedock button.selected .stroke",".vp-sidedock .on .stroke"],Vd=["li.vp-panel-item-on:before"],Hd=["li.vp-panel-item-on:before"],Wd=['.vp-overlay-wrapper .vp-overlay a[role="button"]',".vp-sidedock button:hover",".vp-sidedock button.selected",".play:hover","button.vp-share-embedCopy",".outro-button",".outro-button:hover",".outro-vodWrapper a.outro-vodButton",".outro-vodWrapper a.outro-vodButton:hover","input.vp-email-capture-form-button--submit"],zd=[".vp-controls .play:hover .fill",".vp-sidedock button:hover .fill",".vp-sidedock button.selected .fill",".vp-controls .play-bar .fullscreen.tiny:hover .fill",".vp-share-button .fill",".outro-vodButton .fill"],Gd=[".vp-sidedock button:hover .stroke",".vp-sidedock button.selected .stroke"],Kd=["li.vp-panel-item-on:before"],Yd=['.vp-overlay .vp-overlay-content input[type="submit"]:active',".vp-overlay .embed-copy.zeroclipboard-is-active",'.vp-overlay a[role="button"]:active',".vp-sidedock button:active",".outro-vodWrapper a.outro-vodButton:active"];function Xd(i,e){var o=e.uuid,a=e.id,s=e.isMobileDevice,l=null;function u(e,t){var n=".player-"+o+" ",i=n+e.join(","+n);if(t){var r=a+" ";i+=","+r+e.join(","+r)}return s&&(i=i.replace(/:hover/g,":active")),i=i.replace(/ &/g,"")}function c(){var e;l?function(){for(;0<l.cssRules.length;)l.deleteRule(0)}():((e=document.createElement("style")).setAttribute("data-player",o),document.querySelector("head").appendChild(e),l=e.sheet)}return i.events.on(oi.changeColor,function(e){var t;try{t=new An(e)}catch(e){t=new An("00adef")}var n=function(e){c();var t=e.complement,n=new An(23,35,34,.75),i=new An(0,0,0,.15).overlayOn(e);n.contrast(t).ratio<3&&t.lighten(5,3,n);var r,o=e.lightness<40?e.clone().lighten(15,3,e):e.clone().darken(15,3,e);return Mn(u(Ld,!0),"color:"+e.hex+" !important",l),Mn(u(Pd,!0),"color:"+t.hex+" !important",l),Mn(u(Cd),"color:"+e.hex,l),Mn(u(Md),"fill:"+e.hex,l),Mn(u(Dd),"stroke:"+e.hex,l),Mn(u(Bd),"background-color:"+e.hex,l),Mn(u(qd),"border-color:"+e.hex,l),Mn(u(Od),"color:"+t.hex,l),Mn(u(Rd),"fill:"+t.hex,l),Mn(u(Id),"fill:"+o.hex,l),Mn(u(Fd),"stroke:"+o.hex,l),Mn(u(Kd),"border-color:"+i.hex,l),Mn(u(Yd),"background-color:"+i.hex,l),.95<e.luminance&&(t=e.clone().darken(15,3,e),Mn(u(Nd),"color:"+t.hex,l),Mn(u(jd),"fill:"+t.hex,l),Mn(u(Ud),"stroke:"+t.hex,l),Mn(u(Vd),"background-color:"+t.hex,l),Mn(u(Hd),"border-color:"+t.hex,l),o=t.clone().darken(15,3,t),Mn(u(Id),"fill:"+o.hex,l),Mn(u(Fd),"stroke:"+o.hex,l)),175<e.yiq&&e.luminance<.95&&(r=o.clone().darken(15,3,o),Mn(u(Id),"fill:"+r.hex,l),Mn(u(Fd),"stroke:"+r.hex,l),Mn(u(Wd),"color:"+o.hex,l),Mn(u(zd),"fill:"+o.hex,l),Mn(u(Gd),"stroke:"+o.hex,l)),{main:e.hex,selected:o.hex,sidedockHover:r?o.hex:.95<e.luminance?t.hex:An.white.hex,sidedockSelected:.95<e.luminance?t.hex:e.hex,sidedockSelectedHover:r?r.hex:o.hex}}(t);i.config._colors=n,i.config.embed.color=n.main.replace("#",""),i.events.fire(si.colorChanged,i.config.embed.color)}),i.events.fire(oi.changeColor,i.config.embed.color),{}}function $d(e,t,n,i){var r=i[t];return r?(r=Qd(r=Zd(e,r),n,i.prices),i.expires_in_duration_str&&(r=r.replace("{TIME}",i.expires_in_duration_str)),i.available_on_formatted&&(r=r.replace("{DATE}",i.available_on_formatted)),r):null}function Qd(e,t,n){var i=n.USD;return t in n&&(i=n[t]),-1!==e.indexOf("${price}")?e.replace("${price}",i):-1!==e.indexOf("{PRICE}")?e.replace("{PRICE}",i):e}function Jd(e,t){return!e||0===e.length||-1!==e.indexOf(t)}function Zd(e,t){return void 0!==e&&void 0!==e[t]?e[t]:t}var ef=Object.freeze({formatVodLabel:$d,getDisplayPrice:Qd,isAvailableInCountry:Jd,translateFromRequest:Zd});function tf(u,c){var d,f,h,v,p,m,g,y,_,e,t,n,i,b=!1,r=!1,o=!1,a=!1,s=!1,l=!1,w=!1,k=!1,S=[],E=[],T=null,x=!1,A=!1,L=null,P=u.config.embed.autoplay&&u.config.request.flags.autohide_controls;function C(){return a||w||k}function O(){b&&(A||(r&&x||C()||P)&&(o||(!s&&!l||C())&&(b=!1,u.events.fire(si.sidedockVisibilityChanged,b),(L||c).classList.add("invisible"))))}function R(){if(!b&&!C()){var e=L||c;e.classList.add("invisible"),e.classList.remove("hidden"),e.removeAttribute("hidden"),c.classList.remove("hidden"),c.removeAttribute("hidden"),c.classList.contains("vod")&&c.classList.remove("vod"),setTimeout(function(){b=!0,u.events.fire(si.sidedockVisibilityChanged,b),e.classList.remove("invisible")},0)}}function M(e,t,n){var i="data-label-"+n,r="add"!==n||u.config.user.logged_in?i:"data-label-add-logged-out";e.setAttribute("aria-label",e.getAttribute(r)),t.classList.add("hidden"),t.setAttribute("hidden",""),t.firstChild.innerHTML=e.getAttribute(i)}function I(){var n=S.indexOf(this);E.forEach(function(e,t){t!==n&&e&&e.classList.add("invisible")}),0<=n&&E[n]&&(E[n].classList.add("invisible"),E[n].classList.remove("hidden"),E[n].removeAttribute("hidden",""),T=window.requestAnimationFrame(function(){T=window.requestAnimationFrame(function(){E[n].classList.remove("invisible"),E[n].classList.add("visible")})}))}function D(){var e="BUTTON"===this.tagName?this:this.querySelector("button"),t=S.indexOf(e);0<=t&&E[t]&&(T&&(window.cancelAnimationFrame(T),T=null),E[t].classList.add("invisible"))}function F(){if(d){var e=d.parentElement;L.insertBefore(e,L.firstChild)}}function B(){if(u.config.view===vi.main||u.config.view===vi.privateUnlocked){var e=u.config.embed.settings,t=u.config.video.vod&&"purchase_options"in u.config.video.vod&&u.config.video.vod.purchase_options.length,n=t&&u.config.video.vod.is_coming_soon,i="ondemand.main"===u.config.embed.context,r=u.config.video.vod&&u.config.user.purchased?1:0,o=t&&e.vod&&Jd(u.config.video.vod.countries,u.config.request.country);o&&n&&i&&(o=!1);var a=t&&u.config.video.vod.purchase_options[0],s=null;a&&(s=$d(u.config.request.dynamic_translation_map,"label_string",u.config.request.currency,a)),c.innerHTML=Oc.render("sidedock",{loggedIn:!!u.config.user.logged_in,vodButton:o,purchased:r,vodPurchaseInfo:a,vodDisplayLabel:s,likeButton:e.like,liked:u.config.user.liked,watchLaterButton:e.watch_later,addedToWatchLater:u.config.user.watch_later,collectionsButton:e.collections,shareButton:e.share,strings:{like:"Like",likeLoggedOut:"Like (opens in a new window)",unlike:"Unlike",watchLaterAdd:"Add to Watch Later",watchLaterAddLoggedOut:"Add to Watch Later (opens in a new window)",watchLaterRemove:"Remove from Watch Later",collections:"Add to collections",share:e.share&&e.share.embed_only?"Embed":"Share"}}),d=c.querySelector(".vod-button"),o&&(L=c.querySelector(".sidedock-inner"),r&&F());var l=L||c;t&&o&&!u.config.embed.settings.instant_sidedock?c.classList.add("vod"):Te.touch&&(b=!0,u.events.fire(si.sidedockVisibilityChanged,b),l.classList.remove("hidden"),l.removeAttribute("hidden"),l.classList.remove("invisible")),f=c.querySelector(".like-button"),h=c.querySelector(".like-label"),v=c.querySelector(".watch-later-button"),p=c.querySelector(".watch-later-label"),m=c.querySelector(".collections-button"),g=c.querySelector(".collections-label"),y=c.querySelector(".share-button"),_=c.querySelector(".share-label"),S=[d,f,v,y,m],E=[null,h,p,_,g]}}return B(),e=u.config.embed.settings.instant_sidedock,t=u.config.video.vod,n=t&&"purchase_options"in t&&t.purchase_options.length,i=t&&Jd(u.config.video.vod.countries,u.config.request.country),(e||n&&i)&&(P||R()),Bc(c,".vod-button",function(){var e=d.getAttribute("data-product-id");u.events.fire(si.vodButtonPressed,e)},D),u.events.on(si.outroDisplayed,function(){F(),c.classList.add("sidedock-outro"),"share"===u.config.embed.outro&&(u.config.embed.settings.share=0,B())}),u.events.on(si.outroHidden,function(){!function(){if(d){var e=d.parentElement;c.insertBefore(e,L)}}(),c.classList.remove("sidedock-outro"),"share"===u.config.embed.outro&&(u.config.embed.settings.share=1,B())}),Bc(c,".like-button",function(){u.events.fire(si.likeButtonPressed)},D),u.events.on(si.liked,function(){f&&(f.classList.add("on"),M(f,h,"remove"))}),u.events.on(si.unliked,function(){f&&(f.classList.remove("on"),M(f,h,"add"))}),Bc(c,".watch-later-button",function(){u.events.fire(si.watchLaterButtonPressed)},D),u.events.on(si.addedToWatchLater,function(){v&&(v.classList.add("on"),M(v,p,"remove"))}),u.events.on(si.removedFromWatchLater,function(){v&&(v.classList.remove("on"),M(v,p,"add"))}),Bc(c,".collections-button",function(){u.events.fire(si.collectionsButtonPressed)},D),Bc(c,".share-button",function(){return u.events.fire(u.config.embed.settings.share.embed_only?si.embedButtonPressed:si.shareButtonPressed),!1},D),Il(c).on("blur","button",D).on("mouseleave",".box",D).on(["focus","pointerdown","touchstart","mouseenter"],"button",I).on("transitionend","label",function(e){"opacity"===e.propertyName&&e.target.classList.contains("invisible")&&(e.target.classList.add("hidden"),e.target.setAttribute("hidden",""),e.target.classList.remove("visible"))}),Bc(c,"label",function(){var e=E.indexOf(this);0<=e&&S[e].click()}),u.events.on([si.mousedOut,si.mouseTimeout],O).on(si.mousedOver,R).on(si.targetTimeReached,function(){x=!0,O()}).on(si.played,function(){r=!0}),Il(c).on(["pointerenter","pointerleave","mouseenter","mouseleave"],function(e){"pointerType"in e?"mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(o="pointerenter"===e.type||"MSPointerEnter"===e.type):o="mouseover"===e.type}),Il(c).on("transitionend",function(e){var t=L||c;"opacity"===e.propertyName&&t.classList.contains("invisible")&&(t.classList.add("hidden"),t.setAttribute("hidden",""),d&&t.contains(d)&&(c.classList.add("hidden"),c.setAttribute("hidden","")))}),u.events.on(si.willEnterFullscreen,function(){o=!1,O()}).on(si.didExitFullscreen,function(e){e||(A=!0)}),u.events.on([si.airPlayActivated],function(){s=!0,R()}).on([si.airPlayDeactivated],function(){s=!1}),u.events.on(si.pictureInPictureActivated,function(){l=!0,R()}).on(si.pictureInPictureDeactivated,function(){l=!1}),u.events.on(si.overlayOpened,function(){a=!0,o=!1,O()}).on(si.overlayClosed,function(){a=!1,R()}),u.events.on(si.alertVisibilityChanged,function(e){(w=e)&&O()}),u.events.on([si.menuCentered,si.menuVisibilityChanged],function(e,t){t.isCentered()&&t.isVisible()&&(k=!0,o=!1,O()),t.isCentered()&&t.isVisible()||(k=!1,R())}),u.events.on(si.configChanged,function(){B()}),u.events.on(oi.reset,function(){x=o=!1,O(),A=o=r=!1}),u.events.fire(si.sidedockModuleReady),{}}var nf=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Yn(this,r);var n=parseInt(76*Te.devicePixelRatio,10),i=parseFloat(t.timecode);if(isNaN(i))throw new TypeError("Time must be a number.");if(i<0)throw new TypeError("Time must be a positive number.");this.time=i,this.data=t,this.id=t.id,this.displayTime=t.display_time||6,t.url&&(this.data.url=pr(t.url)),t.image_url&&(t.image=So({width:n,height:n,baseUrl:pr(t.image_url),webpSupport:e.config.request.flags.webp,crop:!0})),this.renderTemplate()}return Xn(r,[{key:"renderTemplate",value:function(){var t=this,e=document.createElement("div");e.innerHTML=Oc.render("card",this.data),this.element=e.children[0],this.data.image&&Eo(this.data.image).catch(function(e){t.element.querySelector(".js-cardImageWrap").style.display="none"})}},{key:"isActive",value:function(e){return e>=this.time&&e<this.end}},{key:"end",get:function(){return this.time+this.displayTime}}]),r}(),rf=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(e,t){return e<t};Yn(this,t),this._data={},this._sortedKeys=[],this._sort=e}return Xn(t,[{key:"_insert",value:function(e){var t=this._sortedKeys.length;if(0===t)this._sortedKeys.push(e);else{for(var n=0;n<t;n++)if(this._sort(e,this._sortedKeys[n])){this._sortedKeys[n-1]!==e&&this._sortedKeys.splice(n,0,e);break}n===t&&this._sortedKeys[n-1]!==e&&this._sortedKeys.splice(n,0,e)}}},{key:"_binarySearch",value:function(e,t,n,i){if(i<n)return-1;var r=parseInt(n+(i-n)/2,10);return e[r]>t?this._binarySearch(e,t,n,r-1):e[r]<t?this._binarySearch(e,t,r+1,i):r}},{key:"delete",value:function(e){var t=this._binarySearch(this._sortedKeys,e,0,this._sortedKeys.length);if(-1===t)throw new Error("key does not exist");this._sortedKeys.splice(t,1),delete this._data[e]}},{key:"set",value:function(e,t){return this._data[e]=t,this._insert(e),this}},{key:"get",value:function(e){return this._data[e]}},{key:"keys",value:function(){return this._sortedKeys.slice()}},{key:"values",value:function(){var t=this;return this.keys().map(function(e){return t._data[e]})}},{key:"forEach",value:function(e){for(var t=this._sortedKeys.length,n=0;n<t&&!1!==e(this._data[this._sortedKeys[n]],this._sortedKeys[n],this);n++);}},{key:"size",get:function(){return this._sortedKeys.length}}]),t}();function of(o,a,t){var s=t.querySelector(".vp-cards"),l=new rf,n=void 0,i=void 0,r=!1,e=function(e){return function(){0<l.size&&e.apply(void 0,arguments)}};function u(){if(g(),l.forEach(function(e,t){e.element.parentNode.removeChild(e.element)}),l=new rf,Array.isArray(o.config.embed.cards)&&o.config.embed.cards.length){if(o.config.video.title&&o.config.embed.settings.title)c(-1,{className:"card--contentInfo",timecode:0,headline:o.config.video.title,teaser:o.config.embed.settings.byline?o.config.video.owner.name:"",image:o.config.video.owner[1<Te.devicePixelRatio?"img_2x":"img"],id:"title-card"});o.config.embed.cards.forEach(function(e){c(e.timecode,e)})}}function c(e,t){var n=l.get(e),i=new nf(o,t);if(l.set(e,i),n)return s.replaceChild(i.element,n.element),i;var r=l.keys().indexOf(e);return s.insertBefore(i.element,s.children[r]),a.dispatch(pc(l.size)),i}function d(e){o.element.classList.toggle("player-withCards",0<e)}function f(e){t.classList.toggle("cards-wrapper--withThumbnails",e)}function h(e){o.element.classList.toggle("player-cardsCarousel",e),o.element.classList.toggle("player-cardsCorner",!e),n.destroy(),e&&n.setUp()}function v(e){var t=function(t){var e=l.values().filter(function(e){return e.isActive(t)}).slice(-1)[0];if(e)return e;if(a.get("ui.cards.isCarouselVisible")){var n=l.values().slice(-1)[0];if(n&&t>n.end)return n}return null}(e);t!==i&&(!t&&r||(r=!1,g(),(i=t)&&"title-card"===i.id?a.get("ui.cards.isCarouselVisible")&&p(i,!0):p(i,!0)))}function p(e,t){e&&(t?e.element.classList.add("card-animating"):e.element.classList.remove("card-animating"),e.element.classList.add("card-active"),Il(e.element.childNodes[1]).on("mouseover",function(){r=!0}),Il(e.element.childNodes[1]).on("mouseout",function(){r=!1}),n.show(e.element),o.events.fire(si.cardDisplayed,e.id,e.data))}function m(e){r||e.classList.remove("card-active")}function g(){Ut(t.querySelectorAll(".card-active")).forEach(m)}function y(e){var t=l.values()[e];t.data.url&&"title-card"!==t.id&&(o.events.fire(si.cardPressed,t.id,t.data),o.telecine.paused||o.events.fire(si.pauseButtonPressed),window.open(t.data.url))}function _(e){e.preventDefault();var t=zn(e.target,s.children),n=l.values()[t];n.data.url&&"title-card"!==n.id&&(o.events.fire(si.cardPressed,n.id,n.data),o.telecine.paused||o.events.fire(si.pauseButtonPressed),window.open(n.data.url))}function b(e){var t=l.values()[e];"title-card"!==t.id&&o.events.fire(si.cardDisplayed,t.id,t.data),o.events.fire(oi.setTime,t.time)}function w(e){var t=c(e.timecode,e);g(),p(t)}function k(e){g();var t=l.get(e.timecode).element;t.parentNode.removeChild(t),l.delete(e.timecode)}return n=new Nc(s),a.watch("ui.cards.size",d),a.watch("ui.cards.isCarouselVisible",h),a.watch("ui.cards.isCardsThumbVisible",f),h(a.get("ui.cards.isCarouselVisible")),o.events.on(si.configChanged,u),o.events.on(oi.addCard,w),o.events.on(oi.removeCard,k),n.on("slide",e(b)),n.on("tap",e(y)),o.events.on(si.playProgress,e(v)),o.events.on(si.ended,e(g)),Bc(document,".player-cardsCorner .card",e(_)),u(),{}}var af=.05,sf={16:"shift",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};function lf(c,d,e){var r,t,n,i=!!c.config.embed.on_site,o=e.querySelector(".volume"),a=!1,s=!1,f=c.config.video.fps/5,h=Math.max(f,.618*c.config.video.duration),v=100,p=f,m=0,g=!1,l=Mc(k,80);function u(){return!i&&(c.config.view===vi.main||c.config.view===vi.privateUnlocked)}function y(){a&&"help"===r&&c.events.fire(si.overlayCloseButtonPressed)}function _(e){return"number"!=typeof e.which&&(e.which=e.keyCode),e}function b(e){if("keypress"===e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return e.which in sf?sf[e.which]:String.fromCharCode(e.which).toLowerCase()}function w(e){var t=e.target||e.srcElement;return"INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable}function k(e,t){if(!d.get(ol)){if(!g){t&&!c.telecine.paused&&c.events.fire(si.pauseButtonPressed);c.events.fire(si.scrubbingStarted,!0),g=!0}var n,i,r,o;n=m,i=Math.ceil(f),r=Math.ceil(h-f),o=n,o/=v,p=r*(--o*o*o+1)+i,1===++m&&(p=c.config.video.fps);var a,s=t?1:p,l="right"===e?s:-s,u=Math["right"===e?"ceil":"floor"](c.telecine.currentTime*c.config.video.fps);a=(u+l)/c.config.video.fps,c.events.fire(oi.seek,null,a)}}function S(e){var t=s.getTabindexItems(),n=t.indexOf(document.activeElement),i="up"===e?n-1:n+1,r=null;return!(r=i>=t.length?t[0]:i<0?t[t.length-1]:t[i])||(r.focus(),!1)}function E(){return!!s||(!(!d.get(ol)||d.get(ll))||(document.activeElement&&document.activeElement!==document.body?void 0:(c.events.fire(si[c.telecine.paused?"playButtonPressed":"pauseButtonPressed"]),y(),!1)))}function T(){return s?(s.element.contains(document.activeElement)&&s.button.focus(),s.hide(),!1):document.activeElement&&e.contains(document.activeElement)?(In(),!0):a?(c.events.fire(si.overlayCloseButtonPressed),!1):void 0}function x(){if(s)return!s.element.contains(document.activeElement)||S("up");if(Te.spatialPlayback&&c.config.video.spatial)return c.telecine.getEffectByName("ThreeSixtyEffect").keyPress("up"),!1;if(c.config.embed.on_site&&document.activeElement&&!e.contains(document.activeElement))return!0;y();return c.events.fire(oi.changeVolume,af,!1,!0),!1}function A(){if(s)return!s.element.contains(document.activeElement)||S("down");if(Te.spatialPlayback&&c.config.video.spatial)return c.telecine.getEffectByName("ThreeSixtyEffect").keyPress("down"),!1;if(c.config.embed.on_site&&document.activeElement&&!e.contains(document.activeElement))return!0;y();return c.events.fire(oi.changeVolume,-af,!1,!0),!1}function L(e,t){if(s)return!s.element.contains(document.activeElement)||S("left"===t?"up":"down");if(y(),Te.spatialPlayback&&c.config.video.spatial)return c.telecine.getEffectByName("ThreeSixtyEffect").keyPress(t),!1;if(document.activeElement&&document.activeElement===o){var n="left"===t?-af:af;return c.events.fire(oi.changeVolume,n,!1,!0),!1}e.shiftKey||0===m?k(t,e.shiftKey):l(t,e.shiftKey)}return c.events.on(si.overlayOpened,function(e){a=!0,"not-supported"===(r=e)&&(i=!0)}),c.events.on(si.overlayClosed,function(){a=!1,r=null}),c.events.on(si.menuVisibilityChanged,function(e,t){s=!!e&&t}),c.events.on(si.configChanged,function(e){e&&(i=!1)}),function(){var i={l:si.likeButtonPressed,w:si.watchLaterButtonPressed,s:si.shareButtonPressed,c:[si.ccButtonPressed,!0],h:[si.prefsButtonPressed,!0],f:si.fullscreenButtonPressed,x:[si.effectButtonPressed,!0],e:[si.effectButtonPressed,!0],d:si.debugButtonPressed,space:E,up:x,down:A,left:L,right:L,esc:T,"?":[oi.showOverlay,"help"]};function e(e){if(_(e),!((t=e).ctrlKey||t.metaKey||t.altKey||(t.which in sf?"keydown"!==t.type:"keypress"!==t.type)||w(e))&&u()){var t,n=b(e);if(n in i){if("function"==typeof i[n])return void(!1===i[n](e,n)&&(e.preventDefault(),e.stopPropagation()));!1===function(e){if(e=Array.isArray(e)?e:[e],a&&"help"===r){if(c.events.fire(si.overlayCloseButtonPressed),e[0]===oi.showOverlay&&"help"===e[1])return!1;if(e[0]!==oi.openVimeo)return setTimeout(function(){c.events.fire.apply(null,e)},250),!1}return c.events.fire.apply(null,e),!1}(i[n])&&(e.preventDefault(),e.stopPropagation())}}}c.config.embed.on_site||(i.v=oi.openVimeo),document.addEventListener("keydown",e,!1),document.addEventListener("keypress",e,!1),document.addEventListener("keyup",function(e){if(_(e),!w(e)&&u()){var t=b(e);!Te.spatialPlayback||!c.config.video.spatial||"left"!==t&&"right"!==t&&"up"!==t&&"down"!==t?d.get(ol)||"left"!==t&&"right"!==t||function(e){p=f,m=0;var t=e.shiftKey;c.events.fire(si.scrubbingEnded,t),g=!1}(e):c.telecine.getEffectByName("ThreeSixtyEffect").keyUp(t)}},!1)}(),c.events.on(si.becameActive,function(){i=!1}).on(si.becameInactive,function(){i=!0}),c.config.embed.on_site&&document.querySelector(".player")===e&&(i=!1),t=void 0,n=!1,document.body.addEventListener("keydown",function(e){9!==e.which||document.body.classList.contains("showfocus")?27===e.which?document.body.classList.remove("showfocus"):32!==e.which&&13!==e.which||(n=!0,clearTimeout(t),t=setTimeout(function(){n=!1},200)):document.body.classList.add("showfocus")}),document.body.addEventListener("click",function(e){n||document.body.classList.remove("showfocus")}),{pause:function(){i=!0},unpause:function(){i=!1}}}var uf=function(){function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.displayTimeout,i=void 0===n?0:n,r=t.label,o=void 0===r?"Alert":r;Yn(this,s),_n(this),this._container=e,this._visible=!1,this._message=null,this._alert=null,this._alertLabel=o;var a=Math.round(i/1e3);0!==a&&(this._alertLabel=o+" Will be dismissed in "+a+" seconds"),this._displayTimer=null,this._displayTimeout=i,this._renderTemplate(),this._attachEvents()}return Xn(s,[{key:"show",value:function(e){var t=this;!0!==this._visible&&(clearTimeout(this._displayTimer),this._alert.classList.remove("hidden"),this._alert.removeAttribute("hidden"),window.requestAnimationFrame(function(){t._alert.classList.add("in")}),(this._alert.querySelector("[data-alert-autofocus]")||this._alert).focus(),this._visible=!0,this.fire("show",e),0!==this._displayTimeout&&(this._displayTimer=setTimeout(function(){t.hide("timeout")},this._displayTimeout)))}},{key:"hide",value:function(e){var t=this;!1!==this._visible&&(clearTimeout(this._displayTimer),this._alert.classList.add("leaving"),window.requestAnimationFrame(function(){var n=t;t._setHideAttributes(),Il(t._alert).on("transitionend",function e(t){"opacity"===t.propertyName&&(n._alert.classList.remove("leaving"),n._alert.classList.add("hidden"),n._alert.setAttribute("hidden",""),Il(n._alert).off("transitionend",e))})}),this._visible=!1,this.fire("hide",e))}},{key:"_setHideAttributes",value:function(){this._alert.classList.remove("in")}},{key:"_renderTemplate",value:function(){this._alert||(this._alert=document.createElement("div"),this._alert.setAttribute("role","alertdialog"),this._alert.setAttribute("aria-label",this._alertLabel),this._alert.setAttribute("aria-atomic","true"),this._alert.classList.add("player-alert"),this._alert.classList.add("hidden"),this._alert.setAttribute("hidden",""),this._container.appendChild(this._alert),this._setHideAttributes()),this._message instanceof HTMLElement?(this._alert.innerHTML="",this._alert.appendChild(this._message)):(this._alert.textContent=this._message,this._alert.innerHTML=this._message);var e=document.createElement("button");e.setAttribute("data-close",""),e.setAttribute("aria-label","Close alert"),e.classList.add("close"),e.innerHTML=Oc.render("icon_close"),this._alert.appendChild(e)}},{key:"_attachEvents",value:function(){var t=this;Il(this._alert).on("click","[data-close]",function(e){t.hide(e)})}},{key:"visible",get:function(){return this._visible}},{key:"message",get:function(){return this._message},set:function(e){e instanceof HTMLElement&&this._message&&e.textContent===this._message.textContent||e!==this._message&&(this._message=e,this._renderTemplate())}}]),s}(),cf=function(){function i(e,t,n){Yn(this,i),this.player=e,this.telecine=t,this.isBufferingTooLong=!1,this.isBufferingTooFrequent=!1,this.autoAlertWasDismissed=!1,this.bufferCount=-1,this.badPlaybackTimer=null,this._setUpAlertUI(n),this._attachEventHandlers()}return Xn(i,[{key:"handleBufferStarted",value:function(){this.bufferCount+=1,this.bufferCount>ni&&(this.isBufferingTooFrequent=!0,this._notifyBadPlayback()),this._startBadPlaybackTimer()}},{key:"handleBufferEnded",value:function(){clearTimeout(this.badPlaybackTimer),this.badPlaybackTimer=null,this.isBufferingTooLong=!1}},{key:"_attachEventHandlers",value:function(){var t=this;this.player.events.on(ei.spatialUnsupported,function(e){t._showSpatialUnsupportedAlert(e)}),this.player.events.on(ei.spatialFailure,function(e){t._showSpatialFailureAlert(e)}),this.player.events.on(ei.bufferStarted,this.handleBufferStarted.bind(this)),this.player.events.on(si.bufferEnded,this.handleBufferEnded.bind(this)),this.player.events.on(ei.badPlayback,function(){t.autoAlertWasDismissed||(t.showAlert("stream_studder"),sr.captureBreadcrumb("Alert shown",{message:"stream_studder"},"video"))}),this.player.events.on(si.qualityChanged,function(e){"auto"===e&&t.alertUI.hide("qualitymenuauto")})}},{key:"_showSpatialUnsupportedAlert",value:function(e){if(!e){this.showAlert("warning_alert",{strings:{text:'See a <a href="https://help.vimeo.com/hc/en-us/articles/115001878167#browsers" target="_blank" rel="noopener">list of browsers</a> that support 360 viewing.'}})}}},{key:"_showSpatialFailureAlert",value:function(e){if(!e){this.showAlert("warning_alert",{strings:{text:'Looking to watch a 360 video? See <a href="https://help.vimeo.com/hc/en-us/articles/115001878167#browsers" target="_blank" rel="noopener">supported browsers and settings</a>.'}})}}},{key:"showAlert",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.alertUI&&!this.player.config.embed.settings.background&&(this.alertUI.message=Oc.render(e,t),this.alertUI.show())}},{key:"_setUpAlertUI",value:function(e){var i=this;this.alertUI=new uf(e),this.alertUI.on("show",function(e){i.player.events.fire(si.alertVisibilityChanged,!0,e)}),this.alertUI.on("hide",function(e){var t=e.target,n=t&&"function"==typeof t.getAttribute;if(n)switch(t.getAttribute("data-context")){case"suggestion":i.player.events.fire(oi.changeQuality,"auto"),e="suggestion";break;default:e="close"}(n||"qualitymenuauto"===e)&&(i.autoAlertWasDismissed=!0),i.player.events.fire(si.alertVisibilityChanged,!1,e)})}},{key:"_startBadPlaybackTimer",value:function(){var e=this;null===this.badPlaybackTimer&&0!==this.bufferCount&&(this.badPlaybackTimer=setTimeout(function(){e.isBufferingTooLong=!0,e._notifyBadPlayback()},ti))}},{key:"_notifyBadPlayback",value:function(){"MediaSourceScanner"===this.telecine.currentScanner&&(this.isBufferingTooLong||this.isBufferingTooFrequent)&&(this.telecine.video.currentFile.restrictedStreamIndexes.length<=0||(this.isBufferingTooLong,this.isBufferingTooFrequent,this.player.events.fire(ei.badPlayback),this.bufferCount=0,this.badPlaybackTimer=null,this.isBufferingTooFrequent=!1,this.isBufferingTooLong=!1))}}]),i}();var df=function(){function n(e,t){Yn(this,n),this.player=e,this.store=t,this._failedRequests=0,this._setUpEvents()}return Xn(n,[{key:"_setUpUI",value:function(){this.store.get(ll)&&null===this.player.element.querySelector(".vp-live-viewer-status-wrapper")&&(this._wrap=document.createElement("div"),this._wrap.classList.add("vp-live-viewer-status-wrapper","invisible"),this._wrap.innerHTML=Oc.render("live_status"),this._wrap.querySelector(".vp-live-status-circle").classList.remove("offline"),this.player.config.video.live_event.show_viewer_count&&(this._wrap.innerHTML+=Oc.render("live_viewer_count"),this.player.element.querySelector(".vp-live-viewer-count").style.display="block"),this.player.element.querySelector(".vp-controls-wrapper").appendChild(this._wrap))}},{key:"_removeUI",value:function(){var e=this.player.element.querySelector(".vp-live-viewer-status-wrapper");null!==e&&this.player.element.querySelector(".vp-controls-wrapper").removeChild(e)}},{key:"_setUpEvents",value:function(){var t=this;this.player.events.on(si.configChanged,function(){t.player.config.video.live_event?t._setUpUI():t._removeUI()}),this.player.events.on(si.liveStreamOnline,function(){t._setUpUI(),t._getViewerCount()}),this.player.events.on(si.controlBarVisibilityChanged,function(e){void 0!==t._wrap&&t._wrap.classList.toggle("invisible",e)})}},{key:"_getViewerCount",value:function(){var n=this;if(this.store.get(ll)&&this.player.config.video.live_event.show_viewer_count){var i=setTimeout(function(){n._getViewerCount()},3e4),e=""+this.player.config.video.id;"unlisted"===this.player.config.video.privacy&&(e+=":"+this.player.config.video.unlisted_hash);var t="https://"+this.player.config.vimeo_api_url+"/videos/"+e+"/stats/live";"password"!==this.player.config.video.privacy&&"disable"!==this.player.config.video.privacy||(t+="?auth="+this.player.config.user.vimeo_live_auth_token),jn(t,{withCredentials:!1,jwt:this.player.config.user.logged_in?this.player.config.user.vimeo_api_client_token:this.player.config.user.vimeo_live_client_token}).then(function(e){var t=JSON.parse(e);t.viewers&&t.viewers.current?(n._failedRequests=0,n._updateViewerCount(t.viewers.current)):(n._failedRequests++,n._updateViewerCount(0))}).catch(function(e){if(n._failedRequests++,3<n._failedRequests){clearTimeout(i),n._viewerCountDisplays=Ut(n.player.element.querySelectorAll(".vp-live-viewer-count"));for(var t=0;t<n._viewerCountDisplays.length;t++)n._viewerCountDisplays[t].classList.add("hidden")}})}}},{key:"_updateViewerCount",value:function(e){this._viewerCountDisplays=Ut(this.player.element.querySelectorAll(".vp-live-viewer-count-value"));for(var t=0;t<this._viewerCountDisplays.length;t++)this._viewerCountDisplays[t].innerHTML=(n=e,n=parseFloat(n),isNaN(n)||n<0?"0":n<1e3?n.toString():1e3<=n&&n<1e6?Math.floor(n/1e3)+"."+Math.round(n%1e3/100)+"k":Math.floor(n/1e6)+"."+Math.round(n%1e6/1e5)+"m");var n}}]),n}();return window.BigScreen=Fc,function(c,e,t,d){Oc.helpers=ef;var n=function(n){if(!0===n)return M.resolve(null);var i=!1;return new M(function(t,e){n.link.addEventListener("load",function(){if(!i){i=!0;var e=(new Date).getTime()-n.startTime;setTimeout(function(){return t(e)},100)}},!1)})}(t),f=new Dc({element:c,delegate:d,cssLoadedPromise:n}),i=f.store;c.classList.add("js-player-fullscreen");var r=f.externalApi,o=null,a=null,s=null,l=null,u=null,h=null,v=c.querySelector(".vp-controls"),p=c.querySelector(".vp-sidedock"),m=c.querySelector(".vp-title"),g=c.querySelector(".vp-cards-wrapper"),y=Te.mobileAndroid||Te.iPhone||Te.windowsPhone||Te.browser.bb10,_={tiny:si.enteredTinyMode,mini:si.enteredMiniMode,normal:si.enteredNormalMode,none:si.enteredNormalMode};function b(e){e&&void 0!==_[e]&&(f.events.fire(_[e]),c.classList.toggle("player-normal","normal"===e),c.classList.toggle("player-mini","mini"===e),c.classList.toggle("player-tiny","tiny"===e))}function w(t){Object.keys(Gu).forEach(function(e){return c.classList.toggle("player-"+e,t===e)})}function k(){var e=(f.config.view===vi.main||f.config.view===vi.privateUnlocked)&&f.config.embed.settings&&!f.config.embed.settings.playbar;c.classList.toggle("no-playbar",e),c.classList.toggle("with-fullscreen",!!f.config.embed.settings.fullscreen);var t=f.config.embed.settings.custom_logo;c.classList.toggle("with-custom-logo",!!t),c.classList.toggle("with-sticky-custom-logo",t&&t.sticky),c.classList.toggle("background-mode",!!f.config.embed.settings.background),c.classList.toggle("touch-support",Te.touch)}function S(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f.config.video.url;if(!(!t||e&&e.metaKey)){if(-1===t.indexOf("#")&&0<f.telecine.currentTime&&f.telecine.currentTime<f.config.video.duration-30&&!f.telecine.paused&&(t+="#at="+Math.floor(f.telecine.currentTime)),!f.config.embed.on_site)return window.open(t),function(e){if(e&&0<e.detail)try{document.activeElement.blur()}catch(e){}}(e),f.events.fire(si.pauseButtonPressed),!1;window.location=t}}function E(){l=new M(function(t,e){var n=null,i=function e(){clearTimeout(n),0<window.innerWidth&&0<window.innerHeight?t():n=setTimeout(e,250)};f.events.once(si.ready,i),f.events.once(si.error,i)})}function T(){function e(){l.then(function(){var e,t,n,i=(e=Dn(c),t=e.width,n=e.height,y?n<=200?"10px":t<450?"12px":t<=1024?"11px":"10px":"10px");return v.style.fontSize=i,p.style.fontSize=i,m.style.fontSize=i,!0}).catch(function(){})}f.events.on(si.didEnterFullscreen,e),f.events.on(si.didExitFullscreen,e),window.addEventListener("orientationchange",e),y&&(c.classList.add("mobile"),e())}function x(){function n(){var e=c;if(d&&d.getFullscreenElement&&"function"==typeof d.getFullscreenElement){var t=d.getFullscreenElement();t&&t instanceof HTMLElement&&t.contains(c)&&t.classList.contains("js-player-fullscreen")&&(e=t)}return e}f.config.embed.fullscreen=!0,Te.iPad&&c.classList.add("no-fullscreen-api-support");var e=f.config.embed.playsinline&&10<=Te.iOS,t=Te.iPad||e;Fc.enabled||t||(c.classList.add("no-fullscreen-support"),Te.iOS||(f.config.embed.fullscreen=!1));var i=!1,r=!1,o=!1;f.events.on([si.pictureInPictureActivated,si.pictureInPictureDeactivated],function(){o=!0}),f.events.on(oi.forceFullscreen,function(){Fc.enabled||Fc.videoEnabled(c)?(f.events.fire(si.willEnterFullscreen),r=!1,Fc.request(n())):f.events.fire(oi.toggleNativeControls,!0)}),f.events.on(si.fullscreenButtonPressed,function(){"picture-in-picture"===f.telecine.presentationMode&&f.events.fire(oi.deactivatePictureInPicture),Fc.element?(f.events.fire(si.willExitFullscreen),Fc.exit()):(f.events.fire(si.willEnterFullscreen),r=!0,Fc.request(n()))});var a=Fc.onenter,s=Fc.onexit;if(Fc.onenter=function(e){var t;if(!i)return n().contains(e)?(t=e,void(o?o=!1:i||(i=!0,f.events.fire(si.didEnterFullscreen,n()===t,r)))):void("function"==typeof a&&a(e))},Fc.onexit=function(){i?o?o=!1:i&&(i=!1,f.events.fire(si.didExitFullscreen,r),r||f.events.fire(oi.toggleNativeControls,!1),r=!1):"function"==typeof s&&s()},Il(c).on("click","a",function(e){Fc.element===n()&&Fc.exit()}),Il(c).on("gestureend",function(e){1<e.scale&&f.events.fire(si.fullscreenButtonPressed)}),"undefined"!=typeof MSGesture){var l=1,u=new MSGesture;u.target=c,Il(c).on("pointerdown",function(e){u.addPointer(e.pointerId)}).on(["MSGestureChange"],function(e){l*=e.scale}).on(["MSGestureEnd"],function(){(!i&&2<=l||i&&l<1)&&f.events.fire(si.fullscreenButtonPressed),l=1})}}function A(){var e,t;k(),f.events.on(si.configChanged,k),E(),e=function(o,a){return f.verifyConfig().then(function(){var e=f.config.request,t=e.signature,n=e.session,i=e.timestamp,r=e.expires;return jn("https://"+f.config.player_url+"/video/"+f.config.video.id+"/"+o+"?signature="+t+"&session="+n+"&time="+i+"&expires="+r,{method:a})}).catch(function(e){sr.captureException(e,{extra:{action:o,method:a}})})},t=function(r,o){return f.updatePhpTokens().then(function(){var e="following"===r?f.config.video.owner.id:f.config.video.id,t=f.config.user.vimeo_api_interaction_tokens,n="";if(t)switch(n="?auth=",r){case di.likes:n+=t.likes;break;case di.watchLater:n+=t.watch_later;break;case di.following:n+=t.following}var i=f.config.video.unlisted_hash&&"following"!==r?":"+f.config.video.unlisted_hash:"";return jn("https://"+f.config.vimeo_api_url+"/users/"+f.config.user.id+"/"+r+"/"+e+i+n,{method:o,withCredentials:!1,jwt:f.config.user.vimeo_api_client_token}).catch(function(e){sr.captureException(e,{extra:{action:r,method:o}})})}).catch(function(e){sr.captureException(e)})},f.events.on(si.vodButtonPressed,function(e){if(f.config.user.purchased){if(!f.config.video.vod.is_feature&&f.config.video.vod.feature_id)return void f.loadVideo(f.config.video.vod.feature_id).then(function(){return f.events.fire(si.playButtonPressed),f.config.video.vod.feature_id}).catch(function(e){sr.captureException(e),f.events.fire(oi.showOverlay,"error",{title:"Sorry",message:"There was a problem. Please try again."})});if(f.config.video.vod&&f.config.video.vod.is_coming_soon)return;f.events.fire(si.playButtonPressed)}else f.performDelegateAction(ai.purchase,function(){f.events.fire(oi.openPopup,"purchase",{productId:e})},e)}),f.events.on(si.likeButtonPressed,function(){f.config.user.logged_in?f.config.user.id!==f.config.video.owner.id&&(f.config.user.liked?f.performDelegateAction(ai.unlike,function(){f.config.video.privacy!==ii.PRIVACY_HIDE_FROM_VIMEO?t("likes","DELETE"):e("like","DELETE"),f.config.user.liked=!1,f.events.fire(si.unliked)}):f.performDelegateAction(ai.like,function(){f.config.video.privacy!==ii.PRIVACY_HIDE_FROM_VIMEO?t("likes","PUT"):e("like","PUT"),f.config.user.liked=!0,f.events.fire(si.liked)})):f.performDelegateAction(ai.loginForm,function(){f.events.fire(oi.openPopup,"login-like")},"like")}),f.events.on(si.watchLaterButtonPressed,function(){(f.config.video.url||f.config.video.privacy===ii.PRIVACY_UNLISTED)&&(f.config.user.logged_in?f.config.user.watch_later?f.performDelegateAction(ai.removeFromWatchLater,function(){t("watchlater","DELETE"),f.config.user.watch_later=!1,f.events.fire(si.removedFromWatchLater)}):f.performDelegateAction(ai.addToWatchLater,function(){t("watchlater","PUT"),f.config.user.watch_later=!0,f.events.fire(si.addedToWatchLater)}):f.performDelegateAction(ai.loginForm,function(){f.events.fire(oi.openPopup,"login-watch-later")},"watch-later"))}),f.events.on(si.collectionsButtonPressed,function(){f.performDelegateAction(ai.collectionsOverlay,function(){f.config.video.vod&&f.config.video.vod.url?S(null,f.config.video.vod.url+"#collections"):f.config.video.url&&S(null,f.config.video.url+"#collections")})}),f.events.on(si.shareButtonPressed,function(){var e=f.config.embed.settings.share&&f.config.embed.settings.share.embed_only,t=function(){f.events.fire(oi.showOverlay,"share",e)};Fc.element?t():f.performDelegateAction(ai.shareOverlay,t)}),f.events.on(si.embedButtonPressed,function(){f.config.embed.settings.share.embed_only&&f.performDelegateAction(ai.shareOverlay,function(){f.events.fire(oi.showOverlay,"share",!0)})}),f.events.on(si.followButtonPressed,function(){if(f.config.user.logged_in&&f.config.user.id!==f.config.video.owner.id){if(f.config.user.following)return t("following","DELETE"),f.config.user.following=!1,void f.events.fire(si.unfollowed);t("following","PUT"),f.config.user.following=!0,f.events.fire(si.followed)}}),T(),i.watch("ui.player.mode",b),i.watch("ui.player.breakpoint",w),x(),Bc(c,"a[data-clip-link]",S),f.events.on(oi.openVimeo,S),function(){if(!f.config.video.live_event)return u&&(u.hide(),u=null),h&&(h=null);i.get(ul)||i.get(dl)||(u=new yd(c,f,i),h=new df(f,i))}()}function L(){o||(o=new Ad(f,i,c.querySelector(".vp-overlay-wrapper")))}function P(){a||(a=new Xd(f,{uuid:f.uuid,id:c.id,isMobileDevice:!1}))}function C(){s||(s=new function(o){var a=null;return o.events.on(oi.openPopup,function(e,t){var n="https://"+o.config.player_url,i=n+"/video/"+o.config.video.id;switch(e){case"login-like":a=Nn(i+"/login/like","login",{width:670,height:545}),o.events.fire(si.popupOpened,e);break;case"login-watch-later":a=Nn(i+"/login/watch-later","login",{width:670,height:545}),o.events.fire(si.popupOpened,e);break;case"login-private-locked":a=Nn(i+"/login/private","login",{width:670,height:545}),o.events.fire(si.popupOpened,e);break;case"purchase":var r=n+"/video/"+(o.config.video.vod.feature_id||o.config.video.id)+"/purchase/vod";t&&t.productId&&(r+="/"+t.productId),r+="?referrer="+encodeURIComponent(o.config.request.referrer),a=Nn(r,"purchase",{width:790,height:670}),o.events.fire(si.popupOpened,e)}}),window.closePopup=function(e){if(a){try{a.close(),o.events.fire(si.popupClosed,e)}catch(e){}a=null}},o.config.embed.on_site||(window.confirmPurchase=function(e,t,n){t?o.loadVideo(e):n&&o.events.fire(si.playButtonPressed)}),o.config.embed.on_site||(window.confirmLoginAction=function(e,t){o.events.fire(si.userLogIn,t)}),{}}(f))}function O(){L(),P(),C(),new Hc(f,i,v),new Kc(f,i,c);var e=new lf(f,i,c);new _d(f,c.querySelector(".notification-wrapper")),new xd(f,i,c.querySelector(".vp-outro-wrapper")),new tf(f,p),new function(d,f){var e=!0,n=!1,t=!1,i=!1,r=!1,o=!1,a=!1,s=!0,l=!1,u=!1,c=!1;function h(){e=!1,f.classList.add("invisible")}function v(){f.classList.remove("hidden"),f.removeAttribute("hidden"),setTimeout(function(){e=!0,f.classList.remove("invisible")},0)}function p(){return t||i||r}function m(){e&&(p()?h():l?h():o||a&&(s&&n||h()))}function g(){e||(!o||p()?s&&!u&&(l||(a||p()?d.config.embed&&d.config.embed.settings.info_on_pause&&s&&!p()&&v():v())):v())}function y(){if(d.config.view===vi.main||d.config.view===vi.privateUnlocked){var e=!!d.config.embed.settings.byline,t=null!==d.config.video.owner.url,n=d.config.video.owner.url,i=0===d.config.embed.on_site,r=d.config.embed.settings.spatial_label,o=void 0!==d.config.video.file_codecs,a={linkToOwner:t,ownerLink:n,targetBlank:i,showPortrait:!!d.config.embed.settings.portrait,portraitImg:d.config.video.owner[1<Te.devicePixelRatio?"img_2x":"img"],showByline:e,showTitle:!!d.config.embed.settings.title,showTitleLink:null!==d.config.video.url,titleLink:d.config.video.url,title:d.config.video.title,is360:d.config.video.spatial&&r,hasHDR:o&&0<d.config.video.file_codecs.hevc.hdr.length,strings:{}};if(d.config.embed.settings.byline){var s=d.config.embed.settings.byline_badge,l="";s&&s.type&&(l=Oc.render("title_byline_badge",{targetBlank:i,cssClass:s.type,link:s.url||!1,displayBadge:!d.config.video.live_event})),a.strings.byline="from "+Oc.render("title_owner_byline",{linkToOwner:t,ownerLink:n,targetBlank:i,owner:d.config.video.owner.name})+l}var u=d.config.embed.settings.badge;if(u){var c=1<Te.devicePixelRatio?"img_2x":"img";Te.svg&&u.svg&&(c="svg"),a.showPortrait=!1,a.badge={link:u.link,img:u[c],offset:u.offset||!1,width:u.width,height:u.height,name:u.name,shadow:u.shadow||!1}}d.config.embed.autoplay&&(f.classList.add("hidden"),f.setAttribute("hidden","")),f.innerHTML=Oc.render("title",a)}}y(),d.events.on([si.mousedOut,si.mouseTimeout],m).on(si.mousedOver,g).on(si.playInitiated,function(){a=!0,s=!1,m()}).on([si.playButtonPressed,si.played],function(){u=s=!1,m()}).on(si.paused,function(e,t){t||(s=!0,g())}).on(si.ended,function(){l=!0,m()}).on(si.scrubbingStarted,function(){c=s,u=!0}).on(si.scrubbingEnded,function(){c&&(u=!1)}).on(si.willEnterFullscreen,function(){m()}).on(si.didExitFullscreen,function(e){e||g()}),Il(f).on(["pointerenter","pointerleave","mouseenter","mouseleave"],function(e){"pointerType"in e?"mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(n="pointerenter"===e.type||"MSPointerEnter"===e.type):n="mouseover"===e.type}),Il(f).on("transitionend",function(e){"opacity"===e.propertyName&&f.classList.contains("invisible")&&(f.classList.add("hidden"),f.setAttribute("hidden",""))},!1),d.events.on(si.ended,function(e){m()}),d.events.on([si.airPlayActivated],function(){o=!0,g()}).on([si.airPlayDeactivated],function(){o=!1,m()}),d.events.on(si.overlayOpened,function(e){"not-supported"!==e&&"private-unlocked"!==e&&"help"!==e&&(t=!0,n=!1,m())}).on(si.overlayClosed,function(){n=t=!1,setTimeout(g,0)}),d.events.on(si.outroDisplayed,function(e){i=!0,n=!1,m()}).on(si.outroHidden,function(){n=i=!1,setTimeout(g,0)}),d.events.on([si.menuCentered,si.menuVisibilityChanged],function(e,t){t.isCentered()&&t.isVisible()&&(r=!0,n=!1,m()),t.isCentered()&&t.isVisible()||(n=r=!1,g())}),Bc(f,".badge",function(){d.events.fire(si.badgePressed,d.config.embed.settings.badge.id)}),d.events.on(si.configChanged,function(){y(),d.config.view===vi.privateUnlocked&&g()}),d.events.on(oi.reset,function(){s=!0,u=l=a=!1,g()}),d.events.fire(si.titleModuleReady)}(f,m),Object.defineProperties(r,{pauseKeyboard:{enumerable:!0,value:e.pause},unpauseKeyboard:{enumerable:!0,value:e.unpause}})}var R={initializationHandler:function(){return O(),A(),M.resolve()},postInitializationHandler:function(){return f.telecine&&(new pd(c.querySelector(".stats-debug"),f),new of(f,i,g),new cf(f,f.telecine,c.querySelector(".vp-player-inner"))),M.resolve()},authorizationHandler:function(e){e(),L(),P();var t="Error",n="Unhandled video privacy";switch(f.config.view){case vi.privatePassword:return new M(function(t,e){f.events.fire(oi.showOverlay,"password"),f.events.once(si.passwordUnlocked,function(e){t(e)})});case vi.privateLocked:C();var i="private-locked",r=null;return f.config.user.logged_in&&(i="error",r={title:"Private Video",message:"Sorry, you don’t have permission to watch.",modal:!0,logo:!!f.config.embed.settings.branding,icon:"lock"}),f.events.fire(oi.showOverlay,i,r),M.reject();case vi.error:t=f.config.title,n=f.config.message}return f.events.fire(oi.showOverlay,"error",{title:t,message:n,modal:!0}),M.reject()}};return f.init(e,R).then(function(){return f.config.view!==vi.privateUnlocked||f.config.embed.autoplay||f.events.fire(oi.showOverlay,"private-unlocked"),!0}).catch(function(e){sr.captureException(e),L(),P(),c.classList.remove("loading"),f.events.fire(si.error,_l.id,_l)}),r}}();
